/*! third party licenses: js/vendor.LICENSE.txt */
import{n as U,V as Rt,s as To,e as De,u as Yu,d as qr,g as Uu,v as Gu,c as Eo,a as ua,b as re,f as Lo,r as Fu,B as Xt,l as ln,U as Xr,h as Zr,_ as da}from"./index-C7ej39AH.chunk.mjs";import{n as de,N as Vu,u as ju,c as Wu,g as qu,a as Xu,t as Zu,l as Ku,b as dn,d as Ju,e as Qu,f as $n,h as td,L as ed,i as ha,j as qe,k as Io,m as We,o as ee,p as Xe,q as ji,r as Kt,s as Ta,v as nd,w as id,x as $o,y as zn,z as ad,I as Wi,A as pa,B as od,C as sd,D as zo,E as Po,F as rd,G as cd,H as ld,J as ud,V as Kr,K as dd}from"./index-1hH991E4.chunk.mjs";import{s as Jr,a as J,C as Bo,j as hd,M as pd,P as fd,e as Ja,b as Qa,I as Ie,c as me,d as tn,f as md,D as gd,g as yd,S as to,h as hn,i as Pn,k as fa,l as js,m as vd,t as Ea,n as _d,o as bd,O as wd,p as Ro,r as xn,_ as Cd,q as Qr,u as tc,v as kd,w as xd,x as Sd,y as Md,z as ec,A as Ad,B as Nd,E as Ho,F as Dd,G as nc,H as Od,J as ic,K as Ws,L as Td,N as Ed,Q as Ld,R as Oi,T as Id,U as ac,V as oc,W as sc,X as La,Y as Ti,Z as $d,$ as Ei,a0 as Ia,a1 as eo,a2 as Li,a3 as zd,a4 as Pd,a5 as Bd,a6 as Rd,a7 as qs}from"./style-BvfQrJhx.chunk.mjs";import{e as Hd}from"./index-BQgRUePv.chunk.mjs";const jr="contacts",Wr="7.2.5";var Yd=function(e,i,a){var o=(a||{}).moduleName||"route";e.registerModule(o,{namespaced:!0,state:no(i.currentRoute),mutations:{ROUTE_CHANGED:function(h,d){e.state[o]=no(d.to,d.from)}}});var s=!1,r,c=e.watch(function(h){return h[o]},function(h){var d=h.fullPath;d!==r&&(r!=null&&(s=!0,i.push(h)),r=d)},{sync:!0}),l=i.afterEach(function(h,d){if(s){s=!1;return}r=h.fullPath,e.commit(o+"/ROUTE_CHANGED",{to:h,from:d})});return function(){l?.(),c?.(),e.unregisterModule(o)}};function no(e,i){var a={name:e.name,path:e.path,hash:e.hash,query:e.query,params:e.params,fullPath:e.fullPath,meta:e.meta};return i&&(a.from=no(i)),Object.freeze(a)}const Ud={name:"ContactsRoot"};var Gd=function(){var e=this,i=e._self._c;return i("router-view")},Fd=[],Vd=U(Ud,Gd,Fd,!1,null,null);const jd=Vd.exports,Wd={name:"NcActionSeparator"};var qd=function(){var e=this,i=e._self._c;return i("li",{staticClass:"action action-separator action--disabled",attrs:{role:"separator"}})},Xd=[],Zd=de(Wd,qd,Xd,!1,null,"3e2324b7");const Kd=Zd.exports,Jd={name:"NcAppContentDetails"};var Qd=function(){var e=this,i=e._self._c;return i("div",{staticClass:"app-content-details"},[e._t("default")],2)},th=[],eh=de(Jd,Qd,th,!1,null,null);const nh=eh.exports,ih={name:"NcAppContentList",props:{selection:{type:Boolean,default:!1},showDetails:{type:Boolean,default:!1}}};var ah=function(){var e=this,i=e._self._c;return i("div",{staticClass:"app-content-list",class:{selection:e.selection,showdetails:e.showDetails}},[e._t("default")],2)},oh=[],sh=de(ih,ah,oh,!1,null,null);const rh=sh.exports,ch={name:"NcAppNavigationList"};var lh=function(){var e=this,i=e._self._c;return i("ul",{staticClass:"app-navigation-list"},[e._t("default")],2)},uh=[],dh=de(ch,lh,uh,!1,null,"058e6060");const hh=dh.exports,ph={name:"NcAppNavigation",components:{NcAppNavigationList:hh,NcAppNavigationToggle:Vu},inject:{setHasAppNavigation:{default:()=>()=>Rt.util.warn("NcAppNavigation is not mounted inside NcContent, this is probably an error."),from:"NcContent:setHasAppNavigation"}},props:{ariaLabel:{type:String,default:""},ariaLabelledby:{type:String,default:""}},setup(){return{isMobile:ju()}},data(){return{open:!this.isMobile,focusTrap:null}},watch:{isMobile(){this.open=!this.isMobile,this.toggleFocusTrap()},open(){this.toggleFocusTrap()}},mounted(){this.setHasAppNavigation(!0),To("toggle-navigation",this.toggleNavigationByEventBus),De("navigation-toggled",{open:this.open}),this.focusTrap=Wu(this.$refs.appNavigationContainer,{allowOutsideClick:!0,fallbackFocus:this.$refs.appNavigationContainer,trapStack:qu(),escapeDeactivates:!1}),this.toggleFocusTrap(),Xu("n",this.onKeyDown,{prevent:!0,stop:!0})},unmounted(){this.setHasAppNavigation(!1),Yu("toggle-navigation",this.toggleNavigationByEventBus),this.focusTrap.deactivate()},methods:{async toggleNavigation(e){if(this.open===e){De("navigation-toggled",{open:this.open});return}this.open=typeof e>"u"?!this.open:e;const i=getComputedStyle(document.body),a=parseInt(i.getPropertyValue("--animation-quick"))||100;this.open&&(await this.$nextTick(),this.focusFirstElement()),setTimeout(()=>{De("navigation-toggled",{open:this.open})},1.5*a)},toggleNavigationByEventBus({open:e}){this.toggleNavigation(e)},toggleFocusTrap(){this.isMobile&&this.open?this.focusTrap.activate():this.focusTrap.deactivate()},handleEsc(){this.isMobile&&this.open&&this.toggleNavigation(!1)},focusFirstElement(){const e=Zu(this.$refs.appNavigationContainer)[0];e&&(e.focus(),Ku.debug("Focusing first element in the navigation",{element:e}))},onKeyDown(e){if(e.key==="n"){if(!this.open){this.toggleNavigation(!0);return}this.isFocusWithinNavigation()&&this.toggleNavigation(!1)}},isFocusWithinNavigation(){const e=document.activeElement;return this.$refs.appNavigationContainer?.contains(e)}}};var fh=function(){var e=this,i=e._self._c;return i("div",{ref:"appNavigationContainer",staticClass:"app-navigation",class:{"app-navigation--close":!e.open}},[i("nav",{staticClass:"app-navigation__content",attrs:{id:"app-navigation-vue","aria-hidden":e.open?"false":"true","aria-label":e.ariaLabel||void 0,"aria-labelledby":e.ariaLabelledby||void 0,inert:!e.open||void 0},on:{keydown:function(a){return!a.type.indexOf("key")&&e._k(a.keyCode,"esc",27,a.key,["Esc","Escape"])?null:e.handleEsc.apply(null,arguments)}}},[i("div",{staticClass:"app-navigation__search"},[e._t("search")],2),i("div",{staticClass:"app-navigation__body",class:{"app-navigation__body--no-list":!e.$scopedSlots.list}},[e._t("default")],2),e.$scopedSlots.list?i("NcAppNavigationList",{staticClass:"app-navigation__list"},[e._t("list")],2):e._e(),e._t("footer")],2),i("NcAppNavigationToggle",{attrs:{open:e.open},on:{"update:open":e.toggleNavigation}})],1)},mh=[],gh=de(ph,fh,mh,!1,null,"6d2acd3d");const yh=gh.exports,vh={name:"NcAppNavigationCaption",components:{NcActions:dn},inheritAttrs:!1,props:{name:{type:String,required:!0},headingId:{type:String,default:null},isHeading:{type:Boolean,default:!1},headingLevel:{type:Number,default:2}," ":{}},computed:{wrapperTag(){return this.isHeading?"div":"li"},captionTag(){const e=Math.max(2,this.headingLevel);return this.isHeading?`h${e}`:"span"},hasActions(){return!!this.$slots.actions}}};var _h=function(){var e=this,i=e._self._c;return i(e.wrapperTag,{tag:"component",staticClass:"app-navigation-caption",class:{"app-navigation-caption--heading":e.isHeading}},[i(e.captionTag,{tag:"component",staticClass:"app-navigation-caption__name",attrs:{id:e.headingId}},[e._v(" "+e._s(e.name)+" ")]),e.hasActions?i("div",{staticClass:"app-navigation-caption__actions"},[i("NcActions",e._g(e._b({scopedSlots:e._u([{key:"icon",fn:function(){return[e._t("actionsTriggerIcon")]},proxy:!0}],null,!0)},"NcActions",e.$attrs,!1),e.$listeners),[e._t("actions")],2)],1):e._e()],1)},bh=[],wh=de(vh,_h,bh,!1,null,"1133b4da");const Ch=wh.exports,kh={name:"NcAppSettingsSection",inject:["registerSection","unregisterSection"],props:{name:{type:String,required:!0},id:{type:String,required:!0,validator(e){return/^[a-z0-9\-_]+$/.test(e)}}},computed:{htmlId(){return"settings-section_"+this.id}},watch:{id(e,i){this.unregisterSection(i),this.registerSection(e,this.name,this.$slots?.icon)},name(e){this.unregisterSection(this.id),this.registerSection(this.id,e,this.$slots?.icon)}},mounted(){this.registerSection(this.id,this.name,this.$slots?.icon)},beforeDestroy(){this.unregisterSection(this.id)}};var xh=function(){var e=this,i=e._self._c;return i("section",{staticClass:"app-settings-section",attrs:{id:e.htmlId,"aria-labelledby":`${e.htmlId}--label`}},[i("h3",{staticClass:"app-settings-section__name",attrs:{id:`${e.htmlId}--label`}},[e._v(" "+e._s(e.name)+" ")]),e._t("default"),e._e()],2)},Sh=[],Mh=de(kh,xh,Sh,!1,null,"e970c9f7");const Ah=Mh.exports,Nh={name:"NcCounterBubble",props:{type:{type:String,default:"",validator(e){return["highlighted","outlined",""].includes(e)}},active:{type:Boolean,default:!1},count:{type:Number,required:!1,default:void 0},raw:{type:Boolean,required:!1,default:!1}},computed:{counterClassObject(){return{"counter-bubble__counter--highlighted":this.type==="highlighted","counter-bubble__counter--outlined":this.type==="outlined",active:this.active}},humanizedCount(){return this.humanizeCount(this.count)}},methods:{humanizeCount(e){return this.raw?e.toString():new Intl.NumberFormat(Ju(),{notation:"compact",compactDisplay:"short"}).format(e)},getHumanizedCount(){if(this.count!==void 0)return{humanized:this.humanizedCount,original:this.count.toString()};if(!this.raw&&this.$slots.default?.length===1){const e=this.$slots.default[0].text?.trim();if(e&&/^\d+$/.test(e)){const i=parseInt(e,10);return{humanized:this.humanizeCount(i),original:e}}}}},render(e){const i=this.getHumanizedCount();return e("div",{staticClass:"counter-bubble__counter",class:this.counterClassObject,attrs:{title:i&&i.original!==i.humanized?i.original:void 0}},[i?.humanized??this.$slots.default])}},Dh=null,Oh=null;var Th=de(Nh,Dh,Oh,!1,null,"f1abaa29");const ma=Th.exports,Eh={name:"NcListItem",components:{NcActions:dn,NcCounterBubble:ma,NcVNodes:Qu},props:{details:{type:String,default:""},name:{type:String,default:void 0},exact:{type:Boolean,default:!1},to:{type:[String,Object],default:null},href:{type:String,default:"#"},target:{type:String,default:""},anchorId:{type:String,default:""},bold:{type:Boolean,default:!1},compact:{type:Boolean,default:!1},active:{type:Boolean,default:!1},linkAriaLabel:{type:String,default:""},actionsAriaLabel:{type:String,default:void 0},counterNumber:{type:[Number,String],default:0},counterType:{type:String,default:"",validator(e){return["highlighted","outlined",""].indexOf(e)!==-1}},forceDisplayActions:{type:Boolean,default:!1},forceMenu:{type:Boolean,default:!1},oneLine:{type:Boolean,default:!1}},emits:["click","update:menuOpen"],setup(){const[e]=window._oc_config?.version.split(".",2)??[];return{isLegacy:e&&Number.parseInt(e)<30}},data(){return{hovered:!1,hasActions:!1,hasSubname:!1,displayActionsOnHoverFocus:!1,menuOpen:!1,hasIndicator:!1,hasDetails:!1}},computed:{showAdditionalElements(){return!this.displayActionsOnHoverFocus||this.forceDisplayActions},showDetails(){return(this.details!==""||this.hasDetails)&&(!this.displayActionsOnHoverFocus||this.forceDisplayActions)}},watch:{menuOpen(e){!e&&!this.hovered&&(this.displayActionsOnHoverFocus=!1)}},mounted(){this.checkSlots()},updated(){this.checkSlots()},methods:{onClick(e,i,a){this.$emit("click",e),!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)&&a&&(i?.(e),e.preventDefault())},showActions(){this.hasActions&&(this.displayActionsOnHoverFocus=!0),this.hovered=!1},hideActions(){this.displayActionsOnHoverFocus=!1},handleBlur(e){this.menuOpen||this.$refs["list-item"].contains(e.relatedTarget)||this.hideActions()},handleMouseleave(){this.menuOpen||(this.displayActionsOnHoverFocus=!1),this.hovered=!1},handleMouseover(){this.showActions(),this.hovered=!0},handleActionsUpdateOpen(e){this.menuOpen=e,this.$emit("update:menuOpen",e)},checkSlots(){this.hasActions!==!!this.$slots.actions&&(this.hasActions=!!this.$slots.actions),this.hasSubname!==!!this.$slots.subname&&(this.hasSubname=!!this.$slots.subname),this.hasIndicator!==!!this.$slots.indicator&&(this.hasIndicator=!!this.$slots.indicator),this.hasDetails!==!!this.$slots.details&&(this.hasDetails=!!this.$slots.details)}}};var Lh=function(){var e=this,i=e._self._c;return i(e.to?"router-link":"NcVNodes",{tag:"component",attrs:{custom:e.to?!0:null,to:e.to,exact:e.to?e.exact:null},scopedSlots:e._u([{key:"default",fn:function({href:a,navigate:o,isActive:s}){return[i("li",{staticClass:"list-item__wrapper",class:{"list-item__wrapper--active":s||e.active}},[i("div",{ref:"list-item",staticClass:"list-item",class:{"list-item--compact":e.compact,"list-item--legacy":e.isLegacy,"list-item--one-line":e.oneLine},on:{mouseover:e.handleMouseover,mouseleave:e.handleMouseleave}},[i("a",{staticClass:"list-item__anchor",attrs:{id:e.anchorId||void 0,"aria-label":e.linkAriaLabel,href:a||e.href,target:e.target||(e.href==="#"?void 0:"_blank"),rel:e.href==="#"?void 0:"noopener noreferrer"},on:{focus:e.showActions,focusout:e.handleBlur,click:function(r){return e.onClick(r,o,a)},keydown:function(r){return!r.type.indexOf("key")&&e._k(r.keyCode,"esc",27,r.key,["Esc","Escape"])?null:e.hideActions.apply(null,arguments)}}},[e._t("icon"),i("div",{staticClass:"list-item-content"},[i("div",{staticClass:"list-item-content__main"},[i("div",{staticClass:"list-item-content__name"},[e._t("name",function(){return[e._v(e._s(e.name))]})],2),e.hasSubname?i("div",{staticClass:"list-item-content__subname",class:{"list-item-content__subname--bold":e.bold}},[e._t("subname")],2):e._e()]),i("div",{staticClass:"list-item-content__details"},[e.showDetails?i("div",{staticClass:"list-item-details__details"},[e._t("details",function(){return[e._v(e._s(e.details))]})],2):e._e(),e.counterNumber||e.hasIndicator?i("div",{directives:[{name:"show",rawName:"v-show",value:e.showAdditionalElements,expression:"showAdditionalElements"}],staticClass:"list-item-details__extra"},[e.counterNumber?i("NcCounterBubble",{staticClass:"list-item-details__counter",attrs:{active:s||e.active,type:e.counterType}},[e._v(" "+e._s(e.counterNumber)+" ")]):e._e(),e.hasIndicator?i("span",{staticClass:"list-item-details__indicator"},[e._t("indicator")],2):e._e()],1):e._e()])])],2),e.$slots["extra-actions"]?i("div",{staticClass:"list-item-content__extra-actions"},[e._t("extra-actions")],2):e._e(),i("div",{directives:[{name:"show",rawName:"v-show",value:e.forceDisplayActions||e.displayActionsOnHoverFocus,expression:"forceDisplayActions || displayActionsOnHoverFocus"}],staticClass:"list-item-content__actions",on:{focusout:e.handleBlur}},[i("NcActions",{ref:"actions",attrs:{primary:s||e.active,"force-menu":e.forceMenu,"aria-label":e.actionsAriaLabel},on:{"update:open":e.handleActionsUpdateOpen},scopedSlots:e._u([e.$slots["actions-icon"]?{key:"icon",fn:function(){return[e._t("actions-icon")]},proxy:!0}:null],null,!0)},[e._t("actions")],2)],1),e.$slots.extra?i("div",{staticClass:"list-item__extra"},[e._t("extra")],2):e._e()])])]}}],null,!0)})},Ih=[],$h=de(Eh,Lh,Ih,!1,null,"40599719");const Yo=$h.exports,zh={name:"NcUserBubbleDiv"};var Ph=function(){var e=this,i=e._self._c;return i("div",[e._t("trigger")],2)},Bh=[],Rh=de(zh,Ph,Bh,!1,null,null);const Hh=Rh.exports,Yh={name:"NcUserBubble",components:{NcAvatar:$n,NcPopover:td,NcUserBubbleDiv:Hh},props:{avatarImage:{type:String,default:void 0},user:{type:String,default:void 0},displayName:{type:String,default:void 0},showUserStatus:{type:Boolean,default:!1},url:{type:String,default:void 0,validator:e=>{try{return e=new URL(e,e?.startsWith?.("/")?window.location.href:void 0),!0}catch{return!1}}},to:{type:[String,Object],default:void 0},open:{type:Boolean,default:!1},primary:{type:Boolean,default:!1},size:{type:Number,default:20},margin:{type:Number,default:2}},emits:["click","update:open"],computed:{isPopoverComponent(){return this.popoverEmpty?"NcUserBubbleDiv":"NcPopover"},isAvatarUrl(){if(!this.avatarImage)return!1;try{return!!new URL(this.avatarImage)}catch{return!1}},isCustomAvatar(){return!!this.avatarImage},hasUrl(){return this.url&&this.url.trim()!==""},isLinkComponent(){return this.hasUrl?"a":this.to?ed:"div"},popoverEmpty(){return!("default"in this.$slots)},styles(){return{content:{height:this.size+"px",lineHeight:this.size+"px",borderRadius:this.size/2+"px"},avatar:{marginInlineStart:this.margin+"px"}}}},mounted(){!this.displayName&&!this.user&&Rt.util.warn("[NcUserBubble] At least `displayName` or `user` property should be set.")},methods:{onOpenChange(e){this.$emit("update:open",e)},onClick(e){this.$emit("click",e)}}};var Uh=function(){var e=this,i=e._self._c;return i(e.isPopoverComponent,{tag:"component",staticClass:"user-bubble__wrapper",attrs:{trigger:"hover focus",shown:e.open},on:{"update:open":e.onOpenChange},scopedSlots:e._u([{key:"trigger",fn:function({attrs:a}){return[i(e.isLinkComponent,e._b({tag:"component",staticClass:"user-bubble__content",class:{"user-bubble__content--primary":e.primary},style:e.styles.content,attrs:{to:e.to,href:e.hasUrl?e.url:null},on:{click:e.onClick}},"component",a,!1),[i("NcAvatar",{staticClass:"user-bubble__avatar",style:e.styles.avatar,attrs:{url:e.isCustomAvatar&&e.isAvatarUrl?e.avatarImage:void 0,"icon-class":e.isCustomAvatar&&!e.isAvatarUrl?e.avatarImage:void 0,user:e.user,"display-name":e.displayName,size:e.size-e.margin*2,"disable-tooltip":!0,"disable-menu":!0,"show-user-status":e.showUserStatus}}),i("span",{staticClass:"user-bubble__name"},[e._v(" "+e._s(e.displayName||e.user)+" ")]),e.$slots.name?i("span",{staticClass:"user-bubble__secondary"},[e._t("name")],2):e._e()],1)]}}],null,!0)},[e._t("default")],2)},Gh=[],Fh=de(Yh,Uh,Gh,!1,null,"a62a9496");const rc=Fh.exports,Vh={name:"AccountGroupIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}};var jh=function(){var e=this,i=e._self._c;return i("span",e._b({staticClass:"material-design-icon account-group-icon",attrs:{"aria-hidden":e.title?null:"true","aria-label":e.title,role:"img"},on:{click:function(a){return e.$emit("click",a)}}},"span",e.$attrs,!1),[i("svg",{staticClass:"material-design-icon__svg",attrs:{fill:e.fillColor,width:e.size,height:e.size,viewBox:"0 0 24 24"}},[i("path",{attrs:{d:"M12,5.5A3.5,3.5 0 0,1 15.5,9A3.5,3.5 0 0,1 12,12.5A3.5,3.5 0 0,1 8.5,9A3.5,3.5 0 0,1 12,5.5M5,8C5.56,8 6.08,8.15 6.53,8.42C6.38,9.85 6.8,11.27 7.66,12.38C7.16,13.34 6.16,14 5,14A3,3 0 0,1 2,11A3,3 0 0,1 5,8M19,8A3,3 0 0,1 22,11A3,3 0 0,1 19,14C17.84,14 16.84,13.34 16.34,12.38C17.2,11.27 17.62,9.85 17.47,8.42C17.92,8.15 18.44,8 19,8M5.5,18.25C5.5,16.18 8.41,14.5 12,14.5C15.59,14.5 18.5,16.18 18.5,18.25V20H5.5V18.25M0,20V18.5C0,17.11 1.89,15.94 4.45,15.6C3.86,16.28 3.5,17.22 3.5,18.25V20H0M24,20H20.5V18.25C20.5,17.22 20.14,16.28 19.55,15.6C22.11,15.94 24,17.11 24,18.5V20Z"}},[e.title?i("title",[e._v(e._s(e.title))]):e._e()])])])},Wh=[],qh=U(Vh,jh,Wh,!1,null,null);const Uo=qh.exports,Xh={name:"CogIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}};var Zh=function(){var e=this,i=e._self._c;return i("span",e._b({staticClass:"material-design-icon cog-icon",attrs:{"aria-hidden":e.title?null:"true","aria-label":e.title,role:"img"},on:{click:function(a){return e.$emit("click",a)}}},"span",e.$attrs,!1),[i("svg",{staticClass:"material-design-icon__svg",attrs:{fill:e.fillColor,width:e.size,height:e.size,viewBox:"0 0 24 24"}},[i("path",{attrs:{d:"M12,15.5A3.5,3.5 0 0,1 8.5,12A3.5,3.5 0 0,1 12,8.5A3.5,3.5 0 0,1 15.5,12A3.5,3.5 0 0,1 12,15.5M19.43,12.97C19.47,12.65 19.5,12.33 19.5,12C19.5,11.67 19.47,11.34 19.43,11L21.54,9.37C21.73,9.22 21.78,8.95 21.66,8.73L19.66,5.27C19.54,5.05 19.27,4.96 19.05,5.05L16.56,6.05C16.04,5.66 15.5,5.32 14.87,5.07L14.5,2.42C14.46,2.18 14.25,2 14,2H10C9.75,2 9.54,2.18 9.5,2.42L9.13,5.07C8.5,5.32 7.96,5.66 7.44,6.05L4.95,5.05C4.73,4.96 4.46,5.05 4.34,5.27L2.34,8.73C2.21,8.95 2.27,9.22 2.46,9.37L4.57,11C4.53,11.34 4.5,11.67 4.5,12C4.5,12.33 4.53,12.65 4.57,12.97L2.46,14.63C2.27,14.78 2.21,15.05 2.34,15.27L4.34,18.73C4.46,18.95 4.73,19.03 4.95,18.95L7.44,17.94C7.96,18.34 8.5,18.68 9.13,18.93L9.5,21.58C9.54,21.82 9.75,22 10,22H14C14.25,22 14.46,21.82 14.5,21.58L14.87,18.93C15.5,18.67 16.04,18.34 16.56,17.94L19.05,18.95C19.27,19.03 19.54,18.95 19.66,18.73L21.66,15.27C21.78,15.05 21.73,14.78 21.54,14.63L19.43,12.97Z"}},[e.title?i("title",[e._v(e._s(e.title))]):e._e()])])])},Kh=[],Jh=U(Xh,Zh,Kh,!1,null,null);const Go=Jh.exports,Qh={name:"LoginIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}};var tp=function(){var e=this,i=e._self._c;return i("span",e._b({staticClass:"material-design-icon login-icon",attrs:{"aria-hidden":e.title?null:"true","aria-label":e.title,role:"img"},on:{click:function(a){return e.$emit("click",a)}}},"span",e.$attrs,!1),[i("svg",{staticClass:"material-design-icon__svg",attrs:{fill:e.fillColor,width:e.size,height:e.size,viewBox:"0 0 24 24"}},[i("path",{attrs:{d:"M11 7L9.6 8.4L12.2 11H2V13H12.2L9.6 15.6L11 17L16 12L11 7M20 19H12V21H20C21.1 21 22 20.1 22 19V5C22 3.9 21.1 3 20 3H12V5H20V19Z"}},[e.title?i("title",[e._v(e._s(e.title))]):e._e()])])])},ep=[],np=U(Qh,tp,ep,!1,null,null);const ip=np.exports,ap={name:"LogoutIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}};var op=function(){var e=this,i=e._self._c;return i("span",e._b({staticClass:"material-design-icon logout-icon",attrs:{"aria-hidden":e.title?null:"true","aria-label":e.title,role:"img"},on:{click:function(a){return e.$emit("click",a)}}},"span",e.$attrs,!1),[i("svg",{staticClass:"material-design-icon__svg",attrs:{fill:e.fillColor,width:e.size,height:e.size,viewBox:"0 0 24 24"}},[i("path",{attrs:{d:"M17 7L15.59 8.41L18.17 11H8V13H18.17L15.59 15.58L17 17L22 12M4 5H12V3H4C2.9 3 2 3.9 2 5V19C2 20.1 2.9 21 4 21H12V19H4V5Z"}},[e.title?i("title",[e._v(e._s(e.title))]):e._e()])])])},sp=[],rp=U(ap,op,sp,!1,null,null);const cp=rp.exports,cc={data(){return{copied:!1,copyLoading:!1,copySuccess:!1}},computed:{copyLinkIcon(){return this.copySuccess?"icon-checkmark":this.copyLoading?"icon-loading-small":"icon-public"}},methods:{async copyToClipboard(e){this.copyLoading=!0;try{await navigator.clipboard.writeText(e),this.copySuccess=!0,this.copied=!0,Jr(t("contacts","Link copied to the clipboard"))}catch{this.copySuccess=!1,this.copied=!0,J(t("contacts","Could not copy link to the clipboard."))}finally{this.copyLoading=!1,setTimeout(()=>{this.copied=!1,this.copySuccess=!1},2e3)}}}},lc={props:{circle:{type:Bo,required:!0}},mixins:[cc],data(){return{loadingAction:!1,loadingJoin:!1}},computed:{copyButtonText(){return this.copied?this.copySuccess?t("contacts","Copied"):t("contacts","Could not copy"):t("contacts","Copy link")},circleUrl(){const e=this.$router.resolve(this.circle.router);return window.location.origin+e.href},joinButtonTitle(){return this.circle.requireJoinAccept?t("contacts","Request to join"):t("contacts","Join team")}},methods:{confirmLeaveCircle(){window.OC.dialogs.confirmDestructive(t("contacts",`You are about to leave {circle}.
Are you sure?`,{circle:this.circle.displayName}),t("contacts","Please confirm team leave"),window.OC.dialogs.YES_NO_BUTTONS,this.leaveCircle,!0)},async leaveCircle(e){if(!e){this.logger.debug("Circle leave cancelled");return}this.loadingAction=!0;const i=this.circle.initiator;try{await this.$store.dispatch("deleteMemberFromCircle",{member:i,leave:!0}),this.circle.initiator=null}catch(a){console.error("Could not leave the circle",i,a),J(t("contacts","Could not leave the team {displayName}",this.circle))}finally{this.loadingAction=!1}},async joinCircle(){this.loadingJoin=!0;try{const e=await hd(this.circle.id),i=new pd(e,this.circle);this.circle.initiator=i,i.circle.addMember(i)}catch(e){J(t("contacts","Unable to join the team")),console.error("Unable to join the circle",e)}finally{this.loadingJoin=!1}},confirmDeleteCircle(){window.OC.dialogs.confirmDestructive(t("contacts",`You are about to delete {circle}.
Are you sure?`,{circle:this.circle.displayName}),t("contacts","Please confirm team deletion"),window.OC.dialogs.YES_NO_BUTTONS,this.deleteCircle,!0)},async deleteCircle(e){if(!e){this.logger.debug("Circle deletion cancelled");return}this.loadingAction=!0;try{this.$store.dispatch("deleteCircle",this.circle.id)}catch{J(t("contacts","Unable to delete the team"))}finally{this.loadingAction=!1}},async addMemberToCircle(){try{await this.$router.push(this.circle.router)}catch{}De("contacts:circles:append",this.circle.id)}}},lp={name:"DetailsHeader",components:{Actions:dn},data(){return{avatarSize:75}},computed:{cssStyle(){return{"--avatar-size":this.avatarSize+"px"}}}};var up=function(){var e=this,i=e._self._c;return i("header",{staticClass:"contact-header",style:e.cssStyle},[i("div",{staticClass:"contact-header__no-wrap"},[i("div",{staticClass:"contact-header__avatar"},[e._t("avatar",null,{avatarSize:e.avatarSize})],2),i("div",{staticClass:"contact-header__infos"},[i("h2",{staticClass:"contact-header__infos-title"},[e._t("title")],2),e.$slots.subtitle?i("div",{staticClass:"contact-header__infos-subtitle"},[e._t("subtitle")],2):e._e(),i("div",{staticClass:"contact-header__quick-actions"},[e._t("quick-actions")],2)])]),i("div",{staticClass:"contact-header__actions"},[e._t("actions"),i("Actions",e._b({ref:"actions",staticClass:"header-menu",attrs:{"menu-align":"right"}},"Actions",e.$attrs,!1),[e._t("actions-menu")],2)],2)])},dp=[],hp=U(lp,up,dp,!1,null,"8f867b07");const uc=hp.exports,pp={name:"ContentHeading",props:{loading:{type:Boolean,default:!1}}};var fp=function(){var e=this,i=e._self._c;return i("h3",{staticClass:"app-content-heading"},[e._t("default"),e.loading?i("div",{staticClass:"app-content-heading__loader icon-loading-small"}):e._e()],2)},mp=[],gp=U(pp,fp,mp,!1,null,"1ec0b892");const Fo=gp.exports,yp={name:"CircleConfigs",components:{CheckboxRadioSwitch:ha,ContentHeading:Fo},props:{circle:{type:Bo,required:!0}},data(){return{PUBLIC_CIRCLE_CONFIG:fd,loading:!1}},methods:{isChecked(e){return(this.circle.config&e)!==0},async onChange(e,i){this.logger.debug(`Circle config ${e} is set to ${i}`),this.loading=e;const a=this.circle.config;i?e=a|e:e=a&~e;try{const o=await Ja(this.circle.id,Qa.Config,e);this.circle.config=o.config}catch(o){console.error("Unable to edit circle config",a,e,o),J(t("contacts","An error happened during the config change"))}finally{this.loading=!1}}}};var vp=function(){var e=this,i=e._self._c;return i("ul",e._l(e.PUBLIC_CIRCLE_CONFIG,function(a,o){return i("li",{key:o,staticClass:"circle-config"},[i("ContentHeading",{staticClass:"circle-config__title"},[e._v(" "+e._s(o)+" ")]),i("ul",{staticClass:"circle-config__list"},e._l(a,function(s,r){return i("CheckboxRadioSwitch",{key:"circle-config"+r,attrs:{checked:e.isChecked(r),loading:e.loading===r,disabled:e.loading!==!1,"wrapper-element":"li"},on:{"update:checked":function(c){return e.onChange(r,c)}}},[e._v(" "+e._s(s)+" ")])}),1)],1)}),0)},_p=[],bp=U(yp,vp,_p,!1,null,"4e2fc442");const wp=bp.exports,Cp={name:"CheckIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}};var kp=function(){var e=this,i=e._self._c;return i("span",e._b({staticClass:"material-design-icon check-icon",attrs:{"aria-hidden":e.title?null:"true","aria-label":e.title,role:"img"},on:{click:function(a){return e.$emit("click",a)}}},"span",e.$attrs,!1),[i("svg",{staticClass:"material-design-icon__svg",attrs:{fill:e.fillColor,width:e.size,height:e.size,viewBox:"0 0 24 24"}},[i("path",{attrs:{d:"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"}},[e.title?i("title",[e._v(e._s(e.title))]):e._e()])])])},xp=[],Sp=U(Cp,kp,xp,!1,null,null);const Vo=Sp.exports,Mp={name:"CloseIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}};var Ap=function(){var e=this,i=e._self._c;return i("span",e._b({staticClass:"material-design-icon close-icon",attrs:{"aria-hidden":e.title?null:"true","aria-label":e.title,role:"img"},on:{click:function(a){return e.$emit("click",a)}}},"span",e.$attrs,!1),[i("svg",{staticClass:"material-design-icon__svg",attrs:{fill:e.fillColor,width:e.size,height:e.size,viewBox:"0 0 24 24"}},[i("path",{attrs:{d:"M19,6.41L17.59,5L12,10.59L6.41,5L5,6.41L10.59,12L5,17.59L6.41,19L12,13.41L17.59,19L19,17.59L13.41,12L19,6.41Z"}},[e.title?i("title",[e._v(e._s(e.title))]):e._e()])])])},Np=[],Dp=U(Mp,Ap,Np,!1,null,null);const Op=Dp.exports,Tp={name:"ExitToAppIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}};var Ep=function(){var e=this,i=e._self._c;return i("span",e._b({staticClass:"material-design-icon exit-to-app-icon",attrs:{"aria-hidden":e.title?null:"true","aria-label":e.title,role:"img"},on:{click:function(a){return e.$emit("click",a)}}},"span",e.$attrs,!1),[i("svg",{staticClass:"material-design-icon__svg",attrs:{fill:e.fillColor,width:e.size,height:e.size,viewBox:"0 0 24 24"}},[i("path",{attrs:{d:"M19,3H5C3.89,3 3,3.89 3,5V9H5V5H19V19H5V15H3V19A2,2 0 0,0 5,21H19A2,2 0 0,0 21,19V5C21,3.89 20.1,3 19,3M10.08,15.58L11.5,17L16.5,12L11.5,7L10.08,8.41L12.67,11H3V13H12.67L10.08,15.58Z"}},[e.title?i("title",[e._v(e._s(e.title))]):e._e()])])])},Lp=[],Ip=U(Tp,Ep,Lp,!1,null,null);const dc=Ip.exports,$p={name:"ShieldCheckIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}};var zp=function(){var e=this,i=e._self._c;return i("span",e._b({staticClass:"material-design-icon shield-check-icon",attrs:{"aria-hidden":e.title?null:"true","aria-label":e.title,role:"img"},on:{click:function(a){return e.$emit("click",a)}}},"span",e.$attrs,!1),[i("svg",{staticClass:"material-design-icon__svg",attrs:{fill:e.fillColor,width:e.size,height:e.size,viewBox:"0 0 24 24"}},[i("path",{attrs:{d:"M10,17L6,13L7.41,11.59L10,14.17L16.59,7.58L18,9M12,1L3,5V11C3,16.55 6.84,21.74 12,23C17.16,21.74 21,16.55 21,11V5L12,1Z"}},[e.title?i("title",[e._v(e._s(e.title))]):e._e()])])])},Pp=[],Bp=U($p,zp,Pp,!1,null,null);const Rp=Bp.exports,ui={computed:{selectedContact(){return this.$route.params.selectedContact},selectedGroup(){return this.$route.params.selectedGroup},selectedCircle(){return this.$route.params.selectedCircle}}},Hp={name:"MemberListItem",components:{IconCheck:Vo,IconClose:Op,IconDelete:Ie,IconExitToApp:dc,IconShieldCheck:Rp,NcListItem:Yo,NcActionButton:qe,NcActionSeparator:Kd,NcActionText:Io,NcAvatar:$n},mixins:[ui],props:{source:{type:Object,required:!0}},data(){return{loading:!1}},computed:{circle(){return this.$store.getters.getCircle(this.selectedCircle)},levelName(){return this.source.level===me.NONE?t("contacts","Pending"):tn[this.source.level]||tn[me.MEMBER]},currentUserLevel(){return this.circle?.initiator?.level||me.MEMBER},currentUserId(){return this.circle?.initiator?.singleId},availableLevelsChange(){const e=Object.keys(tn).map(i=>parseInt(i,10)).filter(i=>i<this.currentUserLevel);return this.currentUserLevel===me.ADMIN&&e.push(me.ADMIN),this.circle.isOwner&&e.push(me.OWNER),e.filter(i=>i!==this.source.level)},isCurrentUser(){return this.currentUserId===this.source.singleId},isPendingApproval(){return this.source?.level===me.NONE&&this.source?.status===md.REQUESTING},canChangeLevel(){return this.source.level>me.NONE&&this.availableLevelsChange.length>0&&this.currentUserLevel>=this.source.level&&this.circle.canManageMembers&&!(this.circle.isOwner&&this.isCurrentUser)},canDelete(){return this.circle.canManageMembers&&this.source.level<=this.currentUserLevel&&!this.isCurrentUser},avatarSize(){return parseInt(window.getComputedStyle(document.body).getPropertyValue("--default-clickable-area"))}},methods:{levelChangeLabel(e){return e===me.OWNER?t("contacts","Promote as sole owner"):this.source.level<e?t("contacts","Promote to {level}",{level:tn[e]}):t("contacts","Demote to {level}",{level:tn[e]})},async deleteMember(){if(this.isCurrentUser)try{await new gd().setName(t("contacts","Leave team")).setText(t("contacts","Are you sure you want to leave this team? This action cannot be undone.")).setButtons([{label:t("contacts","Cancel"),type:"secondary",callback:()=>{}},{label:t("contacts","Leave team"),type:"error",callback:async()=>{try{await this.doDeleteMember()}catch(e){this.logger.error("Error in delete member callback",{e}),J(t("contacts","Leave team failed."))}}}]).build().show()}catch{}else await this.doDeleteMember()},async doDeleteMember(){this.loading=!0;try{await this.$store.dispatch("deleteMemberFromCircle",{member:this.source,leave:this.isCurrentUser})}catch(e){if(e?.response?.status===404){this.logger.debug("Member is not in circle");return}this.logger.error("Could not delete the member",{member:this.source,error:e}),J(t("contacts","Could not delete the member {displayName}",this.source))}finally{this.loading=!1}},async changeLevel(e){this.loading=!0;try{if(await yd(this.circle.id,this.source.id,e),this.showLevelMenu=!1,e===me.OWNER){await this.$store.dispatch("getCircle",this.circle.id),await this.$store.dispatch("getCircleMembers",this.circle.id);return}this.source.level=e}catch(i){this.logger.error("Could not change the member level",{level:tn[e],error:i}),J(t("contacts","Could not change the member level to {level}",{level:tn[e]}))}finally{this.loading=!1}},async acceptMember(){this.loading=!0;try{await await this.$store.dispatch("acceptCircleMember",{circleId:this.circle.id,memberId:this.source.id})}catch(e){this.logger.error("Could not accept membership request",{member:this.source,error:e}),J(t("contacts","Could not accept membership request"))}finally{this.loading=!1}},onMenuClose(){this.showLevelMenu=!1}}};var Yp=function(){var e=this,i=e._self._c;return i("NcListItem",{staticClass:"members-list-item",attrs:{compact:"",name:e.source.displayName},scopedSlots:e._u([{key:"icon",fn:function(){return[i("NcAvatar",{attrs:{"disable-menu":"",size:e.avatarSize,"display-name":e.source.displayName,"is-no-user":!e.source.isUser}})]},proxy:!0},{key:"subname",fn:function(){return[e._v(" "+e._s(e.levelName)+" ")]},proxy:!0},!e.loading&&e.isPendingApproval&&e.circle.canManageMembers?{key:"extra-actions",fn:function(){return[i("NcButton",{on:{click:e.acceptMember},scopedSlots:e._u([{key:"icon",fn:function(){return[i("IconCheck",{attrs:{size:20}})]},proxy:!0}],null,!1,905113861)},[e._v(" "+e._s(e.t("contacts","Accept membership request"))+" ")]),i("NcButton",{on:{click:e.deleteMember},scopedSlots:e._u([{key:"icon",fn:function(){return[i("IconClose",{attrs:{size:20}})]},proxy:!0}],null,!1,2888946197)},[e._v(" "+e._s(e.t("contacts","Reject membership request"))+" ")])]},proxy:!0}:{key:"actions",fn:function(){return[e.loading?i("NcActionText",{attrs:{icon:"icon-loading-small"}},[e._v(" "+e._s(e.t("contacts","Loading …"))+" ")]):[e.canChangeLevel?[i("NcActionText",{scopedSlots:e._u([{key:"icon",fn:function(){return[i("IconShieldCheck",{attrs:{size:16}})]},proxy:!0}],null,!1,3970731743)},[e._v(" "+e._s(e.t("contacts","Manage level"))+" ")]),e._l(e.availableLevelsChange,function(a){return i("NcActionButton",{key:a,attrs:{icon:""},on:{click:function(o){return e.changeLevel(a)}}},[e._v(" "+e._s(e.levelChangeLabel(a))+" ")])}),i("NcActionSeparator")]:e._e(),e.isCurrentUser&&!e.circle.isOwner?i("NcActionButton",{on:{click:e.deleteMember},scopedSlots:e._u([{key:"icon",fn:function(){return[i("IconExitToApp",{attrs:{size:16}})]},proxy:!0}],null,!1,1644731612)},[e._v(" "+e._s(e.t("contacts","Leave team"))+" ")]):e.canDelete?i("NcActionButton",{on:{click:e.deleteMember},scopedSlots:e._u([{key:"icon",fn:function(){return[i("IconDelete",{attrs:{size:20}})]},proxy:!0}])},[e._v(" "+e._s(e.t("contacts","Remove member"))+" ")]):e._e()]]},proxy:!0}],null,!0)})},Up=[],Gp=U(Hp,Yp,Up,!1,null,null);const Fp=Gp.exports,Vp=qr({__name:"MemberListGroup",props:{label:null,type:null,members:null},setup(e){return{__sfc:!0,MemberListItem:Fp}}});var jp=function(){var e=this,i=e._self._c,a=e._self._setupProxy;return i("div",{staticClass:"member-list-group"},[i("h4",{staticClass:"member-list-group__heading",attrs:{id:`member-list-group-${e.type}`}},[e._v(" "+e._s(e.label)+" ")]),i("ul",{staticClass:"member-list-group__list",attrs:{"aria-labelledby":`member-list-group-${e.type}`}},e._l(e.members,function(o){return i(a.MemberListItem,{key:o.singleId,attrs:{source:o}})}),1)])},Wp=[],qp=U(Vp,jp,Wp,!1,null,"5cc5fa63");const Xp=qp.exports;var hc={exports:{}};const Zp=Uu(Gu);(function(e,i){(function(a,o){e.exports=o(Zp)})(Eo,function(a){a=a&&Object.prototype.hasOwnProperty.call(a,"default")?a.default:a;function o(x,C){var y=Object.keys(x);if(Object.getOwnPropertySymbols){var A=Object.getOwnPropertySymbols(x);C&&(A=A.filter(function(D){return Object.getOwnPropertyDescriptor(x,D).enumerable})),y.push.apply(y,A)}return y}function s(x){for(var C=1;C<arguments.length;C++){var y=arguments[C]!=null?arguments[C]:{};C%2?o(Object(y),!0).forEach(function(A){h(x,A,y[A])}):Object.getOwnPropertyDescriptors?Object.defineProperties(x,Object.getOwnPropertyDescriptors(y)):o(Object(y)).forEach(function(A){Object.defineProperty(x,A,Object.getOwnPropertyDescriptor(y,A))})}return x}function r(x,C){if(!(x instanceof C))throw new TypeError("Cannot call a class as a function")}function c(x,C){for(var y=0;y<C.length;y++){var A=C[y];A.enumerable=A.enumerable||!1,A.configurable=!0,"value"in A&&(A.writable=!0),Object.defineProperty(x,A.key,A)}}function l(x,C,y){return C&&c(x.prototype,C),Object.defineProperty(x,"prototype",{writable:!1}),x}function h(x,C,y){return C in x?Object.defineProperty(x,C,{value:y,enumerable:!0,configurable:!0,writable:!0}):x[C]=y,x}function d(x){return m(x)||g(x)||b(x)||N()}function m(x){if(Array.isArray(x))return k(x)}function g(x){if(typeof Symbol<"u"&&x[Symbol.iterator]!=null||x["@@iterator"]!=null)return Array.from(x)}function b(x,C){if(x){if(typeof x=="string")return k(x,C);var y=Object.prototype.toString.call(x).slice(8,-1);if(y==="Object"&&x.constructor&&(y=x.constructor.name),y==="Map"||y==="Set")return Array.from(x);if(y==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(y))return k(x,C)}}function k(x,C){(C==null||C>x.length)&&(C=x.length);for(var y=0,A=new Array(C);y<C;y++)A[y]=x[y];return A}function N(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var L={FRONT:"FRONT",BEHIND:"BEHIND"},B={INIT:"INIT",FIXED:"FIXED",DYNAMIC:"DYNAMIC"},z=0,j=function(){function x(C,y){r(this,x),this.init(C,y)}return l(x,[{key:"init",value:function(C,y){this.param=C,this.callUpdate=y,this.sizes=new Map,this.firstRangeTotalSize=0,this.firstRangeAverageSize=0,this.fixedSizeValue=0,this.calcType=B.INIT,this.offset=0,this.direction="",this.range=Object.create(null),C&&this.checkRange(0,C.keeps-1)}},{key:"destroy",value:function(){this.init(null,null)}},{key:"getRange",value:function(){var C=Object.create(null);return C.start=this.range.start,C.end=this.range.end,C.padFront=this.range.padFront,C.padBehind=this.range.padBehind,C}},{key:"isBehind",value:function(){return this.direction===L.BEHIND}},{key:"isFront",value:function(){return this.direction===L.FRONT}},{key:"getOffset",value:function(C){return(C<1?0:this.getIndexOffset(C))+this.param.slotHeaderSize}},{key:"updateParam",value:function(C,y){var A=this;this.param&&C in this.param&&(C==="uniqueIds"&&this.sizes.forEach(function(D,H){y.includes(H)||A.sizes.delete(H)}),this.param[C]=y)}},{key:"saveSize",value:function(C,y){this.sizes.set(C,y),this.calcType===B.INIT?(this.fixedSizeValue=y,this.calcType=B.FIXED):this.calcType===B.FIXED&&this.fixedSizeValue!==y&&(this.calcType=B.DYNAMIC,delete this.fixedSizeValue),this.calcType!==B.FIXED&&typeof this.firstRangeTotalSize<"u"&&(this.sizes.size<Math.min(this.param.keeps,this.param.uniqueIds.length)?(this.firstRangeTotalSize=d(this.sizes.values()).reduce(function(A,D){return A+D},0),this.firstRangeAverageSize=Math.round(this.firstRangeTotalSize/this.sizes.size)):delete this.firstRangeTotalSize)}},{key:"handleDataSourcesChange",value:function(){var C=this.range.start;this.isFront()?C=C-z:this.isBehind()&&(C=C+z),C=Math.max(C,0),this.updateRange(this.range.start,this.getEndByStart(C))}},{key:"handleSlotSizeChange",value:function(){this.handleDataSourcesChange()}},{key:"handleScroll",value:function(C){this.direction=C<this.offset||C===0?L.FRONT:L.BEHIND,this.offset=C,this.param&&(this.direction===L.FRONT?this.handleFront():this.direction===L.BEHIND&&this.handleBehind())}},{key:"handleFront",value:function(){var C=this.getScrollOvers();if(!(C>this.range.start)){var y=Math.max(C-this.param.buffer,0);this.checkRange(y,this.getEndByStart(y))}}},{key:"handleBehind",value:function(){var C=this.getScrollOvers();C<this.range.start+this.param.buffer||this.checkRange(C,this.getEndByStart(C))}},{key:"getScrollOvers",value:function(){var C=this.offset-this.param.slotHeaderSize;if(C<=0)return 0;if(this.isFixedType())return Math.floor(C/this.fixedSizeValue);for(var y=0,A=0,D=0,H=this.param.uniqueIds.length;y<=H;){if(A=y+Math.floor((H-y)/2),D=this.getIndexOffset(A),D===C)return A;D<C?y=A+1:D>C&&(H=A-1)}return y>0?--y:0}},{key:"getIndexOffset",value:function(C){if(!C)return 0;for(var y=0,A=0,D=0;D<C;D++)A=this.sizes.get(this.param.uniqueIds[D]),y=y+(typeof A=="number"?A:this.getEstimateSize());return y}},{key:"isFixedType",value:function(){return this.calcType===B.FIXED}},{key:"getLastIndex",value:function(){return this.param.uniqueIds.length-1}},{key:"checkRange",value:function(C,y){var A=this.param.keeps,D=this.param.uniqueIds.length;D<=A?(C=0,y=this.getLastIndex()):y-C<A-1&&(C=y-A+1),this.range.start!==C&&this.updateRange(C,y)}},{key:"updateRange",value:function(C,y){this.range.start=C,this.range.end=y,this.range.padFront=this.getPadFront(),this.range.padBehind=this.getPadBehind(),this.callUpdate(this.getRange())}},{key:"getEndByStart",value:function(C){var y=C+this.param.keeps-1,A=Math.min(y,this.getLastIndex());return A}},{key:"getPadFront",value:function(){return this.isFixedType()?this.fixedSizeValue*this.range.start:this.getIndexOffset(this.range.start)}},{key:"getPadBehind",value:function(){var C=this.range.end,y=this.getLastIndex();return this.isFixedType()?(y-C)*this.fixedSizeValue:(y-C)*this.getEstimateSize()}},{key:"getEstimateSize",value:function(){return this.isFixedType()?this.fixedSizeValue:this.firstRangeAverageSize||this.param.estimateSize}}]),x}(),V={dataKey:{type:[String,Function],required:!0},dataSources:{type:Array,required:!0},dataComponent:{type:[Object,Function],required:!0},keeps:{type:Number,default:30},extraProps:{type:Object},estimateSize:{type:Number,default:50},direction:{type:String,default:"vertical"},start:{type:Number,default:0},offset:{type:Number,default:0},topThreshold:{type:Number,default:0},bottomThreshold:{type:Number,default:0},pageMode:{type:Boolean,default:!1},rootTag:{type:String,default:"div"},wrapTag:{type:String,default:"div"},wrapClass:{type:String,default:""},wrapStyle:{type:Object},itemTag:{type:String,default:"div"},itemClass:{type:String,default:""},itemClassAdd:{type:Function},itemStyle:{type:Object},headerTag:{type:String,default:"div"},headerClass:{type:String,default:""},headerStyle:{type:Object},footerTag:{type:String,default:"div"},footerClass:{type:String,default:""},footerStyle:{type:Object},itemScopedSlots:{type:Object}},X={index:{type:Number},event:{type:String},tag:{type:String},horizontal:{type:Boolean},source:{type:Object},component:{type:[Object,Function]},slotComponent:{type:Function},uniqueKey:{type:[String,Number]},extraProps:{type:Object},scopedSlots:{type:Object}},ut={event:{type:String},uniqueKey:{type:String},tag:{type:String},horizontal:{type:Boolean}},lt={created:function(){this.shapeKey=this.horizontal?"offsetWidth":"offsetHeight"},mounted:function(){var x=this;typeof ResizeObserver<"u"&&(this.resizeObserver=new ResizeObserver(function(){x.dispatchSizeChange()}),this.resizeObserver.observe(this.$el))},updated:function(){this.resizeObserver.observe(this.$el)},beforeDestroy:function(){this.resizeObserver&&(this.resizeObserver.disconnect(),this.resizeObserver=null)},methods:{getCurrentSize:function(){return this.$el?this.$el[this.shapeKey]:0},dispatchSizeChange:function(){this.$parent.$emit(this.event,this.uniqueKey,this.getCurrentSize(),this.hasInitial)}}},it=a.component("virtual-list-item",{mixins:[lt],props:X,render:function(x){var C=this.tag,y=this.component,A=this.extraProps,D=A===void 0?{}:A,H=this.index,F=this.source,q=this.scopedSlots,Z=q===void 0?{}:q,Q=this.uniqueKey,ot=this.slotComponent,xt=s(s({},D),{},{source:F,index:H});return x(C,{key:Q,attrs:{role:"listitem"}},[ot?ot({item:F,index:H,scope:xt}):x(y,{props:xt,scopedSlots:Z})])}}),yt=a.component("virtual-list-slot",{mixins:[lt],props:ut,render:function(x){var C=this.tag,y=this.uniqueKey;return x(C,{key:y,attrs:{role:y}},this.$slots.default)}}),vt={ITEM:"item_resize",SLOT:"slot_resize"},_t={HEADER:"thead",FOOTER:"tfoot"},S=a.component("virtual-list",{props:V,data:function(){return{range:null}},watch:{"dataSources.length":function(){this.virtual.updateParam("uniqueIds",this.getUniqueIdFromDataSources()),this.virtual.handleDataSourcesChange()},keeps:function(x){this.virtual.updateParam("keeps",x),this.virtual.handleSlotSizeChange()},start:function(x){this.scrollToIndex(x)},offset:function(x){this.scrollToOffset(x)}},created:function(){this.isHorizontal=this.direction==="horizontal",this.directionKey=this.isHorizontal?"scrollLeft":"scrollTop",this.installVirtual(),this.$on(vt.ITEM,this.onItemResized),(this.$slots.header||this.$slots.footer)&&this.$on(vt.SLOT,this.onSlotResized)},activated:function(){this.scrollToOffset(this.virtual.offset),this.pageMode&&document.addEventListener("scroll",this.onScroll,{passive:!1})},deactivated:function(){this.pageMode&&document.removeEventListener("scroll",this.onScroll)},mounted:function(){this.start?this.scrollToIndex(this.start):this.offset&&this.scrollToOffset(this.offset),this.pageMode&&(this.updatePageModeFront(),document.addEventListener("scroll",this.onScroll,{passive:!1}))},beforeDestroy:function(){this.virtual.destroy(),this.pageMode&&document.removeEventListener("scroll",this.onScroll)},methods:{getSize:function(x){return this.virtual.sizes.get(x)},getSizes:function(){return this.virtual.sizes.size},getOffset:function(){if(this.pageMode)return document.documentElement[this.directionKey]||document.body[this.directionKey];var x=this.$refs.root;return x?Math.ceil(x[this.directionKey]):0},getClientSize:function(){var x=this.isHorizontal?"clientWidth":"clientHeight";if(this.pageMode)return document.documentElement[x]||document.body[x];var C=this.$refs.root;return C?Math.ceil(C[x]):0},getScrollSize:function(){var x=this.isHorizontal?"scrollWidth":"scrollHeight";if(this.pageMode)return document.documentElement[x]||document.body[x];var C=this.$refs.root;return C?Math.ceil(C[x]):0},scrollToOffset:function(x){if(this.pageMode)document.body[this.directionKey]=x,document.documentElement[this.directionKey]=x;else{var C=this.$refs.root;C&&(C[this.directionKey]=x)}},scrollToIndex:function(x){if(x>=this.dataSources.length-1)this.scrollToBottom();else{var C=this.virtual.getOffset(x);this.scrollToOffset(C)}},scrollToBottom:function(){var x=this,C=this.$refs.shepherd;if(C){var y=C[this.isHorizontal?"offsetLeft":"offsetTop"];this.scrollToOffset(y),setTimeout(function(){x.getOffset()+x.getClientSize()+1<x.getScrollSize()&&x.scrollToBottom()},3)}},updatePageModeFront:function(){var x=this.$refs.root;if(x){var C=x.getBoundingClientRect(),y=x.ownerDocument.defaultView,A=this.isHorizontal?C.left+y.pageXOffset:C.top+y.pageYOffset;this.virtual.updateParam("slotHeaderSize",A)}},reset:function(){this.virtual.destroy(),this.scrollToOffset(0),this.installVirtual()},installVirtual:function(){this.virtual=new j({slotHeaderSize:0,slotFooterSize:0,keeps:this.keeps,estimateSize:this.estimateSize,buffer:Math.round(this.keeps/3),uniqueIds:this.getUniqueIdFromDataSources()},this.onRangeChanged),this.range=this.virtual.getRange()},getUniqueIdFromDataSources:function(){var x=this.dataKey;return this.dataSources.map(function(C){return typeof x=="function"?x(C):C[x]})},onItemResized:function(x,C){this.virtual.saveSize(x,C),this.$emit("resized",x,C)},onSlotResized:function(x,C,y){x===_t.HEADER?this.virtual.updateParam("slotHeaderSize",C):x===_t.FOOTER&&this.virtual.updateParam("slotFooterSize",C),y&&this.virtual.handleSlotSizeChange()},onRangeChanged:function(x){this.range=x},onScroll:function(x){var C=this.getOffset(),y=this.getClientSize(),A=this.getScrollSize();C<0||C+y>A+1||!A||(this.virtual.handleScroll(C),this.emitEvent(C,y,A,x))},emitEvent:function(x,C,y,A){this.$emit("scroll",A,this.virtual.getRange()),this.virtual.isFront()&&this.dataSources.length&&x-this.topThreshold<=0?this.$emit("totop"):this.virtual.isBehind()&&x+C+this.bottomThreshold>=y&&this.$emit("tobottom")},getRenderSlots:function(x){for(var C=[],y=this.range,A=y.start,D=y.end,H=this.dataSources,F=this.dataKey,q=this.itemClass,Z=this.itemTag,Q=this.itemStyle,ot=this.isHorizontal,xt=this.extraProps,mt=this.dataComponent,Et=this.itemScopedSlots,Pt=this.$scopedSlots&&this.$scopedSlots.item,St=A;St<=D;St++){var Nt=H[St];if(Nt){var jt=typeof F=="function"?F(Nt):Nt[F];typeof jt=="string"||typeof jt=="number"?C.push(x(it,{props:{index:St,tag:Z,event:vt.ITEM,horizontal:ot,uniqueKey:jt,source:Nt,extraProps:xt,component:mt,slotComponent:Pt,scopedSlots:Et},style:Q,class:"".concat(q).concat(this.itemClassAdd?" "+this.itemClassAdd(St):"")})):console.warn("Cannot get the data-key '".concat(F,"' from data-sources."))}else console.warn("Cannot get the index '".concat(St,"' from data-sources."))}return C}},render:function(x){var C=this.$slots,y=C.header,A=C.footer,D=this.range,H=D.padFront,F=D.padBehind,q=this.isHorizontal,Z=this.pageMode,Q=this.rootTag,ot=this.wrapTag,xt=this.wrapClass,mt=this.wrapStyle,Et=this.headerTag,Pt=this.headerClass,St=this.headerStyle,Nt=this.footerTag,jt=this.footerClass,Hn=this.footerStyle,fn={padding:q?"0px ".concat(F,"px 0px ").concat(H,"px"):"".concat(H,"px 0px ").concat(F,"px")},mi=mt?Object.assign({},mt,fn):fn;return x(Q,{ref:"root",on:{"&scroll":!Z&&this.onScroll}},[y?x(yt,{class:Pt,style:St,props:{tag:Et,event:vt.SLOT,uniqueKey:_t.HEADER}},y):null,x(ot,{class:xt,attrs:{role:"group"},style:mi},this.getRenderSlots(x)),A?x(yt,{class:jt,style:Hn,props:{tag:Nt,event:vt.SLOT,uniqueKey:_t.FOOTER}},A):null,x("div",{ref:"shepherd",style:{width:q?"0px":"100%",height:q?"100%":"0px"}})])}});return S})})(hc);var Kp=hc.exports;const pc=ua(Kp),Jp={name:"MagnifyIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}};var Qp=function(){var e=this,i=e._self._c;return i("span",e._b({staticClass:"material-design-icon magnify-icon",attrs:{"aria-hidden":e.title?null:"true","aria-label":e.title,role:"img"},on:{click:function(a){return e.$emit("click",a)}}},"span",e.$attrs,!1),[i("svg",{staticClass:"material-design-icon__svg",attrs:{fill:e.fillColor,width:e.size,height:e.size,viewBox:"0 0 24 24"}},[i("path",{attrs:{d:"M9.5,3A6.5,6.5 0 0,1 16,9.5C16,11.11 15.41,12.59 14.44,13.73L14.71,14H15.5L20.5,19L19,20.5L14,15.5V14.71L13.73,14.44C12.59,15.41 11.11,16 9.5,16A6.5,6.5 0 0,1 3,9.5A6.5,6.5 0 0,1 9.5,3M9.5,5C7,5 5,7 5,9.5C5,12 7,14 9.5,14C12,14 14,12 14,9.5C14,7 12,5 9.5,5Z"}},[e.title?i("title",[e._v(e._s(e.title))]):e._e()])])])},tf=[],ef=U(Jp,Qp,tf,!1,null,null);const nf=ef.exports,af={name:"EntityBubble",components:{UserBubble:rc},props:{id:{type:String,required:!0},label:{type:String,required:!0},type:{type:String,required:!0}},methods:{onDelete(){this.$emit("delete",{id:this.id,type:this.type})}}};var of=function(){var e=this,i=e._self._c;return i("UserBubble",{staticClass:"entity-picker__bubble",attrs:{margin:0,size:22,"display-name":e.label},scopedSlots:e._u([{key:"name",fn:function(){return[i("a",{staticClass:"entity-picker__bubble-delete icon-close",attrs:{href:"#",title:e.t("contacts","Remove {type}",{type:e.type})},on:{click:e.onDelete}})]},proxy:!0}])})},sf=[],rf=U(af,of,sf,!1,null,"5c279f5d");const cf=rf.exports,lf={name:"EntitySearchResult",components:{UserBubble:rc},props:{source:{type:Object,default(){return{}}},onClick:{type:Function,default(){}},selection:{type:Object,default:()=>({})}},computed:{isSelected(){return this.source.id in this.selection}}};var uf=function(){var e=this,i=e._self._c;return e.source.heading?i("h4",{key:e.source.id,staticClass:"entity-picker__option-caption"},[e._v(" "+e._s(e.t("contacts","Add {type}",{type:e.source.label.toLowerCase()}))+" ")]):i("UserBubble",{staticClass:"entity-picker__bubble",class:{"entity-picker__bubble--selected":e.isSelected},attrs:{"display-name":e.source.label,user:e.source.user,margin:6,size:44,url:"#"},on:{click:function(a){return a.stopPropagation(),a.preventDefault(),e.onClick(e.source)}},scopedSlots:e._u([{key:"title",fn:function(){return[i("span",{staticClass:"entity-picker__bubble-checkmark icon-checkmark"})]},proxy:!0}])})},df=[],hf=U(lf,uf,df,!1,null,"bc6ac935");const pf=hf.exports,ff={name:"EntityPicker",components:{EmptyContent:We,EntityBubble:cf,IconSearch:nf,IconLoading:ee,Modal:Xe,VirtualList:pc},props:{loading:{type:Boolean,default:!1},dataTypes:{type:Array,required:!0,validator:e=>{const i=e.filter(a=>!a.id&&!a.label);return i.length>0?(console.error("The following types MUST have a proper id and label key",i),!1):!0}},dataSet:{type:Array,required:!0,validator:e=>(e.forEach(i=>{(!i.id||!i.label)&&console.error("The following source MUST have a proper id and label key",i)}),!0)},sort:{type:String,default:"label"},confirmLabel:{type:String,default:t("contacts","Add to group")},internalSearch:{type:Boolean,default:!0},selection:{type:Object,default:null},emptyDataSetDescription:{type:String,default:""}},data(){return{searchQuery:"",localSelection:{},EntitySearchResult:pf}},computed:{selectionSet:{get(){return this.selection!==null?this.selection:this.localSelection},set(e){this.selection!==null&&this.$emit("update:selection",e),this.localSelection=e}},isSingleType(){return!(this.dataTypes.length>1)},isEmptySelection(){return Object.keys(this.selectionSet).length===0},searchPlaceholderTypes(){return`${this.dataTypes.map(e=>e.label).join(", ")}…`},searchSet(){return this.internalSearch&&this.searchQuery&&this.searchQuery.trim!==""?this.dataSet.filter(e=>e.label.toLowerCase().indexOf(this.searchQuery.toLowerCase())>-1):this.dataSet},availableEntities(){return this.isSingleType?this.searchSet:this.dataTypes.map(e=>{const i=this.searchSet.filter(o=>o.type===e.id),a=[{id:e.id,label:e.label,heading:!0},...i];return i.length===0?[]:a}).flat()}},mounted(){this.$nextTick(()=>{this.$refs.input.focus(),this.$refs.input.select()})},methods:{onCancel(){this.$emit("close")},onSubmit(){this.$emit("submit",Object.values(this.selectionSet))},onSearch:ji(function(){this.$emit("search",this.searchQuery)},200),onDelete(e){this.$delete(this.selectionSet,e.id,e),console.debug("Removing entity from selection",e)},onClick(e){if(e.id in this.selectionSet){this.$delete(this.selectionSet,e.id),console.debug("Removed entity to selection",e);return}this.$set(this.selectionSet,e.id,e),console.debug("Added entity to selection",e)},onToggle(e){e.id in this.selectionSet?this.onDelete(e):this.onPick(e)}}};var mf=function(){var e=this,i=e._self._c;return i("Modal",{attrs:{size:"normal"},on:{close:e.onCancel}},[i("div",{staticClass:"entity-picker"},[i("div",{staticClass:"entity-picker__search"},[i("div",{staticClass:"entity-picker__search-icon icon-search"}),i("input",{directives:[{name:"model",rawName:"v-model",value:e.searchQuery,expression:"searchQuery"}],ref:"input",staticClass:"entity-picker__search-input",attrs:{placeholder:e.t("contacts","Search {types}",{types:e.searchPlaceholderTypes}),type:"search"},domProps:{value:e.searchQuery},on:{input:[function(a){a.target.composing||(e.searchQuery=a.target.value)},e.onSearch]}})]),e.loading?i("EmptyContent",{attrs:{name:e.t("contacts","Loading …")},scopedSlots:e._u([{key:"icon",fn:function(){return[i("IconLoading",{attrs:{size:20}})]},proxy:!0}],null,!1,3081367109)}):[Object.keys(e.selectionSet).length>0?i("transition-group",{staticClass:"entity-picker__selection",attrs:{name:"zoom",tag:"ul"}},e._l(e.selectionSet,function(a){return i("EntityBubble",e._b({key:a.key||`entity-${a.type}-${a.id}`,on:{delete:function(o){return e.onDelete(a)}}},"EntityBubble",a,!1))}),1):e._e(),e.dataSet.length===0?i("EmptyContent",{attrs:{name:e.t("contacts","Search for people to add"),description:e.emptyDataSetDescription},scopedSlots:e._u([{key:"icon",fn:function(){return[i("IconSearch",{attrs:{size:20}})]},proxy:!0}],null,!1,2588625165)}):e.searchSet.length>0&&e.availableEntities.length>0?i("VirtualList",{staticClass:"entity-picker__options",attrs:{"data-key":"id","data-sources":e.availableEntities,"data-component":e.EntitySearchResult,"estimate-size":44,"extra-props":{selection:e.selectionSet,onClick:e.onClick}}}):e.searchQuery?i("EmptyContent",{attrs:{name:e.t("contacts","No results")},scopedSlots:e._u([{key:"icon",fn:function(){return[i("IconSearch",{attrs:{size:20}})]},proxy:!0}])}):e._e(),i("div",{staticClass:"entity-picker__navigation"},[i("button",{staticClass:"navigation__button-left",attrs:{disabled:e.loading},on:{click:e.onCancel}},[e._v(" "+e._s(e.t("contacts","Cancel"))+" ")]),i("button",{staticClass:"navigation__button-right primary",attrs:{disabled:e.isEmptySelection||e.loading},on:{click:e.onSubmit}},[e._v(" "+e._s(e.confirmLabel)+" ")])])]],2)])},gf=[],yf=U(ff,mf,gf,!1,null,"7031588b");const fc=yf.exports,mc=Object.keys(to),vf=parseInt(window.OC.config["sharing.maxAutocompleteResults"],10)||25,_f=async function(e){const i=await re.get(Lo("apps/files_sharing/api/v1/sharees"),{params:{format:"json",itemType:"contacts",search:e,perPage:vf,shareType:mc,lookup:!1}}),a=i.data.ocs.data,o=i.data.ocs.data.exact;a.exact=[];const s=Object.values(o).reduce((g,b)=>g.concat(b),[]),r=Object.values(a).reduce((g,b)=>g.concat(b),[]),c=s.filter(g=>typeof g=="object").map(g=>io(g)).sort((g,b)=>g.shareType-b.shareType),l=r.filter(g=>typeof g=="object").map(g=>io(g)).sort((g,b)=>g.shareType-b.shareType),h=c.concat(l),d=h.reduce((g,b)=>(b.displayName&&(g[b.displayName]||(g[b.displayName]=0),g[b.displayName]++),g),{}),m=h.map(g=>d[g.displayName]>1&&!g.desc?{...g,desc:g.shareWithDisplayNameUnique}:g);return console.info("suggestions",m),m},bf=async function(){const e=(await re.get(Lo("apps/files_sharing/api/v1/sharees_recommended"),{params:{format:"json",itemType:"contacts",shareType:mc}})).data.ocs.data.exact,i=Object.values(e).reduce((a,o)=>a.concat(o),[]).map(a=>io(a));return console.info("recommendations",i),i},io=function(e){const i=`picker-${e.value.shareType}`;return{label:e.label,id:`${i}-${e.value.shareWith}`,user:[window.OC.Share.SHARE_TYPE_USER,window.OC.Share.SHARE_TYPE_REMOTE].indexOf(e.value.shareType)>-1?e.value.shareWith:null,type:i,...e.value}},wf=qr({name:"MemberList",components:{EntityPicker:fc,IconContact:hn,IconAdd:Pn,MemberListGroup:Xp,NcButton:Kt,NcEmptyContent:We,NcLoadingIcon:ee},mixins:[fa,ui],props:{list:{type:Array,required:!0},loading:{type:Boolean,default:!1}},data(){return{pickerLoading:!1,showPicker:!1,showPickerIntro:!0,recommendations:[],pickerCircle:null,pickerData:[],pickerSelection:{},pickerTypes:js}},computed:{circle(){return this.$store.getters.getCircle(this.selectedCircle)},hasMembers(){return this.groupedList.length>0},filteredPickerData(){return this.pickerData.filter(e=>{const i=to[e.shareType],a=this.list.filter(({userType:o})=>o===i);return a?a.find(o=>o.userId===e.shareWith)===void 0:!0})},groupedList(){return js.map(({labelStandalone:e,type:i})=>({type:i,label:e,members:[...this.list.filter(({userType:a})=>a===i)]})).filter(({members:e})=>e.length>0)}},mounted(){To("contacts:circles:append",this.onShowPicker)},methods:{async onShowPicker(e){this.showPicker=!0,this.pickerLoading=!0,this.pickerCircle=e;try{const i=await bf();this.recommendations=i,this.pickerData=i}catch(i){console.error("Unable to get the recommendations list",i)}finally{this.pickerLoading=!1}},async onSearch(e){if(e.trim()===""){this.pickerData=this.recommendations;return}this.pickerLoading=!0;try{const i=await _f(e);this.pickerData=i}catch(i){console.error("Unable to get the results",i),J(Ta("contacts","Unable to get the results"))}finally{this.pickerLoading=!1}},async onPickerPick(e){this.logger.info("Adding selection to circle",{selection:e,pickerCircle:this.pickerCircle}),this.pickerLoading=!0,e=e.map(i=>({id:i.shareWith,type:to[i.shareType]}));try{if((await this.$store.dispatch("addMembersToCircle",{circleId:this.pickerCircle,selection:e})).length<e.length){vd(Ta("contacts","Some members could not be added")),this.pickerSelection={};return}this.resetPicker()}catch(i){J(Ta("contacts","There was an issue adding members to the team")),console.error("There was an issue adding members to the circle",this.pickerCircle,i)}finally{this.pickerLoading=!1}},resetPicker(){this.showPicker=!1,this.pickerCircle=null,this.pickerData=[],this.pickerSelection={}}}});var Cf=function(){var e=this,i=e._self._c;return e._self._setupProxy,i("section",{staticClass:"member-list"},[i("ContentHeading",[e._v(" "+e._s(e.t("contacts","Team members"))+" ")]),e.loading?i("NcEmptyContent",{staticClass:"empty-content",attrs:{name:e.t("contacts","Loading members list …")},scopedSlots:e._u([{key:"icon",fn:function(){return[i("IconLoading",{attrs:{size:20}})]},proxy:!0}],null,!1,3081367109)}):e.circle.isMember?e.hasMembers?i("div",[i("div",{staticClass:"member-list__new"},[e.circle.canManageMembers?i("NcButton",{on:{click:function(a){return e.onShowPicker(e.circle.id)}},scopedSlots:e._u([{key:"icon",fn:function(){return[e.loading?i("NcLoadingIcon"):i("IconAdd",{attrs:{size:20}})]},proxy:!0}],null,!1,2183041309)},[e._v(" "+e._s(e.t("contacts","Add members"))+" ")]):e._e()],1),e._l(e.groupedList,function(a,o){return i("MemberListGroup",e._b({key:`member-list-group-${o}`},"MemberListGroup",a,!1))})],2):i("NcEmptyContent",{staticClass:"empty-content",attrs:{name:e.t("contacts","You currently have no access to the member list")},scopedSlots:e._u([{key:"icon",fn:function(){return[i("IconContact",{attrs:{size:20}})]},proxy:!0}])}):i("NcEmptyContent",{staticClass:"empty-content",attrs:{name:e.t("contacts","The list of members is only visible to members of this team")},scopedSlots:e._u([{key:"icon",fn:function(){return[i("IconContact",{attrs:{size:20}})]},proxy:!0}])}),e.showPicker?i("EntityPicker",{attrs:{"confirm-label":e.t("contacts","Add to {circle}",{circle:e.circle.displayName}),"data-types":e.pickerTypes,"data-set":e.filteredPickerData,"internal-search":!1,loading:e.pickerLoading,selection:e.pickerSelection},on:{"update:selection":function(a){e.pickerSelection=a},close:e.resetPicker,search:e.onSearch,submit:e.onPickerPick}}):e._e()],1)},kf=[],xf=U(wf,Cf,kf,!1,null,"bbe8e530");const Sf=xf.exports,Gn="enforce_password",Fn="password_single_enabled",vi="password_single",Mf={name:"CirclePasswordSettings",components:{ContentHeading:Fo,CheckboxRadioSwitch:ha,Button:Kt},props:{circle:{type:Object,required:!0}},data(){return{ENFORCE_PASSWORD_PROTECTION:Gn,USE_UNIQUE_PASSWORD:Fn,UNIQUE_PASSWORD:vi,loading:[],uniquePassword:"",uniquePasswordError:!1,showUniquePasswordInput:!1}},computed:{circleId(){return this.circle._data.id},enforcePasswordProtection(){const e=this.circle._data.settings[Gn];return e==="1"||e==="true"},useUniquePassword(){const e=this.circle._data.settings[Fn];return e==="1"||e==="true"}},methods:{async changePasswordProtection(){this.loading.push(Gn);try{const e=!this.enforcePasswordProtection;!e&&this.useUniquePassword&&await this.saveUseUniquePassword(!1),!e&&this.showUniquePasswordInput&&(this.showUniquePasswordInput=!1),await this.$store.dispatch("editCircleSetting",{circleId:this.circleId,setting:{setting:Gn,value:e.toString()}})}finally{this.loading=this.loading.filter(e=>e!==Gn)}},async changeUseUniquePassword(){if(!this.useUniquePassword){this.showUniquePasswordInput=!this.showUniquePasswordInput;return}await this.saveUseUniquePassword(!this.useUniquePassword)},async saveUseUniquePassword(e){this.loading.push(Fn);try{await this.$store.dispatch("editCircleSetting",{circleId:this.circleId,setting:{setting:Fn,value:e.toString()}}),e||(this.uniquePassword="",this.showUniquePasswordInput=!1)}finally{this.loading=this.loading.filter(i=>i!==Fn)}},async saveUniquePassword(){if(this.uniquePassword.length!==0){this.loading.push(vi),this.uniquePasswordError=!1;try{this.useUniquePassword||await this.saveUseUniquePassword(!0),await this.$store.dispatch("editCircleSetting",{circleId:this.circleId,setting:{setting:vi,value:this.uniquePassword}}),this.showUniquePasswordInput=!1,this.uniquePassword=""}catch{this.uniquePasswordError=!0}finally{this.loading=this.loading.filter(e=>e!==vi)}}},onClickChangePassword(){this.showUniquePasswordInput=!0}}};var Af=function(){var e=this,i=e._self._c;return i("ul",[i("li",{staticClass:"circle-config"},[i("ContentHeading",{staticClass:"circle-config__title"},[e._v(" "+e._s(e.t("contacts","Password protection"))+" ")]),i("ul",{staticClass:"circle-config__list"},[i("CheckboxRadioSwitch",{attrs:{checked:e.enforcePasswordProtection,loading:e.loading.includes(e.ENFORCE_PASSWORD_PROTECTION),disabled:e.loading.length>0,"wrapper-element":"li"},on:{"update:checked":e.changePasswordProtection}},[e._v(" "+e._s(e.t("contacts","Enforce password protection on files shared to this team"))+" ")]),e.enforcePasswordProtection?i("CheckboxRadioSwitch",{attrs:{checked:e.useUniquePassword||e.showUniquePasswordInput,loading:e.loading.includes(e.USE_UNIQUE_PASSWORD),disabled:e.loading.length>0,"wrapper-element":"li"},on:{"update:checked":e.changeUseUniquePassword}},[e._v(" "+e._s(e.t("contacts","Use a unique password for all shares to this team"))+" ")]):e._e(),i("li",{staticClass:"unique-password"},[e.showUniquePasswordInput?[i("input",{directives:[{name:"model",rawName:"v-model",value:e.uniquePassword,expression:"uniquePassword"}],attrs:{disabled:e.loading.length>0,placeholder:e.t("contacts","Unique password …"),type:"text"},domProps:{value:e.uniquePassword},on:{keyup:function(a){return!a.type.indexOf("key")&&e._k(a.keyCode,"enter",13,a.key,"Enter")?null:e.saveUniquePassword.apply(null,arguments)},input:function(a){a.target.composing||(e.uniquePassword=a.target.value)}}}),i("Button",{attrs:{type:"tertiary-no-background",disabled:e.loading.length>0||e.uniquePassword.length===0},on:{click:e.saveUniquePassword}},[e._v(" "+e._s(e.t("contacts","Save"))+" ")])]:e.useUniquePassword?i("Button",{staticClass:"change-unique-password",on:{click:e.onClickChangePassword}},[e._v(" "+e._s(e.t("contacts","Change unique password"))+" ")]):e._e(),e.uniquePasswordError?i("div",{staticClass:"unique-password-error"},[e._v(" "+e._s(e.t("contacts","Failed to save password. Please try again later."))+" ")]):e._e()],2)],1)],1)])},Nf=[],Df=U(Mf,Af,Nf,!1,null,"8009c985");const Of=Df.exports,Tf={name:"CircleDetails",components:{Avatar:$n,Button:Kt,CircleConfigs:wp,CirclePasswordSettings:Of,ContentHeading:Fo,DetailsHeader:uc,ListItem:Yo,Cog:Go,IconAccountGroup:Uo,IconDelete:Ie,Login:ip,Logout:cp,MemberList:Sf,Modal:Xe,NcEmptyContent:We,NcLoadingIcon:ee,RichContenteditable:nd},mixins:[lc],setup(){const e=Fu(),{width:i}=id(e);return{avatarList:e,width:i}},data(){return{loadingDescription:!1,loadingName:!1,showSettingsModal:!1,showMembersModal:!1,resources:null}},computed:{descriptionPlaceholder(){return this.circle.description.trim()===""?t("contacts","There is no description for this team"):t("contacts","Enter a description for the team")},isEmptyDescription(){return this.circle.description.trim()===""},showDescription(){return this.circle.isOwner?!0:!this.isEmptyDescription},members(){return Object.values(this.$store.getters.getCircle(this.circle.id)?.members||[])},maxMembers(){const e=parseInt(window.getComputedStyle(document.body).getPropertyValue("--default-clickable-area"))+12,i=Math.floor(this.width/e);return this.members.length>i?i-1:i},memberLimit(){return Math.min(this.members.length,this.maxMembers)},membersLimited(){return this.members.slice(0,this.memberLimit)},hasExtraMembers(){return this.members.length>this.maxMembers},resourceProviders(){return this.resources?.reduce((e,i)=>(e.find(a=>a.id===i.provider.id)||e.push(i.provider),e),[])??[]},resourcesForProvider(){return e=>this.resources?.filter(i=>i.provider.id===e)??[]}},watch:{"circle.id":{handler(){this.fetchTeamResources()},immediate:!0}},methods:{async fetchTeamResources(){const e=await re.get(Lo(`/teams/${this.circle.id}/resources`));this.resources=e.data.ocs.data.resources},onAutocomplete(e,i){i([])},onDescriptionChangeDebounce:ji(function(...e){this.onDescriptionChange(...e)},500),async onDescriptionChange(e){this.loadingDescription=!0;try{await Ja(this.circle.id,Qa.Description,e)}catch(i){console.error("Unable to edit team description",e,i),J(t("contacts","An error happened during description sync"))}finally{this.loadingDescription=!1}},onNameChangeDebounce:ji(function(e){this.onNameChange(e.target.value)},500),async onNameChange(e){this.loadingName=!0;try{await Ja(this.circle.id,Qa.Name,e)}catch(i){console.error("Unable to edit name",e,i),J(t("contacts","An error happened during name sync"))}finally{this.loadingName=!1}}}};var Ef=function(){var e=this,i=e._self._c;return i("div",{staticClass:"circle-details"},[i("DetailsHeader",{scopedSlots:e._u([{key:"avatar",fn:function({avatarSize:a}){return[i("Avatar",{attrs:{"disable-tooltip":!0,"display-name":e.circle.displayName,"is-no-user":!0,size:a}})]}},{key:"title",fn:function(){return[e.loadingName?i("div",{staticClass:"circle-name__loader icon-loading-small"}):e._e(),i("h2",[e._v(" "+e._s(e.circle.displayName)+" ")])]},proxy:!0},e.circle.isOwner?null:{key:"subtitle",fn:function(){return[e._v(" "+e._s(e.t("contacts","Team owned by {owner}",{owner:e.circle.owner.displayName}))+" ")]},proxy:!0},{key:"actions",fn:function(){return[i("Button",{class:e.copyLinkIcon,attrs:{type:"tertiary",href:e.circleUrl,title:e.copyButtonText},on:{click:function(a){return a.stopPropagation(),a.preventDefault(),e.copyToClipboard(e.circleUrl)}}}),(e.circle.isOwner||e.circle.isAdmin)&&!e.circle.isPersonal?i("Button",{on:{click:function(a){e.showSettingsModal=!0}},scopedSlots:e._u([{key:"icon",fn:function(){return[i("Cog",{attrs:{size:20}})]},proxy:!0}],null,!1,3604109635)},[e._v(" "+e._s(e.t("contacts","Team settings"))+" ")]):e._e(),!e.circle.isPendingMember&&!e.circle.isMember&&e.circle.canJoin?i("Button",{staticClass:"primary",attrs:{disabled:e.loadingJoin},on:{click:e.joinCircle},scopedSlots:e._u([{key:"icon",fn:function(){return[i("Login",{attrs:{size:16}})]},proxy:!0}],null,!1,1886710894)},[e._v(" "+e._s(e.t("contacts","Request to join"))+" ")]):e._e()]},proxy:!0}],null,!0)}),e.showDescription?i("section",{staticClass:"circle-details-section"},[i("ContentHeading",{attrs:{loading:e.loadingDescription}},[e._v(" "+e._s(e.t("contacts","Description"))+" ")]),i("RichContenteditable",{staticClass:"circle-details-section__description",attrs:{value:e.circle.description,"auto-complete":e.onAutocomplete,maxlength:1024,multiline:!0,contenteditable:!1,placeholder:e.descriptionPlaceholder},on:{"update:value":[function(a){return e.$set(e.circle,"description",a)},e.onDescriptionChangeDebounce]}})],1):e._e(),e.circle.isMember?i("section",[i("ContentHeading",[e._v(" "+e._s(e.t("contacts","Team resources"))+" ")]),i("p",[e._v(e._s(e.t("contacts","Anything shared with this team will show up here")))]),e._l(e.resourceProviders,function(a){return i("div",{key:a.id},[i("ContentHeading",[i("span",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],staticClass:"provider__icon",domProps:{innerHTML:e._s(a.icon)}}),e._v(" "+e._s(a.name)+" ")]),i("ul",e._l(e.resourcesForProvider(a.id),function(o){return i("ListItem",{key:o.url,staticClass:"resource",attrs:{name:o.label,href:o.url},scopedSlots:e._u([{key:"icon",fn:function(){return[o.iconEmoji?i("span",{staticClass:"resource__icon"},[e._v(" "+e._s(o.iconEmoji)+" ")]):o.iconSvg?i("span",{staticClass:"resource__icon",domProps:{innerHTML:e._s(o.iconSvg)}}):o.iconURL?i("span",{staticClass:"resource__icon"},[i("img",{attrs:{src:o.iconURL,alt:""}})]):e._e()]},proxy:!0}],null,!0)})}),1)],1)})],2):[e.circle.isPendingMember?i("NcEmptyContent",{attrs:{name:e.t("contacts","Your request to join this team is pending approval")},scopedSlots:e._u([{key:"icon",fn:function(){return[i("NcLoadingIcon",{attrs:{size:20}})]},proxy:!0}],null,!1,3155754792)}):i("NcEmptyContent",{attrs:{name:e.t("contacts","You are not a member of {circle}",{circle:e.circle.displayName})},scopedSlots:e._u([{key:"icon",fn:function(){return[i("IconAccountGroup",{attrs:{size:20}})]},proxy:!0}],null,!1,2121133277)})],e.members.length?i("MemberList",{attrs:{list:e.members}}):e._e(),(e.circle.isOwner||e.circle.isAdmin)&&!e.circle.isPersonal&&e.showSettingsModal?i("Modal",{on:{close:function(a){e.showSettingsModal=!1}}},[i("div",{staticClass:"circle-settings"},[i("h2",[e._v(e._s(e.t("contacts","Team settings")))]),i("h3",[e._v(e._s(e.t("contacts","Team name")))]),i("input",{directives:[{name:"model",rawName:"v-model",value:e.circle.displayName,expression:"circle.displayName"}],attrs:{readonly:!e.circle.isOwner,placeholder:e.t("contacts","Team name"),type:"text",autocomplete:"off",autocorrect:"off",spellcheck:"false",name:"displayname"},domProps:{value:e.circle.displayName},on:{input:[function(a){a.target.composing||e.$set(e.circle,"displayName",a.target.value)},e.onNameChangeDebounce]}}),i("h3",[e._v(e._s(e.t("contacts","Description")))]),i("RichContenteditable",{staticClass:"circle-details-section__description",attrs:{value:e.circle.description,"auto-complete":e.onAutocomplete,maxlength:1024,multiline:!0,contenteditable:e.circle.isOwner,placeholder:e.descriptionPlaceholder},on:{"update:value":[function(a){return e.$set(e.circle,"description",a)},e.onDescriptionChangeDebounce]}}),i("h3",[e._v(e._s(e.t("contacts","Settings")))]),i("CircleConfigs",{staticClass:"circle-details-section__configs",attrs:{circle:e.circle}}),i("CirclePasswordSettings",{staticClass:"circle-details-section__configs",attrs:{circle:e.circle}}),i("h3",[e._v(e._s(e.t("contacts","Actions")))]),e.circle.canLeave?i("Button",{attrs:{type:"warning"},on:{click:e.confirmLeaveCircle},scopedSlots:e._u([{key:"icon",fn:function(){return[i("Logout",{attrs:{size:16}})]},proxy:!0}],null,!1,1893119367)},[e._v(" "+e._s(e.t("contacts","Leave team"))+" ")]):e._e(),e.circle.canDelete?i("Button",{attrs:{type:"error",href:"#"},on:{click:function(a){return a.preventDefault(),a.stopPropagation(),e.confirmDeleteCircle.apply(null,arguments)}},scopedSlots:e._u([{key:"icon",fn:function(){return[i("IconDelete",{attrs:{size:20}})]},proxy:!0}],null,!1,881161434)},[e._v(" "+e._s(e.t("contacts","Delete team"))+" ")]):e._e()],1)]):e._e()],2)},Lf=[],If=U(Tf,Ef,Lf,!1,null,"e3c01036");const $f=If.exports,zf={name:"CircleContent",components:{AppContent:$o,CircleDetails:$f,EmptyContent:We,AccountGroup:Uo,IconLoading:ee},mixins:[fa,ui],props:{loading:{type:Boolean,default:!0}},data(){return{loadingList:!1}},computed:{circles(){return this.$store.getters.getCircles},circle(){return this.$store.getters.getCircle(this.selectedCircle)},members(){return Object.values(this.circle?.members||[])},isEmptyCircle(){return this.members.length===0}},watch:{circle(e){e?.id&&this.fetchCircleMembers(e.id)}},beforeMount(){this.circle?.id&&this.fetchCircleMembers(this.circle.id)},methods:{async fetchCircleMembers(e){this.loadingList=!0,this.logger.debug("Fetching members for",{circleId:e});try{await this.$store.dispatch("getCircleMembers",e)}catch(i){console.error(i),J(t("contacts","There was an error fetching the member list"))}finally{this.loadingList=!1}}}};var Pf=function(){var e=this,i=e._self._c;return i("AppContent",[e.circle?e.loading?i("EmptyContent",{staticClass:"empty-content",attrs:{name:e.t("contacts","Loading team…")},scopedSlots:e._u([{key:"icon",fn:function(){return[i("IconLoading",{attrs:{size:20}})]},proxy:!0}])}):i("CircleDetails",{attrs:{circle:e.circle}}):i("EmptyContent",{attrs:{name:e.t("contacts","Please select a team")},scopedSlots:e._u([{key:"icon",fn:function(){return[i("AccountGroup",{attrs:{size:20}})]},proxy:!0}],null,!1,4176711638)})],1)},Bf=[],Rf=U(zf,Pf,Bf,!1,null,"931d2f35");const Hf=Rf.exports;function Yf(e,i){var a=0,o=0;return Float64Array.from(e,i===void 0?s=>a+=+s||0:s=>a+=+i(s,o++,e)||0)}function Uf(e,i){let a;if(i===void 0)for(const o of e)o!=null&&(a<o||a===void 0&&o>=o)&&(a=o);else{let o=-1;for(let s of e)(s=i(s,++o,e))!=null&&(a<s||a===void 0&&s>=s)&&(a=s)}return a}function Gf(e,i){let a;if(i===void 0)for(const o of e)o!=null&&(a>o||a===void 0&&o>=o)&&(a=o);else{let o=-1;for(let s of e)(s=i(s,++o,e))!=null&&(a>s||a===void 0&&s>=s)&&(a=s)}return a}function Ff(e,i){let a=0;if(i===void 0)for(let o of e)(o=+o)&&(a+=o);else{let o=-1;for(let s of e)(s=+i(s,++o,e))&&(a+=s)}return a}var Vf={value:()=>{}};function jo(){for(var e=0,i=arguments.length,a={},o;e<i;++e){if(!(o=arguments[e]+"")||o in a||/[\s.]/.test(o))throw new Error("illegal type: "+o);a[o]=[]}return new Ii(a)}function Ii(e){this._=e}function jf(e,i){return e.trim().split(/^|\s+/).map(function(a){var o="",s=a.indexOf(".");if(s>=0&&(o=a.slice(s+1),a=a.slice(0,s)),a&&!i.hasOwnProperty(a))throw new Error("unknown type: "+a);return{type:a,name:o}})}Ii.prototype=jo.prototype={constructor:Ii,on:function(e,i){var a=this._,o=jf(e+"",a),s,r=-1,c=o.length;if(arguments.length<2){for(;++r<c;)if((s=(e=o[r]).type)&&(s=Wf(a[s],e.name)))return s;return}if(i!=null&&typeof i!="function")throw new Error("invalid callback: "+i);for(;++r<c;)if(s=(e=o[r]).type)a[s]=Xs(a[s],e.name,i);else if(i==null)for(s in a)a[s]=Xs(a[s],e.name,null);return this},copy:function(){var e={},i=this._;for(var a in i)e[a]=i[a].slice();return new Ii(e)},call:function(e,i){if((s=arguments.length-2)>0)for(var a=new Array(s),o=0,s,r;o<s;++o)a[o]=arguments[o+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(r=this._[e],o=0,s=r.length;o<s;++o)r[o].value.apply(i,a)},apply:function(e,i,a){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var o=this._[e],s=0,r=o.length;s<r;++s)o[s].value.apply(i,a)}};function Wf(e,i){for(var a=0,o=e.length,s;a<o;++a)if((s=e[a]).name===i)return s.value}function Xs(e,i,a){for(var o=0,s=e.length;o<s;++o)if(e[o].name===i){e[o]=Vf,e=e.slice(0,o).concat(e.slice(o+1));break}return a!=null&&e.push({name:i,value:a}),e}var ao="http://www.w3.org/1999/xhtml";const Zs={svg:"http://www.w3.org/2000/svg",xhtml:ao,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function ga(e){var i=e+="",a=i.indexOf(":");return a>=0&&(i=e.slice(0,a))!=="xmlns"&&(e=e.slice(a+1)),Zs.hasOwnProperty(i)?{space:Zs[i],local:e}:e}function qf(e){return function(){var i=this.ownerDocument,a=this.namespaceURI;return a===ao&&i.documentElement.namespaceURI===ao?i.createElement(e):i.createElementNS(a,e)}}function Xf(e){return function(){return this.ownerDocument.createElementNS(e.space,e.local)}}function gc(e){var i=ga(e);return(i.local?Xf:qf)(i)}function Zf(){}function Wo(e){return e==null?Zf:function(){return this.querySelector(e)}}function Kf(e){typeof e!="function"&&(e=Wo(e));for(var i=this._groups,a=i.length,o=new Array(a),s=0;s<a;++s)for(var r=i[s],c=r.length,l=o[s]=new Array(c),h,d,m=0;m<c;++m)(h=r[m])&&(d=e.call(h,h.__data__,m,r))&&("__data__"in h&&(d.__data__=h.__data__),l[m]=d);return new Zt(o,this._parents)}function Jf(e){return e==null?[]:Array.isArray(e)?e:Array.from(e)}function Qf(){return[]}function yc(e){return e==null?Qf:function(){return this.querySelectorAll(e)}}function tm(e){return function(){return Jf(e.apply(this,arguments))}}function em(e){typeof e=="function"?e=tm(e):e=yc(e);for(var i=this._groups,a=i.length,o=[],s=[],r=0;r<a;++r)for(var c=i[r],l=c.length,h,d=0;d<l;++d)(h=c[d])&&(o.push(e.call(h,h.__data__,d,c)),s.push(h));return new Zt(o,s)}function vc(e){return function(){return this.matches(e)}}function _c(e){return function(i){return i.matches(e)}}var nm=Array.prototype.find;function im(e){return function(){return nm.call(this.children,e)}}function am(){return this.firstElementChild}function om(e){return this.select(e==null?am:im(typeof e=="function"?e:_c(e)))}var sm=Array.prototype.filter;function rm(){return Array.from(this.children)}function cm(e){return function(){return sm.call(this.children,e)}}function lm(e){return this.selectAll(e==null?rm:cm(typeof e=="function"?e:_c(e)))}function um(e){typeof e!="function"&&(e=vc(e));for(var i=this._groups,a=i.length,o=new Array(a),s=0;s<a;++s)for(var r=i[s],c=r.length,l=o[s]=[],h,d=0;d<c;++d)(h=r[d])&&e.call(h,h.__data__,d,r)&&l.push(h);return new Zt(o,this._parents)}function bc(e){return new Array(e.length)}function dm(){return new Zt(this._enter||this._groups.map(bc),this._parents)}function qi(e,i){this.ownerDocument=e.ownerDocument,this.namespaceURI=e.namespaceURI,this._next=null,this._parent=e,this.__data__=i}qi.prototype={constructor:qi,appendChild:function(e){return this._parent.insertBefore(e,this._next)},insertBefore:function(e,i){return this._parent.insertBefore(e,i)},querySelector:function(e){return this._parent.querySelector(e)},querySelectorAll:function(e){return this._parent.querySelectorAll(e)}};function hm(e){return function(){return e}}function pm(e,i,a,o,s,r){for(var c=0,l,h=i.length,d=r.length;c<d;++c)(l=i[c])?(l.__data__=r[c],o[c]=l):a[c]=new qi(e,r[c]);for(;c<h;++c)(l=i[c])&&(s[c]=l)}function fm(e,i,a,o,s,r,c){var l,h,d=new Map,m=i.length,g=r.length,b=new Array(m),k;for(l=0;l<m;++l)(h=i[l])&&(b[l]=k=c.call(h,h.__data__,l,i)+"",d.has(k)?s[l]=h:d.set(k,h));for(l=0;l<g;++l)k=c.call(e,r[l],l,r)+"",(h=d.get(k))?(o[l]=h,h.__data__=r[l],d.delete(k)):a[l]=new qi(e,r[l]);for(l=0;l<m;++l)(h=i[l])&&d.get(b[l])===h&&(s[l]=h)}function mm(e){return e.__data__}function gm(e,i){if(!arguments.length)return Array.from(this,mm);var a=i?fm:pm,o=this._parents,s=this._groups;typeof e!="function"&&(e=hm(e));for(var r=s.length,c=new Array(r),l=new Array(r),h=new Array(r),d=0;d<r;++d){var m=o[d],g=s[d],b=g.length,k=ym(e.call(m,m&&m.__data__,d,o)),N=k.length,L=l[d]=new Array(N),B=c[d]=new Array(N),z=h[d]=new Array(b);a(m,g,L,B,z,k,i);for(var j=0,V=0,X,ut;j<N;++j)if(X=L[j]){for(j>=V&&(V=j+1);!(ut=B[V])&&++V<N;);X._next=ut||null}}return c=new Zt(c,o),c._enter=l,c._exit=h,c}function ym(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function vm(){return new Zt(this._exit||this._groups.map(bc),this._parents)}function _m(e,i,a){var o=this.enter(),s=this,r=this.exit();return typeof e=="function"?(o=e(o),o&&(o=o.selection())):o=o.append(e+""),i!=null&&(s=i(s),s&&(s=s.selection())),a==null?r.remove():a(r),o&&s?o.merge(s).order():s}function bm(e){for(var i=e.selection?e.selection():e,a=this._groups,o=i._groups,s=a.length,r=o.length,c=Math.min(s,r),l=new Array(s),h=0;h<c;++h)for(var d=a[h],m=o[h],g=d.length,b=l[h]=new Array(g),k,N=0;N<g;++N)(k=d[N]||m[N])&&(b[N]=k);for(;h<s;++h)l[h]=a[h];return new Zt(l,this._parents)}function wm(){for(var e=this._groups,i=-1,a=e.length;++i<a;)for(var o=e[i],s=o.length-1,r=o[s],c;--s>=0;)(c=o[s])&&(r&&c.compareDocumentPosition(r)^4&&r.parentNode.insertBefore(c,r),r=c);return this}function Cm(e){e||(e=km);function i(g,b){return g&&b?e(g.__data__,b.__data__):!g-!b}for(var a=this._groups,o=a.length,s=new Array(o),r=0;r<o;++r){for(var c=a[r],l=c.length,h=s[r]=new Array(l),d,m=0;m<l;++m)(d=c[m])&&(h[m]=d);h.sort(i)}return new Zt(s,this._parents).order()}function km(e,i){return e<i?-1:e>i?1:e>=i?0:NaN}function xm(){var e=arguments[0];return arguments[0]=this,e.apply(null,arguments),this}function Sm(){return Array.from(this)}function Mm(){for(var e=this._groups,i=0,a=e.length;i<a;++i)for(var o=e[i],s=0,r=o.length;s<r;++s){var c=o[s];if(c)return c}return null}function Am(){let e=0;for(const i of this)++e;return e}function Nm(){return!this.node()}function Dm(e){for(var i=this._groups,a=0,o=i.length;a<o;++a)for(var s=i[a],r=0,c=s.length,l;r<c;++r)(l=s[r])&&e.call(l,l.__data__,r,s);return this}function Om(e){return function(){this.removeAttribute(e)}}function Tm(e){return function(){this.removeAttributeNS(e.space,e.local)}}function Em(e,i){return function(){this.setAttribute(e,i)}}function Lm(e,i){return function(){this.setAttributeNS(e.space,e.local,i)}}function Im(e,i){return function(){var a=i.apply(this,arguments);a==null?this.removeAttribute(e):this.setAttribute(e,a)}}function $m(e,i){return function(){var a=i.apply(this,arguments);a==null?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,a)}}function zm(e,i){var a=ga(e);if(arguments.length<2){var o=this.node();return a.local?o.getAttributeNS(a.space,a.local):o.getAttribute(a)}return this.each((i==null?a.local?Tm:Om:typeof i=="function"?a.local?$m:Im:a.local?Lm:Em)(a,i))}function wc(e){return e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView}function Pm(e){return function(){this.style.removeProperty(e)}}function Bm(e,i,a){return function(){this.style.setProperty(e,i,a)}}function Rm(e,i,a){return function(){var o=i.apply(this,arguments);o==null?this.style.removeProperty(e):this.style.setProperty(e,o,a)}}function Hm(e,i,a){return arguments.length>1?this.each((i==null?Pm:typeof i=="function"?Rm:Bm)(e,i,a??"")):On(this.node(),e)}function On(e,i){return e.style.getPropertyValue(i)||wc(e).getComputedStyle(e,null).getPropertyValue(i)}function Ym(e){return function(){delete this[e]}}function Um(e,i){return function(){this[e]=i}}function Gm(e,i){return function(){var a=i.apply(this,arguments);a==null?delete this[e]:this[e]=a}}function Fm(e,i){return arguments.length>1?this.each((i==null?Ym:typeof i=="function"?Gm:Um)(e,i)):this.node()[e]}function Cc(e){return e.trim().split(/^|\s+/)}function qo(e){return e.classList||new kc(e)}function kc(e){this._node=e,this._names=Cc(e.getAttribute("class")||"")}kc.prototype={add:function(e){var i=this._names.indexOf(e);i<0&&(this._names.push(e),this._node.setAttribute("class",this._names.join(" ")))},remove:function(e){var i=this._names.indexOf(e);i>=0&&(this._names.splice(i,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(e){return this._names.indexOf(e)>=0}};function xc(e,i){for(var a=qo(e),o=-1,s=i.length;++o<s;)a.add(i[o])}function Sc(e,i){for(var a=qo(e),o=-1,s=i.length;++o<s;)a.remove(i[o])}function Vm(e){return function(){xc(this,e)}}function jm(e){return function(){Sc(this,e)}}function Wm(e,i){return function(){(i.apply(this,arguments)?xc:Sc)(this,e)}}function qm(e,i){var a=Cc(e+"");if(arguments.length<2){for(var o=qo(this.node()),s=-1,r=a.length;++s<r;)if(!o.contains(a[s]))return!1;return!0}return this.each((typeof i=="function"?Wm:i?Vm:jm)(a,i))}function Xm(){this.textContent=""}function Zm(e){return function(){this.textContent=e}}function Km(e){return function(){var i=e.apply(this,arguments);this.textContent=i??""}}function Jm(e){return arguments.length?this.each(e==null?Xm:(typeof e=="function"?Km:Zm)(e)):this.node().textContent}function Qm(){this.innerHTML=""}function tg(e){return function(){this.innerHTML=e}}function eg(e){return function(){var i=e.apply(this,arguments);this.innerHTML=i??""}}function ng(e){return arguments.length?this.each(e==null?Qm:(typeof e=="function"?eg:tg)(e)):this.node().innerHTML}function ig(){this.nextSibling&&this.parentNode.appendChild(this)}function ag(){return this.each(ig)}function og(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function sg(){return this.each(og)}function rg(e){var i=typeof e=="function"?e:gc(e);return this.select(function(){return this.appendChild(i.apply(this,arguments))})}function cg(){return null}function lg(e,i){var a=typeof e=="function"?e:gc(e),o=i==null?cg:typeof i=="function"?i:Wo(i);return this.select(function(){return this.insertBefore(a.apply(this,arguments),o.apply(this,arguments)||null)})}function ug(){var e=this.parentNode;e&&e.removeChild(this)}function dg(){return this.each(ug)}function hg(){var e=this.cloneNode(!1),i=this.parentNode;return i?i.insertBefore(e,this.nextSibling):e}function pg(){var e=this.cloneNode(!0),i=this.parentNode;return i?i.insertBefore(e,this.nextSibling):e}function fg(e){return this.select(e?pg:hg)}function mg(e){return arguments.length?this.property("__data__",e):this.node().__data__}function gg(e){return function(i){e.call(this,i,this.__data__)}}function yg(e){return e.trim().split(/^|\s+/).map(function(i){var a="",o=i.indexOf(".");return o>=0&&(a=i.slice(o+1),i=i.slice(0,o)),{type:i,name:a}})}function vg(e){return function(){var i=this.__on;if(i){for(var a=0,o=-1,s=i.length,r;a<s;++a)r=i[a],(!e.type||r.type===e.type)&&r.name===e.name?this.removeEventListener(r.type,r.listener,r.options):i[++o]=r;++o?i.length=o:delete this.__on}}}function _g(e,i,a){return function(){var o=this.__on,s,r=gg(i);if(o){for(var c=0,l=o.length;c<l;++c)if((s=o[c]).type===e.type&&s.name===e.name){this.removeEventListener(s.type,s.listener,s.options),this.addEventListener(s.type,s.listener=r,s.options=a),s.value=i;return}}this.addEventListener(e.type,r,a),s={type:e.type,name:e.name,value:i,listener:r,options:a},o?o.push(s):this.__on=[s]}}function bg(e,i,a){var o=yg(e+""),s,r=o.length,c;if(arguments.length<2){var l=this.node().__on;if(l){for(var h=0,d=l.length,m;h<d;++h)for(s=0,m=l[h];s<r;++s)if((c=o[s]).type===m.type&&c.name===m.name)return m.value}return}for(l=i?_g:vg,s=0;s<r;++s)this.each(l(o[s],i,a));return this}function Mc(e,i,a){var o=wc(e),s=o.CustomEvent;typeof s=="function"?s=new s(i,a):(s=o.document.createEvent("Event"),a?(s.initEvent(i,a.bubbles,a.cancelable),s.detail=a.detail):s.initEvent(i,!1,!1)),e.dispatchEvent(s)}function wg(e,i){return function(){return Mc(this,e,i)}}function Cg(e,i){return function(){return Mc(this,e,i.apply(this,arguments))}}function kg(e,i){return this.each((typeof i=="function"?Cg:wg)(e,i))}function*xg(){for(var e=this._groups,i=0,a=e.length;i<a;++i)for(var o=e[i],s=0,r=o.length,c;s<r;++s)(c=o[s])&&(yield c)}var Ac=[null];function Zt(e,i){this._groups=e,this._parents=i}function Tn(){return new Zt([[document.documentElement]],Ac)}function Sg(){return this}Zt.prototype=Tn.prototype={constructor:Zt,select:Kf,selectAll:em,selectChild:om,selectChildren:lm,filter:um,data:gm,enter:dm,exit:vm,join:_m,merge:bm,selection:Sg,order:wm,sort:Cm,call:xm,nodes:Sm,node:Mm,size:Am,empty:Nm,each:Dm,attr:zm,style:Hm,property:Fm,classed:qm,text:Jm,html:ng,raise:ag,lower:sg,append:rg,insert:lg,remove:dg,clone:fg,datum:mg,on:bg,dispatch:kg,[Symbol.iterator]:xg};function Ft(e){return typeof e=="string"?new Zt([[document.querySelector(e)]],[document.documentElement]):new Zt([[e]],Ac)}function Mg(e){let i;for(;i=e.sourceEvent;)e=i;return e}function en(e,i){if(e=Mg(e),i===void 0&&(i=e.currentTarget),i){var a=i.ownerSVGElement||i;if(a.createSVGPoint){var o=a.createSVGPoint();return o.x=e.clientX,o.y=e.clientY,o=o.matrixTransform(i.getScreenCTM().inverse()),[o.x,o.y]}if(i.getBoundingClientRect){var s=i.getBoundingClientRect();return[e.clientX-s.left-i.clientLeft,e.clientY-s.top-i.clientTop]}}return[e.pageX,e.pageY]}const oo={capture:!0,passive:!1};function so(e){e.preventDefault(),e.stopImmediatePropagation()}function Ag(e){var i=e.document.documentElement,a=Ft(e).on("dragstart.drag",so,oo);"onselectstart"in i?a.on("selectstart.drag",so,oo):(i.__noselect=i.style.MozUserSelect,i.style.MozUserSelect="none")}function Ng(e,i){var a=e.document.documentElement,o=Ft(e).on("dragstart.drag",null);i&&(o.on("click.drag",so,oo),setTimeout(function(){o.on("click.drag",null)},0)),"onselectstart"in a?o.on("selectstart.drag",null):(a.style.MozUserSelect=a.__noselect,delete a.__noselect)}function Xo(e,i,a){e.prototype=i.prototype=a,a.constructor=e}function Nc(e,i){var a=Object.create(e.prototype);for(var o in i)a[o]=i[o];return a}function di(){}var ei=.7,Xi=1/ei,Sn="\\s*([+-]?\\d+)\\s*",ni="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",ve="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Dg=/^#([0-9a-f]{3,8})$/,Og=new RegExp(`^rgb\\(${Sn},${Sn},${Sn}\\)$`),Tg=new RegExp(`^rgb\\(${ve},${ve},${ve}\\)$`),Eg=new RegExp(`^rgba\\(${Sn},${Sn},${Sn},${ni}\\)$`),Lg=new RegExp(`^rgba\\(${ve},${ve},${ve},${ni}\\)$`),Ig=new RegExp(`^hsl\\(${ni},${ve},${ve}\\)$`),$g=new RegExp(`^hsla\\(${ni},${ve},${ve},${ni}\\)$`),Ks={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};Xo(di,ii,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:Js,formatHex:Js,formatHex8:zg,formatHsl:Pg,formatRgb:Qs,toString:Qs});function Js(){return this.rgb().formatHex()}function zg(){return this.rgb().formatHex8()}function Pg(){return Dc(this).formatHsl()}function Qs(){return this.rgb().formatRgb()}function ii(e){var i,a;return e=(e+"").trim().toLowerCase(),(i=Dg.exec(e))?(a=i[1].length,i=parseInt(i[1],16),a===6?tr(i):a===3?new Vt(i>>8&15|i>>4&240,i>>4&15|i&240,(i&15)<<4|i&15,1):a===8?_i(i>>24&255,i>>16&255,i>>8&255,(i&255)/255):a===4?_i(i>>12&15|i>>8&240,i>>8&15|i>>4&240,i>>4&15|i&240,((i&15)<<4|i&15)/255):null):(i=Og.exec(e))?new Vt(i[1],i[2],i[3],1):(i=Tg.exec(e))?new Vt(i[1]*255/100,i[2]*255/100,i[3]*255/100,1):(i=Eg.exec(e))?_i(i[1],i[2],i[3],i[4]):(i=Lg.exec(e))?_i(i[1]*255/100,i[2]*255/100,i[3]*255/100,i[4]):(i=Ig.exec(e))?ir(i[1],i[2]/100,i[3]/100,1):(i=$g.exec(e))?ir(i[1],i[2]/100,i[3]/100,i[4]):Ks.hasOwnProperty(e)?tr(Ks[e]):e==="transparent"?new Vt(NaN,NaN,NaN,0):null}function tr(e){return new Vt(e>>16&255,e>>8&255,e&255,1)}function _i(e,i,a,o){return o<=0&&(e=i=a=NaN),new Vt(e,i,a,o)}function Bg(e){return e instanceof di||(e=ii(e)),e?(e=e.rgb(),new Vt(e.r,e.g,e.b,e.opacity)):new Vt}function ro(e,i,a,o){return arguments.length===1?Bg(e):new Vt(e,i,a,o??1)}function Vt(e,i,a,o){this.r=+e,this.g=+i,this.b=+a,this.opacity=+o}Xo(Vt,ro,Nc(di,{brighter(e){return e=e==null?Xi:Math.pow(Xi,e),new Vt(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?ei:Math.pow(ei,e),new Vt(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new Vt(rn(this.r),rn(this.g),rn(this.b),Zi(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:er,formatHex:er,formatHex8:Rg,formatRgb:nr,toString:nr}));function er(){return`#${on(this.r)}${on(this.g)}${on(this.b)}`}function Rg(){return`#${on(this.r)}${on(this.g)}${on(this.b)}${on((isNaN(this.opacity)?1:this.opacity)*255)}`}function nr(){const e=Zi(this.opacity);return`${e===1?"rgb(":"rgba("}${rn(this.r)}, ${rn(this.g)}, ${rn(this.b)}${e===1?")":`, ${e})`}`}function Zi(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function rn(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function on(e){return e=rn(e),(e<16?"0":"")+e.toString(16)}function ir(e,i,a,o){return o<=0?e=i=a=NaN:a<=0||a>=1?e=i=NaN:i<=0&&(e=NaN),new ae(e,i,a,o)}function Dc(e){if(e instanceof ae)return new ae(e.h,e.s,e.l,e.opacity);if(e instanceof di||(e=ii(e)),!e)return new ae;if(e instanceof ae)return e;e=e.rgb();var i=e.r/255,a=e.g/255,o=e.b/255,s=Math.min(i,a,o),r=Math.max(i,a,o),c=NaN,l=r-s,h=(r+s)/2;return l?(i===r?c=(a-o)/l+(a<o)*6:a===r?c=(o-i)/l+2:c=(i-a)/l+4,l/=h<.5?r+s:2-r-s,c*=60):l=h>0&&h<1?0:c,new ae(c,l,h,e.opacity)}function Hg(e,i,a,o){return arguments.length===1?Dc(e):new ae(e,i,a,o??1)}function ae(e,i,a,o){this.h=+e,this.s=+i,this.l=+a,this.opacity=+o}Xo(ae,Hg,Nc(di,{brighter(e){return e=e==null?Xi:Math.pow(Xi,e),new ae(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?ei:Math.pow(ei,e),new ae(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,i=isNaN(e)||isNaN(this.s)?0:this.s,a=this.l,o=a+(a<.5?a:1-a)*i,s=2*a-o;return new Vt($a(e>=240?e-240:e+120,s,o),$a(e,s,o),$a(e<120?e+240:e-120,s,o),this.opacity)},clamp(){return new ae(ar(this.h),bi(this.s),bi(this.l),Zi(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=Zi(this.opacity);return`${e===1?"hsl(":"hsla("}${ar(this.h)}, ${bi(this.s)*100}%, ${bi(this.l)*100}%${e===1?")":`, ${e})`}`}}));function ar(e){return e=(e||0)%360,e<0?e+360:e}function bi(e){return Math.max(0,Math.min(1,e||0))}function $a(e,i,a){return(e<60?i+(a-i)*e/60:e<180?a:e<240?i+(a-i)*(240-e)/60:i)*255}const Oc=e=>()=>e;function Yg(e,i){return function(a){return e+a*i}}function Ug(e,i,a){return e=Math.pow(e,a),i=Math.pow(i,a)-e,a=1/a,function(o){return Math.pow(e+o*i,a)}}function Gg(e){return(e=+e)==1?Tc:function(i,a){return a-i?Ug(i,a,e):Oc(isNaN(i)?a:i)}}function Tc(e,i){var a=i-e;return a?Yg(e,a):Oc(isNaN(e)?i:e)}const or=function e(i){var a=Gg(i);function o(s,r){var c=a((s=ro(s)).r,(r=ro(r)).r),l=a(s.g,r.g),h=a(s.b,r.b),d=Tc(s.opacity,r.opacity);return function(m){return s.r=c(m),s.g=l(m),s.b=h(m),s.opacity=d(m),s+""}}return o.gamma=e,o}(1);function Ge(e,i){return e=+e,i=+i,function(a){return e*(1-a)+i*a}}var co=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,za=new RegExp(co.source,"g");function Fg(e){return function(){return e}}function Vg(e){return function(i){return e(i)+""}}function jg(e,i){var a=co.lastIndex=za.lastIndex=0,o,s,r,c=-1,l=[],h=[];for(e=e+"",i=i+"";(o=co.exec(e))&&(s=za.exec(i));)(r=s.index)>a&&(r=i.slice(a,r),l[c]?l[c]+=r:l[++c]=r),(o=o[0])===(s=s[0])?l[c]?l[c]+=s:l[++c]=s:(l[++c]=null,h.push({i:c,x:Ge(o,s)})),a=za.lastIndex;return a<i.length&&(r=i.slice(a),l[c]?l[c]+=r:l[++c]=r),l.length<2?h[0]?Vg(h[0].x):Fg(i):(i=h.length,function(d){for(var m=0,g;m<i;++m)l[(g=h[m]).i]=g.x(d);return l.join("")})}var sr=180/Math.PI,Ec={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function Lc(e,i,a,o,s,r){var c,l,h;return(c=Math.sqrt(e*e+i*i))&&(e/=c,i/=c),(h=e*a+i*o)&&(a-=e*h,o-=i*h),(l=Math.sqrt(a*a+o*o))&&(a/=l,o/=l,h/=l),e*o<i*a&&(e=-e,i=-i,h=-h,c=-c),{translateX:s,translateY:r,rotate:Math.atan2(i,e)*sr,skewX:Math.atan(h)*sr,scaleX:c,scaleY:l}}var wi;function Wg(e){const i=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(e+"");return i.isIdentity?Ec:Lc(i.a,i.b,i.c,i.d,i.e,i.f)}function qg(e){return e==null||(wi||(wi=document.createElementNS("http://www.w3.org/2000/svg","g")),wi.setAttribute("transform",e),!(e=wi.transform.baseVal.consolidate()))?Ec:(e=e.matrix,Lc(e.a,e.b,e.c,e.d,e.e,e.f))}function Ic(e,i,a,o){function s(d){return d.length?d.pop()+" ":""}function r(d,m,g,b,k,N){if(d!==g||m!==b){var L=k.push("translate(",null,i,null,a);N.push({i:L-4,x:Ge(d,g)},{i:L-2,x:Ge(m,b)})}else(g||b)&&k.push("translate("+g+i+b+a)}function c(d,m,g,b){d!==m?(d-m>180?m+=360:m-d>180&&(d+=360),b.push({i:g.push(s(g)+"rotate(",null,o)-2,x:Ge(d,m)})):m&&g.push(s(g)+"rotate("+m+o)}function l(d,m,g,b){d!==m?b.push({i:g.push(s(g)+"skewX(",null,o)-2,x:Ge(d,m)}):m&&g.push(s(g)+"skewX("+m+o)}function h(d,m,g,b,k,N){if(d!==g||m!==b){var L=k.push(s(k)+"scale(",null,",",null,")");N.push({i:L-4,x:Ge(d,g)},{i:L-2,x:Ge(m,b)})}else(g!==1||b!==1)&&k.push(s(k)+"scale("+g+","+b+")")}return function(d,m){var g=[],b=[];return d=e(d),m=e(m),r(d.translateX,d.translateY,m.translateX,m.translateY,g,b),c(d.rotate,m.rotate,g,b),l(d.skewX,m.skewX,g,b),h(d.scaleX,d.scaleY,m.scaleX,m.scaleY,g,b),d=m=null,function(k){for(var N=-1,L=b.length,B;++N<L;)g[(B=b[N]).i]=B.x(k);return g.join("")}}}var Xg=Ic(Wg,"px, ","px)","deg)"),Zg=Ic(qg,", ",")",")"),Kg=1e-12;function rr(e){return((e=Math.exp(e))+1/e)/2}function Jg(e){return((e=Math.exp(e))-1/e)/2}function Qg(e){return((e=Math.exp(2*e))-1)/(e+1)}const t1=function e(i,a,o){function s(r,c){var l=r[0],h=r[1],d=r[2],m=c[0],g=c[1],b=c[2],k=m-l,N=g-h,L=k*k+N*N,B,z;if(L<Kg)z=Math.log(b/d)/i,B=function(it){return[l+it*k,h+it*N,d*Math.exp(i*it*z)]};else{var j=Math.sqrt(L),V=(b*b-d*d+o*L)/(2*d*a*j),X=(b*b-d*d-o*L)/(2*b*a*j),ut=Math.log(Math.sqrt(V*V+1)-V),lt=Math.log(Math.sqrt(X*X+1)-X);z=(lt-ut)/i,B=function(it){var yt=it*z,vt=rr(ut),_t=d/(a*j)*(vt*Qg(i*yt+ut)-Jg(ut));return[l+_t*k,h+_t*N,d*vt/rr(i*yt+ut)]}}return B.duration=z*1e3*i/Math.SQRT2,B}return s.rho=function(r){var c=Math.max(.001,+r),l=c*c,h=l*l;return e(c,l,h)},s}(Math.SQRT2,2,4);var En=0,Zn=0,Vn=0,$c=1e3,Ki,Kn,Ji=0,un=0,ya=0,ai=typeof performance=="object"&&performance.now?performance:Date,zc=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function Zo(){return un||(zc(e1),un=ai.now()+ya)}function e1(){un=0}function Qi(){this._call=this._time=this._next=null}Qi.prototype=Pc.prototype={constructor:Qi,restart:function(e,i,a){if(typeof e!="function")throw new TypeError("callback is not a function");a=(a==null?Zo():+a)+(i==null?0:+i),!this._next&&Kn!==this&&(Kn?Kn._next=this:Ki=this,Kn=this),this._call=e,this._time=a,lo()},stop:function(){this._call&&(this._call=null,this._time=1/0,lo())}};function Pc(e,i,a){var o=new Qi;return o.restart(e,i,a),o}function n1(){Zo(),++En;for(var e=Ki,i;e;)(i=un-e._time)>=0&&e._call.call(void 0,i),e=e._next;--En}function cr(){un=(Ji=ai.now())+ya,En=Zn=0;try{n1()}finally{En=0,a1(),un=0}}function i1(){var e=ai.now(),i=e-Ji;i>$c&&(ya-=i,Ji=e)}function a1(){for(var e,i=Ki,a,o=1/0;i;)i._call?(o>i._time&&(o=i._time),e=i,i=i._next):(a=i._next,i._next=null,i=e?e._next=a:Ki=a);Kn=e,lo(o)}function lo(e){if(!En){Zn&&(Zn=clearTimeout(Zn));var i=e-un;i>24?(e<1/0&&(Zn=setTimeout(cr,e-ai.now()-ya)),Vn&&(Vn=clearInterval(Vn))):(Vn||(Ji=ai.now(),Vn=setInterval(i1,$c)),En=1,zc(cr))}}function lr(e,i,a){var o=new Qi;return i=i==null?0:+i,o.restart(s=>{o.stop(),e(s+i)},i,a),o}var o1=jo("start","end","cancel","interrupt"),s1=[],Bc=0,ur=1,uo=2,$i=3,dr=4,ho=5,zi=6;function va(e,i,a,o,s,r){var c=e.__transition;if(!c)e.__transition={};else if(a in c)return;r1(e,a,{name:i,index:o,group:s,on:o1,tween:s1,time:r.time,delay:r.delay,duration:r.duration,ease:r.ease,timer:null,state:Bc})}function Ko(e,i){var a=he(e,i);if(a.state>Bc)throw new Error("too late; already scheduled");return a}function _e(e,i){var a=he(e,i);if(a.state>$i)throw new Error("too late; already running");return a}function he(e,i){var a=e.__transition;if(!a||!(a=a[i]))throw new Error("transition not found");return a}function r1(e,i,a){var o=e.__transition,s;o[i]=a,a.timer=Pc(r,0,a.time);function r(d){a.state=ur,a.timer.restart(c,a.delay,a.time),a.delay<=d&&c(d-a.delay)}function c(d){var m,g,b,k;if(a.state!==ur)return h();for(m in o)if(k=o[m],k.name===a.name){if(k.state===$i)return lr(c);k.state===dr?(k.state=zi,k.timer.stop(),k.on.call("interrupt",e,e.__data__,k.index,k.group),delete o[m]):+m<i&&(k.state=zi,k.timer.stop(),k.on.call("cancel",e,e.__data__,k.index,k.group),delete o[m])}if(lr(function(){a.state===$i&&(a.state=dr,a.timer.restart(l,a.delay,a.time),l(d))}),a.state=uo,a.on.call("start",e,e.__data__,a.index,a.group),a.state===uo){for(a.state=$i,s=new Array(b=a.tween.length),m=0,g=-1;m<b;++m)(k=a.tween[m].value.call(e,e.__data__,a.index,a.group))&&(s[++g]=k);s.length=g+1}}function l(d){for(var m=d<a.duration?a.ease.call(null,d/a.duration):(a.timer.restart(h),a.state=ho,1),g=-1,b=s.length;++g<b;)s[g].call(e,m);a.state===ho&&(a.on.call("end",e,e.__data__,a.index,a.group),h())}function h(){a.state=zi,a.timer.stop(),delete o[i];for(var d in o)return;delete e.__transition}}function Pi(e,i){var a=e.__transition,o,s,r=!0,c;if(a){i=i==null?null:i+"";for(c in a){if((o=a[c]).name!==i){r=!1;continue}s=o.state>uo&&o.state<ho,o.state=zi,o.timer.stop(),o.on.call(s?"interrupt":"cancel",e,e.__data__,o.index,o.group),delete a[c]}r&&delete e.__transition}}function c1(e){return this.each(function(){Pi(this,e)})}function l1(e,i){var a,o;return function(){var s=_e(this,e),r=s.tween;if(r!==a){o=a=r;for(var c=0,l=o.length;c<l;++c)if(o[c].name===i){o=o.slice(),o.splice(c,1);break}}s.tween=o}}function u1(e,i,a){var o,s;if(typeof a!="function")throw new Error;return function(){var r=_e(this,e),c=r.tween;if(c!==o){s=(o=c).slice();for(var l={name:i,value:a},h=0,d=s.length;h<d;++h)if(s[h].name===i){s[h]=l;break}h===d&&s.push(l)}r.tween=s}}function d1(e,i){var a=this._id;if(e+="",arguments.length<2){for(var o=he(this.node(),a).tween,s=0,r=o.length,c;s<r;++s)if((c=o[s]).name===e)return c.value;return null}return this.each((i==null?l1:u1)(a,e,i))}function Jo(e,i,a){var o=e._id;return e.each(function(){var s=_e(this,o);(s.value||(s.value={}))[i]=a.apply(this,arguments)}),function(s){return he(s,o).value[i]}}function Rc(e,i){var a;return(typeof i=="number"?Ge:i instanceof ii?or:(a=ii(i))?(i=a,or):jg)(e,i)}function h1(e){return function(){this.removeAttribute(e)}}function p1(e){return function(){this.removeAttributeNS(e.space,e.local)}}function f1(e,i,a){var o,s=a+"",r;return function(){var c=this.getAttribute(e);return c===s?null:c===o?r:r=i(o=c,a)}}function m1(e,i,a){var o,s=a+"",r;return function(){var c=this.getAttributeNS(e.space,e.local);return c===s?null:c===o?r:r=i(o=c,a)}}function g1(e,i,a){var o,s,r;return function(){var c,l=a(this),h;return l==null?void this.removeAttribute(e):(c=this.getAttribute(e),h=l+"",c===h?null:c===o&&h===s?r:(s=h,r=i(o=c,l)))}}function y1(e,i,a){var o,s,r;return function(){var c,l=a(this),h;return l==null?void this.removeAttributeNS(e.space,e.local):(c=this.getAttributeNS(e.space,e.local),h=l+"",c===h?null:c===o&&h===s?r:(s=h,r=i(o=c,l)))}}function v1(e,i){var a=ga(e),o=a==="transform"?Zg:Rc;return this.attrTween(e,typeof i=="function"?(a.local?y1:g1)(a,o,Jo(this,"attr."+e,i)):i==null?(a.local?p1:h1)(a):(a.local?m1:f1)(a,o,i))}function _1(e,i){return function(a){this.setAttribute(e,i.call(this,a))}}function b1(e,i){return function(a){this.setAttributeNS(e.space,e.local,i.call(this,a))}}function w1(e,i){var a,o;function s(){var r=i.apply(this,arguments);return r!==o&&(a=(o=r)&&b1(e,r)),a}return s._value=i,s}function C1(e,i){var a,o;function s(){var r=i.apply(this,arguments);return r!==o&&(a=(o=r)&&_1(e,r)),a}return s._value=i,s}function k1(e,i){var a="attr."+e;if(arguments.length<2)return(a=this.tween(a))&&a._value;if(i==null)return this.tween(a,null);if(typeof i!="function")throw new Error;var o=ga(e);return this.tween(a,(o.local?w1:C1)(o,i))}function x1(e,i){return function(){Ko(this,e).delay=+i.apply(this,arguments)}}function S1(e,i){return i=+i,function(){Ko(this,e).delay=i}}function M1(e){var i=this._id;return arguments.length?this.each((typeof e=="function"?x1:S1)(i,e)):he(this.node(),i).delay}function A1(e,i){return function(){_e(this,e).duration=+i.apply(this,arguments)}}function N1(e,i){return i=+i,function(){_e(this,e).duration=i}}function D1(e){var i=this._id;return arguments.length?this.each((typeof e=="function"?A1:N1)(i,e)):he(this.node(),i).duration}function O1(e,i){if(typeof i!="function")throw new Error;return function(){_e(this,e).ease=i}}function T1(e){var i=this._id;return arguments.length?this.each(O1(i,e)):he(this.node(),i).ease}function E1(e,i){return function(){var a=i.apply(this,arguments);if(typeof a!="function")throw new Error;_e(this,e).ease=a}}function L1(e){if(typeof e!="function")throw new Error;return this.each(E1(this._id,e))}function I1(e){typeof e!="function"&&(e=vc(e));for(var i=this._groups,a=i.length,o=new Array(a),s=0;s<a;++s)for(var r=i[s],c=r.length,l=o[s]=[],h,d=0;d<c;++d)(h=r[d])&&e.call(h,h.__data__,d,r)&&l.push(h);return new Ee(o,this._parents,this._name,this._id)}function $1(e){if(e._id!==this._id)throw new Error;for(var i=this._groups,a=e._groups,o=i.length,s=a.length,r=Math.min(o,s),c=new Array(o),l=0;l<r;++l)for(var h=i[l],d=a[l],m=h.length,g=c[l]=new Array(m),b,k=0;k<m;++k)(b=h[k]||d[k])&&(g[k]=b);for(;l<o;++l)c[l]=i[l];return new Ee(c,this._parents,this._name,this._id)}function z1(e){return(e+"").trim().split(/^|\s+/).every(function(i){var a=i.indexOf(".");return a>=0&&(i=i.slice(0,a)),!i||i==="start"})}function P1(e,i,a){var o,s,r=z1(i)?Ko:_e;return function(){var c=r(this,e),l=c.on;l!==o&&(s=(o=l).copy()).on(i,a),c.on=s}}function B1(e,i){var a=this._id;return arguments.length<2?he(this.node(),a).on.on(e):this.each(P1(a,e,i))}function R1(e){return function(){var i=this.parentNode;for(var a in this.__transition)if(+a!==e)return;i&&i.removeChild(this)}}function H1(){return this.on("end.remove",R1(this._id))}function Y1(e){var i=this._name,a=this._id;typeof e!="function"&&(e=Wo(e));for(var o=this._groups,s=o.length,r=new Array(s),c=0;c<s;++c)for(var l=o[c],h=l.length,d=r[c]=new Array(h),m,g,b=0;b<h;++b)(m=l[b])&&(g=e.call(m,m.__data__,b,l))&&("__data__"in m&&(g.__data__=m.__data__),d[b]=g,va(d[b],i,a,b,d,he(m,a)));return new Ee(r,this._parents,i,a)}function U1(e){var i=this._name,a=this._id;typeof e!="function"&&(e=yc(e));for(var o=this._groups,s=o.length,r=[],c=[],l=0;l<s;++l)for(var h=o[l],d=h.length,m,g=0;g<d;++g)if(m=h[g]){for(var b=e.call(m,m.__data__,g,h),k,N=he(m,a),L=0,B=b.length;L<B;++L)(k=b[L])&&va(k,i,a,L,b,N);r.push(b),c.push(m)}return new Ee(r,c,i,a)}var G1=Tn.prototype.constructor;function F1(){return new G1(this._groups,this._parents)}function V1(e,i){var a,o,s;return function(){var r=On(this,e),c=(this.style.removeProperty(e),On(this,e));return r===c?null:r===a&&c===o?s:s=i(a=r,o=c)}}function Hc(e){return function(){this.style.removeProperty(e)}}function j1(e,i,a){var o,s=a+"",r;return function(){var c=On(this,e);return c===s?null:c===o?r:r=i(o=c,a)}}function W1(e,i,a){var o,s,r;return function(){var c=On(this,e),l=a(this),h=l+"";return l==null&&(h=l=(this.style.removeProperty(e),On(this,e))),c===h?null:c===o&&h===s?r:(s=h,r=i(o=c,l))}}function q1(e,i){var a,o,s,r="style."+i,c="end."+r,l;return function(){var h=_e(this,e),d=h.on,m=h.value[r]==null?l||(l=Hc(i)):void 0;(d!==a||s!==m)&&(o=(a=d).copy()).on(c,s=m),h.on=o}}function X1(e,i,a){var o=(e+="")=="transform"?Xg:Rc;return i==null?this.styleTween(e,V1(e,o)).on("end.style."+e,Hc(e)):typeof i=="function"?this.styleTween(e,W1(e,o,Jo(this,"style."+e,i))).each(q1(this._id,e)):this.styleTween(e,j1(e,o,i),a).on("end.style."+e,null)}function Z1(e,i,a){return function(o){this.style.setProperty(e,i.call(this,o),a)}}function K1(e,i,a){var o,s;function r(){var c=i.apply(this,arguments);return c!==s&&(o=(s=c)&&Z1(e,c,a)),o}return r._value=i,r}function J1(e,i,a){var o="style."+(e+="");if(arguments.length<2)return(o=this.tween(o))&&o._value;if(i==null)return this.tween(o,null);if(typeof i!="function")throw new Error;return this.tween(o,K1(e,i,a??""))}function Q1(e){return function(){this.textContent=e}}function t0(e){return function(){var i=e(this);this.textContent=i??""}}function e0(e){return this.tween("text",typeof e=="function"?t0(Jo(this,"text",e)):Q1(e==null?"":e+""))}function n0(e){return function(i){this.textContent=e.call(this,i)}}function i0(e){var i,a;function o(){var s=e.apply(this,arguments);return s!==a&&(i=(a=s)&&n0(s)),i}return o._value=e,o}function a0(e){var i="text";if(arguments.length<1)return(i=this.tween(i))&&i._value;if(e==null)return this.tween(i,null);if(typeof e!="function")throw new Error;return this.tween(i,i0(e))}function o0(){for(var e=this._name,i=this._id,a=Yc(),o=this._groups,s=o.length,r=0;r<s;++r)for(var c=o[r],l=c.length,h,d=0;d<l;++d)if(h=c[d]){var m=he(h,i);va(h,e,a,d,c,{time:m.time+m.delay+m.duration,delay:0,duration:m.duration,ease:m.ease})}return new Ee(o,this._parents,e,a)}function s0(){var e,i,a=this,o=a._id,s=a.size();return new Promise(function(r,c){var l={value:c},h={value:function(){--s===0&&r()}};a.each(function(){var d=_e(this,o),m=d.on;m!==e&&(i=(e=m).copy(),i._.cancel.push(l),i._.interrupt.push(l),i._.end.push(h)),d.on=i}),s===0&&r()})}var r0=0;function Ee(e,i,a,o){this._groups=e,this._parents=i,this._name=a,this._id=o}function Yc(){return++r0}var ke=Tn.prototype;Ee.prototype={constructor:Ee,select:Y1,selectAll:U1,selectChild:ke.selectChild,selectChildren:ke.selectChildren,filter:I1,merge:$1,selection:F1,transition:o0,call:ke.call,nodes:ke.nodes,node:ke.node,size:ke.size,empty:ke.empty,each:ke.each,on:B1,attr:v1,attrTween:k1,style:X1,styleTween:J1,text:e0,textTween:a0,remove:H1,tween:d1,delay:M1,duration:D1,ease:T1,easeVarying:L1,end:s0,[Symbol.iterator]:ke[Symbol.iterator]};function c0(e){return((e*=2)<=1?e*e*e:(e-=2)*e*e+2)/2}var l0={time:null,delay:0,duration:250,ease:c0};function u0(e,i){for(var a;!(a=e.__transition)||!(a=a[i]);)if(!(e=e.parentNode))throw new Error(`transition ${i} not found`);return a}function d0(e){var i,a;e instanceof Ee?(i=e._id,e=e._name):(i=Yc(),(a=l0).time=Zo(),e=e==null?null:e+"");for(var o=this._groups,s=o.length,r=0;r<s;++r)for(var c=o[r],l=c.length,h,d=0;d<l;++d)(h=c[d])&&va(h,e,i,d,c,a||u0(h,i));return new Ee(o,this._parents,e,i)}Tn.prototype.interrupt=c1,Tn.prototype.transition=d0;const po=Math.PI,fo=2*po,an=1e-6,h0=fo-an;function mo(){this._x0=this._y0=this._x1=this._y1=null,this._=""}function Uc(){return new mo}mo.prototype=Uc.prototype={constructor:mo,moveTo:function(e,i){this._+="M"+(this._x0=this._x1=+e)+","+(this._y0=this._y1=+i)},closePath:function(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")},lineTo:function(e,i){this._+="L"+(this._x1=+e)+","+(this._y1=+i)},quadraticCurveTo:function(e,i,a,o){this._+="Q"+ +e+","+ +i+","+(this._x1=+a)+","+(this._y1=+o)},bezierCurveTo:function(e,i,a,o,s,r){this._+="C"+ +e+","+ +i+","+ +a+","+ +o+","+(this._x1=+s)+","+(this._y1=+r)},arcTo:function(e,i,a,o,s){e=+e,i=+i,a=+a,o=+o,s=+s;var r=this._x1,c=this._y1,l=a-e,h=o-i,d=r-e,m=c-i,g=d*d+m*m;if(s<0)throw new Error("negative radius: "+s);if(this._x1===null)this._+="M"+(this._x1=e)+","+(this._y1=i);else if(g>an)if(!(Math.abs(m*l-h*d)>an)||!s)this._+="L"+(this._x1=e)+","+(this._y1=i);else{var b=a-r,k=o-c,N=l*l+h*h,L=b*b+k*k,B=Math.sqrt(N),z=Math.sqrt(g),j=s*Math.tan((po-Math.acos((N+g-L)/(2*B*z)))/2),V=j/z,X=j/B;Math.abs(V-1)>an&&(this._+="L"+(e+V*d)+","+(i+V*m)),this._+="A"+s+","+s+",0,0,"+ +(m*b>d*k)+","+(this._x1=e+X*l)+","+(this._y1=i+X*h)}},arc:function(e,i,a,o,s,r){e=+e,i=+i,a=+a,r=!!r;var c=a*Math.cos(o),l=a*Math.sin(o),h=e+c,d=i+l,m=1^r,g=r?o-s:s-o;if(a<0)throw new Error("negative radius: "+a);this._x1===null?this._+="M"+h+","+d:(Math.abs(this._x1-h)>an||Math.abs(this._y1-d)>an)&&(this._+="L"+h+","+d),a&&(g<0&&(g=g%fo+fo),g>h0?this._+="A"+a+","+a+",0,1,"+m+","+(e-c)+","+(i-l)+"A"+a+","+a+",0,1,"+m+","+(this._x1=h)+","+(this._y1=d):g>an&&(this._+="A"+a+","+a+",0,"+ +(g>=po)+","+m+","+(this._x1=e+a*Math.cos(s))+","+(this._y1=i+a*Math.sin(s))))},rect:function(e,i,a,o){this._+="M"+(this._x0=this._x1=+e)+","+(this._y0=this._y1=+i)+"h"+ +a+"v"+ +o+"h"+-a+"Z"},toString:function(){return this._}};function p0(e){var i=0,a=e.children,o=a&&a.length;if(!o)i=1;else for(;--o>=0;)i+=a[o].value;e.value=i}function f0(){return this.eachAfter(p0)}function m0(e,i){let a=-1;for(const o of this)e.call(i,o,++a,this);return this}function g0(e,i){for(var a=this,o=[a],s,r,c=-1;a=o.pop();)if(e.call(i,a,++c,this),s=a.children)for(r=s.length-1;r>=0;--r)o.push(s[r]);return this}function y0(e,i){for(var a=this,o=[a],s=[],r,c,l,h=-1;a=o.pop();)if(s.push(a),r=a.children)for(c=0,l=r.length;c<l;++c)o.push(r[c]);for(;a=s.pop();)e.call(i,a,++h,this);return this}function v0(e,i){let a=-1;for(const o of this)if(e.call(i,o,++a,this))return o}function _0(e){return this.eachAfter(function(i){for(var a=+e(i.data)||0,o=i.children,s=o&&o.length;--s>=0;)a+=o[s].value;i.value=a})}function b0(e){return this.eachBefore(function(i){i.children&&i.children.sort(e)})}function w0(e){for(var i=this,a=C0(i,e),o=[i];i!==a;)i=i.parent,o.push(i);for(var s=o.length;e!==a;)o.splice(s,0,e),e=e.parent;return o}function C0(e,i){if(e===i)return e;var a=e.ancestors(),o=i.ancestors(),s=null;for(e=a.pop(),i=o.pop();e===i;)s=e,e=a.pop(),i=o.pop();return s}function k0(){for(var e=this,i=[e];e=e.parent;)i.push(e);return i}function x0(){return Array.from(this)}function S0(){var e=[];return this.eachBefore(function(i){i.children||e.push(i)}),e}function M0(){var e=this,i=[];return e.each(function(a){a!==e&&i.push({source:a.parent,target:a})}),i}function*A0(){var e=this,i,a=[e],o,s,r;do for(i=a.reverse(),a=[];e=i.pop();)if(yield e,o=e.children)for(s=0,r=o.length;s<r;++s)a.push(o[s]);while(a.length)}function Gc(e,i){e instanceof Map?(e=[void 0,e],i===void 0&&(i=O0)):i===void 0&&(i=D0);for(var a=new Ln(e),o,s=[a],r,c,l,h;o=s.pop();)if((c=i(o.data))&&(h=(c=Array.from(c)).length))for(o.children=c,l=h-1;l>=0;--l)s.push(r=c[l]=new Ln(c[l])),r.parent=o,r.depth=o.depth+1;return a.eachBefore(Fc)}function N0(){return Gc(this).eachBefore(T0)}function D0(e){return e.children}function O0(e){return Array.isArray(e)?e[1]:null}function T0(e){e.data.value!==void 0&&(e.value=e.data.value),e.data=e.data.data}function Fc(e){var i=0;do e.height=i;while((e=e.parent)&&e.height<++i)}function Ln(e){this.data=e,this.depth=this.height=0,this.parent=null}Ln.prototype=Gc.prototype={constructor:Ln,count:f0,each:m0,eachAfter:y0,eachBefore:g0,find:v0,sum:_0,sort:b0,path:w0,ancestors:k0,descendants:x0,leaves:S0,links:M0,copy:N0,[Symbol.iterator]:A0};function Pa(e){return e==null?null:E0(e)}function E0(e){if(typeof e!="function")throw new Error;return e}var L0={depth:-1},hr={},Ba={};function I0(e){return e.id}function $0(e){return e.parentId}function z0(){var e=I0,i=$0,a;function o(s){var r=Array.from(s),c=e,l=i,h,d,m,g,b,k,N,L,B=new Map;if(a!=null){const z=r.map((X,ut)=>P0(a(X,ut,s))),j=z.map(pr),V=new Set(z).add("");for(const X of j)V.has(X)||(V.add(X),z.push(X),j.push(pr(X)),r.push(Ba));c=(X,ut)=>z[ut],l=(X,ut)=>j[ut]}for(m=0,h=r.length;m<h;++m)d=r[m],k=r[m]=new Ln(d),(N=c(d,m,s))!=null&&(N+="")&&(L=k.id=N,B.set(L,B.has(L)?hr:k)),(N=l(d,m,s))!=null&&(N+="")&&(k.parent=N);for(m=0;m<h;++m)if(k=r[m],N=k.parent){if(b=B.get(N),!b)throw new Error("missing: "+N);if(b===hr)throw new Error("ambiguous: "+N);b.children?b.children.push(k):b.children=[k],k.parent=b}else{if(g)throw new Error("multiple roots");g=k}if(!g)throw new Error("no root");if(a!=null){for(;g.data===Ba&&g.children.length===1;)g=g.children[0],--h;for(let z=r.length-1;z>=0&&(k=r[z],k.data===Ba);--z)k.data=null}if(g.parent=L0,g.eachBefore(function(z){z.depth=z.parent.depth+1,--h}).eachBefore(Fc),g.parent=null,h>0)throw new Error("cycle");return g}return o.id=function(s){return arguments.length?(e=Pa(s),o):e},o.parentId=function(s){return arguments.length?(i=Pa(s),o):i},o.path=function(s){return arguments.length?(a=Pa(s),o):a},o}function P0(e){e=`${e}`;let i=e.length;return go(e,i-1)&&!go(e,i-2)&&(e=e.slice(0,-1)),e[0]==="/"?e:`/${e}`}function pr(e){let i=e.length;if(i<2)return"";for(;--i>1&&!go(e,i););return e.slice(0,i)}function go(e,i){if(e[i]==="/"){let a=0;for(;i>0&&e[--i]==="\\";)++a;if(!(a&1))return!0}return!1}function B0(e,i){return e.parent===i.parent?1:2}function Ra(e){var i=e.children;return i?i[0]:e.t}function Ha(e){var i=e.children;return i?i[i.length-1]:e.t}function R0(e,i,a){var o=a/(i.i-e.i);i.c-=o,i.s+=a,e.c+=o,i.z+=a,i.m+=a}function H0(e){for(var i=0,a=0,o=e.children,s=o.length,r;--s>=0;)r=o[s],r.z+=i,r.m+=i,i+=r.s+(a+=r.c)}function Y0(e,i,a){return e.a.parent===i.parent?e.a:a}function Bi(e,i){this._=e,this.parent=null,this.children=null,this.A=null,this.a=this,this.z=0,this.m=0,this.c=0,this.s=0,this.t=null,this.i=i}Bi.prototype=Object.create(Ln.prototype);function U0(e){for(var i=new Bi(e,0),a,o=[i],s,r,c,l;a=o.pop();)if(r=a._.children)for(a.children=new Array(l=r.length),c=l-1;c>=0;--c)o.push(s=a.children[c]=new Bi(r[c],c)),s.parent=a;return(i.parent=new Bi(null,0)).children=[i],i}function G0(){var e=B0,i=1,a=1,o=null;function s(d){var m=U0(d);if(m.eachAfter(r),m.parent.m=-m.z,m.eachBefore(c),o)d.eachBefore(h);else{var g=d,b=d,k=d;d.eachBefore(function(j){j.x<g.x&&(g=j),j.x>b.x&&(b=j),j.depth>k.depth&&(k=j)});var N=g===b?1:e(g,b)/2,L=N-g.x,B=i/(b.x+N+L),z=a/(k.depth||1);d.eachBefore(function(j){j.x=(j.x+L)*B,j.y=j.depth*z})}return d}function r(d){var m=d.children,g=d.parent.children,b=d.i?g[d.i-1]:null;if(m){H0(d);var k=(m[0].z+m[m.length-1].z)/2;b?(d.z=b.z+e(d._,b._),d.m=d.z-k):d.z=k}else b&&(d.z=b.z+e(d._,b._));d.parent.A=l(d,b,d.parent.A||g[0])}function c(d){d._.x=d.z+d.parent.m,d.m+=d.parent.m}function l(d,m,g){if(m){for(var b=d,k=d,N=m,L=b.parent.children[0],B=b.m,z=k.m,j=N.m,V=L.m,X;N=Ha(N),b=Ra(b),N&&b;)L=Ra(L),k=Ha(k),k.a=d,X=N.z+j-b.z-B+e(N._,b._),X>0&&(R0(Y0(N,d,g),d,X),B+=X,z+=X),j+=N.m,B+=b.m,V+=L.m,z+=k.m;N&&!Ha(k)&&(k.t=N,k.m+=j-z),b&&!Ra(L)&&(L.t=b,L.m+=B-V,g=d)}return g}function h(d){d.x*=i,d.y=d.depth*a}return s.separation=function(d){return arguments.length?(e=d,s):e},s.size=function(d){return arguments.length?(o=!1,i=+d[0],a=+d[1],s):o?null:[i,a]},s.nodeSize=function(d){return arguments.length?(o=!0,i=+d[0],a=+d[1],s):o?[i,a]:null},s}function fr(e){return function(){return e}}var F0=Array.prototype.slice;function V0(e){return e[0]}function j0(e){return e[1]}class W0{constructor(i,a){this._context=i,this._x=a}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line}point(i,a){switch(i=+i,a=+a,this._point){case 0:{this._point=1,this._line?this._context.lineTo(i,a):this._context.moveTo(i,a);break}case 1:this._point=2;default:{this._x?this._context.bezierCurveTo(this._x0=(this._x0+i)/2,this._y0,this._x0,a,i,a):this._context.bezierCurveTo(this._x0,this._y0=(this._y0+a)/2,i,this._y0,i,a);break}}this._x0=i,this._y0=a}}function q0(e){return new W0(e,!0)}function X0(e){return e.source}function Z0(e){return e.target}function K0(e){let i=X0,a=Z0,o=V0,s=j0,r=null,c=null;function l(){let h;const d=F0.call(arguments),m=i.apply(this,d),g=a.apply(this,d);if(r==null&&(c=e(h=Uc())),c.lineStart(),d[0]=m,c.point(+o.apply(this,d),+s.apply(this,d)),d[0]=g,c.point(+o.apply(this,d),+s.apply(this,d)),c.lineEnd(),h)return c=null,h+""||null}return l.source=function(h){return arguments.length?(i=h,l):i},l.target=function(h){return arguments.length?(a=h,l):a},l.x=function(h){return arguments.length?(o=typeof h=="function"?h:fr(+h),l):o},l.y=function(h){return arguments.length?(s=typeof h=="function"?h:fr(+h),l):s},l.context=function(h){return arguments.length?(h==null?r=c=null:c=e(r=h),l):r},l}function J0(){return K0(q0)}const Ci=e=>()=>e;function Q0(e,{sourceEvent:i,target:a,transform:o,dispatch:s}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:i,enumerable:!0,configurable:!0},target:{value:a,enumerable:!0,configurable:!0},transform:{value:o,enumerable:!0,configurable:!0},_:{value:s}})}function Me(e,i,a){this.k=e,this.x=i,this.y=a}Me.prototype={constructor:Me,scale:function(e){return e===1?this:new Me(this.k*e,this.x,this.y)},translate:function(e,i){return e===0&i===0?this:new Me(this.k,this.x+this.k*e,this.y+this.k*i)},apply:function(e){return[e[0]*this.k+this.x,e[1]*this.k+this.y]},applyX:function(e){return e*this.k+this.x},applyY:function(e){return e*this.k+this.y},invert:function(e){return[(e[0]-this.x)/this.k,(e[1]-this.y)/this.k]},invertX:function(e){return(e-this.x)/this.k},invertY:function(e){return(e-this.y)/this.k},rescaleX:function(e){return e.copy().domain(e.range().map(this.invertX,this).map(e.invert,e))},rescaleY:function(e){return e.copy().domain(e.range().map(this.invertY,this).map(e.invert,e))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var Qo=new Me(1,0,0);Me.prototype;function Ya(e){e.stopImmediatePropagation()}function jn(e){e.preventDefault(),e.stopImmediatePropagation()}function ty(e){return(!e.ctrlKey||e.type==="wheel")&&!e.button}function ey(){var e=this;return e instanceof SVGElement?(e=e.ownerSVGElement||e,e.hasAttribute("viewBox")?(e=e.viewBox.baseVal,[[e.x,e.y],[e.x+e.width,e.y+e.height]]):[[0,0],[e.width.baseVal.value,e.height.baseVal.value]]):[[0,0],[e.clientWidth,e.clientHeight]]}function mr(){return this.__zoom||Qo}function ny(e){return-e.deltaY*(e.deltaMode===1?.05:e.deltaMode?1:.002)*(e.ctrlKey?10:1)}function iy(){return navigator.maxTouchPoints||"ontouchstart"in this}function ay(e,i,a){var o=e.invertX(i[0][0])-a[0][0],s=e.invertX(i[1][0])-a[1][0],r=e.invertY(i[0][1])-a[0][1],c=e.invertY(i[1][1])-a[1][1];return e.translate(s>o?(o+s)/2:Math.min(0,o)||Math.max(0,s),c>r?(r+c)/2:Math.min(0,r)||Math.max(0,c))}function oy(){var e=ty,i=ey,a=ay,o=ny,s=iy,r=[0,1/0],c=[[-1/0,-1/0],[1/0,1/0]],l=250,h=t1,d=jo("start","zoom","end"),m,g,b,k=500,N=150,L=0,B=10;function z(y){y.property("__zoom",mr).on("wheel.zoom",yt,{passive:!1}).on("mousedown.zoom",vt).on("dblclick.zoom",_t).filter(s).on("touchstart.zoom",S).on("touchmove.zoom",x).on("touchend.zoom touchcancel.zoom",C).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}z.transform=function(y,A,D,H){var F=y.selection?y.selection():y;F.property("__zoom",mr),y!==F?ut(y,A,D,H):F.interrupt().each(function(){lt(this,arguments).event(H).start().zoom(null,typeof A=="function"?A.apply(this,arguments):A).end()})},z.scaleBy=function(y,A,D,H){z.scaleTo(y,function(){var F=this.__zoom.k,q=typeof A=="function"?A.apply(this,arguments):A;return F*q},D,H)},z.scaleTo=function(y,A,D,H){z.transform(y,function(){var F=i.apply(this,arguments),q=this.__zoom,Z=D==null?X(F):typeof D=="function"?D.apply(this,arguments):D,Q=q.invert(Z),ot=typeof A=="function"?A.apply(this,arguments):A;return a(V(j(q,ot),Z,Q),F,c)},D,H)},z.translateBy=function(y,A,D,H){z.transform(y,function(){return a(this.__zoom.translate(typeof A=="function"?A.apply(this,arguments):A,typeof D=="function"?D.apply(this,arguments):D),i.apply(this,arguments),c)},null,H)},z.translateTo=function(y,A,D,H,F){z.transform(y,function(){var q=i.apply(this,arguments),Z=this.__zoom,Q=H==null?X(q):typeof H=="function"?H.apply(this,arguments):H;return a(Qo.translate(Q[0],Q[1]).scale(Z.k).translate(typeof A=="function"?-A.apply(this,arguments):-A,typeof D=="function"?-D.apply(this,arguments):-D),q,c)},H,F)};function j(y,A){return A=Math.max(r[0],Math.min(r[1],A)),A===y.k?y:new Me(A,y.x,y.y)}function V(y,A,D){var H=A[0]-D[0]*y.k,F=A[1]-D[1]*y.k;return H===y.x&&F===y.y?y:new Me(y.k,H,F)}function X(y){return[(+y[0][0]+ +y[1][0])/2,(+y[0][1]+ +y[1][1])/2]}function ut(y,A,D,H){y.on("start.zoom",function(){lt(this,arguments).event(H).start()}).on("interrupt.zoom end.zoom",function(){lt(this,arguments).event(H).end()}).tween("zoom",function(){var F=this,q=arguments,Z=lt(F,q).event(H),Q=i.apply(F,q),ot=D==null?X(Q):typeof D=="function"?D.apply(F,q):D,xt=Math.max(Q[1][0]-Q[0][0],Q[1][1]-Q[0][1]),mt=F.__zoom,Et=typeof A=="function"?A.apply(F,q):A,Pt=h(mt.invert(ot).concat(xt/mt.k),Et.invert(ot).concat(xt/Et.k));return function(St){if(St===1)St=Et;else{var Nt=Pt(St),jt=xt/Nt[2];St=new Me(jt,ot[0]-Nt[0]*jt,ot[1]-Nt[1]*jt)}Z.zoom(null,St)}})}function lt(y,A,D){return!D&&y.__zooming||new it(y,A)}function it(y,A){this.that=y,this.args=A,this.active=0,this.sourceEvent=null,this.extent=i.apply(y,A),this.taps=0}it.prototype={event:function(y){return y&&(this.sourceEvent=y),this},start:function(){return++this.active===1&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(y,A){return this.mouse&&y!=="mouse"&&(this.mouse[1]=A.invert(this.mouse[0])),this.touch0&&y!=="touch"&&(this.touch0[1]=A.invert(this.touch0[0])),this.touch1&&y!=="touch"&&(this.touch1[1]=A.invert(this.touch1[0])),this.that.__zoom=A,this.emit("zoom"),this},end:function(){return--this.active===0&&(delete this.that.__zooming,this.emit("end")),this},emit:function(y){var A=Ft(this.that).datum();d.call(y,this.that,new Q0(y,{sourceEvent:this.sourceEvent,target:z,type:y,transform:this.that.__zoom,dispatch:d}),A)}};function yt(y,...A){if(!e.apply(this,arguments))return;var D=lt(this,A).event(y),H=this.__zoom,F=Math.max(r[0],Math.min(r[1],H.k*Math.pow(2,o.apply(this,arguments)))),q=en(y);if(D.wheel)(D.mouse[0][0]!==q[0]||D.mouse[0][1]!==q[1])&&(D.mouse[1]=H.invert(D.mouse[0]=q)),clearTimeout(D.wheel);else{if(H.k===F)return;D.mouse=[q,H.invert(q)],Pi(this),D.start()}jn(y),D.wheel=setTimeout(Z,N),D.zoom("mouse",a(V(j(H,F),D.mouse[0],D.mouse[1]),D.extent,c));function Z(){D.wheel=null,D.end()}}function vt(y,...A){if(b||!e.apply(this,arguments))return;var D=y.currentTarget,H=lt(this,A,!0).event(y),F=Ft(y.view).on("mousemove.zoom",ot,!0).on("mouseup.zoom",xt,!0),q=en(y,D),Z=y.clientX,Q=y.clientY;Ag(y.view),Ya(y),H.mouse=[q,this.__zoom.invert(q)],Pi(this),H.start();function ot(mt){if(jn(mt),!H.moved){var Et=mt.clientX-Z,Pt=mt.clientY-Q;H.moved=Et*Et+Pt*Pt>L}H.event(mt).zoom("mouse",a(V(H.that.__zoom,H.mouse[0]=en(mt,D),H.mouse[1]),H.extent,c))}function xt(mt){F.on("mousemove.zoom mouseup.zoom",null),Ng(mt.view,H.moved),jn(mt),H.event(mt).end()}}function _t(y,...A){if(e.apply(this,arguments)){var D=this.__zoom,H=en(y.changedTouches?y.changedTouches[0]:y,this),F=D.invert(H),q=D.k*(y.shiftKey?.5:2),Z=a(V(j(D,q),H,F),i.apply(this,A),c);jn(y),l>0?Ft(this).transition().duration(l).call(ut,Z,H,y):Ft(this).call(z.transform,Z,H,y)}}function S(y,...A){if(e.apply(this,arguments)){var D=y.touches,H=D.length,F=lt(this,A,y.changedTouches.length===H).event(y),q,Z,Q,ot;for(Ya(y),Z=0;Z<H;++Z)Q=D[Z],ot=en(Q,this),ot=[ot,this.__zoom.invert(ot),Q.identifier],F.touch0?!F.touch1&&F.touch0[2]!==ot[2]&&(F.touch1=ot,F.taps=0):(F.touch0=ot,q=!0,F.taps=1+!!m);m&&(m=clearTimeout(m)),q&&(F.taps<2&&(g=ot[0],m=setTimeout(function(){m=null},k)),Pi(this),F.start())}}function x(y,...A){if(this.__zooming){var D=lt(this,A).event(y),H=y.changedTouches,F=H.length,q,Z,Q,ot;for(jn(y),q=0;q<F;++q)Z=H[q],Q=en(Z,this),D.touch0&&D.touch0[2]===Z.identifier?D.touch0[0]=Q:D.touch1&&D.touch1[2]===Z.identifier&&(D.touch1[0]=Q);if(Z=D.that.__zoom,D.touch1){var xt=D.touch0[0],mt=D.touch0[1],Et=D.touch1[0],Pt=D.touch1[1],St=(St=Et[0]-xt[0])*St+(St=Et[1]-xt[1])*St,Nt=(Nt=Pt[0]-mt[0])*Nt+(Nt=Pt[1]-mt[1])*Nt;Z=j(Z,Math.sqrt(St/Nt)),Q=[(xt[0]+Et[0])/2,(xt[1]+Et[1])/2],ot=[(mt[0]+Pt[0])/2,(mt[1]+Pt[1])/2]}else if(D.touch0)Q=D.touch0[0],ot=D.touch0[1];else return;D.zoom("touch",a(V(Z,Q,ot),D.extent,c))}}function C(y,...A){if(this.__zooming){var D=lt(this,A).event(y),H=y.changedTouches,F=H.length,q,Z;for(Ya(y),b&&clearTimeout(b),b=setTimeout(function(){b=null},k),q=0;q<F;++q)Z=H[q],D.touch0&&D.touch0[2]===Z.identifier?delete D.touch0:D.touch1&&D.touch1[2]===Z.identifier&&delete D.touch1;if(D.touch1&&!D.touch0&&(D.touch0=D.touch1,delete D.touch1),D.touch0)D.touch0[1]=this.__zoom.invert(D.touch0[0]);else if(D.end(),D.taps===2&&(Z=en(Z,this),Math.hypot(g[0]-Z[0],g[1]-Z[1])<B)){var Q=Ft(this).on("dblclick.zoom");Q&&Q.apply(this,arguments)}}}return z.wheelDelta=function(y){return arguments.length?(o=typeof y=="function"?y:Ci(+y),z):o},z.filter=function(y){return arguments.length?(e=typeof y=="function"?y:Ci(!!y),z):e},z.touchable=function(y){return arguments.length?(s=typeof y=="function"?y:Ci(!!y),z):s},z.extent=function(y){return arguments.length?(i=typeof y=="function"?y:Ci([[+y[0][0],+y[0][1]],[+y[1][0],+y[1][1]]]),z):i},z.scaleExtent=function(y){return arguments.length?(r[0]=+y[0],r[1]=+y[1],z):[r[0],r[1]]},z.translateExtent=function(y){return arguments.length?(c[0][0]=+y[0][0],c[1][0]=+y[1][0],c[0][1]=+y[0][1],c[1][1]=+y[1][1],z):[[c[0][0],c[0][1]],[c[1][0],c[1][1]]]},z.constrain=function(y){return arguments.length?(a=y,z):a},z.duration=function(y){return arguments.length?(l=+y,z):l},z.interpolate=function(y){return arguments.length?(h=y,z):h},z.on=function(){var y=d.on.apply(d,arguments);return y===d?z:y},z.clickDistance=function(y){return arguments.length?(L=(y=+y)*y,z):Math.sqrt(L)},z.tapDistance=function(y){return arguments.length?(B=+y,z):B},z}const sy={name:"ChartTemplate",components:{Avatar:$n},props:{data:{type:Object,default:()=>{}},onAvatarClick:{type:Function,default:()=>{}}},computed:{selectedChart(){return this.$route.params.selectedChart}}};var ry=function(){var e=this,i=e._self._c;return i("div",{staticClass:"org-chart-node"},[i("div",{staticClass:"inner-box"},[i("router-link",{attrs:{to:{name:"contact",params:{selectedGroup:e.selectedChart,selectedContact:e.data.key}}}},[i("Avatar",{staticClass:"org-chart-node__avatar",attrs:{"disable-tooltip":!0,"display-name":e.data.fullName,"is-no-user":!0,size:60,url:e.data.photoUrl}})],1),i("div",{staticClass:"panel"}),i("div",{staticClass:"main-container"},[i("h3",{staticClass:"fullName"},[e._v(" "+e._s(e.data.fullName)+" ")]),i("h4",{staticClass:"title"},[e._v(" "+e._s(e.data.title)+" ")])]),i("div",{staticClass:"description"},[e.data._directSubordinates?i("p",[e._v(" "+e._s(e.t("contacts","Manages"))+": "+e._s(e.data._directSubordinates)+" ")]):e._e(),e.data._totalSubordinates?i("p",[e._v(" "+e._s(e.t("contacts","Oversees"))+": "+e._s(e.data._totalSubordinates)+" ")]):e._e()])],1)])},cy=[],ly=U(sy,ry,cy,!1,null,"3b98df70");const uy=ly.exports;function dy(e){var i=0,a=e.children,o=a&&a.length;if(!o)i=1;else for(;--o>=0;)i+=a[o].value;e.value=i}function hy(){return this.eachAfter(dy)}function py(e){var i=this,a,o=[i],s,r,c;do for(a=o.reverse(),o=[];i=a.pop();)if(e(i),s=i.children,s)for(r=0,c=s.length;r<c;++r)o.push(s[r]);while(o.length);return this}function fy(e){for(var i=this,a=[i],o,s;i=a.pop();)if(e(i),o=i.children,o)for(s=o.length-1;s>=0;--s)a.push(o[s]);return this}function my(e){for(var i=this,a=[i],o=[],s,r,c;i=a.pop();)if(o.push(i),s=i.children,s)for(r=0,c=s.length;r<c;++r)a.push(s[r]);for(;i=o.pop();)e(i);return this}function gy(e){return this.eachAfter(function(i){for(var a=+e(i.data)||0,o=i.children,s=o&&o.length;--s>=0;)a+=o[s].value;i.value=a})}function yy(e){return this.eachBefore(function(i){i.children&&i.children.sort(e)})}function vy(e){for(var i=this,a=_y(i,e),o=[i];i!==a;)i=i.parent,o.push(i);for(var s=o.length;e!==a;)o.splice(s,0,e),e=e.parent;return o}function _y(e,i){if(e===i)return e;var a=e.ancestors(),o=i.ancestors(),s=null;for(e=a.pop(),i=o.pop();e===i;)s=e,e=a.pop(),i=o.pop();return s}function by(){for(var e=this,i=[e];e=e.parent;)i.push(e);return i}function wy(){var e=[];return this.each(function(i){e.push(i)}),e}function Cy(){var e=[];return this.eachBefore(function(i){i.children||e.push(i)}),e}function ky(){var e=this,i=[];return e.each(function(a){a!==e&&i.push({source:a.parent,target:a})}),i}function ts(e,i){var a=new ta(e),o=+e.value&&(a.value=e.value),s,r=[a],c,l,h,d;for(i==null&&(i=Sy);s=r.pop();)if(o&&(s.value=+s.data.value),(l=i(s.data))&&(d=l.length))for(s.children=new Array(d),h=d-1;h>=0;--h)r.push(c=s.children[h]=new ta(l[h])),c.parent=s,c.depth=s.depth+1;return a.eachBefore(Ay)}function xy(){return ts(this).eachBefore(My)}function Sy(e){return e.children}function My(e){e.data=e.data.data}function Ay(e){var i=0;do e.height=i;while((e=e.parent)&&e.height<++i)}function ta(e){this.data=e,this.depth=this.height=0,this.parent=null}ta.prototype=ts.prototype={constructor:ta,count:hy,each:py,eachAfter:my,eachBefore:fy,sum:gy,sort:yy,path:vy,ancestors:by,descendants:wy,leaves:Cy,links:ky,copy:xy};const Ny="d3-flextree",Dy="2.1.2",Oy="build/d3-flextree.js",Ty="index",Ey={name:"Chris Maloney",url:"http://chrismaloney.org"},Ly="Flexible tree layout algorithm that allows for variable node sizes.",Iy=["d3","d3-module","layout","tree","hierarchy","d3-hierarchy","plugin","d3-plugin","infovis","visualization","2d"],$y="https://github.com/klortho/d3-flextree",zy="WTFPL",Py={type:"git",url:"https://github.com/klortho/d3-flextree.git"},By={clean:"rm -rf build demo test","build:demo":"rollup -c --environment BUILD:demo","build:dev":"rollup -c --environment BUILD:dev","build:prod":"rollup -c --environment BUILD:prod","build:test":"rollup -c --environment BUILD:test",build:"rollup -c",lint:"eslint index.js src","test:main":"node test/bundle.js","test:browser":"node test/browser-tests.js",test:"npm-run-all test:*",prepare:"npm-run-all clean build lint test"},Ry={"d3-hierarchy":"^1.1.5"},Hy={"babel-plugin-external-helpers":"^6.22.0","babel-preset-es2015-rollup":"^3.0.0",d3:"^4.13.0","d3-selection-multi":"^1.0.1",eslint:"^4.19.1",jsdom:"^11.6.2","npm-run-all":"^4.1.2",rollup:"^0.55.3","rollup-plugin-babel":"^2.7.1","rollup-plugin-commonjs":"^8.0.2","rollup-plugin-copy":"^0.2.3","rollup-plugin-json":"^2.3.0","rollup-plugin-node-resolve":"^3.0.2","rollup-plugin-uglify":"^3.0.0","uglify-es":"^3.3.9"},Yy={name:Ny,version:Dy,main:Oy,module:Ty,"jsnext:main":"index",author:Ey,description:Ly,keywords:Iy,homepage:$y,license:zy,repository:Py,scripts:By,dependencies:Ry,devDependencies:Hy},{version:Uy}=Yy,Gy=Object.freeze({children:e=>e.children,nodeSize:e=>e.data.size,spacing:0});function es(e){const i=Object.assign({},Gy,e);function a(l){const h=i[l];return typeof h=="function"?h:()=>h}function o(l){const h=c(r(),l,d=>d.children);return h.update(),h.data}function s(){const l=a("nodeSize"),h=a("spacing");return class Vc extends ts.prototype.constructor{constructor(m){super(m)}copy(){const m=c(this.constructor,this,g=>g.children);return m.each(g=>g.data=g.data.data),m}get size(){return l(this)}spacing(m){return h(this,m)}get nodes(){return this.descendants()}get xSize(){return this.size[0]}get ySize(){return this.size[1]}get top(){return this.y}get bottom(){return this.y+this.ySize}get left(){return this.x-this.xSize/2}get right(){return this.x+this.xSize/2}get root(){const m=this.ancestors();return m[m.length-1]}get numChildren(){return this.hasChildren?this.children.length:0}get hasChildren(){return!this.noChildren}get noChildren(){return this.children===null}get firstChild(){return this.hasChildren?this.children[0]:null}get lastChild(){return this.hasChildren?this.children[this.numChildren-1]:null}get extents(){return(this.children||[]).reduce((m,g)=>Vc.maxExtents(m,g.extents),this.nodeExtents)}get nodeExtents(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}static maxExtents(m,g){return{top:Math.min(m.top,g.top),bottom:Math.max(m.bottom,g.bottom),left:Math.min(m.left,g.left),right:Math.max(m.right,g.right)}}}}function r(){const l=s(),h=a("nodeSize"),d=a("spacing");return class extends l{constructor(m){super(m),Object.assign(this,{x:0,y:0,relX:0,prelim:0,shift:0,change:0,lExt:this,lExtRelX:0,lThr:null,rExt:this,rExtRelX:0,rThr:null})}get size(){return h(this.data)}spacing(m){return d(this.data,m.data)}get x(){return this.data.x}set x(m){this.data.x=m}get y(){return this.data.y}set y(m){this.data.y=m}update(){return jc(this),Wc(this),this}}}function c(l,h,d){const m=(g,b)=>{const k=new l(g);Object.assign(k,{parent:b,depth:b===null?0:b.depth+1,height:0,length:1});const N=d(g)||[];return k.children=N.length===0?null:N.map(L=>m(L,k)),k.children&&Object.assign(k,k.children.reduce((L,B)=>({height:Math.max(L.height,B.height+1),length:L.length+B.length}),k)),k};return m(h,null)}return Object.assign(o,{nodeSize(l){return arguments.length?(i.nodeSize=l,o):i.nodeSize},spacing(l){return arguments.length?(i.spacing=l,o):i.spacing},children(l){return arguments.length?(i.children=l,o):i.children},hierarchy(l,h){const d=typeof h>"u"?i.children:h;return c(s(),l,d)},dump(l){const h=a("nodeSize"),d=m=>g=>{const b=m+"  ",k=m+"    ",{x:N,y:L}=g,B=h(g),z=g.children||[],j=z.length===0?" ":`,${b}children: [${k}${z.map(d(k)).join(k)}${b}],${m}`;return`{ size: [${B.join(", ")}],${b}x: ${N}, y: ${L}${j}},`};return d(`
`)(l)}}),o}es.version=Uy;const jc=(e,i=0)=>(e.y=i,(e.children||[]).reduce((a,o)=>{const[s,r]=a;jc(o,e.y+e.ySize);const c=(s===0?o.lExt:o.rExt).bottom;s!==0&&Vy(e,s,r);const l=Qy(c,s,r);return[s+1,l]},[0,null]),Fy(e),Jy(e),e),Wc=(e,i,a)=>{typeof i>"u"&&(i=-e.relX-e.prelim,a=0);const o=i+e.relX;return e.relX=o+e.prelim-a,e.prelim=0,e.x=a+e.relX,(e.children||[]).forEach(s=>Wc(s,o,e.x)),e},Fy=e=>{(e.children||[]).reduce((i,a)=>{const[o,s]=i,r=o+a.shift,c=s+r+a.change;return a.relX+=c,[r,c]},[0,0])},Vy=(e,i,a)=>{const o=e.children[i-1],s=e.children[i];let r=o,c=o.relX,l=s,h=s.relX,d=!0;for(;r&&l;){r.bottom>a.lowY&&(a=a.next);const m=c+r.prelim-(h+l.prelim)+r.xSize/2+l.xSize/2+r.spacing(l);(m>0||m<0&&d)&&(h+=m,jy(s,m),Wy(e,i,a.index,m)),d=!1;const g=r.bottom,b=l.bottom;g<=b&&(r=Xy(r),r&&(c+=r.relX)),g>=b&&(l=qy(l),l&&(h+=l.relX))}!r&&l?Zy(e,i,l,h):r&&!l&&Ky(e,i,r,c)},jy=(e,i)=>{e.relX+=i,e.lExtRelX+=i,e.rExtRelX+=i},Wy=(e,i,a,o)=>{const s=e.children[i],r=i-a;if(r>1){const c=o/r;e.children[a+1].shift+=c,s.shift-=c,s.change-=o-c}},qy=e=>e.hasChildren?e.firstChild:e.lThr,Xy=e=>e.hasChildren?e.lastChild:e.rThr,Zy=(e,i,a,o)=>{const s=e.firstChild,r=s.lExt,c=e.children[i];r.lThr=a;const l=o-a.relX-s.lExtRelX;r.relX+=l,r.prelim-=l,s.lExt=c.lExt,s.lExtRelX=c.lExtRelX},Ky=(e,i,a,o)=>{const s=e.children[i],r=s.rExt,c=e.children[i-1];r.rThr=a;const l=o-a.relX-s.rExtRelX;r.relX+=l,r.prelim-=l,s.rExt=c.rExt,s.rExtRelX=c.rExtRelX},Jy=e=>{if(e.hasChildren){const i=e.firstChild,a=e.lastChild,o=(i.prelim+i.relX-i.xSize/2+a.relX+a.prelim+a.xSize/2)/2;Object.assign(e,{prelim:o,lExt:i.lExt,lExtRelX:i.lExtRelX,rExt:a.rExt,rExtRelX:a.rExtRelX})}},Qy=(e,i,a)=>{for(;a!==null&&e>=a.lowY;)a=a.next;return{lowY:e,index:i,next:a}},gt={selection:Tn,select:Ft,max:Uf,min:Gf,sum:Ff,cumsum:Yf,tree:G0,stratify:z0,zoom:oy,zoomIdentity:Qo,linkHorizontal:J0,flextree:es};let tv=class{constructor(){const e={id:`ID${Math.floor(Math.random()*1e6)}`,firstDraw:!0,ctx:document.createElement("canvas").getContext("2d"),initialExpandLevel:1,nodeDefaultBackground:"none",lastTransform:{x:0,y:0,k:1},allowedNodesCount:{},zoomBehavior:null,generateRoot:null,svgWidth:800,svgHeight:window.innerHeight-100,container:"body",data:null,connections:[],defaultFont:"Helvetica",nodeId:i=>i.nodeId||i.id,parentNodeId:i=>i.parentNodeId||i.parentId,rootMargin:40,nodeWidth:i=>250,nodeHeight:i=>150,neighbourMargin:(i,a)=>80,siblingsMargin:i=>20,childrenMargin:i=>60,compactMarginPair:i=>100,compactMarginBetween:i=>20,nodeButtonWidth:i=>40,nodeButtonHeight:i=>40,nodeButtonX:i=>-20,nodeButtonY:i=>-20,linkYOffset:30,pagingStep:i=>5,minPagingVisibleNodes:i=>2e3,scaleExtent:[.001,20],duration:400,imageName:"Chart",setActiveNodeCentered:!0,layout:"top",compact:!0,createZoom:i=>gt.zoom(),onZoomStart:i=>{},onZoom:i=>{},onZoomEnd:i=>{},onNodeClick:i=>i,onExpandOrCollapse:i=>i,nodeContent:i=>`<div style="padding:5px;font-size:10px;">Sample Node(id=${i.id}), override using <br/> 
            <code>chart.nodeContent({data}=>{ <br/>
             &nbsp;&nbsp;&nbsp;&nbsp;return '' // Custom HTML <br/>
             })</code>
             <br/> 
             Or check different <a href="https://github.com/bumbeishvili/org-chart#jump-to-examples" target="_blank">layout examples</a>
             </div>`,buttonContent:({node:i,state:a})=>`<div style="border:1px solid #E4E2E9;border-radius:3px;padding:3px;font-size:9px;margin:auto auto;background-color:white"> ${{left:o=>o?`<div style="display:flex;"><span style="align-items:center;display:flex;"><svg width="8" height="8" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                      <path d="M14.283 3.50094L6.51 11.4749C6.37348 11.615 6.29707 11.8029 6.29707 11.9984C6.29707 12.194 6.37348 12.3819 6.51 12.5219L14.283 20.4989C14.3466 20.5643 14.4226 20.6162 14.5066 20.6516C14.5906 20.6871 14.6808 20.7053 14.772 20.7053C14.8632 20.7053 14.9534 20.6871 15.0374 20.6516C15.1214 20.6162 15.1974 20.5643 15.261 20.4989C15.3918 20.365 15.4651 20.1852 15.4651 19.9979C15.4651 19.8107 15.3918 19.6309 15.261 19.4969L7.9515 11.9984L15.261 4.50144C15.3914 4.36756 15.4643 4.18807 15.4643 4.00119C15.4643 3.81431 15.3914 3.63482 15.261 3.50094C15.1974 3.43563 15.1214 3.38371 15.0374 3.34827C14.9534 3.31282 14.8632 3.29456 14.772 3.29456C14.6808 3.29456 14.5906 3.31282 14.5066 3.34827C14.4226 3.38371 14.3466 3.43563 14.283 3.50094V3.50094Z" fill="#716E7B" stroke="#716E7B"/>
                      </svg></span><span style="color:#716E7B">${i.data._directSubordinatesPaging} </span></div>`:`<div style="display:flex;"><span style="align-items:center;display:flex;"><svg width="8" height="8" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                          <path d="M7.989 3.49944C7.85817 3.63339 7.78492 3.8132 7.78492 4.00044C7.78492 4.18768 7.85817 4.36749 7.989 4.50144L15.2985 11.9999L7.989 19.4969C7.85817 19.6309 7.78492 19.8107 7.78492 19.9979C7.78492 20.1852 7.85817 20.365 7.989 20.4989C8.05259 20.5643 8.12863 20.6162 8.21261 20.6516C8.2966 20.6871 8.38684 20.7053 8.478 20.7053C8.56916 20.7053 8.6594 20.6871 8.74338 20.6516C8.82737 20.6162 8.90341 20.5643 8.967 20.4989L16.74 12.5234C16.8765 12.3834 16.9529 12.1955 16.9529 11.9999C16.9529 11.8044 16.8765 11.6165 16.74 11.4764L8.967 3.50094C8.90341 3.43563 8.82737 3.38371 8.74338 3.34827C8.6594 3.31282 8.56916 3.29456 8.478 3.29456C8.38684 3.29456 8.2966 3.31282 8.21261 3.34827C8.12863 3.38371 8.05259 3.43563 7.989 3.50094V3.49944Z" fill="#716E7B" stroke="#716E7B"/>
                          </svg></span><span style="color:#716E7B">${i.data._directSubordinatesPaging} </span></div>`,bottom:o=>o?`<div style="display:flex;"><span style="align-items:center;display:flex;"><svg width="8" height="8" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                       <path d="M19.497 7.98903L12 15.297L4.503 7.98903C4.36905 7.85819 4.18924 7.78495 4.002 7.78495C3.81476 7.78495 3.63495 7.85819 3.501 7.98903C3.43614 8.05257 3.38462 8.12842 3.34944 8.21213C3.31427 8.29584 3.29615 8.38573 3.29615 8.47653C3.29615 8.56733 3.31427 8.65721 3.34944 8.74092C3.38462 8.82463 3.43614 8.90048 3.501 8.96403L11.4765 16.74C11.6166 16.8765 11.8044 16.953 12 16.953C12.1956 16.953 12.3834 16.8765 12.5235 16.74L20.499 8.96553C20.5643 8.90193 20.6162 8.8259 20.6517 8.74191C20.6871 8.65792 20.7054 8.56769 20.7054 8.47653C20.7054 8.38537 20.6871 8.29513 20.6517 8.21114C20.6162 8.12715 20.5643 8.05112 20.499 7.98753C20.3651 7.85669 20.1852 7.78345 19.998 7.78345C19.8108 7.78345 19.6309 7.85669 19.497 7.98753V7.98903Z" fill="#716E7B" stroke="#716E7B"/>
                       </svg></span><span style="margin-left:1px;color:#716E7B" >${i.data._directSubordinatesPaging} </span></div>
                       `:`<div style="display:flex;"><span style="align-items:center;display:flex;"><svg width="8" height="8" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                       <path d="M11.457 8.07005L3.49199 16.4296C3.35903 16.569 3.28485 16.7543 3.28485 16.9471C3.28485 17.1398 3.35903 17.3251 3.49199 17.4646L3.50099 17.4736C3.56545 17.5414 3.64304 17.5954 3.72904 17.6324C3.81504 17.6693 3.90765 17.6883 4.00124 17.6883C4.09483 17.6883 4.18745 17.6693 4.27344 17.6324C4.35944 17.5954 4.43703 17.5414 4.50149 17.4736L12.0015 9.60155L19.4985 17.4736C19.563 17.5414 19.6405 17.5954 19.7265 17.6324C19.8125 17.6693 19.9052 17.6883 19.9987 17.6883C20.0923 17.6883 20.1849 17.6693 20.2709 17.6324C20.3569 17.5954 20.4345 17.5414 20.499 17.4736L20.508 17.4646C20.641 17.3251 20.7151 17.1398 20.7151 16.9471C20.7151 16.7543 20.641 16.569 20.508 16.4296L12.543 8.07005C12.4729 7.99653 12.3887 7.93801 12.2954 7.89801C12.202 7.85802 12.1015 7.8374 12 7.8374C11.8984 7.8374 11.798 7.85802 11.7046 7.89801C11.6113 7.93801 11.527 7.99653 11.457 8.07005Z" fill="#716E7B" stroke="#716E7B"/>
                       </svg></span><span style="margin-left:1px;color:#716E7B" >${i.data._directSubordinatesPaging} </span></div>
                    `,right:o=>o?`<div style="display:flex;"><span style="align-items:center;display:flex;"><svg width="8" height="8" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                       <path d="M7.989 3.49944C7.85817 3.63339 7.78492 3.8132 7.78492 4.00044C7.78492 4.18768 7.85817 4.36749 7.989 4.50144L15.2985 11.9999L7.989 19.4969C7.85817 19.6309 7.78492 19.8107 7.78492 19.9979C7.78492 20.1852 7.85817 20.365 7.989 20.4989C8.05259 20.5643 8.12863 20.6162 8.21261 20.6516C8.2966 20.6871 8.38684 20.7053 8.478 20.7053C8.56916 20.7053 8.6594 20.6871 8.74338 20.6516C8.82737 20.6162 8.90341 20.5643 8.967 20.4989L16.74 12.5234C16.8765 12.3834 16.9529 12.1955 16.9529 11.9999C16.9529 11.8044 16.8765 11.6165 16.74 11.4764L8.967 3.50094C8.90341 3.43563 8.82737 3.38371 8.74338 3.34827C8.6594 3.31282 8.56916 3.29456 8.478 3.29456C8.38684 3.29456 8.2966 3.31282 8.21261 3.34827C8.12863 3.38371 8.05259 3.43563 7.989 3.50094V3.49944Z" fill="#716E7B" stroke="#716E7B"/>
                       </svg></span><span style="color:#716E7B">${i.data._directSubordinatesPaging} </span></div>`:`<div style="display:flex;"><span style="align-items:center;display:flex;"><svg width="8" height="8" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                       <path d="M14.283 3.50094L6.51 11.4749C6.37348 11.615 6.29707 11.8029 6.29707 11.9984C6.29707 12.194 6.37348 12.3819 6.51 12.5219L14.283 20.4989C14.3466 20.5643 14.4226 20.6162 14.5066 20.6516C14.5906 20.6871 14.6808 20.7053 14.772 20.7053C14.8632 20.7053 14.9534 20.6871 15.0374 20.6516C15.1214 20.6162 15.1974 20.5643 15.261 20.4989C15.3918 20.365 15.4651 20.1852 15.4651 19.9979C15.4651 19.8107 15.3918 19.6309 15.261 19.4969L7.9515 11.9984L15.261 4.50144C15.3914 4.36756 15.4643 4.18807 15.4643 4.00119C15.4643 3.81431 15.3914 3.63482 15.261 3.50094C15.1974 3.43563 15.1214 3.38371 15.0374 3.34827C14.9534 3.31282 14.8632 3.29456 14.772 3.29456C14.6808 3.29456 14.5906 3.31282 14.5066 3.34827C14.4226 3.38371 14.3466 3.43563 14.283 3.50094V3.50094Z" fill="#716E7B" stroke="#716E7B"/>
                       </svg></span><span style="color:#716E7B">${i.data._directSubordinatesPaging} </span></div>`,top:o=>o?`<div style="display:flex;"><span style="align-items:center;display:flex;"><svg width="8" height="8" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M11.457 8.07005L3.49199 16.4296C3.35903 16.569 3.28485 16.7543 3.28485 16.9471C3.28485 17.1398 3.35903 17.3251 3.49199 17.4646L3.50099 17.4736C3.56545 17.5414 3.64304 17.5954 3.72904 17.6324C3.81504 17.6693 3.90765 17.6883 4.00124 17.6883C4.09483 17.6883 4.18745 17.6693 4.27344 17.6324C4.35944 17.5954 4.43703 17.5414 4.50149 17.4736L12.0015 9.60155L19.4985 17.4736C19.563 17.5414 19.6405 17.5954 19.7265 17.6324C19.8125 17.6693 19.9052 17.6883 19.9987 17.6883C20.0923 17.6883 20.1849 17.6693 20.2709 17.6324C20.3569 17.5954 20.4345 17.5414 20.499 17.4736L20.508 17.4646C20.641 17.3251 20.7151 17.1398 20.7151 16.9471C20.7151 16.7543 20.641 16.569 20.508 16.4296L12.543 8.07005C12.4729 7.99653 12.3887 7.93801 12.2954 7.89801C12.202 7.85802 12.1015 7.8374 12 7.8374C11.8984 7.8374 11.798 7.85802 11.7046 7.89801C11.6113 7.93801 11.527 7.99653 11.457 8.07005Z" fill="#716E7B" stroke="#716E7B"/>
                        </svg></span><span style="margin-left:1px;color:#716E7B">${i.data._directSubordinatesPaging} </span></div>
                        `:`<div style="display:flex;"><span style="align-items:center;display:flex;"><svg width="8" height="8" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M19.497 7.98903L12 15.297L4.503 7.98903C4.36905 7.85819 4.18924 7.78495 4.002 7.78495C3.81476 7.78495 3.63495 7.85819 3.501 7.98903C3.43614 8.05257 3.38462 8.12842 3.34944 8.21213C3.31427 8.29584 3.29615 8.38573 3.29615 8.47653C3.29615 8.56733 3.31427 8.65721 3.34944 8.74092C3.38462 8.82463 3.43614 8.90048 3.501 8.96403L11.4765 16.74C11.6166 16.8765 11.8044 16.953 12 16.953C12.1956 16.953 12.3834 16.8765 12.5235 16.74L20.499 8.96553C20.5643 8.90193 20.6162 8.8259 20.6517 8.74191C20.6871 8.65792 20.7054 8.56769 20.7054 8.47653C20.7054 8.38537 20.6871 8.29513 20.6517 8.21114C20.6162 8.12715 20.5643 8.05112 20.499 7.98753C20.3651 7.85669 20.1852 7.78345 19.998 7.78345C19.8108 7.78345 19.6309 7.85669 19.497 7.98753V7.98903Z" fill="#716E7B" stroke="#716E7B"/>
                        </svg></span><span style="margin-left:1px;color:#716E7B">${i.data._directSubordinatesPaging} </span></div>
                    `}[a.layout](i.children)}  </div>`,pagingButton:(i,a,o,s)=>{const r=s.pagingStep(i.parent),c=i.parent.data._pagingStep,l=i.parent.data._directSubordinatesPaging-c;return`
                   <div style="margin-top:90px;">
                      <div style="display:flex;width:170px;border-radius:20px;padding:5px 15px; padding-bottom:4px;;background-color:#E5E9F2">
                      <div><svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                      <path d="M5.59 7.41L10.18 12L5.59 16.59L7 18L13 12L7 6L5.59 7.41ZM16 6H18V18H16V6Z" fill="#716E7B" stroke="#716E7B"/>
                      </svg>
                      </div><div style="line-height:2"> Show next ${Math.min(l,r)}  nodes </div></div>
                   </div>
                `},nodeUpdate:function(i,a,o){gt.select(this).select(".node-rect").attr("stroke",s=>s.data._highlighted||s.data._upToTheRootHighlighted?"#E27396":"none").attr("stroke-width",i.data._highlighted||i.data._upToTheRootHighlighted?10:1)},nodeEnter:i=>i,nodeExit:i=>i,linkUpdate:function(i,a,o){gt.select(this).attr("stroke",s=>s.data._upToTheRootHighlighted?"#E27396":"#E4E2E9").attr("stroke-width",s=>s.data._upToTheRootHighlighted?5:1),i.data._upToTheRootHighlighted&&gt.select(this).raise()},hdiagonal:function(i,a,o){const s=i.x,r=i.y,c=a.x,l=a.y;let h=o&&o.x!=null?o.x:s,d=o&&o.y!=null?o.y:r,m=c-s<0?-1:1,g=l-r<0?-1:1,b=35,k=Math.abs(c-s)/2<b?Math.abs(c-s)/2:b;k=Math.abs(l-r)/2<k?Math.abs(l-r)/2:k;let N=Math.abs(c-s)/2-k;return`
                          M ${h} ${d}
                          L ${h} ${r}
                          L ${s} ${r}
                          L ${s+N*m} ${r}
                          C ${s+N*m+k*m} ${r} 
                            ${s+N*m+k*m} ${r} 
                            ${s+N*m+k*m} ${r+k*g}
                          L ${s+N*m+k*m} ${l-k*g} 
                          C ${s+N*m+k*m}  ${l} 
                            ${s+N*m+k*m}  ${l} 
                            ${c-N*m}  ${l}
                          L ${c} ${l}
               `},diagonal:function(i,a,o,s={sy:0}){const r=i.x;let c=i.y;const l=a.x,h=a.y;let d=o&&o.x!=null?o.x:r,m=o&&o.y!=null?o.y:c,g=l-r<0?-1:1,b=h-c<0?-1:1;c+=s.sy;let k=35,N=Math.abs(l-r)/2<k?Math.abs(l-r)/2:k;N=Math.abs(h-c)/2<N?Math.abs(h-c)/2:N;let L=Math.abs(h-c)/2-N,B=Math.abs(l-r)-N*2;return`
                          M ${d} ${m}
                          L ${r} ${m}
                          L ${r} ${c}
                          L ${r} ${c+L*b}
                          C  ${r} ${c+L*b+N*b} ${r} ${c+L*b+N*b} ${r+N*g} ${c+L*b+N*b}
                          L ${r+B*g+N*g} ${c+L*b+N*b}
                          C  ${l}  ${c+L*b+N*b} ${l}  ${c+L*b+N*b} ${l} ${h-L*b}
                          L ${l} ${h}
               `},defs:function(i,a){return`<defs>
                    ${a.map(o=>{const s=this.getTextWidth(o.label,{ctx:i.ctx,fontSize:2,defaultFont:i.defaultFont});return`
                       <marker id="${o.from+"_"+o.to}" refX="${o._source.x<o._target.x?-7:7}" refY="5" markerWidth="500"  markerHeight="500"  orient="${o._source.x<o._target.x?"auto":"auto-start-reverse"}" >
                       <rect rx=0.5 width=${o.label?s+3:0} height=3 y=1  fill="#E27396"></rect>
                       <text font-size="2px" x=1 fill="white" y=3>${o.label||""}</text>
                       </marker>

                       <marker id="arrow-${o.from+"_"+o.to}"  markerWidth="500"  markerHeight="500"  refY="2"  refX="1" orient="${o._source.x<o._target.x?"auto":"auto-start-reverse"}" >
                       <path transform="translate(0)" d='M0,0 V4 L2,2 Z' fill='#E27396' />
                       </marker>
                    `}).join("")}
                    </defs>
                    `},connectionsUpdate:function(i,a,o){gt.select(this).attr("stroke",s=>"#E27396").attr("stroke-linecap","round").attr("stroke-width",s=>"5").attr("pointer-events","none").attr("marker-start",s=>`url(#${s.from+"_"+s.to})`).attr("marker-end",s=>`url(#arrow-${s.from+"_"+s.to})`)},linkGroupArc:gt.linkHorizontal().x(i=>i.x).y(i=>i.y),layoutBindings:{left:{nodeLeftX:i=>0,nodeRightX:i=>i.width,nodeTopY:i=>-i.height/2,nodeBottomY:i=>i.height/2,nodeJoinX:i=>i.x+i.width,nodeJoinY:i=>i.y-i.height/2,linkJoinX:i=>i.x+i.width,linkJoinY:i=>i.y,linkX:i=>i.x,linkY:i=>i.y,linkCompactXStart:i=>i.x+i.width/2,linkCompactYStart:i=>i.y+(i.compactEven?i.height/2:-i.height/2),compactLinkMidX:(i,a)=>i.firstCompactNode.x,compactLinkMidY:(i,a)=>i.firstCompactNode.y+i.firstCompactNode.flexCompactDim[0]/4+a.compactMarginPair(i)/4,linkParentX:i=>i.parent.x+i.parent.width,linkParentY:i=>i.parent.y,buttonX:i=>i.width,buttonY:i=>i.height/2,centerTransform:({root:i,rootMargin:a,centerY:o,scale:s,centerX:r})=>`translate(${a},${o}) scale(${s})`,compactDimension:{sizeColumn:i=>i.height,sizeRow:i=>i.width,reverse:i=>i.slice().reverse()},nodeFlexSize:({height:i,width:a,siblingsMargin:o,childrenMargin:s,state:r,node:c})=>r.compact&&c.flexCompactDim?[c.flexCompactDim[0],c.flexCompactDim[1]]:[i+o,a+s],zoomTransform:({centerY:i,scale:a})=>`translate(0,${i}) scale(${a})`,diagonal:this.hdiagonal.bind(this),swap:i=>{const a=i.x;i.x=i.y,i.y=a},nodeUpdateTransform:({x:i,y:a,width:o,height:s})=>`translate(${i},${a-s/2})`},top:{nodeLeftX:i=>-i.width/2,nodeRightX:i=>i.width/2,nodeTopY:i=>0,nodeBottomY:i=>i.height,nodeJoinX:i=>i.x-i.width/2,nodeJoinY:i=>i.y+i.height,linkJoinX:i=>i.x,linkJoinY:i=>i.y+i.height,linkCompactXStart:i=>i.x+(i.compactEven?i.width/2:-i.width/2),linkCompactYStart:i=>i.y+i.height/2,compactLinkMidX:(i,a)=>i.firstCompactNode.x+i.firstCompactNode.flexCompactDim[0]/4+a.compactMarginPair(i)/4,compactLinkMidY:i=>i.firstCompactNode.y,compactDimension:{sizeColumn:i=>i.width,sizeRow:i=>i.height,reverse:i=>i},linkX:i=>i.x,linkY:i=>i.y,linkParentX:i=>i.parent.x,linkParentY:i=>i.parent.y+i.parent.height,buttonX:i=>i.width/2,buttonY:i=>i.height,centerTransform:({root:i,rootMargin:a,centerY:o,scale:s,centerX:r})=>`translate(${r},${a}) scale(${s})`,nodeFlexSize:({height:i,width:a,siblingsMargin:o,childrenMargin:s,state:r,node:c,compactViewIndex:l})=>r.compact&&c.flexCompactDim?[c.flexCompactDim[0],c.flexCompactDim[1]]:[a+o,i+s],zoomTransform:({centerX:i,scale:a})=>`translate(${i},0}) scale(${a})`,diagonal:this.diagonal.bind(this),swap:i=>{},nodeUpdateTransform:({x:i,y:a,width:o,height:s})=>`translate(${i-o/2},${a})`},bottom:{nodeLeftX:i=>-i.width/2,nodeRightX:i=>i.width/2,nodeTopY:i=>-i.height,nodeBottomY:i=>0,nodeJoinX:i=>i.x-i.width/2,nodeJoinY:i=>i.y-i.height-i.height,linkJoinX:i=>i.x,linkJoinY:i=>i.y-i.height,linkCompactXStart:i=>i.x+(i.compactEven?i.width/2:-i.width/2),linkCompactYStart:i=>i.y-i.height/2,compactLinkMidX:(i,a)=>i.firstCompactNode.x+i.firstCompactNode.flexCompactDim[0]/4+a.compactMarginPair(i)/4,compactLinkMidY:i=>i.firstCompactNode.y,linkX:i=>i.x,linkY:i=>i.y,compactDimension:{sizeColumn:i=>i.width,sizeRow:i=>i.height,reverse:i=>i},linkParentX:i=>i.parent.x,linkParentY:i=>i.parent.y-i.parent.height,buttonX:i=>i.width/2,buttonY:i=>0,centerTransform:({root:i,rootMargin:a,centerY:o,scale:s,centerX:r,chartHeight:c})=>`translate(${r},${c-a}) scale(${s})`,nodeFlexSize:({height:i,width:a,siblingsMargin:o,childrenMargin:s,state:r,node:c})=>r.compact&&c.flexCompactDim?[c.flexCompactDim[0],c.flexCompactDim[1]]:[a+o,i+s],zoomTransform:({centerX:i,scale:a})=>`translate(${i},0}) scale(${a})`,diagonal:this.diagonal.bind(this),swap:i=>{i.y=-i.y},nodeUpdateTransform:({x:i,y:a,width:o,height:s})=>`translate(${i-o/2},${a-s})`},right:{nodeLeftX:i=>-i.width,nodeRightX:i=>0,nodeTopY:i=>-i.height/2,nodeBottomY:i=>i.height/2,nodeJoinX:i=>i.x-i.width-i.width,nodeJoinY:i=>i.y-i.height/2,linkJoinX:i=>i.x-i.width,linkJoinY:i=>i.y,linkX:i=>i.x,linkY:i=>i.y,linkParentX:i=>i.parent.x-i.parent.width,linkParentY:i=>i.parent.y,buttonX:i=>0,buttonY:i=>i.height/2,linkCompactXStart:i=>i.x-i.width/2,linkCompactYStart:i=>i.y+(i.compactEven?i.height/2:-i.height/2),compactLinkMidX:(i,a)=>i.firstCompactNode.x,compactLinkMidY:(i,a)=>i.firstCompactNode.y+i.firstCompactNode.flexCompactDim[0]/4+a.compactMarginPair(i)/4,centerTransform:({root:i,rootMargin:a,centerY:o,scale:s,centerX:r,chartWidth:c})=>`translate(${c-a},${o}) scale(${s})`,nodeFlexSize:({height:i,width:a,siblingsMargin:o,childrenMargin:s,state:r,node:c})=>r.compact&&c.flexCompactDim?[c.flexCompactDim[0],c.flexCompactDim[1]]:[i+o,a+s],compactDimension:{sizeColumn:i=>i.height,sizeRow:i=>i.width,reverse:i=>i.slice().reverse()},zoomTransform:({centerY:i,scale:a})=>`translate(0,${i}) scale(${a})`,diagonal:this.hdiagonal.bind(this),swap:i=>{const a=i.x;i.x=-i.y,i.y=a},nodeUpdateTransform:({x:i,y:a,width:o,height:s})=>`translate(${i-o},${a-s/2})`}}};this.getChartState=()=>e,Object.keys(e).forEach(i=>{this[i]=function(a){if(arguments.length)e[i]=a;else return e[i];return this}}),this.initializeEnterExitUpdatePattern()}initializeEnterExitUpdatePattern(){gt.selection.prototype.patternify=function(e){var i=this,a=e.selector,o=e.tag,s=e.data||[a],r=i.selectAll("."+a).data(s,(c,l)=>typeof c=="object"&&c.id?c.id:l);return r.exit().remove(),r=r.enter().append(o).merge(r),r.attr("class",a),r}}getNodeChildren({data:e,children:i,_children:a},o){return o.push(e),i&&i.forEach(s=>{this.getNodeChildren(s,o)}),a&&a.forEach(s=>{this.getNodeChildren(s,o)}),o}initialZoom(e){const i=this.getChartState();return i.lastTransform.k=e,this}render(){const e=this.getChartState();if(!e.data||e.data.length==0)return console.log("ORG CHART - Data is empty"),e.container&&(Ft(e.container).select(".nodes-wrapper").remove(),Ft(e.container).select(".links-wrapper").remove(),Ft(e.container).select(".connections-wrapper").remove()),this;const i=gt.select(e.container),a=i.node().getBoundingClientRect();a.width>0&&(e.svgWidth=a.width);const o={id:`ID${Math.floor(Math.random()*1e6)}`,chartWidth:e.svgWidth,chartHeight:e.svgHeight};if(e.calc=o,o.centerX=o.chartWidth/2,o.centerY=o.chartHeight/2,e.firstDraw){const c={zoom:null};c.zoom=e.createZoom().clickDistance(10).on("start",(l,h)=>e.onZoomStart(l)).on("end",(l,h)=>e.onZoomEnd(l)).on("zoom",(l,h)=>{e.onZoom(l),this.zoomed(l,h)}).scaleExtent(e.scaleExtent),e.zoomBehavior=c.zoom}e.flexTreeLayout=es({nodeSize:c=>{const l=e.nodeWidth(c),h=e.nodeHeight(c),d=e.siblingsMargin(c),m=e.childrenMargin(c);return e.layoutBindings[e.layout].nodeFlexSize({state:e,node:c,width:l,height:h,siblingsMargin:d,childrenMargin:m})}}).spacing((c,l)=>c.parent==l.parent?0:e.neighbourMargin(c,l)),this.setLayouts({expandNodesFirst:!1});const s=i.patternify({tag:"svg",selector:"svg-chart-container"}).attr("width",e.svgWidth).attr("height",e.svgHeight).attr("font-family",e.defaultFont);e.firstDraw&&s.call(e.zoomBehavior).on("dblclick.zoom",null).attr("cursor","move"),e.svg=s;const r=s.patternify({tag:"g",selector:"chart"});return e.centerG=r.patternify({tag:"g",selector:"center-group"}),e.linksWrapper=e.centerG.patternify({tag:"g",selector:"links-wrapper"}),e.nodesWrapper=e.centerG.patternify({tag:"g",selector:"nodes-wrapper"}),e.connectionsWrapper=e.centerG.patternify({tag:"g",selector:"connections-wrapper"}),e.defsWrapper=s.patternify({tag:"g",selector:"defs-wrapper"}),e.firstDraw&&e.centerG.attr("transform",()=>e.layoutBindings[e.layout].centerTransform({centerX:o.centerX,centerY:o.centerY,scale:e.lastTransform.k,rootMargin:e.rootMargin,root:e.root,chartHeight:o.chartHeight,chartWidth:o.chartWidth})),e.chart=r,this.update(e.root),gt.select(window).on(`resize.${e.id}`,()=>{const c=gt.select(e.container).node().getBoundingClientRect();e.svg.attr("width",c.width)}),e.firstDraw&&(e.firstDraw=!1),this}addNode(e){const i=this.getChartState();if(e&&(i.parentNodeId(e)==null||i.parentNodeId(e)==i.nodeId(e))&&i.data.length==0)return i.data.push(e),this.render(),this;const a=i.generateRoot(i.data).descendants(),o=a.filter(({data:s})=>i.nodeId(s).toString()===i.nodeId(e).toString())[0];return a.filter(({data:s})=>i.nodeId(s).toString()===i.parentNodeId(e).toString())[0],o?(console.log(`ORG CHART - ADD - Node with id "${i.nodeId(e)}" already exists in tree`),this):(e._centered&&!e._expanded&&(e._expanded=!0),i.data.push(e),this.updateNodesState(),this)}removeNode(e){const i=this.getChartState(),a=i.generateRoot(i.data).descendants().filter(({data:o})=>i.nodeId(o)==e)[0];return a?(a.descendants().forEach(o=>o.data._filteredOut=!0),i.data=i.data.filter(o=>!o._filteredOut),i.data.length==0?this.render():this.updateNodesState.bind(this)(),this):(console.log(`ORG CHART - REMOVE - Node with id "${e}" not found in the tree`),this)}groupBy(e,i,a){const o={};return e.forEach(s=>{const r=i(s);o[r]||(o[r]=[]),o[r].push(s)}),Object.keys(o).forEach(s=>{o[s]=a(o[s])}),Object.entries(o)}calculateCompactFlexDimensions(e){const i=this.getChartState();e.eachBefore(a=>{a.firstCompact=null,a.compactEven=null,a.flexCompactDim=null,a.firstCompactNode=null}),e.eachBefore(a=>{if(a.children&&a.children.length>1){const o=a.children.filter(d=>!d.children);if(o.length<2)return;o.forEach((d,m)=>{m||(d.firstCompact=!0),m%2?d.compactEven=!1:d.compactEven=!0,d.row=Math.floor(m/2)});const s=gt.max(o.filter(d=>d.compactEven),i.layoutBindings[i.layout].compactDimension.sizeColumn),r=gt.max(o.filter(d=>!d.compactEven),i.layoutBindings[i.layout].compactDimension.sizeColumn),c=Math.max(s,r)*2,l=this.groupBy(o,d=>d.row,d=>gt.max(d,m=>i.layoutBindings[i.layout].compactDimension.sizeRow(m)+i.compactMarginBetween(m))),h=gt.sum(l.map(d=>d[1]));o.forEach(d=>{d.firstCompactNode=o[0],d.firstCompact?d.flexCompactDim=[c+i.compactMarginPair(d),h-i.compactMarginBetween(d)]:d.flexCompactDim=[0,0]}),a.flexCompactDim=null}})}calculateCompactFlexPositions(e){const i=this.getChartState();e.eachBefore(a=>{if(a.children){const o=a.children.filter(d=>d.flexCompactDim),s=o[0];if(!s)return;o.forEach((d,m,g)=>{m==0&&(s.x-=s.flexCompactDim[0]/2),m&m%2-1?d.x=s.x+s.flexCompactDim[0]*.25-i.compactMarginPair(d)/4:m&&(d.x=s.x+s.flexCompactDim[0]*.75+i.compactMarginPair(d)/4)});const r=s.x+s.flexCompactDim[0]*.5;s.x=s.x+s.flexCompactDim[0]*.25-i.compactMarginPair(s)/4;const c=a.x-r;Math.abs(c)<10&&o.forEach(d=>d.x+=c);const l=this.groupBy(o,d=>d.row,d=>gt.max(d,m=>i.layoutBindings[i.layout].compactDimension.sizeRow(m))),h=gt.cumsum(l.map(d=>d[1]+i.compactMarginBetween(d)));o.forEach((d,m)=>{d.row?d.y=s.y+h[d.row-1]:d.y=s.y})}})}update({x0:e,y0:i,x:a=0,y:o=0,width:s,height:r}){const c=this.getChartState();c.calc,c.compact&&this.calculateCompactFlexDimensions(c.root);const l=c.flexTreeLayout(c.root);c.compact&&this.calculateCompactFlexPositions(c.root);const h=l.descendants(),d=l.descendants().slice(1);h.forEach(c.layoutBindings[c.layout].swap);const m=c.connections,g={};c.allNodes.forEach(S=>g[c.nodeId(S.data)]=S);const b={};h.forEach(S=>b[c.nodeId(S.data)]=S),m.forEach(S=>{const x=g[S.from],C=g[S.to];S._source=x,S._target=C});const k=m.filter(S=>b[S.from]&&b[S.to]),N=c.defs.bind(this)(c,k),L=c.defsWrapper.html();N!==L&&c.defsWrapper.html(N);const B=c.linksWrapper.selectAll("path.link").data(d,S=>c.nodeId(S.data)),z=B.enter().insert("path","g").attr("class","link").attr("d",S=>{const x=c.layoutBindings[c.layout].linkJoinX({x:e,y:i,width:s,height:r}),C=c.layoutBindings[c.layout].linkJoinY({x:e,y:i,width:s,height:r}),y={x,y:C};return c.layoutBindings[c.layout].diagonal(y,y,y)}).merge(B);z.attr("fill","none"),this.isEdge()?z.style("display",S=>S.data._pagingButton?"none":"auto"):z.attr("display",S=>S.data._pagingButton?"none":"auto"),z.each(c.linkUpdate),z.transition().duration(c.duration).attr("d",S=>{const x=c.compact&&S.flexCompactDim?{x:c.layoutBindings[c.layout].compactLinkMidX(S,c),y:c.layoutBindings[c.layout].compactLinkMidY(S,c)}:{x:c.layoutBindings[c.layout].linkX(S),y:c.layoutBindings[c.layout].linkY(S)},C={x:c.layoutBindings[c.layout].linkParentX(S),y:c.layoutBindings[c.layout].linkParentY(S)},y=c.compact&&S.flexCompactDim?{x:c.layoutBindings[c.layout].linkCompactXStart(S),y:c.layoutBindings[c.layout].linkCompactYStart(S)}:x;return c.layoutBindings[c.layout].diagonal(x,C,y,{sy:c.linkYOffset})}),B.exit().transition().duration(c.duration).attr("d",S=>{const x=c.layoutBindings[c.layout].linkJoinX({x:a,y:o,width:s,height:r}),C=c.layoutBindings[c.layout].linkJoinY({x:a,y:o,width:s,height:r}),y={x,y:C};return c.layoutBindings[c.layout].diagonal(y,y,null,{sy:c.linkYOffset})}).remove();const j=c.connectionsWrapper.selectAll("path.connection").data(k),V=j.enter().insert("path","g").attr("class","connection").attr("d",S=>{const x=c.layoutBindings[c.layout].linkJoinX({x:e,y:i,width:s,height:r}),C=c.layoutBindings[c.layout].linkJoinY({x:e,y:i,width:s,height:r}),y={x,y:C};return c.layoutBindings[c.layout].diagonal(y,y,null,{sy:c.linkYOffset})}).merge(j);V.attr("fill","none"),V.transition().duration(c.duration).attr("d",S=>{const x=c.layoutBindings[c.layout].linkX({x:S._source.x,y:S._source.y,width:S._source.width,height:S._source.height}),C=c.layoutBindings[c.layout].linkY({x:S._source.x,y:S._source.y,width:S._source.width,height:S._source.height}),y=c.layoutBindings[c.layout].linkJoinX({x:S._target.x,y:S._target.y,width:S._target.width,height:S._target.height}),A=c.layoutBindings[c.layout].linkJoinY({x:S._target.x,y:S._target.y,width:S._target.width,height:S._target.height});return c.linkGroupArc({source:{x,y:C},target:{x:y,y:A}})}),V.each(c.connectionsUpdate),j.exit().transition().duration(c.duration).attr("opacity",0).remove();const X=c.nodesWrapper.selectAll("g.node").data(h,({data:S})=>c.nodeId(S)),ut=X.enter().append("g").attr("class","node").attr("transform",S=>{if(S==c.root)return`translate(${e},${i})`;const x=c.layoutBindings[c.layout].nodeJoinX({x:e,y:i,width:s,height:r}),C=c.layoutBindings[c.layout].nodeJoinY({x:e,y:i,width:s,height:r});return`translate(${x},${C})`}).attr("cursor","pointer").on("click.node",(S,x)=>{const{data:C}=x;if(![...S.srcElement.classList].includes("node-button-foreign-object")){if([...S.srcElement.classList].includes("paging-button-wrapper")){this.loadPagingNodes(x);return}if(!C._pagingButton){c.onNodeClick(x);return}console.log("event fired, no handlers")}}).on("keydown.node",(S,x)=>{if(S.key==="Enter"||S.key===" "||S.key==="Spacebar"){if([...S.srcElement.classList].includes("node-button-foreign-object"))return;if([...S.srcElement.classList].includes("paging-button-wrapper")){this.loadPagingNodes(x);return}(S.key==="Enter"||S.key===" "||S.key==="Spacebar")&&this.onButtonClick(S,x)}});ut.each(c.nodeEnter),ut.patternify({tag:"rect",selector:"node-rect",data:S=>[S]});const lt=ut.merge(X).style("font","12px sans-serif");lt.patternify({tag:"foreignObject",selector:"node-foreign-object",data:S=>[S]}).style("overflow","visible").patternify({tag:"xhtml:div",selector:"node-foreign-object-div",data:S=>[S]}),this.restyleForeignObjectElements();const it=ut.patternify({tag:"g",selector:"node-button-g",data:S=>[S]}).on("click",(S,x)=>this.onButtonClick(S,x)).on("keydown",(S,x)=>{(S.key==="Enter"||S.key===" "||S.key==="Spacebar")&&this.onButtonClick(S,x)});it.patternify({tag:"rect",selector:"node-button-rect",data:S=>[S]}).attr("opacity",0).attr("pointer-events","all").attr("width",S=>c.nodeButtonWidth(S)).attr("height",S=>c.nodeButtonHeight(S)).attr("x",S=>c.nodeButtonX(S)).attr("y",S=>c.nodeButtonY(S)),it.patternify({tag:"foreignObject",selector:"node-button-foreign-object",data:S=>[S]}).attr("width",S=>c.nodeButtonWidth(S)).attr("height",S=>c.nodeButtonHeight(S)).attr("x",S=>c.nodeButtonX(S)).attr("y",S=>c.nodeButtonY(S)).style("overflow","visible").patternify({tag:"xhtml:div",selector:"node-button-div",data:S=>[S]}).style("pointer-events","none").style("display","flex").style("width","100%").style("height","100%"),lt.transition().attr("opacity",0).duration(c.duration).attr("transform",({x:S,y:x,width:C,height:y})=>c.layoutBindings[c.layout].nodeUpdateTransform({x:S,y:x,width:C,height:y})).attr("opacity",1),lt.select(".node-rect").attr("width",({width:S})=>S).attr("height",({height:S})=>S).attr("x",({width:S})=>0).attr("y",({height:S})=>0).attr("cursor","pointer").attr("rx",3).attr("fill",c.nodeDefaultBackground),lt.select(".node-button-g").attr("transform",({data:S,width:x,height:C})=>{const y=c.layoutBindings[c.layout].buttonX({width:x,height:C}),A=c.layoutBindings[c.layout].buttonY({width:x,height:C});return`translate(${y},${A})`}).attr("display",({data:S})=>S._directSubordinates>0?null:"none").attr("opacity",({data:S,children:x,_children:C})=>S._pagingButton?0:x||C?1:0),lt.select(".node-button-foreign-object .node-button-div").html(S=>c.buttonContent({node:S,state:c})),lt.select(".node-button-text").attr("text-anchor","middle").attr("alignment-baseline","middle").attr("font-size",({children:S})=>S?40:26).text(({children:S})=>S?"-":"+").attr("y",this.isEdge()?10:0),lt.each(c.nodeUpdate);const yt=X.exit();yt.each(c.nodeExit);const vt=yt.data().reduce((S,x)=>S.depth<x.depth?S:x,{depth:1/0});yt.attr("opacity",1).transition().duration(c.duration).attr("transform",S=>{let{x,y:C,width:y,height:A}=vt.parent||{};const D=c.layoutBindings[c.layout].nodeJoinX({x,y:C,width:y,height:A}),H=c.layoutBindings[c.layout].nodeJoinY({x,y:C,width:y,height:A});return`translate(${D},${H})`}).on("end",function(){gt.select(this).remove()}).attr("opacity",0),h.forEach(S=>{S.x0=S.x,S.y0=S.y});const _t=c.allNodes.filter(S=>S.data._centered)[0];if(_t){let S=[_t];_t.data._centeredWithDescendants&&(c.compact?S=_t.descendants().filter((x,C)=>C<7):S=_t.descendants().filter((x,C,y)=>{const A=Math.round(y.length/2),D=2;return y.length%2?C>A-D&&C<A+D-1:C>A-D&&C<A+D})),_t.data._centeredWithDescendants=null,_t.data._centered=null,this.fit({animate:!0,scale:!1,nodes:S})}}isEdge(){return window.navigator.userAgent.includes("Edge")}hdiagonal(e,i,a,o){return this.getChartState().hdiagonal(e,i,a,o)}diagonal(e,i,a,o){return this.getChartState().diagonal(e,i,a,o)}restyleForeignObjectElements(){const e=this.getChartState();e.svg.selectAll(".node-foreign-object").attr("width",({width:i})=>i).attr("height",({height:i})=>i).attr("x",({width:i})=>0).attr("y",({height:i})=>0),e.svg.selectAll(".node-foreign-object-div").style("width",({width:i})=>`${i}px`).style("height",({height:i})=>`${i}px`).html(function(i,a,o){return i.data._pagingButton?`<div class="paging-button-wrapper"><div style="pointer-events:none">${e.pagingButton(i,a,o,e)}</div></div>`:e.nodeContent.bind(this)(i,a,o,e)})}onButtonClick(e,i){const a=this.getChartState();i.data._pagingButton||(a.setActiveNodeCentered&&(i.data._centered=!0,i.data._centeredWithDescendants=!0),i.children?(i._children=i.children,i.children=null,this.setExpansionFlagToChildren(i,!1)):(i.children=i._children,i._children=null,i.children&&i.children.forEach(({data:o})=>o._expanded=!0)),this.update(i),e.stopPropagation(),a.onExpandOrCollapse(i))}setExpansionFlagToChildren({data:e,children:i,_children:a},o){e._expanded=o,i&&i.forEach(s=>{this.setExpansionFlagToChildren(s,o)}),a&&a.forEach(s=>{this.setExpansionFlagToChildren(s,o)})}expandSomeNodes(e){if(e.data._expanded){let i=e.parent;for(;i&&i._children;)i.children=i._children,i._children=null,i=i.parent}e._children&&e._children.forEach(i=>this.expandSomeNodes(i)),e.children&&e.children.forEach(i=>this.expandSomeNodes(i))}updateNodesState(){const e=this.getChartState();this.setLayouts({expandNodesFirst:!0}),this.update(e.root)}setLayouts({expandNodesFirst:e=!0}){const i=this.getChartState();i.generateRoot=gt.stratify().id(s=>i.nodeId(s)).parentId(s=>i.parentNodeId(s)),i.root=i.generateRoot(i.data);const a=i.root.descendants();i.initialExpandLevel>1&&a.length>0&&(a.forEach(s=>{s.depth<=i.initialExpandLevel&&(s.data._expanded=!0)}),i.initialExpandLevel=1);const o={};i.root.descendants().filter(s=>s.children).filter(s=>!s.data._pagingStep).forEach(s=>{s.data._pagingStep=i.minPagingVisibleNodes(s)}),i.root.eachBefore((s,r)=>{s.data._directSubordinatesPaging=s.children?s.children.length:0,s.children&&s.children.forEach((c,l)=>{if(c.data._pagingButton=!1,l>s.data._pagingStep&&(o[c.id]=!0),l===s.data._pagingStep&&s.children.length-1>s.data._pagingStep&&(c.data._pagingButton=!0),o[c.parent.id]&&(o[c.id]=!0),c.data._expanded||c.data._centered||c.data._highlighted||c.data._upToTheRootHighlighted){let h=c;for(;h&&(o[h.id]||h.data._pagingButton);)o[h.id]=!1,h.data._pagingButton&&(h.data._pagingButton=!1,h.parent.children.forEach(d=>{d.data._expanded=!0,o[d.id]=!1})),h=h.parent}})}),i.root=gt.stratify().id(s=>i.nodeId(s)).parentId(s=>i.parentNodeId(s))(i.data.filter(s=>o[s.id]!==!0)),i.root.each((s,r,c)=>{let l=s._hierarchyHeight||s.height,h=i.nodeWidth(s),d=i.nodeHeight(s);Object.assign(s,{width:h,height:d,_hierarchyHeight:l})}),i.root.x0=0,i.root.y0=0,i.allNodes=i.root.descendants(),i.allNodes.forEach(s=>{Object.assign(s.data,{_directSubordinates:s.children?s.children.length:0,_totalSubordinates:s.descendants().length-1})}),i.root.children&&(e&&i.root.children.forEach(this.expand),i.root.children.forEach(s=>this.collapse(s)),i.initialExpandLevel==0&&(i.root._children=i.root.children,i.root.children=null),[i.root].forEach(s=>this.expandSomeNodes(s)))}collapse(e){e.children&&(e._children=e.children,e._children.forEach(i=>this.collapse(i)),e.children=null)}expand(e){e._children&&(e.children=e._children,e.children.forEach(i=>this.expand(i)),e._children=null)}zoomed(e,i){const a=this.getChartState(),o=a.chart,s=e.transform;a.lastTransform=s,o.attr("transform",s),this.isEdge()&&this.restyleForeignObjectElements()}zoomTreeBounds({x0:e,x1:i,y0:a,y1:o,params:s={animate:!0,scale:!0,onCompleted:()=>{}}}){const{centerG:r,svgWidth:c,svgHeight:l,svg:h,zoomBehavior:d,duration:m,lastTransform:g}=this.getChartState();let b=Math.min(8,.9/Math.max((i-e)/c,(o-a)/l)),k=gt.zoomIdentity.translate(c/2,l/2);k=k.scale(s.scale?b:g.k),k=k.translate(-(e+i)/2,-(a+o)/2),h.transition().duration(s.animate?m:0).call(d.transform,k),r.transition().duration(s.animate?m:0).attr("transform","translate(0,0)").on("end",function(){s.onCompleted&&s.onCompleted()})}fit({animate:e=!0,nodes:i,scale:a=!0,onCompleted:o=()=>{}}={}){const s=this.getChartState(),{root:r}=s;let c=i||r.descendants();const l=gt.min(c,g=>g.x+s.layoutBindings[s.layout].nodeLeftX(g)),h=gt.max(c,g=>g.x+s.layoutBindings[s.layout].nodeRightX(g)),d=gt.min(c,g=>g.y+s.layoutBindings[s.layout].nodeTopY(g)),m=gt.max(c,g=>g.y+s.layoutBindings[s.layout].nodeBottomY(g));return this.zoomTreeBounds({params:{animate:e,scale:a,onCompleted:o},x0:l-50,x1:h+50,y0:d-50,y1:m+50}),this}loadPagingNodes(e){const i=this.getChartState();e.data._pagingButton=!1;const a=e.parent.data._pagingStep,o=i.pagingStep(e.parent),s=a+o;e.parent.data._pagingStep=s,this.updateNodesState()}setExpanded(e,i=!0){const a=this.getChartState(),o=a.allNodes.filter(({data:s})=>a.nodeId(s)==e)[0];if(!o)return console.log(`ORG CHART - ${i?"EXPAND":"COLLAPSE"} - Node with id (${e})  not found in the tree`),this;if(o.data._expanded=i,i==!1){const s=o.parent||{descendants:()=>[]};s.descendants().filter(r=>r!=s).forEach(r=>r.data._expanded=!1)}return this}setCentered(e){const i=this.getChartState(),a=i.generateRoot(i.data).descendants().filter(({data:o})=>i.nodeId(o).toString()==e.toString())[0];return a?(a.ancestors().forEach(o=>o.data._expanded=!0),a.data._centered=!0,a.data._expanded=!0,this):(console.log(`ORG CHART - CENTER - Node with id (${e}) not found in the tree`),this)}setHighlighted(e){const i=this.getChartState(),a=i.generateRoot(i.data).descendants().filter(o=>i.nodeId(o.data).toString()===e.toString())[0];return a?(a.ancestors().forEach(o=>o.data._expanded=!0),a.data._highlighted=!0,a.data._expanded=!0,a.data._centered=!0,this):(console.log(`ORG CHART - HIGHLIGHT - Node with id (${e})  not found in the tree`),this)}setUpToTheRootHighlighted(e){const i=this.getChartState(),a=i.generateRoot(i.data).descendants().filter(o=>i.nodeId(o.data).toString()===e.toString())[0];return a?(a.ancestors().forEach(o=>o.data._expanded=!0),a.data._upToTheRootHighlighted=!0,a.data._expanded=!0,a.ancestors().forEach(o=>o.data._upToTheRootHighlighted=!0),this):(console.log(`ORG CHART - HIGHLIGHTROOT - Node with id (${e}) not found in the tree`),this)}clearHighlighting(){const e=this.getChartState();return e.allNodes.forEach(i=>{i.data._highlighted=!1,i.data._upToTheRootHighlighted=!1}),this.update(e.root),this}fullscreen(e){const i=this.getChartState(),a=gt.select(e||i.container).node();gt.select(document).on("fullscreenchange."+i.id,function(o){(document.fullscreenElement||document.mozFullscreenElement||document.webkitFullscreenElement)==a?setTimeout(s=>{i.svg.attr("height",window.innerHeight-40)},500):i.svg.attr("height",i.svgHeight)}),a.requestFullscreen?a.requestFullscreen():a.mozRequestFullScreen?a.mozRequestFullScreen():a.webkitRequestFullscreen?a.webkitRequestFullscreen():a.msRequestFullscreen&&a.msRequestFullscreen()}zoomIn(){const{svg:e,zoomBehavior:i}=this.getChartState();e.transition().call(i.scaleBy,1.3)}zoomOut(){const{svg:e,zoomBehavior:i}=this.getChartState();e.transition().call(i.scaleBy,.78)}toDataURL(e,i){var a=new XMLHttpRequest;a.onload=function(){var o=new FileReader;o.onloadend=function(){i(o.result)},o.readAsDataURL(a.response)},a.open("GET",e),a.responseType="blob",a.send()}exportImg({full:e=!1,scale:i=3,onLoad:a=r=>r,save:o=!0,backgroundColor:s="#FAFAFA"}={}){const r=this,c=this.getChartState(),{svg:l,root:h}=c;let d=0;const m=l.selectAll("img");let g=m.size();const b=()=>{JSON.parse(JSON.stringify(r.lastTransform()));const k=r.duration();e&&r.fit();const{svg:N}=r.getChartState();setTimeout(L=>{r.downloadImage({node:N.node(),scale:i,isSvg:!1,backgroundColor:s,onAlreadySerialized:B=>{r.update(h)},imageName:c.imageName,onLoad:a,save:o})},e?k+10:0)};g>0?m.each(function(){r.toDataURL(this.src,k=>{this.src=k,++d==g&&b()})}):b()}exportSvg(){const{svg:e,imageName:i}=this.getChartState();return this.downloadImage({imageName:i,node:e.node(),scale:3,isSvg:!0}),this}expandAll(){const{allNodes:e,root:i,data:a}=this.getChartState();return a.forEach(o=>o._expanded=!0),this.render(),this}collapseAll(){const{allNodes:e,root:i}=this.getChartState();return e.forEach(a=>a.data._expanded=!1),this.initialExpandLevel(0),this.render(),this}downloadImage({node:e,scale:i=2,imageName:a="graph",isSvg:o=!1,save:s=!0,backgroundColor:r="#FAFAFA",onAlreadySerialized:c=h=>{},onLoad:l=h=>{}}){const h=e;function d(N,L){var B=document.createElement("a");typeof B.download=="string"?(document.body.appendChild(B),B.download=L,B.href=N,B.click(),document.body.removeChild(B)):location.replace(N)}function m(N){const L="http://www.w3.org/2000/xmlns/",B="http://www.w3.org/1999/xlink",z="http://www.w3.org/2000/svg";N=N.cloneNode(!0);const j=window.location.href+"#",V=document.createTreeWalker(N,NodeFilter.SHOW_ELEMENT,null,!1);for(;V.nextNode();)for(const X of V.currentNode.attributes)X.value.includes(j)&&(X.value=X.value.replace(j,"#"));return N.setAttributeNS(L,"xmlns",z),N.setAttributeNS(L,"xmlns:xlink",B),new XMLSerializer().serializeToString(N)}if(o){let N=m(h);N=`<?xml version="1.0" standalone="no"?>\r
`+N;var k="data:image/svg+xml;charset=utf-8,"+encodeURIComponent(N);d(k,a+".svg"),c();return}const g=i,b=document.createElement("img");b.onload=function(){const N=document.createElement("canvas"),L=h.getBoundingClientRect();N.width=L.width*g,N.height=L.height*g;const B=N.getContext("2d");B.fillStyle=r,B.fillRect(0,0,L.width*g,L.height*g),B.drawImage(b,0,0,L.width*g,L.height*g);let z=N.toDataURL("image/png");l&&l(z),s&&d(z,a+".png")};var k="data:image/svg+xml; charset=utf8, "+encodeURIComponent(m(h));c(),b.src=k}getTextWidth(e,{fontSize:i=14,fontWeight:a=400,defaultFont:o="Helvetice",ctx:s}={}){return s.font=`${a||""} ${i}px ${o} `,s.measureText(e).width}clear(){const e=this.getChartState();gt.select(window).on(`resize.${e.id}`,null),e.svg&&e.svg.selectAll("*").remove()}};const ev={name:"OrgChart",components:{NcSelect:zn},props:{data:{type:Array,default:()=>[]}},data(){return{chartReference:null,chart:0}},computed:{charts(){return this.data.map((e,i)=>{const a=e.find(o=>o.parentNodeId===null);return{id:i,label:a.org?`${a.org} (${a.fullName})`:a.fullName}}).sort((e,i)=>e.label.localeCompare(i.label,ad().replace("_","-"),{sensitivity:"base"}))},placeholder(){return t("contacts","Select chart …")}},watch:{data(){this.data[this.chart]?.length&&this.renderChart(this.data[this.chart])}},mounted(){this.data[this.chart]?.length&&this.renderChart(this.data[this.chart])},methods:{chartChanged(e){this.renderChart(this.data[e.id])},goToContact(e){this.$router.push({name:"contact",params:{selectedGroup:this.$route.params.selectedChart,selectedContact:e}})},renderChart(e){const i=this;this.chartReference||(this.chartReference=new tv),this.chartReference.container(this.$refs.svgElementContainer).data(e).nodeWidth(()=>250).initialZoom(1).nodeHeight(()=>200).childrenMargin(()=>70).compactMarginBetween(()=>15).compactMarginPair(()=>80).nodeContent(()=>"").nodeUpdate(function(a){const o=this.querySelector(".node-foreign-object-div");if(o)if(a.data.rendered)o.appendChild(a.data.rendered);else{const s=Rt.extend(uy),r=new s({propsData:{data:a.data,onAvatarClick:c=>i.goToContact(c)},router:Vi}).$mount();a.data.rendered=r.$el,o.appendChild(r.$el)}Ft(this).select(".inner-box").attr("class",s=>s.data._highlighted||s.data._upToTheRootHighlighted?"inner-box inner-box-highlight":"inner-box")}).linkUpdate(function(a){Ft(this).attr("stroke",()=>"var(--color-primary-element)").attr("stroke-width",o=>o.data._upToTheRootHighlighted?2:1),a.data._upToTheRootHighlighted&&Ft(this).raise()}).onNodeClick(a=>{this.chartReference.data().filter(o=>o.nodeId===a)[0]._upToTheRootHighlighted?this.chartReference.clearHighlighting():(this.chartReference.clearHighlighting(),this.chartReference.setUpToTheRootHighlighted(a).render())}).render()}}};var nv=function(){var e=this,i=e._self._c;return i("div",{staticClass:"org-chart"},[e.data.length>1?i("div",{staticClass:"org-chart__menu"},[i("h3",[e._v(" "+e._s(e.t("contacts","Chart"))+": ")]),i("NcSelect",{staticClass:"chart-selection",attrs:{disabled:e.data.length===1,options:e.charts,"allow-empty":!1,searchable:!1,placeholder:e.placeholder,"input-id":"select-chart-input",label:"label"},on:{input:e.chartChanged},model:{value:e.chart,callback:function(a){e.chart=a},expression:"chart"}})],1):e._e(),i("div",{ref:"svgElementContainer",staticClass:"org-chart__container"})])},iv=[],av=U(ev,nv,iv,!1,null,null);const ov=av.exports,sv={name:"ChartContent",components:{AppContent:$o,OrgChart:ov},props:{contactsList:{type:Object,required:!0}},data(){return{data:[],searchQuery:""}},computed:{transformData(){const e={},i=Object.keys(this.contactsList).map(r=>{const[c,l]=r.split("~");return e[l]||(e[l]={}),e[l][c]=this.contactsList[r]}),a=[],o=i.filter(r=>r.managersName).reduce((r,c)=>{r.push(Ea(c));const l=e[c.addressbook.id][c.managersName];return l&&!l.managersName&&!a.some(h=>h.nodeId===l.uid)&&(r.push(Ea(l)),a.push(Ea(l))),r},[]),s=a.map(r=>_d(o,r));return console.debug("Org charts",s.map((r,c)=>r.map(l=>`list ${c} ${l.nodeId} (${l.fullName}) -> ${l.parentNodeId}`))),s}}};var rv=function(){var e=this,i=e._self._c;return i("AppContent",[i("OrgChart",{attrs:{data:e.transformData}})],1)},cv=[],lv=U(sv,rv,cv,!1,null,null);const uv=lv.exports,dv=new TextEncoder,hv=new TextDecoder;function yo(e,i){let a,o;if(typeof e=="string"||typeof e=="number")a=`${e}`,o=dv.encode(a);else if(typeof Xt<"u"&&Xt.isBuffer(o))a=e.toString();else if(Array.isArray(e))o=new Uint8Array(e),a=hv.decode(e);else throw new Error("Bad data: "+typeof e);if(/^[0-9]+$/.test(a)){if(o.byteLength>7089)throw new Error("Too much data");return mv(a)}if(/^[0-9A-Z \$%\*\+\.\/\:\-]+$/.test(a)){if(o.byteLength>4296)throw new Error("Too much data");return fv(a)}if(i&&/^https?:/i.test(a))return gv(a);if(o.byteLength>2953)throw new Error("Too much data");return pv(new Uint8Array(o))}function oe(e,i,a){for(let o=1<<i-1;o;o>>>=1)e.push(o&a?1:0)}function pv(e){const i=e.byteLength,a=[];for(let r=0;r<i;r++)oe(a,8,e[r]);const o={};let s=[0,1,0,0];if(oe(s,16,i),o.data10=o.data27=s.concat(a),i<256){let r=[0,1,0,0];oe(r,8,i),o.data1=r.concat(a)}return o}const gr=function(e){const i={};for(let a=0;a<e.length;a++)i[e[a]]=a;return i}("0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ $%*+-./:");function fv(e){const i=e.length,a=[];for(let r=0;r<i;r+=2){let c=6,l=gr[e[r]];e[r+1]&&(c=11,l=l*45+gr[e[r+1]]),oe(a,c,l)}const o={};let s=[0,0,1,0];if(oe(s,13,i),o.data27=s.concat(a),i<2048){let r=[0,0,1,0];oe(r,11,i),o.data10=r.concat(a)}if(i<512){let r=[0,0,1,0];oe(r,9,i),o.data1=r.concat(a)}return o}function mv(e){const i=e.length,a=[];for(let r=0;r<i;r+=3){const c=e.substr(r,3),l=Math.ceil(c.length*10/3);oe(a,l,parseInt(c,10))}const o={};let s=[0,0,0,1];if(oe(s,14,i),o.data27=s.concat(a),i<4096){let r=[0,0,0,1];oe(r,12,i),o.data10=r.concat(a)}if(i<1024){let r=[0,0,0,1];oe(r,10,i),o.data1=r.concat(a)}return o}function gv(e){const i=e.indexOf("/",8)+1||e.length,a=yo(e.slice(0,i).toUpperCase(),!1);if(i>=e.length)return a;const o=yo(e.slice(i),!1);return a.data27=a.data27.concat(o.data27),a.data10&&o.data10&&(a.data10=a.data10.concat(o.data10)),a.data1&&o.data1&&(a.data1=a.data1.concat(o.data1)),a}function yv(e,i){e=[].slice.call(e);const a=Zc(i);for(let o=0;o<i;o++)e.push(0);for(;e.length>i;){if(!e[0]){e.shift();continue}const o=Xc(e[0]);for(let s=0;s<=i;s++)e[s]=e[s]^vo(a[s]+o);e.shift()}return new Uint8Array(e)}const vv=285,ea=[1],qc=[];for(let e=1;e<256;e++){let i=ea[e-1]<<1;i>255&&(i^=vv),ea[e]=i}for(let e=0;e<255;e++)qc[ea[e]]=e;function vo(e){for(;e<0;)e+=255;for(;e>255;)e-=255;return ea[e]}function Xc(e){if(e<1||e>255)throw Error(`Bad log(${e})`);return qc[e]}const Ua=[[0],[0,0],[0,25,1]];function Zc(e){if(Ua[e])return Ua[e];const i=Zc(e-1),a=[];a[0]=i[0];for(let o=1;o<=e;o++)a[o]=Xc(vo(i[o])^vo(i[o-1]+e-1));return Ua[e]=a,a}function _v(e){const i=(e<<2)+17,a=[];let o=Array(i).fill(0);for(let s=0;s<i;s++)a[s]=[...o];return a}function bv(e){const i=e.length;for(var a=-3;a<=3;a++)for(let o=-3;o<=3;o++){const s=Math.max(a,o),r=Math.min(a,o),c=s==2&&r>=-2||r==-2&&s<=2?128:129;e[3+a][3+o]=c,e[3+a][i-4+o]=c,e[i-4+a][3+o]=c}for(var a=0;a<8;a++)e[7][a]=e[a][7]=e[7][i-a-1]=e[a][i-8]=e[i-8][a]=e[i-1-a][7]=128}function wv(e){const i=e.length;if(i>21){const o=i-13;let s=Math.round(o/Math.ceil(o/28));s%2&&s++;const r=[];for(let c=o+6;c>10;c-=s)r.unshift(c);r.unshift(6);for(var a=0;a<r.length;a++)for(let c=0;c<r.length;c++){const l=r[a],h=r[c];if(!e[l][h])for(let d=-2;d<=2;d++)for(let m=-2;m<=2;m++){const g=Math.max(d,m),b=Math.min(d,m),k=g==1&&b>=-1||b==-1&&g<=1?128:129;e[l+d][h+m]=k}}}for(var a=8;a<i-8;a++)e[6][a]=e[a][6]=a%2?128:129}function Cv(e){const i=e.length;for(var a=0;a<8;a++)a!=6&&(e[8][a]=e[a][8]=128),e[8][i-1-a]=128,e[i-1-a][8]=128;if(e[8][8]=128,e[i-8][8]=129,!(i<45))for(var a=i-11;a<i-8;a++)for(let s=0;s<6;s++)e[a][s]=e[s][a]=128}const yr=function(){const e=Array(32),i=Array(40),a=1335,o=7973,s=21522;for(let c=0;c<32;c++){let l=c<<10;for(let h=5;h>0;h--)l>>>9+h&&(l^=a<<h-1);e[c]=(l|c<<10)^s}for(let c=7;c<=40;c++){let l=c<<12;for(let h=6;h>0;h--)l>>>11+h&&(l^=o<<h-1);i[c]=l|c<<12}const r={L:1,M:0,Q:3,H:2};return function(c,l,h){const d=c.length,m=e[r[l]<<3|h];function g(L){return m>>L&1?129:128}for(var b=0;b<8;b++)c[8][d-1-b]=g(b),b<6&&(c[b][8]=g(b));for(var b=8;b<15;b++)c[d-15+b][8]=g(b),b>8&&(c[8][14-b]=g(b));c[7][8]=g(6),c[8][8]=g(7),c[8][7]=g(8);const k=i[(d-17)/4];if(!k)return;function N(L){return k>>L&1?129:128}for(var b=0;b<6;b++)for(let B=0;B<3;B++)c[d-11+B][b]=c[b][d-11+B]=N(b*3+B)}}(),vr=function(){const e=[(i,a)=>(i+a)%2==0,(i,a)=>i%2==0,(i,a)=>a%3==0,(i,a)=>(i+a)%3==0,(i,a)=>(Math.floor(i/2)+Math.floor(a/3))%2==0,(i,a)=>i*a%2+i*a%3==0,(i,a)=>(i*a%2+i*a%3)%2==0,(i,a)=>(i*a%3+(i+a)%2)%2==0];return function(i,a,o){const s=i.length;let r,c,l=-1;r=c=s-1;const h=e[o];let d=a.blocks[a.blocks.length-1].length;for(var m=0;m<d;m++)for(var g=0;g<a.blocks.length;g++)a.blocks[g].length<=m||b(a.blocks[g][m]);d=a.ec_len;for(var m=0;m<d;m++)for(var g=0;g<a.ec.length;g++)b(a.ec[g][m]);if(c>-1)do i[r][c]=h(r,c)?1:0;while(k());function b(N){for(let L=128;L;L>>=1){let B=!!(L&N);h(r,c)&&(B=!B),i[r][c]=B?1:0,k()}}function k(){do if(c%2^+(c<6)?l<0&&r==0||l>0&&r==s-1?(c--,l=-l):(c++,r+=l):c--,c==6&&c--,c<0)return!1;while(i[r][c]&240);return!0}}}();function kv(e){const i=e.length;let a=0;for(var o=0;o<i;o++){for(var s=e[o][0]&1,r=1,c=1;c<i;c++){var l=e[o][c]&1;if(l==s){r++;continue}r>=5&&(a+=r-2),s=l,r=1}r>=5&&(a+=r-2)}for(var c=0;c<i;c++){for(var s=e[0][c]&1,r=1,o=1;o<i;o++){var l=e[o][c]&1;if(l==s){r++;continue}r>=5&&(a+=r-2),s=l,r=1}r>=5&&(a+=r-2)}for(var o=0;o<i-1;o++)for(var c=0;c<i-1;c++){const k=e[o][c]+e[o][c+1]+e[o+1][c]+e[o+1][c+1]&7;(k==0||k==4)&&(a+=3)}function h(g){return e[o][c+g]&1}function d(g){return e[o+g][c]&1}for(var o=0;o<i;o++)for(var c=0;c<i;c++)c<i-6&&h(0)&&!h(1)&&h(2)&&h(3)&&h(4)&&!h(5)&&h(6)&&(c>=4&&!(h(-4)||h(-3)||h(-2)||h(-1))&&(a+=40),c<i-10&&!(h(7)||h(8)||h(9)||h(10))&&(a+=40)),o<i-6&&d(0)&&!d(1)&&d(2)&&d(3)&&d(4)&&!d(5)&&d(6)&&(o>=4&&!(d(-4)||d(-3)||d(-2)||d(-1))&&(a+=40),o<i-10&&!(d(7)||d(8)||d(9)||d(10))&&(a+=40));let m=0;for(var o=0;o<i;o++)for(var c=0;c<i;c++)e[o][c]&1&&m++;return a+=10*Math.floor(Math.abs(10-20*m/(i*i))),a}function xv(e){const i=_v(e.version);bv(i),wv(i),Cv(i);let a=1/0,o=0;for(let s=0;s<8;s++){vr(i,e,s),yr(i,e.ec_level,s);const r=kv(i);r<a&&(a=r,o=s)}return vr(i,e,o),yr(i,e.ec_level,o),i.map(s=>s.map(r=>r&1))}const Kc=["L","M","Q","H"];function Sv(e,i){let a=1,o;for(e.data1?o=Math.ceil(e.data1.length/8):a=10;a<10;a++){let s=Fa[a][i];if(s.data_len>=o)return Ga(s)}for(e.data10?o=Math.ceil(e.data10.length/8):a=27;a<27;a++){let s=Fa[a][i];if(s.data_len>=o)return Ga(s)}for(o=Math.ceil(e.data27.length/8);a<41;a++){let s=Fa[a][i];if(s.data_len>=o)return Ga(s)}throw new Error("Too much data")}function Mv(e,i){const a=new Uint8Array(i.data_len);let o;i.version<10?o=e.data1:i.version<27?o=e.data10:o=e.data27;const s=o.length;for(let l=0;l<s;l+=8){let h=0;for(let d=0;d<8;d++)h=h<<1|(o[l+d]?1:0);a[l/8]=h}let r=236;for(let l=Math.ceil((s+4)/8);l<a.length;l++)a[l]=r,r=r==236?17:236;let c=0;return i.blocks=i.blocks.map(l=>{const h=a.slice(c,c+l);return c+=l,i.ec.push(yv(h,i.ec_len)),h}),i}function Av(e,i,a){i=Kc.includes(i)?i:"M";const o=yo(e,a),s=Mv(o,Sv(o,i));return xv(s)}const Ga=typeof structuredClone<"u"?structuredClone:e=>JSON.parse(JSON.stringify(e)),Nv=[[],[26,7,1,10,1,13,1,17,1],[44,10,1,16,1,22,1,28,1],[70,15,1,26,1,36,2,44,2],[100,20,1,36,2,52,2,64,4],[134,26,1,48,2,72,4,88,4],[172,36,2,64,4,96,4,112,4],[196,40,2,72,4,108,6,130,5],[242,48,2,88,4,132,6,156,6],[292,60,2,110,5,160,8,192,8],[346,72,4,130,5,192,8,224,8],[404,80,4,150,5,224,8,264,11],[466,96,4,176,8,260,10,308,11],[532,104,4,198,9,288,12,352,16],[581,120,4,216,9,320,16,384,16],[655,132,6,240,10,360,12,432,18],[733,144,6,280,10,408,17,480,16],[815,168,6,308,11,448,16,532,19],[901,180,6,338,13,504,18,588,21],[991,196,7,364,14,546,21,650,25],[1085,224,8,416,16,600,20,700,25],[1156,224,8,442,17,644,23,750,25],[1258,252,9,476,17,690,23,816,34],[1364,270,9,504,18,750,25,900,30],[1474,300,10,560,20,810,27,960,32],[1588,312,12,588,21,870,29,1050,35],[1706,336,12,644,23,952,34,1110,37],[1828,360,12,700,25,1020,34,1200,40],[1921,390,13,728,26,1050,35,1260,42],[2051,420,14,784,28,1140,38,1350,45],[2185,450,15,812,29,1200,40,1440,48],[2323,480,16,868,31,1290,43,1530,51],[2465,510,17,924,33,1350,45,1620,54],[2611,540,18,980,35,1440,48,1710,57],[2761,570,19,1036,37,1530,51,1800,60],[2876,570,19,1064,38,1590,53,1890,63],[3034,600,20,1120,40,1680,56,1980,66],[3196,630,21,1204,43,1770,59,2100,70],[3362,660,22,1260,45,1860,62,2220,74],[3532,720,24,1316,47,1950,65,2310,77],[3706,750,25,1372,49,2040,68,2430,81]],Fa=Nv.map((e,i)=>{if(!i)return Object.create(null);const a=Object.create(null);for(let o=1;o<8;o+=2){const s=e[0]-e[o],r=e[o+1],c=Kc[o/2|0],l={version:i,ec_level:c,data_len:s,ec_len:e[o]/r,blocks:[],ec:[]};for(let h=r,d=s;h>0;h--){const m=d/h|0;l.blocks.push(m),d-=m}a[c]=l}return a});var Jc={exports:{}},Dv={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]},Qc={exports:{}},Ov=function(e){return!e||typeof e=="string"?!1:e instanceof Array||Array.isArray(e)||e.length>=0&&(e.splice instanceof Function||Object.getOwnPropertyDescriptor(e,e.length-1)&&e.constructor.name!=="String")},Tv=Ov,Ev=Array.prototype.concat,Lv=Array.prototype.slice,_r=Qc.exports=function(e){for(var i=[],a=0,o=e.length;a<o;a++){var s=e[a];Tv(s)?i=Ev.call(i,Lv.call(s)):i.push(s)}return i};_r.wrap=function(e){return function(){return e(_r(arguments))}};var Iv=Qc.exports,Qn=Dv,Wn=Iv,tl=Object.hasOwnProperty,el=Object.create(null);for(var Va in Qn)tl.call(Qn,Va)&&(el[Qn[Va]]=Va);var Wt=Jc.exports={to:{},get:{}};Wt.get=function(e){var i=e.substring(0,3).toLowerCase(),a,o;switch(i){case"hsl":a=Wt.get.hsl(e),o="hsl";break;case"hwb":a=Wt.get.hwb(e),o="hwb";break;default:a=Wt.get.rgb(e),o="rgb";break}return a?{model:o,value:a}:null},Wt.get.rgb=function(e){if(!e)return null;var i=/^#([a-f0-9]{3,4})$/i,a=/^#([a-f0-9]{6})([a-f0-9]{2})?$/i,o=/^rgba?\(\s*([+-]?\d+)(?=[\s,])\s*(?:,\s*)?([+-]?\d+)(?=[\s,])\s*(?:,\s*)?([+-]?\d+)\s*(?:[,|\/]\s*([+-]?[\d\.]+)(%?)\s*)?\)$/,s=/^rgba?\(\s*([+-]?[\d\.]+)\%\s*,?\s*([+-]?[\d\.]+)\%\s*,?\s*([+-]?[\d\.]+)\%\s*(?:[,|\/]\s*([+-]?[\d\.]+)(%?)\s*)?\)$/,r=/^(\w+)$/,c=[0,0,0,1],l,h,d;if(l=e.match(a)){for(d=l[2],l=l[1],h=0;h<3;h++){var m=h*2;c[h]=parseInt(l.slice(m,m+2),16)}d&&(c[3]=parseInt(d,16)/255)}else if(l=e.match(i)){for(l=l[1],d=l[3],h=0;h<3;h++)c[h]=parseInt(l[h]+l[h],16);d&&(c[3]=parseInt(d+d,16)/255)}else if(l=e.match(o)){for(h=0;h<3;h++)c[h]=parseInt(l[h+1],0);l[4]&&(l[5]?c[3]=parseFloat(l[4])*.01:c[3]=parseFloat(l[4]))}else if(l=e.match(s)){for(h=0;h<3;h++)c[h]=Math.round(parseFloat(l[h+1])*2.55);l[4]&&(l[5]?c[3]=parseFloat(l[4])*.01:c[3]=parseFloat(l[4]))}else return(l=e.match(r))?l[1]==="transparent"?[0,0,0,0]:tl.call(Qn,l[1])?(c=Qn[l[1]],c[3]=1,c):null:null;for(h=0;h<3;h++)c[h]=Ue(c[h],0,255);return c[3]=Ue(c[3],0,1),c},Wt.get.hsl=function(e){if(!e)return null;var i=/^hsla?\(\s*([+-]?(?:\d{0,3}\.)?\d+)(?:deg)?\s*,?\s*([+-]?[\d\.]+)%\s*,?\s*([+-]?[\d\.]+)%\s*(?:[,|\/]\s*([+-]?(?=\.\d|\d)(?:0|[1-9]\d*)?(?:\.\d*)?(?:[eE][+-]?\d+)?)\s*)?\)$/,a=e.match(i);if(a){var o=parseFloat(a[4]),s=(parseFloat(a[1])%360+360)%360,r=Ue(parseFloat(a[2]),0,100),c=Ue(parseFloat(a[3]),0,100),l=Ue(isNaN(o)?1:o,0,1);return[s,r,c,l]}return null},Wt.get.hwb=function(e){if(!e)return null;var i=/^hwb\(\s*([+-]?\d{0,3}(?:\.\d+)?)(?:deg)?\s*,\s*([+-]?[\d\.]+)%\s*,\s*([+-]?[\d\.]+)%\s*(?:,\s*([+-]?(?=\.\d|\d)(?:0|[1-9]\d*)?(?:\.\d*)?(?:[eE][+-]?\d+)?)\s*)?\)$/,a=e.match(i);if(a){var o=parseFloat(a[4]),s=(parseFloat(a[1])%360+360)%360,r=Ue(parseFloat(a[2]),0,100),c=Ue(parseFloat(a[3]),0,100),l=Ue(isNaN(o)?1:o,0,1);return[s,r,c,l]}return null},Wt.to.hex=function(){var e=Wn(arguments);return"#"+ki(e[0])+ki(e[1])+ki(e[2])+(e[3]<1?ki(Math.round(e[3]*255)):"")},Wt.to.rgb=function(){var e=Wn(arguments);return e.length<4||e[3]===1?"rgb("+Math.round(e[0])+", "+Math.round(e[1])+", "+Math.round(e[2])+")":"rgba("+Math.round(e[0])+", "+Math.round(e[1])+", "+Math.round(e[2])+", "+e[3]+")"},Wt.to.rgb.percent=function(){var e=Wn(arguments),i=Math.round(e[0]/255*100),a=Math.round(e[1]/255*100),o=Math.round(e[2]/255*100);return e.length<4||e[3]===1?"rgb("+i+"%, "+a+"%, "+o+"%)":"rgba("+i+"%, "+a+"%, "+o+"%, "+e[3]+")"},Wt.to.hsl=function(){var e=Wn(arguments);return e.length<4||e[3]===1?"hsl("+e[0]+", "+e[1]+"%, "+e[2]+"%)":"hsla("+e[0]+", "+e[1]+"%, "+e[2]+"%, "+e[3]+")"},Wt.to.hwb=function(){var e=Wn(arguments),i="";return e.length>=4&&e[3]!==1&&(i=", "+e[3]),"hwb("+e[0]+", "+e[1]+"%, "+e[2]+"%"+i+")"},Wt.to.keyword=function(e){return el[e.slice(0,3)]};function Ue(e,i,a){return Math.min(Math.max(i,e),a)}function ki(e){var i=Math.round(e).toString(16).toUpperCase();return i.length<2?"0"+i:i}var $v=Jc.exports;const br=ua($v);function zv(e){return{...(e?.type??"png")==="png"?Bv:Rv,...e}}function wr(e){return typeof e=="string"?br.to.hex(br.get.rgb(e)):`#${(e>>>8).toString(16).padStart(6,"0")}`}function Pv(e,i,a=0,o=0){let s=[];for(let r=0;r<e.length;r++){const c=e[r];for(let l=0;l<c.length;l++)if(c[l]){const h=r*i+a,d=(r+1)*i+a,m=l*i+a,g=(l+1)*i+a,b=[];b.push(`M ${h} ${m+o}`),b.push(`L ${h} ${g-o}`),o>0&&b.push(`A ${o} ${o} 0 0 0 ${h+o} ${g} `),b.push(`L ${d-o} ${g}`),o>0&&b.push(`A ${o} ${o} 0 0 0 ${d} ${g-o}`),b.push(`L ${d} ${m+o}`),o>0&&b.push(`A ${o} ${o} 0 0 0 ${d-o} ${m}`),b.push(`L ${h+o} ${m}`),o>0&&b.push(`A ${o} ${o} 0 0 0 ${h} ${m+o}`),b.push("z"),s.push(b.join(" "))}}return s.join(" ")}const nl={type:"png",parse_url:!1,ec_level:"M",logo:void 0,logoWidth:20,logoHeight:20,bgColor:4294967295,color:255},Bv={...nl,margin:1,size:5},Rv={...nl,margin:1,size:0},il="3.7.7",Hv=il,Bn=typeof Xt=="function",Cr=typeof TextDecoder=="function"?new TextDecoder:void 0,kr=typeof TextEncoder=="function"?new TextEncoder:void 0,Yv="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",Jn=Array.prototype.slice.call(Yv),xi=(e=>{let i={};return e.forEach((a,o)=>i[a]=o),i})(Jn),Uv=/^(?:[A-Za-z\d+\/]{4})*?(?:[A-Za-z\d+\/]{2}(?:==)?|[A-Za-z\d+\/]{3}=?)?$/,zt=String.fromCharCode.bind(String),xr=typeof Uint8Array.from=="function"?Uint8Array.from.bind(Uint8Array):e=>new Uint8Array(Array.prototype.slice.call(e,0)),al=e=>e.replace(/=/g,"").replace(/[+\/]/g,i=>i=="+"?"-":"_"),ol=e=>e.replace(/[^A-Za-z0-9\+\/]/g,""),sl=e=>{let i,a,o,s,r="";const c=e.length%3;for(let l=0;l<e.length;){if((a=e.charCodeAt(l++))>255||(o=e.charCodeAt(l++))>255||(s=e.charCodeAt(l++))>255)throw new TypeError("invalid character found");i=a<<16|o<<8|s,r+=Jn[i>>18&63]+Jn[i>>12&63]+Jn[i>>6&63]+Jn[i&63]}return c?r.slice(0,c-3)+"===".substring(c):r},ns=typeof btoa=="function"?e=>btoa(e):Bn?e=>Xt.from(e,"binary").toString("base64"):sl,_o=Bn?e=>Xt.from(e).toString("base64"):e=>{let i=[];for(let a=0,o=e.length;a<o;a+=4096)i.push(zt.apply(null,e.subarray(a,a+4096)));return ns(i.join(""))},Ri=(e,i=!1)=>i?al(_o(e)):_o(e),Gv=e=>{if(e.length<2){var i=e.charCodeAt(0);return i<128?e:i<2048?zt(192|i>>>6)+zt(128|i&63):zt(224|i>>>12&15)+zt(128|i>>>6&63)+zt(128|i&63)}else{var i=65536+(e.charCodeAt(0)-55296)*1024+(e.charCodeAt(1)-56320);return zt(240|i>>>18&7)+zt(128|i>>>12&63)+zt(128|i>>>6&63)+zt(128|i&63)}},Fv=/[\uD800-\uDBFF][\uDC00-\uDFFFF]|[^\x00-\x7F]/g,rl=e=>e.replace(Fv,Gv),Sr=Bn?e=>Xt.from(e,"utf8").toString("base64"):kr?e=>_o(kr.encode(e)):e=>ns(rl(e)),Mn=(e,i=!1)=>i?al(Sr(e)):Sr(e),Mr=e=>Mn(e,!0),Vv=/[\xC0-\xDF][\x80-\xBF]|[\xE0-\xEF][\x80-\xBF]{2}|[\xF0-\xF7][\x80-\xBF]{3}/g,jv=e=>{switch(e.length){case 4:var i=(7&e.charCodeAt(0))<<18|(63&e.charCodeAt(1))<<12|(63&e.charCodeAt(2))<<6|63&e.charCodeAt(3),a=i-65536;return zt((a>>>10)+55296)+zt((a&1023)+56320);case 3:return zt((15&e.charCodeAt(0))<<12|(63&e.charCodeAt(1))<<6|63&e.charCodeAt(2));default:return zt((31&e.charCodeAt(0))<<6|63&e.charCodeAt(1))}},cl=e=>e.replace(Vv,jv),ll=e=>{if(e=e.replace(/\s+/g,""),!Uv.test(e))throw new TypeError("malformed base64.");e+="==".slice(2-(e.length&3));let i,a="",o,s;for(let r=0;r<e.length;)i=xi[e.charAt(r++)]<<18|xi[e.charAt(r++)]<<12|(o=xi[e.charAt(r++)])<<6|(s=xi[e.charAt(r++)]),a+=o===64?zt(i>>16&255):s===64?zt(i>>16&255,i>>8&255):zt(i>>16&255,i>>8&255,i&255);return a},is=typeof atob=="function"?e=>atob(ol(e)):Bn?e=>Xt.from(e,"base64").toString("binary"):ll,ul=Bn?e=>xr(Xt.from(e,"base64")):e=>xr(is(e).split("").map(i=>i.charCodeAt(0))),dl=e=>ul(hl(e)),Wv=Bn?e=>Xt.from(e,"base64").toString("utf8"):Cr?e=>Cr.decode(ul(e)):e=>cl(is(e)),hl=e=>ol(e.replace(/[-_]/g,i=>i=="-"?"+":"/")),bo=e=>Wv(hl(e)),qv=e=>{if(typeof e!="string")return!1;const i=e.replace(/\s+/g,"").replace(/={0,2}$/,"");return!/[^\s0-9a-zA-Z\+/]/.test(i)||!/[^\s0-9a-zA-Z\-_]/.test(i)},pl=e=>({value:e,enumerable:!1,writable:!0,configurable:!0}),fl=function(){const e=(i,a)=>Object.defineProperty(String.prototype,i,pl(a));e("fromBase64",function(){return bo(this)}),e("toBase64",function(i){return Mn(this,i)}),e("toBase64URI",function(){return Mn(this,!0)}),e("toBase64URL",function(){return Mn(this,!0)}),e("toUint8Array",function(){return dl(this)})},ml=function(){const e=(i,a)=>Object.defineProperty(Uint8Array.prototype,i,pl(a));e("toBase64",function(i){return Ri(this,i)}),e("toBase64URI",function(){return Ri(this,!0)}),e("toBase64URL",function(){return Ri(this,!0)})},Xv=()=>{fl(),ml()},Zv={version:il,VERSION:Hv,atob:is,atobPolyfill:ll,btoa:ns,btoaPolyfill:sl,fromBase64:bo,toBase64:Mn,encode:Mn,encodeURI:Mr,encodeURL:Mr,utob:rl,btou:cl,decode:bo,isValid:qv,fromUint8Array:Ri,toUint8Array:dl,extendString:fl,extendUint8Array:ml,extendBuiltins:Xv};async function Kv(e,i={}){const a=zv({...i,type:"svg"}),o=Av(e,a.ec_level,a.parse_url);return Qv({matrix:o,...a})}const Jv=new TextEncoder;async function Qv({matrix:e,margin:i,size:a,logo:o,logoWidth:s,logoHeight:r,color:c,bgColor:l,imageWidth:h,imageHeight:d,borderRadius:m}){const g=a||9,b=(e.length+2*i)*(g||1),k=h?` width="${h}"`:"",N=d?`height="${h}" `:"",L='<?xml version="1.0" encoding="utf-8"?>',B=`<svg xmlns="http://www.w3.org/2000/svg" version="1.1" xmlns:xlink="http://www.w3.org/1999/xlink"${k} ${N}viewBox="0 0 ${b} ${b}">`,z=t2(e,{color:c,bgColor:l,size:b,margin:i,blockSize:g,borderRadius:m}),j="</svg>",V=o?e2(o,b,s,r):"";return Jv.encode(L+B+z+V+j)}function t2(e,i){const a=Pv(e,i.blockSize,i.margin*i.blockSize,i.borderRadius);let o=`<rect width="${i.size}" height="${i.size}" fill="${wr(i.bgColor)}"></rect>`;return o+='<path shape-rendering="geometricPrecision" d="'+a+'" fill="'+wr(i.color)+'"/>',o}function e2(e,i,a,o){const s=`data:image/png;base64,${typeof Xt<"u"&&Xt.isBuffer(e)?e.toString("base64"):Zv.fromUint8Array(new Uint8Array(e))}`;return`<image width="${a/100*i}" height="${o/100*i}" xlink:href="${s}" x="${i/2-a/100*i/2}" y="${i/2-o/100*i/2}"></image>`}const n2={name:"DownloadIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}};var i2=function(){var e=this,i=e._self._c;return i("span",e._b({staticClass:"material-design-icon download-icon",attrs:{"aria-hidden":e.title?null:"true","aria-label":e.title,role:"img"},on:{click:function(a){return e.$emit("click",a)}}},"span",e.$attrs,!1),[i("svg",{staticClass:"material-design-icon__svg",attrs:{fill:e.fillColor,width:e.size,height:e.size,viewBox:"0 0 24 24"}},[i("path",{attrs:{d:"M5,20H19V18H5M19,9H15V3H9V9H5L12,16L19,9Z"}},[e.title?i("title",[e._v(e._s(e.title))]):e._e()])])])},a2=[],o2=U(n2,i2,a2,!1,null,null);const _a=o2.exports,s2={name:"QrcodeIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}};var r2=function(){var e=this,i=e._self._c;return i("span",e._b({staticClass:"material-design-icon qrcode-icon",attrs:{"aria-hidden":e.title?null:"true","aria-label":e.title,role:"img"},on:{click:function(a){return e.$emit("click",a)}}},"span",e.$attrs,!1),[i("svg",{staticClass:"material-design-icon__svg",attrs:{fill:e.fillColor,width:e.size,height:e.size,viewBox:"0 0 24 24"}},[i("path",{attrs:{d:"M3,11H5V13H3V11M11,5H13V9H11V5M9,11H13V15H11V13H9V11M15,11H17V13H19V11H21V13H19V15H21V19H19V21H17V19H13V21H11V17H15V15H17V13H15V11M19,19V15H17V19H19M15,3H21V9H15V3M17,5V7H19V5H17M3,3H9V9H3V3M5,5V7H7V5H5M3,15H9V21H3V15M5,17V19H7V17H5Z"}},[e.title?i("title",[e._v(e._s(e.title))]):e._e()])])])},c2=[],l2=U(s2,r2,c2,!1,null,null);const u2=l2.exports,d2={name:"CakeIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}};var h2=function(){var e=this,i=e._self._c;return i("span",e._b({staticClass:"material-design-icon cake-icon",attrs:{"aria-hidden":e.title?null:"true","aria-label":e.title,role:"img"},on:{click:function(a){return e.$emit("click",a)}}},"span",e.$attrs,!1),[i("svg",{staticClass:"material-design-icon__svg",attrs:{fill:e.fillColor,width:e.size,height:e.size,viewBox:"0 0 24 24"}},[i("path",{attrs:{d:"M11.5,0.5C12,0.75 13,2.4 13,3.5C13,4.6 12.33,5 11.5,5C10.67,5 10,4.85 10,3.75C10,2.65 11,2 11.5,0.5M18.5,9C21,9 23,11 23,13.5C23,15.06 22.21,16.43 21,17.24V23H12L3,23V17.24C1.79,16.43 1,15.06 1,13.5C1,11 3,9 5.5,9H10V6H13V9H18.5M12,16A2.5,2.5 0 0,0 14.5,13.5H16A2.5,2.5 0 0,0 18.5,16A2.5,2.5 0 0,0 21,13.5A2.5,2.5 0 0,0 18.5,11H5.5A2.5,2.5 0 0,0 3,13.5A2.5,2.5 0 0,0 5.5,16A2.5,2.5 0 0,0 8,13.5H9.5A2.5,2.5 0 0,0 12,16Z"}},[e.title?i("title",[e._v(e._s(e.title))]):e._e()])])])},p2=[],f2=U(d2,h2,p2,!1,null,null);const m2=f2.exports,g2={name:"EyeCircleIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}};var y2=function(){var e=this,i=e._self._c;return i("span",e._b({staticClass:"material-design-icon eye-circle-icon",attrs:{"aria-hidden":e.title?null:"true","aria-label":e.title,role:"img"},on:{click:function(a){return e.$emit("click",a)}}},"span",e.$attrs,!1),[i("svg",{staticClass:"material-design-icon__svg",attrs:{fill:e.fillColor,width:e.size,height:e.size,viewBox:"0 0 24 24"}},[i("path",{attrs:{d:"M12,9.5A2.5,2.5 0 0,0 9.5,12A2.5,2.5 0 0,0 12,14.5A2.5,2.5 0 0,0 14.5,12A2.5,2.5 0 0,0 12,9.5M12,13A1,1 0 0,1 11,12A1,1 0 0,1 12,11A1,1 0 0,1 13,12A1,1 0 0,1 12,13M12,9.5A2.5,2.5 0 0,0 9.5,12A2.5,2.5 0 0,0 12,14.5A2.5,2.5 0 0,0 14.5,12A2.5,2.5 0 0,0 12,9.5M12,13A1,1 0 0,1 11,12A1,1 0 0,1 12,11A1,1 0 0,1 13,12A1,1 0 0,1 12,13M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2M12,16C9.37,16 7,14.43 6,12C7.38,8.69 11.19,7.12 14.5,8.5C16.08,9.16 17.34,10.42 18,12C17,14.43 14.63,16 12,16M12,9.5A2.5,2.5 0 0,0 9.5,12A2.5,2.5 0 0,0 12,14.5A2.5,2.5 0 0,0 14.5,12A2.5,2.5 0 0,0 12,9.5M12,13A1,1 0 0,1 11,12A1,1 0 0,1 12,11A1,1 0 0,1 13,12A1,1 0 0,1 12,13Z"}},[e.title?i("title",[e._v(e._s(e.title))]):e._e()])])])},v2=[],_2=U(g2,y2,v2,!1,null,null);const b2=_2.exports,w2={name:"FolderMultipleImageIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}};var C2=function(){var e=this,i=e._self._c;return i("span",e._b({staticClass:"material-design-icon folder-multiple-image-icon",attrs:{"aria-hidden":e.title?null:"true","aria-label":e.title,role:"img"},on:{click:function(a){return e.$emit("click",a)}}},"span",e.$attrs,!1),[i("svg",{staticClass:"material-design-icon__svg",attrs:{fill:e.fillColor,width:e.size,height:e.size,viewBox:"0 0 24 24"}},[i("path",{attrs:{d:"M7,15L11.5,9L15,13.5L17.5,10.5L21,15M22,4H14L12,2H6A2,2 0 0,0 4,4V16A2,2 0 0,0 6,18H22A2,2 0 0,0 24,16V6A2,2 0 0,0 22,4M2,6H0V11H0V20A2,2 0 0,0 2,22H20V20H2V6Z"}},[e.title?i("title",[e._v(e._s(e.title))]):e._e()])])])},k2=[],x2=U(w2,C2,k2,!1,null,null);const S2=x2.exports,M2={name:"ChevronLeftIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}};var A2=function(){var e=this,i=e._self._c;return i("span",e._b({staticClass:"material-design-icon chevron-left-icon",attrs:{"aria-hidden":e.title?null:"true","aria-label":e.title,role:"img"},on:{click:function(a){return e.$emit("click",a)}}},"span",e.$attrs,!1),[i("svg",{staticClass:"material-design-icon__svg",attrs:{fill:e.fillColor,width:e.size,height:e.size,viewBox:"0 0 24 24"}},[i("path",{attrs:{d:"M15.41,16.58L10.83,12L15.41,7.41L14,6L8,12L14,18L15.41,16.58Z"}},[e.title?i("title",[e._v(e._s(e.title))]):e._e()])])])},N2=[],D2=U(M2,A2,N2,!1,null,null);const O2=D2.exports,T2={name:"DotsHorizontalIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}};var E2=function(){var e=this,i=e._self._c;return i("span",e._b({staticClass:"material-design-icon dots-horizontal-icon",attrs:{"aria-hidden":e.title?null:"true","aria-label":e.title,role:"img"},on:{click:function(a){return e.$emit("click",a)}}},"span",e.$attrs,!1),[i("svg",{staticClass:"material-design-icon__svg",attrs:{fill:e.fillColor,width:e.size,height:e.size,viewBox:"0 0 24 24"}},[i("path",{attrs:{d:"M16,12A2,2 0 0,1 18,10A2,2 0 0,1 20,12A2,2 0 0,1 18,14A2,2 0 0,1 16,12M10,12A2,2 0 0,1 12,10A2,2 0 0,1 14,12A2,2 0 0,1 12,14A2,2 0 0,1 10,12M4,12A2,2 0 0,1 6,10A2,2 0 0,1 8,12A2,2 0 0,1 6,14A2,2 0 0,1 4,12Z"}},[e.title?i("title",[e._v(e._s(e.title))]):e._e()])])])},L2=[],I2=U(T2,E2,L2,!1,null,null);const $2=I2.exports,z2={name:"ContactDetailsAddNewProp",components:{IconAdd:Pn,PropertyTitleIcon:bd,Actions:dn,ActionButton:qe,ChevronLeft:O2,DotsHorizontalIcon:$2},mixins:[wd],props:{contact:{type:Ro,default:null},bus:{type:Object,required:!0}},data(){return{moreActionsOpen:!1}},computed:{properties(){return xn.properties},propertiesOrder(){return xn.fieldOrder},usedProperties(){return this.contact.jCal[1].map(e=>e[0])},availablePrimaryProperties(){return Object.keys(this.properties).filter(e=>this.properties[e].primary).map(e=>({id:e,name:this.properties[e].readableName,icon:this.properties[e].icon})).sort((e,i)=>this.propertiesOrder.indexOf(e.id)-this.propertiesOrder.indexOf(i.id))},availableSecondaryProperties(){return Object.keys(this.properties).filter(e=>!this.properties[e].primary).map(e=>({id:e,name:this.properties[e].readableName,icon:this.properties[e].icon})).sort((e,i)=>e.name.localeCompare(i.name))}},created(){this.bus.on("add-prop",this.addProp)},destroyed(){this.bus.off("add-prop",this.addProp)},methods:{async addProp(e){if(this.usedProperties.includes(e)&&!this.properties[e].multiple){this.bus.emit("focus-prop",e);return}if(e==="x-managersname"){const i=this.otherContacts(this.contact);i.length===1?(await this.contact.vCard.addPropertyWithValue(e,i[0].key),await this.$store.dispatch("updateContact",this.contact)):await this.contact.vCard.addPropertyWithValue(e,"")}else if(this.properties[e]&&this.properties[e].defaultjCal&&this.properties[e].defaultjCal[this.contact.version]){const i=this.properties[e].defaultjCal[this.contact.version],a=new Wi.Property([e,...i]);await this.contact.vCard.addProperty(a)}else{const i=this.properties[e].defaultValue;let a=i?i.value:"";Array.isArray(a)&&(a=[...a]);const o=await this.contact.vCard.addPropertyWithValue(e,a);i&&i.type&&o.setParameter("type",i.type)}this.moreActionsOpen=!1,this.bus.emit("focus-prop",e)}}};var P2=function(){var e=this,i=e._self._c;return i("div",{staticClass:"property__row"},[i("div",{staticClass:"property__label"}),i("div",{staticClass:"property__value"},[i("Actions",{attrs:{"menu-align":"right",event:"",type:"secondary","menu-name":e.t("contacts","Add more info")},nativeOn:{click:function(a){a.preventDefault()}},scopedSlots:e._u([{key:"icon",fn:function(){return[i("IconAdd",{attrs:{size:20}})]},proxy:!0}])},[e.moreActionsOpen?e._e():[e._l(e.availablePrimaryProperties,function(a){return i("ActionButton",{key:a.id,staticClass:"action--primary",attrs:{"close-after-click":!0},on:{click:function(o){return o.preventDefault(),e.addProp(a.id)}},scopedSlots:e._u([{key:"icon",fn:function(){return[i("PropertyTitleIcon",{attrs:{icon:a.icon}})]},proxy:!0}],null,!0)},[e._v(" "+e._s(a.name)+" ")])}),i("ActionButton",{attrs:{"close-after-click":!1},on:{click:function(a){e.moreActionsOpen=!0}},scopedSlots:e._u([{key:"icon",fn:function(){return[i("DotsHorizontalIcon",{attrs:{title:e.t("contacts","More fields"),size:20}})]},proxy:!0}],null,!1,1229943913)},[e._v(" "+e._s(e.t("contacts","More fields"))+" ")])],e.moreActionsOpen?[i("ActionButton",{attrs:{"close-after-click":!1},on:{click:function(a){e.moreActionsOpen=!1}},scopedSlots:e._u([{key:"icon",fn:function(){return[i("ChevronLeft",{attrs:{title:e.t("contacts","More fields"),size:20}}),e._v(" "+e._s(e.t("contacts","More fields"))+" ")]},proxy:!0}],null,!1,1205835463)}),e._l(e.availableSecondaryProperties,function(a){return i("ActionButton",{key:a.id,staticClass:"action--primary",attrs:{"close-after-click":!0},on:{click:function(o){return o.preventDefault(),e.addProp(a.id)}},scopedSlots:e._u([{key:"icon",fn:function(){return[i("PropertyTitleIcon",{attrs:{icon:a.icon}})]},proxy:!0}],null,!0)},[e._v(" "+e._s(a.name)+" ")])})]:e._e()],2)],1),i("div",{staticClass:"property__actions"})])},B2=[],R2=U(z2,P2,B2,!1,null,null);const H2=R2.exports,Y2={name:"CloudDownloadIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}};var U2=function(){var e=this,i=e._self._c;return i("span",e._b({staticClass:"material-design-icon cloud-download-icon",attrs:{"aria-hidden":e.title?null:"true","aria-label":e.title,role:"img"},on:{click:function(a){return e.$emit("click",a)}}},"span",e.$attrs,!1),[i("svg",{staticClass:"material-design-icon__svg",attrs:{fill:e.fillColor,width:e.size,height:e.size,viewBox:"0 0 24 24"}},[i("path",{attrs:{d:"M6.5 20Q4.22 20 2.61 18.43 1 16.85 1 14.58 1 12.63 2.17 11.1 3.35 9.57 5.25 9.15 5.83 7.13 7.39 5.75 8.95 4.38 11 4.08V12.15L9.4 10.6L8 12L12 16L16 12L14.6 10.6L13 12.15V4.08Q15.58 4.43 17.29 6.39 19 8.35 19 11 20.73 11.2 21.86 12.5 23 13.78 23 15.5 23 17.38 21.69 18.69 20.38 20 18.5 20Z"}},[e.title?i("title",[e._v(e._s(e.title))]):e._e()])])])},G2=[],F2=U(Y2,U2,G2,!1,null,null);const V2=F2.exports,j2={name:"UploadIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}};var W2=function(){var e=this,i=e._self._c;return i("span",e._b({staticClass:"material-design-icon upload-icon",attrs:{"aria-hidden":e.title?null:"true","aria-label":e.title,role:"img"},on:{click:function(a){return e.$emit("click",a)}}},"span",e.$attrs,!1),[i("svg",{staticClass:"material-design-icon__svg",attrs:{fill:e.fillColor,width:e.size,height:e.size,viewBox:"0 0 24 24"}},[i("path",{attrs:{d:"M9,16V10H5L12,3L19,10H15V16H9M5,20V18H19V20H5Z"}},[e.title?i("title",[e._v(e._s(e.title))]):e._e()])])])},q2=[],X2=U(j2,W2,q2,!1,null,null);const gl=X2.exports,Z2={name:"FolderIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}};var K2=function(){var e=this,i=e._self._c;return i("span",e._b({staticClass:"material-design-icon folder-icon",attrs:{"aria-hidden":e.title?null:"true","aria-label":e.title,role:"img"},on:{click:function(a){return e.$emit("click",a)}}},"span",e.$attrs,!1),[i("svg",{staticClass:"material-design-icon__svg",attrs:{fill:e.fillColor,width:e.size,height:e.size,viewBox:"0 0 24 24"}},[i("path",{attrs:{d:"M10,4H4C2.89,4 2,4.89 2,6V18A2,2 0 0,0 4,20H20A2,2 0 0,0 22,18V8C22,6.89 21.1,6 20,6H12L10,4Z"}},[e.title?i("title",[e._v(e._s(e.title))]):e._e()])])])},J2=[],Q2=U(Z2,K2,J2,!1,null,null);const yl=Q2.exports,t_={name:"ImageIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}};var e_=function(){var e=this,i=e._self._c;return i("span",e._b({staticClass:"material-design-icon image-icon",attrs:{"aria-hidden":e.title?null:"true","aria-label":e.title,role:"img"},on:{click:function(a){return e.$emit("click",a)}}},"span",e.$attrs,!1),[i("svg",{staticClass:"material-design-icon__svg",attrs:{fill:e.fillColor,width:e.size,height:e.size,viewBox:"0 0 24 24"}},[i("path",{attrs:{d:"M8.5,13.5L11,16.5L14.5,12L19,18H5M21,19V5C21,3.89 20.1,3 19,3H5A2,2 0 0,0 3,5V19A2,2 0 0,0 5,21H19A2,2 0 0,0 21,19Z"}},[e.title?i("title",[e._v(e._s(e.title))]):e._e()])])])},n_=[],i_=U(t_,e_,n_,!1,null,null);const a_=i_.exports;var vl={},_l={exports:{}};(function(e,i){(function(a,o){e.exports=o()})(Eo,function(){function a(u,f){var p=Object.keys(u);if(Object.getOwnPropertySymbols){var v=Object.getOwnPropertySymbols(u);f&&(v=v.filter(function(_){return Object.getOwnPropertyDescriptor(u,_).enumerable})),p.push.apply(p,v)}return p}function o(u){for(var f=1;f<arguments.length;f++){var p=arguments[f]!=null?arguments[f]:{};f%2?a(Object(p),!0).forEach(function(v){h(u,v,p[v])}):Object.getOwnPropertyDescriptors?Object.defineProperties(u,Object.getOwnPropertyDescriptors(p)):a(Object(p)).forEach(function(v){Object.defineProperty(u,v,Object.getOwnPropertyDescriptor(p,v))})}return u}function s(u){"@babel/helpers - typeof";return s=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(f){return typeof f}:function(f){return f&&typeof Symbol=="function"&&f.constructor===Symbol&&f!==Symbol.prototype?"symbol":typeof f},s(u)}function r(u,f){if(!(u instanceof f))throw new TypeError("Cannot call a class as a function")}function c(u,f){for(var p=0;p<f.length;p++){var v=f[p];v.enumerable=v.enumerable||!1,v.configurable=!0,"value"in v&&(v.writable=!0),Object.defineProperty(u,v.key,v)}}function l(u,f,p){return f&&c(u.prototype,f),p&&c(u,p),Object.defineProperty(u,"prototype",{writable:!1}),u}function h(u,f,p){return f in u?Object.defineProperty(u,f,{value:p,enumerable:!0,configurable:!0,writable:!0}):u[f]=p,u}function d(u){return m(u)||g(u)||b(u)||N()}function m(u){if(Array.isArray(u))return k(u)}function g(u){if(typeof Symbol<"u"&&u[Symbol.iterator]!=null||u["@@iterator"]!=null)return Array.from(u)}function b(u,f){if(u){if(typeof u=="string")return k(u,f);var p=Object.prototype.toString.call(u).slice(8,-1);if(p==="Object"&&u.constructor&&(p=u.constructor.name),p==="Map"||p==="Set")return Array.from(u);if(p==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(p))return k(u,f)}}function k(u,f){(f==null||f>u.length)&&(f=u.length);for(var p=0,v=new Array(f);p<f;p++)v[p]=u[p];return v}function N(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var L=typeof window<"u"&&typeof window.document<"u",B=L?window:{},z=L&&B.document.documentElement?"ontouchstart"in B.document.documentElement:!1,j=L?"PointerEvent"in B:!1,V="cropper",X="all",ut="crop",lt="move",it="zoom",yt="e",vt="w",_t="s",S="n",x="ne",C="nw",y="se",A="sw",D="".concat(V,"-crop"),H="".concat(V,"-disabled"),F="".concat(V,"-hidden"),q="".concat(V,"-hide"),Z="".concat(V,"-invisible"),Q="".concat(V,"-modal"),ot="".concat(V,"-move"),xt="".concat(V,"Action"),mt="".concat(V,"Preview"),Et="crop",Pt="move",St="none",Nt="crop",jt="cropend",Hn="cropmove",fn="cropstart",mi="dblclick",ou=z?"touchstart":"mousedown",su=z?"touchmove":"mousemove",ru=z?"touchend touchcancel":"mouseup",Cs=j?"pointerdown":ou,ks=j?"pointermove":su,xs=j?"pointerup pointercancel":ru,Ss="ready",Ms="resize",As="wheel",xa="zoom",Ns="image/jpeg",cu=/^e|w|s|n|se|sw|ne|nw|all|crop|move|zoom$/,lu=/^data:/,uu=/^data:image\/jpeg;base64,/,du=/^img|canvas$/i,Ds=200,Os=100,Ts={viewMode:0,dragMode:Et,initialAspectRatio:NaN,aspectRatio:NaN,data:null,preview:"",responsive:!0,restore:!0,checkCrossOrigin:!0,checkOrientation:!0,modal:!0,guides:!0,center:!0,highlight:!0,background:!0,autoCrop:!0,autoCropArea:.8,movable:!0,rotatable:!0,scalable:!0,zoomable:!0,zoomOnTouch:!0,zoomOnWheel:!0,wheelZoomRatio:.1,cropBoxMovable:!0,cropBoxResizable:!0,toggleDragModeOnDblclick:!0,minCanvasWidth:0,minCanvasHeight:0,minCropBoxWidth:0,minCropBoxHeight:0,minContainerWidth:Ds,minContainerHeight:Os,ready:null,cropstart:null,cropmove:null,cropend:null,crop:null,zoom:null},hu='<div class="cropper-container" touch-action="none"><div class="cropper-wrap-box"><div class="cropper-canvas"></div></div><div class="cropper-drag-box"></div><div class="cropper-crop-box"><span class="cropper-view-box"></span><span class="cropper-dashed dashed-h"></span><span class="cropper-dashed dashed-v"></span><span class="cropper-center"></span><span class="cropper-face"></span><span class="cropper-line line-e" data-cropper-action="e"></span><span class="cropper-line line-n" data-cropper-action="n"></span><span class="cropper-line line-w" data-cropper-action="w"></span><span class="cropper-line line-s" data-cropper-action="s"></span><span class="cropper-point point-e" data-cropper-action="e"></span><span class="cropper-point point-n" data-cropper-action="n"></span><span class="cropper-point point-w" data-cropper-action="w"></span><span class="cropper-point point-s" data-cropper-action="s"></span><span class="cropper-point point-ne" data-cropper-action="ne"></span><span class="cropper-point point-nw" data-cropper-action="nw"></span><span class="cropper-point point-sw" data-cropper-action="sw"></span><span class="cropper-point point-se" data-cropper-action="se"></span></div></div>',pu=Number.isNaN||B.isNaN;function et(u){return typeof u=="number"&&!pu(u)}var Es=function(u){return u>0&&u<1/0};function Sa(u){return typeof u>"u"}function Ze(u){return s(u)==="object"&&u!==null}var fu=Object.prototype.hasOwnProperty;function mn(u){if(!Ze(u))return!1;try{var f=u.constructor,p=f.prototype;return f&&p&&fu.call(p,"isPrototypeOf")}catch{return!1}}function Yt(u){return typeof u=="function"}var mu=Array.prototype.slice;function Ls(u){return Array.from?Array.from(u):mu.call(u)}function Dt(u,f){return u&&Yt(f)&&(Array.isArray(u)||et(u.length)?Ls(u).forEach(function(p,v){f.call(u,p,v,u)}):Ze(u)&&Object.keys(u).forEach(function(p){f.call(u,u[p],p,u)})),u}var Ct=Object.assign||function(u){for(var f=arguments.length,p=new Array(f>1?f-1:0),v=1;v<f;v++)p[v-1]=arguments[v];return Ze(u)&&p.length>0&&p.forEach(function(_){Ze(_)&&Object.keys(_).forEach(function(w){u[w]=_[w]})}),u},gu=/\.\d*(?:0|9){12}\d*$/;function gn(u){var f=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1e11;return gu.test(u)?Math.round(u*f)/f:u}var yu=/^width|height|left|top|marginLeft|marginTop$/;function Pe(u,f){var p=u.style;Dt(f,function(v,_){yu.test(_)&&et(v)&&(v="".concat(v,"px")),p[_]=v})}function vu(u,f){return u.classList?u.classList.contains(f):u.className.indexOf(f)>-1}function It(u,f){if(f){if(et(u.length)){Dt(u,function(v){It(v,f)});return}if(u.classList){u.classList.add(f);return}var p=u.className.trim();p?p.indexOf(f)<0&&(u.className="".concat(p," ").concat(f)):u.className=f}}function pe(u,f){if(f){if(et(u.length)){Dt(u,function(p){pe(p,f)});return}if(u.classList){u.classList.remove(f);return}u.className.indexOf(f)>=0&&(u.className=u.className.replace(f,""))}}function yn(u,f,p){if(f){if(et(u.length)){Dt(u,function(v){yn(v,f,p)});return}p?It(u,f):pe(u,f)}}var _u=/([a-z\d])([A-Z])/g;function Ma(u){return u.replace(_u,"$1-$2").toLowerCase()}function Aa(u,f){return Ze(u[f])?u[f]:u.dataset?u.dataset[f]:u.getAttribute("data-".concat(Ma(f)))}function Yn(u,f,p){Ze(p)?u[f]=p:u.dataset?u.dataset[f]=p:u.setAttribute("data-".concat(Ma(f)),p)}function bu(u,f){if(Ze(u[f]))try{delete u[f]}catch{u[f]=void 0}else if(u.dataset)try{delete u.dataset[f]}catch{u.dataset[f]=void 0}else u.removeAttribute("data-".concat(Ma(f)))}var Is=/\s\s*/,$s=function(){var u=!1;if(L){var f=!1,p=function(){},v=Object.defineProperty({},"once",{get:function(){return u=!0,f},set:function(_){f=_}});B.addEventListener("test",p,v),B.removeEventListener("test",p,v)}return u}();function ie(u,f,p){var v=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{},_=p;f.trim().split(Is).forEach(function(w){if(!$s){var M=u.listeners;M&&M[w]&&M[w][p]&&(_=M[w][p],delete M[w][p],Object.keys(M[w]).length===0&&delete M[w],Object.keys(M).length===0&&delete u.listeners)}u.removeEventListener(w,_,v)})}function Jt(u,f,p){var v=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{},_=p;f.trim().split(Is).forEach(function(w){if(v.once&&!$s){var M=u.listeners,E=M===void 0?{}:M;_=function(){delete E[w][p],u.removeEventListener(w,_,v);for(var I=arguments.length,O=new Array(I),T=0;T<I;T++)O[T]=arguments[T];p.apply(u,O)},E[w]||(E[w]={}),E[w][p]&&u.removeEventListener(w,E[w][p],v),E[w][p]=_,u.listeners=E}u.addEventListener(w,_,v)})}function vn(u,f,p){var v;return Yt(Event)&&Yt(CustomEvent)?v=new CustomEvent(f,{detail:p,bubbles:!0,cancelable:!0}):(v=document.createEvent("CustomEvent"),v.initCustomEvent(f,!0,!0,p)),u.dispatchEvent(v)}function zs(u){var f=u.getBoundingClientRect();return{left:f.left+(window.pageXOffset-document.documentElement.clientLeft),top:f.top+(window.pageYOffset-document.documentElement.clientTop)}}var Na=B.location,wu=/^(\w+:)\/\/([^:/?#]*):?(\d*)/i;function Ps(u){var f=u.match(wu);return f!==null&&(f[1]!==Na.protocol||f[2]!==Na.hostname||f[3]!==Na.port)}function Bs(u){var f="timestamp=".concat(new Date().getTime());return u+(u.indexOf("?")===-1?"?":"&")+f}function Un(u){var f=u.rotate,p=u.scaleX,v=u.scaleY,_=u.translateX,w=u.translateY,M=[];et(_)&&_!==0&&M.push("translateX(".concat(_,"px)")),et(w)&&w!==0&&M.push("translateY(".concat(w,"px)")),et(f)&&f!==0&&M.push("rotate(".concat(f,"deg)")),et(p)&&p!==1&&M.push("scaleX(".concat(p,")")),et(v)&&v!==1&&M.push("scaleY(".concat(v,")"));var E=M.length?M.join(" "):"none";return{WebkitTransform:E,msTransform:E,transform:E}}function Cu(u){var f=o({},u),p=0;return Dt(u,function(v,_){delete f[_],Dt(f,function(w){var M=Math.abs(v.startX-w.startX),E=Math.abs(v.startY-w.startY),I=Math.abs(v.endX-w.endX),O=Math.abs(v.endY-w.endY),T=Math.sqrt(M*M+E*E),$=Math.sqrt(I*I+O*O),st=($-T)/T;Math.abs(st)>Math.abs(p)&&(p=st)})}),p}function gi(u,f){var p=u.pageX,v=u.pageY,_={endX:p,endY:v};return f?_:o({startX:p,startY:v},_)}function ku(u){var f=0,p=0,v=0;return Dt(u,function(_){var w=_.startX,M=_.startY;f+=w,p+=M,v+=1}),f/=v,p/=v,{pageX:f,pageY:p}}function Be(u){var f=u.aspectRatio,p=u.height,v=u.width,_=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"contain",w=Es(v),M=Es(p);if(w&&M){var E=p*f;_==="contain"&&E>v||_==="cover"&&E<v?p=v/f:v=p*f}else w?p=v/f:M&&(v=p*f);return{width:v,height:p}}function xu(u){var f=u.width,p=u.height,v=u.degree;if(v=Math.abs(v)%180,v===90)return{width:p,height:f};var _=v%90*Math.PI/180,w=Math.sin(_),M=Math.cos(_),E=f*M+p*w,I=f*w+p*M;return v>90?{width:I,height:E}:{width:E,height:I}}function Su(u,f,p,v){var _=f.aspectRatio,w=f.naturalWidth,M=f.naturalHeight,E=f.rotate,I=E===void 0?0:E,O=f.scaleX,T=O===void 0?1:O,$=f.scaleY,st=$===void 0?1:$,tt=p.aspectRatio,pt=p.naturalWidth,ht=p.naturalHeight,Ot=v.fillColor,$t=Ot===void 0?"transparent":Ot,Mt=v.imageSmoothingEnabled,Re=Mt===void 0?!0:Mt,Ut=v.imageSmoothingQuality,R=Ut===void 0?"low":Ut,dt=v.maxWidth,Tt=dt===void 0?1/0:dt,fe=v.maxHeight,Ce=fe===void 0?1/0:fe,Ke=v.minWidth,Je=Ke===void 0?0:Ke,He=v.minHeight,Ye=He===void 0?0:He,Qe=document.createElement("canvas"),Bt=Qe.getContext("2d"),yi=Be({aspectRatio:tt,width:Tt,height:Ce}),Ys=Be({aspectRatio:tt,width:Je,height:Ye},"cover"),Da=Math.min(yi.width,Math.max(Ys.width,pt)),Oa=Math.min(yi.height,Math.max(Ys.height,ht)),Us=Be({aspectRatio:_,width:Tt,height:Ce}),Gs=Be({aspectRatio:_,width:Je,height:Ye},"cover"),Fs=Math.min(Us.width,Math.max(Gs.width,w)),Vs=Math.min(Us.height,Math.max(Gs.height,M)),Ru=[-Fs/2,-Vs/2,Fs,Vs];return Qe.width=gn(Da),Qe.height=gn(Oa),Bt.fillStyle=$t,Bt.fillRect(0,0,Da,Oa),Bt.save(),Bt.translate(Da/2,Oa/2),Bt.rotate(I*Math.PI/180),Bt.scale(T,st),Bt.imageSmoothingEnabled=Re,Bt.imageSmoothingQuality=R,Bt.drawImage.apply(Bt,[u].concat(d(Ru.map(function(Hu){return Math.floor(gn(Hu))})))),Bt.restore(),Qe}var Rs=String.fromCharCode;function Mu(u,f,p){var v="";p+=f;for(var _=f;_<p;_+=1)v+=Rs(u.getUint8(_));return v}var Au=/^data:.*,/;function Nu(u){var f=u.replace(Au,""),p=atob(f),v=new ArrayBuffer(p.length),_=new Uint8Array(v);return Dt(_,function(w,M){_[M]=p.charCodeAt(M)}),v}function Du(u,f){for(var p=[],v=8192,_=new Uint8Array(u);_.length>0;)p.push(Rs.apply(null,Ls(_.subarray(0,v)))),_=_.subarray(v);return"data:".concat(f,";base64,").concat(btoa(p.join("")))}function Ou(u){var f=new DataView(u),p;try{var v,_,w;if(f.getUint8(0)===255&&f.getUint8(1)===216)for(var M=f.byteLength,E=2;E+1<M;){if(f.getUint8(E)===255&&f.getUint8(E+1)===225){_=E;break}E+=1}if(_){var I=_+4,O=_+10;if(Mu(f,I,4)==="Exif"){var T=f.getUint16(O);if(v=T===18761,(v||T===19789)&&f.getUint16(O+2,v)===42){var $=f.getUint32(O+4,v);$>=8&&(w=O+$)}}}if(w){var st=f.getUint16(w,v),tt,pt;for(pt=0;pt<st;pt+=1)if(tt=w+pt*12+2,f.getUint16(tt,v)===274){tt+=8,p=f.getUint16(tt,v),f.setUint16(tt,1,v);break}}}catch{p=1}return p}function Tu(u){var f=0,p=1,v=1;switch(u){case 2:p=-1;break;case 3:f=-180;break;case 4:v=-1;break;case 5:f=90,v=-1;break;case 6:f=90;break;case 7:f=90,p=-1;break;case 8:f=-90;break}return{rotate:f,scaleX:p,scaleY:v}}var Eu={render:function(){this.initContainer(),this.initCanvas(),this.initCropBox(),this.renderCanvas(),this.cropped&&this.renderCropBox()},initContainer:function(){var u=this.element,f=this.options,p=this.container,v=this.cropper,_=Number(f.minContainerWidth),w=Number(f.minContainerHeight);It(v,F),pe(u,F);var M={width:Math.max(p.offsetWidth,_>=0?_:Ds),height:Math.max(p.offsetHeight,w>=0?w:Os)};this.containerData=M,Pe(v,{width:M.width,height:M.height}),It(u,F),pe(v,F)},initCanvas:function(){var u=this.containerData,f=this.imageData,p=this.options.viewMode,v=Math.abs(f.rotate)%180===90,_=v?f.naturalHeight:f.naturalWidth,w=v?f.naturalWidth:f.naturalHeight,M=_/w,E=u.width,I=u.height;u.height*M>u.width?p===3?E=u.height*M:I=u.width/M:p===3?I=u.width/M:E=u.height*M;var O={aspectRatio:M,naturalWidth:_,naturalHeight:w,width:E,height:I};this.canvasData=O,this.limited=p===1||p===2,this.limitCanvas(!0,!0),O.width=Math.min(Math.max(O.width,O.minWidth),O.maxWidth),O.height=Math.min(Math.max(O.height,O.minHeight),O.maxHeight),O.left=(u.width-O.width)/2,O.top=(u.height-O.height)/2,O.oldLeft=O.left,O.oldTop=O.top,this.initialCanvasData=Ct({},O)},limitCanvas:function(u,f){var p=this.options,v=this.containerData,_=this.canvasData,w=this.cropBoxData,M=p.viewMode,E=_.aspectRatio,I=this.cropped&&w;if(u){var O=Number(p.minCanvasWidth)||0,T=Number(p.minCanvasHeight)||0;M>1?(O=Math.max(O,v.width),T=Math.max(T,v.height),M===3&&(T*E>O?O=T*E:T=O/E)):M>0&&(O?O=Math.max(O,I?w.width:0):T?T=Math.max(T,I?w.height:0):I&&(O=w.width,T=w.height,T*E>O?O=T*E:T=O/E));var $=Be({aspectRatio:E,width:O,height:T});O=$.width,T=$.height,_.minWidth=O,_.minHeight=T,_.maxWidth=1/0,_.maxHeight=1/0}if(f)if(M>(I?0:1)){var st=v.width-_.width,tt=v.height-_.height;_.minLeft=Math.min(0,st),_.minTop=Math.min(0,tt),_.maxLeft=Math.max(0,st),_.maxTop=Math.max(0,tt),I&&this.limited&&(_.minLeft=Math.min(w.left,w.left+(w.width-_.width)),_.minTop=Math.min(w.top,w.top+(w.height-_.height)),_.maxLeft=w.left,_.maxTop=w.top,M===2&&(_.width>=v.width&&(_.minLeft=Math.min(0,st),_.maxLeft=Math.max(0,st)),_.height>=v.height&&(_.minTop=Math.min(0,tt),_.maxTop=Math.max(0,tt))))}else _.minLeft=-_.width,_.minTop=-_.height,_.maxLeft=v.width,_.maxTop=v.height},renderCanvas:function(u,f){var p=this.canvasData,v=this.imageData;if(f){var _=xu({width:v.naturalWidth*Math.abs(v.scaleX||1),height:v.naturalHeight*Math.abs(v.scaleY||1),degree:v.rotate||0}),w=_.width,M=_.height,E=p.width*(w/p.naturalWidth),I=p.height*(M/p.naturalHeight);p.left-=(E-p.width)/2,p.top-=(I-p.height)/2,p.width=E,p.height=I,p.aspectRatio=w/M,p.naturalWidth=w,p.naturalHeight=M,this.limitCanvas(!0,!1)}(p.width>p.maxWidth||p.width<p.minWidth)&&(p.left=p.oldLeft),(p.height>p.maxHeight||p.height<p.minHeight)&&(p.top=p.oldTop),p.width=Math.min(Math.max(p.width,p.minWidth),p.maxWidth),p.height=Math.min(Math.max(p.height,p.minHeight),p.maxHeight),this.limitCanvas(!1,!0),p.left=Math.min(Math.max(p.left,p.minLeft),p.maxLeft),p.top=Math.min(Math.max(p.top,p.minTop),p.maxTop),p.oldLeft=p.left,p.oldTop=p.top,Pe(this.canvas,Ct({width:p.width,height:p.height},Un({translateX:p.left,translateY:p.top}))),this.renderImage(u),this.cropped&&this.limited&&this.limitCropBox(!0,!0)},renderImage:function(u){var f=this.canvasData,p=this.imageData,v=p.naturalWidth*(f.width/f.naturalWidth),_=p.naturalHeight*(f.height/f.naturalHeight);Ct(p,{width:v,height:_,left:(f.width-v)/2,top:(f.height-_)/2}),Pe(this.image,Ct({width:p.width,height:p.height},Un(Ct({translateX:p.left,translateY:p.top},p)))),u&&this.output()},initCropBox:function(){var u=this.options,f=this.canvasData,p=u.aspectRatio||u.initialAspectRatio,v=Number(u.autoCropArea)||.8,_={width:f.width,height:f.height};p&&(f.height*p>f.width?_.height=_.width/p:_.width=_.height*p),this.cropBoxData=_,this.limitCropBox(!0,!0),_.width=Math.min(Math.max(_.width,_.minWidth),_.maxWidth),_.height=Math.min(Math.max(_.height,_.minHeight),_.maxHeight),_.width=Math.max(_.minWidth,_.width*v),_.height=Math.max(_.minHeight,_.height*v),_.left=f.left+(f.width-_.width)/2,_.top=f.top+(f.height-_.height)/2,_.oldLeft=_.left,_.oldTop=_.top,this.initialCropBoxData=Ct({},_)},limitCropBox:function(u,f){var p=this.options,v=this.containerData,_=this.canvasData,w=this.cropBoxData,M=this.limited,E=p.aspectRatio;if(u){var I=Number(p.minCropBoxWidth)||0,O=Number(p.minCropBoxHeight)||0,T=M?Math.min(v.width,_.width,_.width+_.left,v.width-_.left):v.width,$=M?Math.min(v.height,_.height,_.height+_.top,v.height-_.top):v.height;I=Math.min(I,v.width),O=Math.min(O,v.height),E&&(I&&O?O*E>I?O=I/E:I=O*E:I?O=I/E:O&&(I=O*E),$*E>T?$=T/E:T=$*E),w.minWidth=Math.min(I,T),w.minHeight=Math.min(O,$),w.maxWidth=T,w.maxHeight=$}f&&(M?(w.minLeft=Math.max(0,_.left),w.minTop=Math.max(0,_.top),w.maxLeft=Math.min(v.width,_.left+_.width)-w.width,w.maxTop=Math.min(v.height,_.top+_.height)-w.height):(w.minLeft=0,w.minTop=0,w.maxLeft=v.width-w.width,w.maxTop=v.height-w.height))},renderCropBox:function(){var u=this.options,f=this.containerData,p=this.cropBoxData;(p.width>p.maxWidth||p.width<p.minWidth)&&(p.left=p.oldLeft),(p.height>p.maxHeight||p.height<p.minHeight)&&(p.top=p.oldTop),p.width=Math.min(Math.max(p.width,p.minWidth),p.maxWidth),p.height=Math.min(Math.max(p.height,p.minHeight),p.maxHeight),this.limitCropBox(!1,!0),p.left=Math.min(Math.max(p.left,p.minLeft),p.maxLeft),p.top=Math.min(Math.max(p.top,p.minTop),p.maxTop),p.oldLeft=p.left,p.oldTop=p.top,u.movable&&u.cropBoxMovable&&Yn(this.face,xt,p.width>=f.width&&p.height>=f.height?lt:X),Pe(this.cropBox,Ct({width:p.width,height:p.height},Un({translateX:p.left,translateY:p.top}))),this.cropped&&this.limited&&this.limitCanvas(!0,!0),this.disabled||this.output()},output:function(){this.preview(),vn(this.element,Nt,this.getData())}},Lu={initPreview:function(){var u=this.element,f=this.crossOrigin,p=this.options.preview,v=f?this.crossOriginUrl:this.url,_=u.alt||"The image to preview",w=document.createElement("img");if(f&&(w.crossOrigin=f),w.src=v,w.alt=_,this.viewBox.appendChild(w),this.viewBoxImage=w,!!p){var M=p;typeof p=="string"?M=u.ownerDocument.querySelectorAll(p):p.querySelector&&(M=[p]),this.previews=M,Dt(M,function(E){var I=document.createElement("img");Yn(E,mt,{width:E.offsetWidth,height:E.offsetHeight,html:E.innerHTML}),f&&(I.crossOrigin=f),I.src=v,I.alt=_,I.style.cssText='display:block;width:100%;height:auto;min-width:0!important;min-height:0!important;max-width:none!important;max-height:none!important;image-orientation:0deg!important;"',E.innerHTML="",E.appendChild(I)})}},resetPreview:function(){Dt(this.previews,function(u){var f=Aa(u,mt);Pe(u,{width:f.width,height:f.height}),u.innerHTML=f.html,bu(u,mt)})},preview:function(){var u=this.imageData,f=this.canvasData,p=this.cropBoxData,v=p.width,_=p.height,w=u.width,M=u.height,E=p.left-f.left-u.left,I=p.top-f.top-u.top;!this.cropped||this.disabled||(Pe(this.viewBoxImage,Ct({width:w,height:M},Un(Ct({translateX:-E,translateY:-I},u)))),Dt(this.previews,function(O){var T=Aa(O,mt),$=T.width,st=T.height,tt=$,pt=st,ht=1;v&&(ht=$/v,pt=_*ht),_&&pt>st&&(ht=st/_,tt=v*ht,pt=st),Pe(O,{width:tt,height:pt}),Pe(O.getElementsByTagName("img")[0],Ct({width:w*ht,height:M*ht},Un(Ct({translateX:-E*ht,translateY:-I*ht},u))))}))}},Iu={bind:function(){var u=this.element,f=this.options,p=this.cropper;Yt(f.cropstart)&&Jt(u,fn,f.cropstart),Yt(f.cropmove)&&Jt(u,Hn,f.cropmove),Yt(f.cropend)&&Jt(u,jt,f.cropend),Yt(f.crop)&&Jt(u,Nt,f.crop),Yt(f.zoom)&&Jt(u,xa,f.zoom),Jt(p,Cs,this.onCropStart=this.cropStart.bind(this)),f.zoomable&&f.zoomOnWheel&&Jt(p,As,this.onWheel=this.wheel.bind(this),{passive:!1,capture:!0}),f.toggleDragModeOnDblclick&&Jt(p,mi,this.onDblclick=this.dblclick.bind(this)),Jt(u.ownerDocument,ks,this.onCropMove=this.cropMove.bind(this)),Jt(u.ownerDocument,xs,this.onCropEnd=this.cropEnd.bind(this)),f.responsive&&Jt(window,Ms,this.onResize=this.resize.bind(this))},unbind:function(){var u=this.element,f=this.options,p=this.cropper;Yt(f.cropstart)&&ie(u,fn,f.cropstart),Yt(f.cropmove)&&ie(u,Hn,f.cropmove),Yt(f.cropend)&&ie(u,jt,f.cropend),Yt(f.crop)&&ie(u,Nt,f.crop),Yt(f.zoom)&&ie(u,xa,f.zoom),ie(p,Cs,this.onCropStart),f.zoomable&&f.zoomOnWheel&&ie(p,As,this.onWheel,{passive:!1,capture:!0}),f.toggleDragModeOnDblclick&&ie(p,mi,this.onDblclick),ie(u.ownerDocument,ks,this.onCropMove),ie(u.ownerDocument,xs,this.onCropEnd),f.responsive&&ie(window,Ms,this.onResize)}},$u={resize:function(){if(!this.disabled){var u=this.options,f=this.container,p=this.containerData,v=f.offsetWidth/p.width,_=f.offsetHeight/p.height,w=Math.abs(v-1)>Math.abs(_-1)?v:_;if(w!==1){var M,E;u.restore&&(M=this.getCanvasData(),E=this.getCropBoxData()),this.render(),u.restore&&(this.setCanvasData(Dt(M,function(I,O){M[O]=I*w})),this.setCropBoxData(Dt(E,function(I,O){E[O]=I*w})))}}},dblclick:function(){this.disabled||this.options.dragMode===St||this.setDragMode(vu(this.dragBox,D)?Pt:Et)},wheel:function(u){var f=this,p=Number(this.options.wheelZoomRatio)||.1,v=1;this.disabled||(u.preventDefault(),!this.wheeling&&(this.wheeling=!0,setTimeout(function(){f.wheeling=!1},50),u.deltaY?v=u.deltaY>0?1:-1:u.wheelDelta?v=-u.wheelDelta/120:u.detail&&(v=u.detail>0?1:-1),this.zoom(-v*p,u)))},cropStart:function(u){var f=u.buttons,p=u.button;if(!(this.disabled||(u.type==="mousedown"||u.type==="pointerdown"&&u.pointerType==="mouse")&&(et(f)&&f!==1||et(p)&&p!==0||u.ctrlKey))){var v=this.options,_=this.pointers,w;u.changedTouches?Dt(u.changedTouches,function(M){_[M.identifier]=gi(M)}):_[u.pointerId||0]=gi(u),Object.keys(_).length>1&&v.zoomable&&v.zoomOnTouch?w=it:w=Aa(u.target,xt),cu.test(w)&&vn(this.element,fn,{originalEvent:u,action:w})!==!1&&(u.preventDefault(),this.action=w,this.cropping=!1,w===ut&&(this.cropping=!0,It(this.dragBox,Q)))}},cropMove:function(u){var f=this.action;if(!(this.disabled||!f)){var p=this.pointers;u.preventDefault(),vn(this.element,Hn,{originalEvent:u,action:f})!==!1&&(u.changedTouches?Dt(u.changedTouches,function(v){Ct(p[v.identifier]||{},gi(v,!0))}):Ct(p[u.pointerId||0]||{},gi(u,!0)),this.change(u))}},cropEnd:function(u){if(!this.disabled){var f=this.action,p=this.pointers;u.changedTouches?Dt(u.changedTouches,function(v){delete p[v.identifier]}):delete p[u.pointerId||0],f&&(u.preventDefault(),Object.keys(p).length||(this.action=""),this.cropping&&(this.cropping=!1,yn(this.dragBox,Q,this.cropped&&this.options.modal)),vn(this.element,jt,{originalEvent:u,action:f}))}}},zu={change:function(u){var f=this.options,p=this.canvasData,v=this.containerData,_=this.cropBoxData,w=this.pointers,M=this.action,E=f.aspectRatio,I=_.left,O=_.top,T=_.width,$=_.height,st=I+T,tt=O+$,pt=0,ht=0,Ot=v.width,$t=v.height,Mt=!0,Re;!E&&u.shiftKey&&(E=T&&$?T/$:1),this.limited&&(pt=_.minLeft,ht=_.minTop,Ot=pt+Math.min(v.width,p.width,p.left+p.width),$t=ht+Math.min(v.height,p.height,p.top+p.height));var Ut=w[Object.keys(w)[0]],R={x:Ut.endX-Ut.startX,y:Ut.endY-Ut.startY},dt=function(Tt){switch(Tt){case yt:st+R.x>Ot&&(R.x=Ot-st);break;case vt:I+R.x<pt&&(R.x=pt-I);break;case S:O+R.y<ht&&(R.y=ht-O);break;case _t:tt+R.y>$t&&(R.y=$t-tt);break}};switch(M){case X:I+=R.x,O+=R.y;break;case yt:if(R.x>=0&&(st>=Ot||E&&(O<=ht||tt>=$t))){Mt=!1;break}dt(yt),T+=R.x,T<0&&(M=vt,T=-T,I-=T),E&&($=T/E,O+=(_.height-$)/2);break;case S:if(R.y<=0&&(O<=ht||E&&(I<=pt||st>=Ot))){Mt=!1;break}dt(S),$-=R.y,O+=R.y,$<0&&(M=_t,$=-$,O-=$),E&&(T=$*E,I+=(_.width-T)/2);break;case vt:if(R.x<=0&&(I<=pt||E&&(O<=ht||tt>=$t))){Mt=!1;break}dt(vt),T-=R.x,I+=R.x,T<0&&(M=yt,T=-T,I-=T),E&&($=T/E,O+=(_.height-$)/2);break;case _t:if(R.y>=0&&(tt>=$t||E&&(I<=pt||st>=Ot))){Mt=!1;break}dt(_t),$+=R.y,$<0&&(M=S,$=-$,O-=$),E&&(T=$*E,I+=(_.width-T)/2);break;case x:if(E){if(R.y<=0&&(O<=ht||st>=Ot)){Mt=!1;break}dt(S),$-=R.y,O+=R.y,T=$*E}else dt(S),dt(yt),R.x>=0?st<Ot?T+=R.x:R.y<=0&&O<=ht&&(Mt=!1):T+=R.x,R.y<=0?O>ht&&($-=R.y,O+=R.y):($-=R.y,O+=R.y);T<0&&$<0?(M=A,$=-$,T=-T,O-=$,I-=T):T<0?(M=C,T=-T,I-=T):$<0&&(M=y,$=-$,O-=$);break;case C:if(E){if(R.y<=0&&(O<=ht||I<=pt)){Mt=!1;break}dt(S),$-=R.y,O+=R.y,T=$*E,I+=_.width-T}else dt(S),dt(vt),R.x<=0?I>pt?(T-=R.x,I+=R.x):R.y<=0&&O<=ht&&(Mt=!1):(T-=R.x,I+=R.x),R.y<=0?O>ht&&($-=R.y,O+=R.y):($-=R.y,O+=R.y);T<0&&$<0?(M=y,$=-$,T=-T,O-=$,I-=T):T<0?(M=x,T=-T,I-=T):$<0&&(M=A,$=-$,O-=$);break;case A:if(E){if(R.x<=0&&(I<=pt||tt>=$t)){Mt=!1;break}dt(vt),T-=R.x,I+=R.x,$=T/E}else dt(_t),dt(vt),R.x<=0?I>pt?(T-=R.x,I+=R.x):R.y>=0&&tt>=$t&&(Mt=!1):(T-=R.x,I+=R.x),R.y>=0?tt<$t&&($+=R.y):$+=R.y;T<0&&$<0?(M=x,$=-$,T=-T,O-=$,I-=T):T<0?(M=y,T=-T,I-=T):$<0&&(M=C,$=-$,O-=$);break;case y:if(E){if(R.x>=0&&(st>=Ot||tt>=$t)){Mt=!1;break}dt(yt),T+=R.x,$=T/E}else dt(_t),dt(yt),R.x>=0?st<Ot?T+=R.x:R.y>=0&&tt>=$t&&(Mt=!1):T+=R.x,R.y>=0?tt<$t&&($+=R.y):$+=R.y;T<0&&$<0?(M=C,$=-$,T=-T,O-=$,I-=T):T<0?(M=A,T=-T,I-=T):$<0&&(M=x,$=-$,O-=$);break;case lt:this.move(R.x,R.y),Mt=!1;break;case it:this.zoom(Cu(w),u),Mt=!1;break;case ut:if(!R.x||!R.y){Mt=!1;break}Re=zs(this.cropper),I=Ut.startX-Re.left,O=Ut.startY-Re.top,T=_.minWidth,$=_.minHeight,R.x>0?M=R.y>0?y:x:R.x<0&&(I-=T,M=R.y>0?A:C),R.y<0&&(O-=$),this.cropped||(pe(this.cropBox,F),this.cropped=!0,this.limited&&this.limitCropBox(!0,!0));break}Mt&&(_.width=T,_.height=$,_.left=I,_.top=O,this.action=M,this.renderCropBox()),Dt(w,function(Tt){Tt.startX=Tt.endX,Tt.startY=Tt.endY})}},Pu={crop:function(){return this.ready&&!this.cropped&&!this.disabled&&(this.cropped=!0,this.limitCropBox(!0,!0),this.options.modal&&It(this.dragBox,Q),pe(this.cropBox,F),this.setCropBoxData(this.initialCropBoxData)),this},reset:function(){return this.ready&&!this.disabled&&(this.imageData=Ct({},this.initialImageData),this.canvasData=Ct({},this.initialCanvasData),this.cropBoxData=Ct({},this.initialCropBoxData),this.renderCanvas(),this.cropped&&this.renderCropBox()),this},clear:function(){return this.cropped&&!this.disabled&&(Ct(this.cropBoxData,{left:0,top:0,width:0,height:0}),this.cropped=!1,this.renderCropBox(),this.limitCanvas(!0,!0),this.renderCanvas(),pe(this.dragBox,Q),It(this.cropBox,F)),this},replace:function(u){var f=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return!this.disabled&&u&&(this.isImg&&(this.element.src=u),f?(this.url=u,this.image.src=u,this.ready&&(this.viewBoxImage.src=u,Dt(this.previews,function(p){p.getElementsByTagName("img")[0].src=u}))):(this.isImg&&(this.replaced=!0),this.options.data=null,this.uncreate(),this.load(u))),this},enable:function(){return this.ready&&this.disabled&&(this.disabled=!1,pe(this.cropper,H)),this},disable:function(){return this.ready&&!this.disabled&&(this.disabled=!0,It(this.cropper,H)),this},destroy:function(){var u=this.element;return u[V]?(u[V]=void 0,this.isImg&&this.replaced&&(u.src=this.originalUrl),this.uncreate(),this):this},move:function(u){var f=arguments.length>1&&arguments[1]!==void 0?arguments[1]:u,p=this.canvasData,v=p.left,_=p.top;return this.moveTo(Sa(u)?u:v+Number(u),Sa(f)?f:_+Number(f))},moveTo:function(u){var f=arguments.length>1&&arguments[1]!==void 0?arguments[1]:u,p=this.canvasData,v=!1;return u=Number(u),f=Number(f),this.ready&&!this.disabled&&this.options.movable&&(et(u)&&(p.left=u,v=!0),et(f)&&(p.top=f,v=!0),v&&this.renderCanvas(!0)),this},zoom:function(u,f){var p=this.canvasData;return u=Number(u),u<0?u=1/(1-u):u=1+u,this.zoomTo(p.width*u/p.naturalWidth,null,f)},zoomTo:function(u,f,p){var v=this.options,_=this.canvasData,w=_.width,M=_.height,E=_.naturalWidth,I=_.naturalHeight;if(u=Number(u),u>=0&&this.ready&&!this.disabled&&v.zoomable){var O=E*u,T=I*u;if(vn(this.element,xa,{ratio:u,oldRatio:w/E,originalEvent:p})===!1)return this;if(p){var $=this.pointers,st=zs(this.cropper),tt=$&&Object.keys($).length?ku($):{pageX:p.pageX,pageY:p.pageY};_.left-=(O-w)*((tt.pageX-st.left-_.left)/w),_.top-=(T-M)*((tt.pageY-st.top-_.top)/M)}else mn(f)&&et(f.x)&&et(f.y)?(_.left-=(O-w)*((f.x-_.left)/w),_.top-=(T-M)*((f.y-_.top)/M)):(_.left-=(O-w)/2,_.top-=(T-M)/2);_.width=O,_.height=T,this.renderCanvas(!0)}return this},rotate:function(u){return this.rotateTo((this.imageData.rotate||0)+Number(u))},rotateTo:function(u){return u=Number(u),et(u)&&this.ready&&!this.disabled&&this.options.rotatable&&(this.imageData.rotate=u%360,this.renderCanvas(!0,!0)),this},scaleX:function(u){var f=this.imageData.scaleY;return this.scale(u,et(f)?f:1)},scaleY:function(u){var f=this.imageData.scaleX;return this.scale(et(f)?f:1,u)},scale:function(u){var f=arguments.length>1&&arguments[1]!==void 0?arguments[1]:u,p=this.imageData,v=!1;return u=Number(u),f=Number(f),this.ready&&!this.disabled&&this.options.scalable&&(et(u)&&(p.scaleX=u,v=!0),et(f)&&(p.scaleY=f,v=!0),v&&this.renderCanvas(!0,!0)),this},getData:function(){var u=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,f=this.options,p=this.imageData,v=this.canvasData,_=this.cropBoxData,w;if(this.ready&&this.cropped){w={x:_.left-v.left,y:_.top-v.top,width:_.width,height:_.height};var M=p.width/p.naturalWidth;if(Dt(w,function(O,T){w[T]=O/M}),u){var E=Math.round(w.y+w.height),I=Math.round(w.x+w.width);w.x=Math.round(w.x),w.y=Math.round(w.y),w.width=I-w.x,w.height=E-w.y}}else w={x:0,y:0,width:0,height:0};return f.rotatable&&(w.rotate=p.rotate||0),f.scalable&&(w.scaleX=p.scaleX||1,w.scaleY=p.scaleY||1),w},setData:function(u){var f=this.options,p=this.imageData,v=this.canvasData,_={};if(this.ready&&!this.disabled&&mn(u)){var w=!1;f.rotatable&&et(u.rotate)&&u.rotate!==p.rotate&&(p.rotate=u.rotate,w=!0),f.scalable&&(et(u.scaleX)&&u.scaleX!==p.scaleX&&(p.scaleX=u.scaleX,w=!0),et(u.scaleY)&&u.scaleY!==p.scaleY&&(p.scaleY=u.scaleY,w=!0)),w&&this.renderCanvas(!0,!0);var M=p.width/p.naturalWidth;et(u.x)&&(_.left=u.x*M+v.left),et(u.y)&&(_.top=u.y*M+v.top),et(u.width)&&(_.width=u.width*M),et(u.height)&&(_.height=u.height*M),this.setCropBoxData(_)}return this},getContainerData:function(){return this.ready?Ct({},this.containerData):{}},getImageData:function(){return this.sized?Ct({},this.imageData):{}},getCanvasData:function(){var u=this.canvasData,f={};return this.ready&&Dt(["left","top","width","height","naturalWidth","naturalHeight"],function(p){f[p]=u[p]}),f},setCanvasData:function(u){var f=this.canvasData,p=f.aspectRatio;return this.ready&&!this.disabled&&mn(u)&&(et(u.left)&&(f.left=u.left),et(u.top)&&(f.top=u.top),et(u.width)?(f.width=u.width,f.height=u.width/p):et(u.height)&&(f.height=u.height,f.width=u.height*p),this.renderCanvas(!0)),this},getCropBoxData:function(){var u=this.cropBoxData,f;return this.ready&&this.cropped&&(f={left:u.left,top:u.top,width:u.width,height:u.height}),f||{}},setCropBoxData:function(u){var f=this.cropBoxData,p=this.options.aspectRatio,v,_;return this.ready&&this.cropped&&!this.disabled&&mn(u)&&(et(u.left)&&(f.left=u.left),et(u.top)&&(f.top=u.top),et(u.width)&&u.width!==f.width&&(v=!0,f.width=u.width),et(u.height)&&u.height!==f.height&&(_=!0,f.height=u.height),p&&(v?f.height=f.width/p:_&&(f.width=f.height*p)),this.renderCropBox()),this},getCroppedCanvas:function(){var u=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!this.ready||!window.HTMLCanvasElement)return null;var f=this.canvasData,p=Su(this.image,this.imageData,f,u);if(!this.cropped)return p;var v=this.getData(),_=v.x,w=v.y,M=v.width,E=v.height,I=p.width/Math.floor(f.naturalWidth);I!==1&&(_*=I,w*=I,M*=I,E*=I);var O=M/E,T=Be({aspectRatio:O,width:u.maxWidth||1/0,height:u.maxHeight||1/0}),$=Be({aspectRatio:O,width:u.minWidth||0,height:u.minHeight||0},"cover"),st=Be({aspectRatio:O,width:u.width||(I!==1?p.width:M),height:u.height||(I!==1?p.height:E)}),tt=st.width,pt=st.height;tt=Math.min(T.width,Math.max($.width,tt)),pt=Math.min(T.height,Math.max($.height,pt));var ht=document.createElement("canvas"),Ot=ht.getContext("2d");ht.width=gn(tt),ht.height=gn(pt),Ot.fillStyle=u.fillColor||"transparent",Ot.fillRect(0,0,tt,pt);var $t=u.imageSmoothingEnabled,Mt=$t===void 0?!0:$t,Re=u.imageSmoothingQuality;Ot.imageSmoothingEnabled=Mt,Re&&(Ot.imageSmoothingQuality=Re);var Ut=p.width,R=p.height,dt=_,Tt=w,fe,Ce,Ke,Je,He,Ye;dt<=-M||dt>Ut?(dt=0,fe=0,Ke=0,He=0):dt<=0?(Ke=-dt,dt=0,fe=Math.min(Ut,M+dt),He=fe):dt<=Ut&&(Ke=0,fe=Math.min(M,Ut-dt),He=fe),fe<=0||Tt<=-E||Tt>R?(Tt=0,Ce=0,Je=0,Ye=0):Tt<=0?(Je=-Tt,Tt=0,Ce=Math.min(R,E+Tt),Ye=Ce):Tt<=R&&(Je=0,Ce=Math.min(E,R-Tt),Ye=Ce);var Qe=[dt,Tt,fe,Ce];if(He>0&&Ye>0){var Bt=tt/M;Qe.push(Ke*Bt,Je*Bt,He*Bt,Ye*Bt)}return Ot.drawImage.apply(Ot,[p].concat(d(Qe.map(function(yi){return Math.floor(gn(yi))})))),ht},setAspectRatio:function(u){var f=this.options;return!this.disabled&&!Sa(u)&&(f.aspectRatio=Math.max(0,u)||NaN,this.ready&&(this.initCropBox(),this.cropped&&this.renderCropBox())),this},setDragMode:function(u){var f=this.options,p=this.dragBox,v=this.face;if(this.ready&&!this.disabled){var _=u===Et,w=f.movable&&u===Pt;u=_||w?u:St,f.dragMode=u,Yn(p,xt,u),yn(p,D,_),yn(p,ot,w),f.cropBoxMovable||(Yn(v,xt,u),yn(v,D,_),yn(v,ot,w))}return this}},Bu=B.Cropper,Hs=function(){function u(f){var p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(r(this,u),!f||!du.test(f.tagName))throw new Error("The first argument is required and must be an <img> or <canvas> element.");this.element=f,this.options=Ct({},Ts,mn(p)&&p),this.cropped=!1,this.disabled=!1,this.pointers={},this.ready=!1,this.reloading=!1,this.replaced=!1,this.sized=!1,this.sizing=!1,this.init()}return l(u,[{key:"init",value:function(){var f=this.element,p=f.tagName.toLowerCase(),v;if(!f[V]){if(f[V]=this,p==="img"){if(this.isImg=!0,v=f.getAttribute("src")||"",this.originalUrl=v,!v)return;v=f.src}else p==="canvas"&&window.HTMLCanvasElement&&(v=f.toDataURL());this.load(v)}}},{key:"load",value:function(f){var p=this;if(f){this.url=f,this.imageData={};var v=this.element,_=this.options;if(!_.rotatable&&!_.scalable&&(_.checkOrientation=!1),!_.checkOrientation||!window.ArrayBuffer){this.clone();return}if(lu.test(f)){uu.test(f)?this.read(Nu(f)):this.clone();return}var w=new XMLHttpRequest,M=this.clone.bind(this);this.reloading=!0,this.xhr=w,w.onabort=M,w.onerror=M,w.ontimeout=M,w.onprogress=function(){w.getResponseHeader("content-type")!==Ns&&w.abort()},w.onload=function(){p.read(w.response)},w.onloadend=function(){p.reloading=!1,p.xhr=null},_.checkCrossOrigin&&Ps(f)&&v.crossOrigin&&(f=Bs(f)),w.open("GET",f,!0),w.responseType="arraybuffer",w.withCredentials=v.crossOrigin==="use-credentials",w.send()}}},{key:"read",value:function(f){var p=this.options,v=this.imageData,_=Ou(f),w=0,M=1,E=1;if(_>1){this.url=Du(f,Ns);var I=Tu(_);w=I.rotate,M=I.scaleX,E=I.scaleY}p.rotatable&&(v.rotate=w),p.scalable&&(v.scaleX=M,v.scaleY=E),this.clone()}},{key:"clone",value:function(){var f=this.element,p=this.url,v=f.crossOrigin,_=p;this.options.checkCrossOrigin&&Ps(p)&&(v||(v="anonymous"),_=Bs(p)),this.crossOrigin=v,this.crossOriginUrl=_;var w=document.createElement("img");v&&(w.crossOrigin=v),w.src=_||p,w.alt=f.alt||"The image to crop",this.image=w,w.onload=this.start.bind(this),w.onerror=this.stop.bind(this),It(w,q),f.parentNode.insertBefore(w,f.nextSibling)}},{key:"start",value:function(){var f=this,p=this.image;p.onload=null,p.onerror=null,this.sizing=!0;var v=B.navigator&&/(?:iPad|iPhone|iPod).*?AppleWebKit/i.test(B.navigator.userAgent),_=function(E,I){Ct(f.imageData,{naturalWidth:E,naturalHeight:I,aspectRatio:E/I}),f.initialImageData=Ct({},f.imageData),f.sizing=!1,f.sized=!0,f.build()};if(p.naturalWidth&&!v){_(p.naturalWidth,p.naturalHeight);return}var w=document.createElement("img"),M=document.body||document.documentElement;this.sizingImage=w,w.onload=function(){_(w.width,w.height),v||M.removeChild(w)},w.src=p.src,v||(w.style.cssText="left:0;max-height:none!important;max-width:none!important;min-height:0!important;min-width:0!important;opacity:0;position:absolute;top:0;z-index:-1;",M.appendChild(w))}},{key:"stop",value:function(){var f=this.image;f.onload=null,f.onerror=null,f.parentNode.removeChild(f),this.image=null}},{key:"build",value:function(){if(!(!this.sized||this.ready)){var f=this.element,p=this.options,v=this.image,_=f.parentNode,w=document.createElement("div");w.innerHTML=hu;var M=w.querySelector(".".concat(V,"-container")),E=M.querySelector(".".concat(V,"-canvas")),I=M.querySelector(".".concat(V,"-drag-box")),O=M.querySelector(".".concat(V,"-crop-box")),T=O.querySelector(".".concat(V,"-face"));this.container=_,this.cropper=M,this.canvas=E,this.dragBox=I,this.cropBox=O,this.viewBox=M.querySelector(".".concat(V,"-view-box")),this.face=T,E.appendChild(v),It(f,F),_.insertBefore(M,f.nextSibling),pe(v,q),this.initPreview(),this.bind(),p.initialAspectRatio=Math.max(0,p.initialAspectRatio)||NaN,p.aspectRatio=Math.max(0,p.aspectRatio)||NaN,p.viewMode=Math.max(0,Math.min(3,Math.round(p.viewMode)))||0,It(O,F),p.guides||It(O.getElementsByClassName("".concat(V,"-dashed")),F),p.center||It(O.getElementsByClassName("".concat(V,"-center")),F),p.background&&It(M,"".concat(V,"-bg")),p.highlight||It(T,Z),p.cropBoxMovable&&(It(T,ot),Yn(T,xt,X)),p.cropBoxResizable||(It(O.getElementsByClassName("".concat(V,"-line")),F),It(O.getElementsByClassName("".concat(V,"-point")),F)),this.render(),this.ready=!0,this.setDragMode(p.dragMode),p.autoCrop&&this.crop(),this.setData(p.data),Yt(p.ready)&&Jt(f,Ss,p.ready,{once:!0}),vn(f,Ss)}}},{key:"unbuild",value:function(){if(this.ready){this.ready=!1,this.unbind(),this.resetPreview();var f=this.cropper.parentNode;f&&f.removeChild(this.cropper),pe(this.element,F)}}},{key:"uncreate",value:function(){this.ready?(this.unbuild(),this.ready=!1,this.cropped=!1):this.sizing?(this.sizingImage.onload=null,this.sizing=!1,this.sized=!1):this.reloading?(this.xhr.onabort=null,this.xhr.abort()):this.image&&this.stop()}}],[{key:"noConflict",value:function(){return window.Cropper=Bu,u}},{key:"setDefaults",value:function(f){Ct(Ts,mn(f)&&f)}}]),u}();return Ct(Hs.prototype,Eu,Lu,Iu,$u,zu,Pu),Hs})})(_l);var o_=_l.exports;Object.defineProperty(vl,"__esModule",{value:!0});var s_=o_,r_=c_(s_);function c_(e){return e&&e.__esModule?e:{default:e}}function l_(e,i){var a={};for(var o in e)i.indexOf(o)>=0||Object.prototype.hasOwnProperty.call(e,o)&&(a[o]=e[o]);return a}var u_=typeof window>"u"?[String,Array]:[String,Array,Element,NodeList],d_=vl.default={render:function(e){var i=this.crossorigin||void 0;return e("div",{style:this.containerStyle},[e("img",{ref:"img",attrs:{src:this.src,alt:this.alt||"image",style:"max-width: 100%",crossorigin:i},on:this.$listeners,style:this.imgStyle})])},props:{containerStyle:Object,src:{type:String,default:""},alt:String,imgStyle:Object,viewMode:Number,dragMode:String,initialAspectRatio:Number,aspectRatio:Number,data:Object,preview:u_,responsive:{type:Boolean,default:!0},restore:{type:Boolean,default:!0},checkCrossOrigin:{type:Boolean,default:!0},checkOrientation:{type:Boolean,default:!0},crossorigin:{type:String},modal:{type:Boolean,default:!0},guides:{type:Boolean,default:!0},center:{type:Boolean,default:!0},highlight:{type:Boolean,default:!0},background:{type:Boolean,default:!0},autoCrop:{type:Boolean,default:!0},autoCropArea:Number,movable:{type:Boolean,default:!0},rotatable:{type:Boolean,default:!0},scalable:{type:Boolean,default:!0},zoomable:{type:Boolean,default:!0},zoomOnTouch:{type:Boolean,default:!0},zoomOnWheel:{type:Boolean,default:!0},wheelZoomRatio:Number,cropBoxMovable:{type:Boolean,default:!0},cropBoxResizable:{type:Boolean,default:!0},toggleDragModeOnDblclick:{type:Boolean,default:!0},minCanvasWidth:Number,minCanvasHeight:Number,minCropBoxWidth:Number,minCropBoxHeight:Number,minContainerWidth:Number,minContainerHeight:Number,ready:Function,cropstart:Function,cropmove:Function,cropend:Function,crop:Function,zoom:Function},mounted:function(){var e=this.$options.props;e.containerStyle,e.src,e.alt,e.imgStyle;var i=l_(e,["containerStyle","src","alt","imgStyle"]),a={};for(var o in i)this[o]!==void 0&&(a[o]=this[o]);this.cropper=new r_.default(this.$refs.img,a)},methods:{reset:function(){return this.cropper.reset()},clear:function(){return this.cropper.clear()},initCrop:function(){return this.cropper.crop()},replace:function(e){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return this.cropper.replace(e,i)},enable:function(){return this.cropper.enable()},disable:function(){return this.cropper.disable()},destroy:function(){return this.cropper.destroy()},move:function(e,i){return this.cropper.move(e,i)},moveTo:function(e){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e;return this.cropper.moveTo(e,i)},relativeZoom:function(e,i){return this.cropper.zoom(e,i)},zoomTo:function(e,i){return this.cropper.zoomTo(e,i)},rotate:function(e){return this.cropper.rotate(e)},rotateTo:function(e){return this.cropper.rotateTo(e)},scaleX:function(e){return this.cropper.scaleX(e)},scaleY:function(e){return this.cropper.scaleY(e)},scale:function(e){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e;return this.cropper.scale(e,i)},getData:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return this.cropper.getData(e)},setData:function(e){return this.cropper.setData(e)},getContainerData:function(){return this.cropper.getContainerData()},getImageData:function(){return this.cropper.getImageData()},getCanvasData:function(){return this.cropper.getCanvasData()},setCanvasData:function(e){return this.cropper.setCanvasData(e)},getCropBoxData:function(){return this.cropper.getCropBoxData()},setCropBoxData:function(e){return this.cropper.setCropBoxData(e)},getCroppedCanvas:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.cropper.getCroppedCanvas(e)},setAspectRatio:function(e){return this.cropper.setAspectRatio(e)},setDragMode:function(e){return this.cropper.setDragMode(e)}}};const h_=ln("contacts","supportedNetworks"),p_={name:"ContactDetailsAvatar",components:{ActionButton:qe,ActionLink:pa,Actions:dn,Avatar:$n,IconCloudDownload:V2,IconDownload:_a,IconDelete:Ie,IconUpload:gl,IconFolder:yl,IconImage:a_,NcButton:Kt,VueCropper:d_,NcModal:Xe},props:{contact:{type:Object,required:!0},isReadOnly:{type:Boolean,required:!0},reloadBus:{type:Object,required:!0}},data(){return{opened:!1,loading:!1,photoUrl:void 0,root:Xr(`dav/files/${Zr().uid}`),showCropper:!1,cropperOptions:{aspectRatio:1/1,viewMode:3,guides:!1,center:!1,highlight:!1,autoCropArea:1,dragMode:"move",minContainerWidth:100,minContainerHeight:100}}},computed:{supportedSocial(){const e=this.contact.vCard.getAllProperties("email"),i=this.contact.vCard.getAllProperties("x-socialprofile").map(r=>r.jCal[1].type.toString().toLowerCase()),a=this.contact.vCard.getAllProperties("impp").map(r=>r.jCal[1].type.toString().toLowerCase()),o=[].concat(i,a),s=h_.map(r=>r.toLowerCase());return e.length&&o.push("gravatar"),s.filter(r=>o.includes(r)).map(r=>this.capitalize(r))}},watch:{async contact(){await this.loadPhotoUrl()}},async mounted(){await this.loadPhotoUrl()},methods:{onLoad(...e){console.debug(...e)},async processPicture(e){const i=this.getMimetype(e);if(!i.startsWith("image/"))return J(t("contacts","Please select a valid format")),!1;if(i==="image/svg"){const a=atob(e.toString("base64"));if(!await Cd(a))throw new Error("Unsafe svg image",a)}return this.openCropper(e,i),!0},openCropper(e,i){const a=`data:${i};base64,${e.toString("base64")}`;this.$refs.cropper.replace(a),this.showCropper=!0},handleUploadedFile(e){if(e.target.files&&!this.loading){this.closeMenu();const i=e.target.files[0],a=new FileReader;a.onload=o=>{try{if(typeof o.target.result=="object"){const s=Xt.from(o.target.result,"binary");if(this.processPicture(s))return;throw new Error("Wrong image mimetype")}}catch(s){console.error(s),J(t("contacts","Invalid image"))}finally{this.resetPicker()}},a.readAsArrayBuffer(i)}},resetPicker(){this.$refs.uploadInput.value="",this.loading=!1},capitalize(e){return e.charAt(0).toUpperCase()+e.slice(1).toLowerCase()},getMimetype(e){const i=[];e.slice(0,12).forEach(s=>{i.push(s.toString(16).padStart(2,"0"))});const a=i.join("").toUpperCase(),o=parseInt(window.OC.config.version.split(".")[0]);if(o>=31&&a.slice(0,8)==="52494646"&&a.slice(16,24)==="57454250")return"image/webp";if(o>=32&&a.slice(8,24)==="6674797061766966")return"image/avif";switch(a.slice(0,8)){case"89504E47":return"image/png";case"47494638":return"image/gif";case"3C3F786D":case"3C737667":return"image/svg+xml";case"FFD8FFDB":case"FFD8FFE0":case"FFD8FFE1":return"image/jpeg";default:return"application/octet-stream"}},async setPhoto(e,i){if(this.contact.photo&&this.contact.vCard.addPropertyWithValue("photo",""),this.contact.version==="3.0"){this.contact.photo=e;const a=this.contact.vCard.getFirstProperty("photo");a.setParameter("encoding","b"),i&&a.setParameter("type",i.split("/").pop())}else this.contact.photo=`data:${i};base64,${e}`;await this.$store.dispatch("updateContact",this.contact),await this.loadPhotoUrl(),await this.reloadBus.emit("reload-avatar",this.contact.key),this.loading=!1},async loadPhotoUrl(){if(this.photoUrl=void 0,this.contact.photo){const e=await this.contact.getPhotoUrl();if(!e){console.warn("contact has an invalid photo");return}this.photoUrl=e}else this.contact.url&&(this.photoUrl=`${this.contact.url}?photo`)},saveAvatar(){this.showCropper=!1,this.loading=!0,this.$refs.cropper.getCroppedCanvas({minWidth:16,minHeight:16,maxWidth:512,maxHeight:512}).toBlob(async e=>{if(e===null){J(t("contacts","Error cropping picture")),this.cancel();return}const i=new FileReader;i.readAsDataURL(e),i.onloadend=()=>{const a=i.result;this.setPhoto(a.split(",").pop(),e.type)}})},removePhoto(){this.contact.vCard.removeAllProperties("photo"),this.$store.dispatch("updateContact",this.contact),this.photoUrl=void 0,this.reloadBus.emit("delete-avatar",this.contact.key)},cancel(){this.showCropper=!1,this.loading=!1},selectFileInput(){this.loading||this.$refs.uploadInput.click()},async selectFilePicker(){if(!this.loading){this.closeMenu();const e=await Qr(t("contacts","Pick an avatar")).setMimeTypeFilter(["image/png","image/jpeg","image/gif","image/x-xbitmap","image/bmp","image/svg+xml"]).addButton({label:t("calendar","Pick"),type:"primary",callback:i=>tc.debug("Picked avatar",{nodes:i})}).build().pick();if(e){this.loading=!0;try{const i=await re.get(`${this.root}${e}`,{responseType:"arraybuffer"}),a=Xt.from(i.data,"binary");this.processPicture(a)}catch(i){J(t("contacts","Error while processing the picture.")),console.error(i),this.loading=!1}finally{this.resetPicker()}}}},async getSocialAvatar(e){if(!this.loading){this.loading=!0;try{if((await re.put(da("/apps/contacts/api/v1/social/avatar/{network}/{id}/{uid}",{network:e.toLowerCase(),id:this.contact.addressbook.id,uid:this.contact.uid})))?.status!==200)throw new URIError("Download of social profile avatar failed");await this.$store.dispatch("fetchFullContact",{contact:this.contact,forceReFetch:!0});const i=this.$store.getters.getContact(this.contact.key);await this.$emit("update-local-contact",i),await this.loadPhotoUrl(),await this.reloadBus.emit("reload-avatar",this.contact.key),Jr(t("contacts","Avatar downloaded from social network"))}catch(i){i?.response?.status===304?kd(t("contacts","Avatar already up to date")):(J(t("contacts","Avatar download failed")),console.debug(i))}}this.loading=!1},closeMenu(){this.opened=!1}}};var f_=function(){var e=this,i=e._self._c;return i("div",{directives:[{name:"click-outside",rawName:"v-click-outside",value:e.closeMenu,expression:"closeMenu"}],staticClass:"contact-header-avatar__wrapper"},[i("input",{ref:"uploadInput",staticClass:"hidden",attrs:{id:"contact-avatar-upload",type:"file",accept:"image/*"},on:{change:e.handleUploadedFile}}),e.contact.addressbook.id==="z-server-generated--system"?i("Avatar",{staticClass:"contact-header-avatar__photo",attrs:{"disable-menu":"","show-user-status":!1,user:e.contact.uid,size:75}}):i("Avatar",{staticClass:"contact-header-avatar__photo",attrs:{"disable-tooltip":!0,"display-name":e.contact.displayName,"is-no-user":!0,size:75,url:e.photoUrl}}),i("NcModal",{attrs:{show:e.showCropper,size:"small"},on:{"update:show":function(a){e.showCropper=a},close:e.cancel}},[i("div",{staticClass:"avatar__container"},[i("h2",[e._v(e._s(e.t("contacts","Crop contact photo")))]),i("VueCropper",e._b({ref:"cropper",staticClass:"avatar__cropper"},"VueCropper",e.cropperOptions,!1)),i("div",{staticClass:"avatar__cropper-buttons"},[i("NcButton",{attrs:{type:"tertiary"},on:{click:e.cancel}},[e._v(" "+e._s(e.t("contacts","Cancel"))+" ")]),i("NcButton",{attrs:{type:"primary"},on:{click:e.saveAvatar}},[e._v(" "+e._s(e.t("contacts","Save"))+" ")])],1)],1)]),e.isReadOnly?e._e():i("Actions",{staticClass:"contact-header-avatar__menu",attrs:{"force-menu":!0,open:e.opened},on:{"update:open":function(a){e.opened=a}},scopedSlots:e._u([{key:"icon",fn:function(){return[i("IconImage",{attrs:{size:20,"fill-color":"#fff"}})]},proxy:!0}],null,!1,1819936392)},[i("ActionButton",{on:{click:function(a){return a.stopPropagation(),a.preventDefault(),e.selectFileInput.apply(null,arguments)}},scopedSlots:e._u([{key:"icon",fn:function(){return[i("IconUpload",{attrs:{size:20}})]},proxy:!0}],null,!1,337456192)},[e._v(" "+e._s(e.t("contacts","Upload a new picture"))+" ")]),i("ActionButton",{on:{click:e.selectFilePicker},scopedSlots:e._u([{key:"icon",fn:function(){return[i("IconFolder",{attrs:{size:20}})]},proxy:!0}],null,!1,2686820117)},[e._v(" "+e._s(e.t("contacts","Choose from Files"))+" ")]),e._l(e.supportedSocial,function(a){return i("ActionButton",{key:a,on:{click:function(o){return e.getSocialAvatar(a)}},scopedSlots:e._u([{key:"icon",fn:function(){return[i("IconCloudDownload",{attrs:{size:20}})]},proxy:!0}],null,!0)},[e._v(" "+e._s(e.t("contacts","Get from "+a))+" ")])}),e.contact.photo?[i("ActionLink",{attrs:{href:`${e.contact.url}?photo`,target:"_blank"},scopedSlots:e._u([{key:"icon",fn:function(){return[i("IconDownload",{attrs:{size:20}})]},proxy:!0}],null,!1,2487097783)},[e._v(" "+e._s(e.t("contacts","Download picture"))+" ")]),i("ActionButton",{on:{click:e.removePhoto},scopedSlots:e._u([{key:"icon",fn:function(){return[i("IconDelete",{attrs:{size:20}})]},proxy:!0}],null,!1,881161434)},[e._v(" "+e._s(e.t("contacts","Delete picture"))+" ")])]:e._e()],2)],1)},m_=[],g_=U(p_,f_,m_,!1,null,"e40f66c0");const y_=g_.exports,v_=[];function Si(e){return e>=48&&e<=57}function __(e,i,a){if(typeof e!="string")throw new TypeError(`The first argument must be a string. Received type '${typeof e}'`);if(typeof i!="string")throw new TypeError(`The second argument must be a string. Received type '${typeof i}'`);const o=e.length,s=i.length;let r=0,c=0,l=v_,h=0;for(a&&(a.caseInsensitive&&(e=e.toLowerCase(),i=i.toLowerCase()),a.alphabet&&(l=b_(a.alphabet)));r<o&&c<s;){let d=e.charCodeAt(r),m=i.charCodeAt(c);if(Si(d)){if(!Si(m))return d-m;let g=r,b=c;for(;d===48&&++g<o;)d=e.charCodeAt(g);for(;m===48&&++b<s;)m=i.charCodeAt(b);g!==b&&h===0&&(h=g-b);let k=g,N=b;for(;k<o&&Si(e.charCodeAt(k));)++k;for(;N<s&&Si(i.charCodeAt(N));)++N;let L=k-g-N+b;if(L!==0)return L;for(;g<k;)if(L=e.charCodeAt(g++)-i.charCodeAt(b++),L!==0)return L;r=k,c=N;continue}if(d!==m)return d<l.length&&m<l.length&&l[d]!==-1&&l[m]!==-1?l[d]-l[m]:d-m;++r,++c}return r<o?1:c<s?-1:h}const Ar={};function b_(e){const i=Ar[e];if(i!==void 0)return i;const a=[],o=e.split("").reduce((s,r)=>Math.max(s,r.charCodeAt(0)),0);for(let s=0;s<=o;s++)a.push(-1);for(let s=0;s<e.length;s++)a[e.charCodeAt(s)]=s;return Ar[e]=a,a}var w_=__;const wo=ua(w_),C_={name:"PropertyGroups",components:{PropertyTitle:xd,NcSelect:zn},props:{propModel:{type:Object,default:()=>{},required:!0},value:{type:Array,default:()=>[],required:!0},contact:{type:Ro,default:null,required:!0},isReadOnly:{type:Boolean,required:!0}},data(){return{localValue:[...this.value].sort()}},computed:{showAsText(){return this.isReadOnly&&this.localValue.length<=1},showProperty(){return this.isReadOnly&&this.localValue.length>0||!this.isReadOnly},groups(){return this.$store.getters.getGroups.slice(0).map(e=>e.name).sort((e,i)=>wo(e,i,{caseInsensitive:!0}))},formatGroupsTitle(){return this.localValue.slice(3).join(", ")}},watch:{value(){this.localValue=this.value},selectType(){this.localType=this.selectType}},methods:{updateValue(){this.$emit("update:value",this.localValue)}}};var k_=function(){var e=this,i=e._self._c;return e.propModel&&e.showProperty?i("div",{staticClass:"property"},[i("PropertyTitle",{attrs:{icon:"icon-contacts-dark","readable-name":e.t("contacts","Contact groups"),"is-read-only":e.isReadOnly}}),i("div",{staticClass:"property__row"},[i("div",{staticClass:"property__label"},[i("span",[e._v(e._s(e.propModel.readableName))])]),i("div",{staticClass:"property__value"},[e.isReadOnly?i("div",[e.localValue.length===0?i("span",[e._v(e._s(e.t("contacts","None")))]):i("div",{staticClass:"group__list"},e._l(e.localValue,function(a,o){return i("span",{key:o},[e._v(" "+e._s(a)+e._s(o===e.localValue.length-1?"":", ")+" ")])}),0)]):i("NcSelect",{attrs:{options:e.groups,"no-wrap":!0,placeholder:e.t("contacts","Add contact in group"),multiple:!0,"close-on-select":!1,clearable:!0,"deselect-from-dropdown":!0,taggable:!0,"tag-placeholder":"create"},on:{"option:deselected":e.updateValue,close:e.updateValue},scopedSlots:e._u([{key:"limit",fn:function(){return[i("span",{directives:[{name:"tooltip",rawName:"v-tooltip.auto",value:e.formatGroupsTitle,expression:"formatGroupsTitle",modifiers:{auto:!0}}],staticClass:"multiselect__limit"},[e._v(" +"+e._s(e.localValue.length-3)+" ")])]},proxy:!0},{key:"no-options",fn:function(){return[i("span",[e._v(e._s(e.t("contacts","No results")))])]},proxy:!0}],null,!1,2766193613),model:{value:e.localValue,callback:function(a){e.localValue=a},expression:"localValue"}})],1),i("div",{staticClass:"property__actions"})])],1):e._e()},x_=[],S_=U(C_,k_,x_,!1,null,"3ecbedb4");const M_=S_.exports,A_={name:"PropertyRev",props:{value:{type:Object,required:!0}},computed:{relativeDate(){return Sd.unix(this.value.toUnixTime()).fromNow()}}};var N_=function(){var e=this,i=e._self._c;return i("div",{staticClass:"property property--rev"},[i("div",{staticClass:"property__row"},[i("div",{staticClass:"property__label"}),i("div",{staticClass:"property__value"},[e._v(" "+e._s(e.t("contacts","Last modified"))+" "+e._s(e.relativeDate)+" ")]),i("div",{staticClass:"property__actions"})])])},D_=[],O_=U(A_,N_,D_,!1,null,"cdb3abf5");const T_=O_.exports,E_=ln("contacts","isTalkEnabled",!1),{profileEnabled:L_}=ln("user_status","profileEnabled",!1),I_={name:"ContactDetails",components:{Actions:dn,ActionButton:qe,ActionLink:pa,AddNewProp:H2,AppContentDetails:nh,ContactAvatar:y_,ContactDetailsProperty:Md,DetailsHeader:uc,EmptyContent:We,IconContact:hn,IconMail:ec,IconMessage:Ad,IconCall:Nd,IconAccount:Ho,IconDownload:_a,IconDelete:Ie,IconQr:u2,CakeIcon:m2,IconCopy:Dd,IconLoading:ee,PencilIcon:nc,CheckIcon:Vo,Modal:Xe,NcSelect:zn,PropertyGroups:M_,PropertyRev:T_,PropertySelect:Od,NcButton:Kt,NcRelatedResourcesPanel:od,NcEmptyContent:We,FolderMultipleImage:S2},mixins:[fa],provide(){return{sharedState:this.sharedState}},props:{contactKey:{type:String,default:void 0},contacts:{type:Array,default:()=>[]},reloadBus:{type:Object,required:!0},desc:{type:String,required:!1,default:""}},data(){return{fixed:!1,localContact:void 0,loadingData:!0,loadingUpdate:!1,qrcode:"",showPickAddressbookModal:!1,pickedAddressbook:null,editMode:!1,newGroupsValue:[],newAddressBook:null,contactDetailsSelector:".contact-details",excludeFromBirthdayKey:"x-nc-exclude-from-birthday-calendar",bus:ic(),showMenuPopover:!1,profileEnabled:L_,isTalkEnabled:E_,hasFilesResources:!1,hasTalkResources:!1,hasCalendarResources:!1,hasDeckResources:!1,deckPanelHasError:!1,filesPanelHasError:!1,talkPanelHasError:!1,calendarPanelHasError:!1,sharedState:Rt.observable({validEmail:!0})}},computed:{hasRelatedResources(){return this.hasFilesResources||this.hasTalkResources||this.hasCalendarResources||this.hasDeckResources},addressbookIsReadOnly(){return this.contact.addressbook?.readOnly},isReadOnly(){return this.addressbookIsReadOnly||!this.editMode},isDataValid(){return this.sharedState.validEmail},warning(){return this.addressbookIsReadOnly?{icon:b2,classes:[],msg:t("contacts","This contact is in read-only mode. You do not have permission to edit this contact.")}:!1},conflict(){return this.contact.conflict?t("contacts","The contact you were trying to edit has changed. Please manually refresh the contact. Any further edits will be discarded."):!1},sortedProperties(){return this.localContact.properties.slice(0).sort((e,i)=>{const a=e.name.split(".").pop(),o=i.name.split(".").pop();return xn.fieldOrder.indexOf(a)-xn.fieldOrder.indexOf(o)})},groupedProperties(){return this.sortedProperties.reduce((e,i)=>this.canDisplay(i)?i.name==="bday"||i.name==="deathdate"||i.name==="anniversary"?(e.lifeEvents||(e.lifeEvents=[]),e.lifeEvents.push(i),e):(e[i.name]||(e[i.name]=[]),e[i.name].push(i),e):e,{})},addressbookModel(){return{readableName:t("contacts","Address book"),icon:"icon-address-book",options:this.addressbooksOptions}},addressbook(){return this.contact.addressbook.id},groupsModel(){return{readableName:t("contacts","Contact groups"),icon:"icon-contacts-dark"}},addressbooksOptions(){return this.addressbooks.filter(e=>e.enabled).map(e=>({id:e.id,name:e.displayName,readOnly:e.readOnly}))},copyableAddressbooksOptions(){return this.addressbooksOptions.filter(e=>!e.readOnly).filter(e=>e.id!==this.contact.addressbook.id).map(e=>({id:e.id,name:e.name}))},addressbooks(){return this.$store.getters.getAddressbooks},contact(){return this.$store.getters.getContact(this.contactKey)},excludeFromBirthdayLabel(){return this.localContact.vCard.hasProperty(this.excludeFromBirthdayKey)?t("contacts","Add contact to Birthday Calendar"):t("contacts","Exclude contact from Birthday Calendar")},enableToggleBirthdayExclusion(){return parseInt(window.OC.config.version.split(".")[0])>=26&&this.localContact?.vCard},formattedSubtitle(){const e=this.contact.title,i=this.contact.org;return e&&i?t("contacts","{title} at {organization}",{title:e,organization:i}):e?Ws(e):i?Ws(i):""},profilePageLink(){return this.contact.socialLink("NEXTCLOUD")},emailAddressProperties(){return this.localContact.properties.find(e=>e.name==="email")},emailAddress(){return this.emailAddressProperties?.getFirstValue()},phoneNumberProperties(){return this.localContact.properties.find(e=>e.name==="tel")},phoneNumberList(){return this.groupedProperties?.tel?.map(e=>e.getFirstValue()).filter(e=>!!e)},emailAddressList(){return this.groupedProperties?.email?.map(e=>e.getFirstValue()).filter(e=>!!e)},callUrl(){return da("/apps/spreed/?callUser={uid}",{uid:this.contact.uid})},isInSystemAddressBook(){return this.contact.addressbook.id==="z-server-generated--system"},nextcloudVersionAtLeast28(){return parseInt(window.OC.config.version.split(".")[0])>=28}},watch:{contact(e,i){this.contactKey&&e!==i&&this.selectContact(this.contactKey)}},beforeMount(){this.contactKey&&this.selectContact(this.contactKey),document.addEventListener("keydown",this.onCtrlSave)},beforeDestroy(){document.removeEventListener("keydown",this.onCtrlSave)},methods:{updateGroups(e){this.newGroupsValue=e},updateAddressbook(e){this.newAddressBook=e},async updateContact(){this.fixed=!1,this.loadingUpdate=!0;try{await this.$store.dispatch("updateContact",this.localContact)}finally{this.loadingUpdate=!1}if(!this.localContact.dav){this.logger.debug("New contact synced!",{localContact:this.localContact});const e=this.$store.getters.getContact(this.localContact.key);await this.updateLocalContact(e)}},async showQRcode(){const e=this.contact.jCal.slice(0);e[1]=e[1].filter(a=>a[0]!=="photo");const i=Wi.stringify(e);if(i.length>0){const a=await Kv(i),o=new TextDecoder().decode(a);this.qrcode=btoa(o)}},async toggleBirthdayExclusionForContact(){this.localContact.vCard.hasProperty(this.excludeFromBirthdayKey)?this.localContact.vCard.removeProperty(this.excludeFromBirthdayKey):this.localContact.vCard.addPropertyWithValue(this.excludeFromBirthdayKey,!0),await this.updateContact()},selectInput(){this.$refs.fullname&&this.$refs.fullname.value===t("contacts","Name")&&this.$refs.fullname.select()},async selectContact(e){this.loadingData=!0,this.editMode=!1;const i=this.$store.getters.getContact(e);if(i)if(i.dav)try{await this.$store.dispatch("fetchFullContact",{contact:i}),await this.updateLocalContact(i)}catch(a){a.name==="ParserError"?J(t("contacts","Syntax error. Cannot open the contact.")):a?.status===404?J(t("contacts","The contact does not exist on the server anymore.")):J(t("contacts","Unable to retrieve the contact from the server, please check your network connection.")),console.error(a),this.$store.dispatch("deleteContact",{contact:this.contact,dav:!1})}else await this.updateLocalContact(i),this.editMode=!0;this.loadingData=!1},deleteContact(){this.$store.dispatch("deleteContact",{contact:this.contact})},async moveContactToAddressbook(e){const i=this.addressbooks.find(a=>a.id===e);if(this.loadingUpdate=!0,i)try{const a=await this.$store.dispatch("moveContactToAddressbook",{contact:this.contact,addressbook:i});this.$router.push({name:"contact",params:{selectedGroup:this.$route.params.selectedGroup,selectedContact:a.key}})}catch(a){console.error(a),J(t("contacts","An error occurred while trying to move the contact"))}finally{this.loadingUpdate=!1}},async copyContactToAddressbook(e){const i=this.addressbooks.find(a=>a.id===e);if(this.loadingUpdate=!0,i)try{const a=await this.$store.dispatch("copyContactToAddressbook",{contact:this.contact,addressbook:i});this.$router.push({name:"contact",params:{selectedGroup:this.$route.params.selectedGroup,selectedContact:a.key}})}catch(a){console.error(a),J(t("contacts","An error occurred while trying to copy the contact"))}finally{this.loadingUpdate=!1}},refreshContact(){this.$store.dispatch("fetchFullContact",{contact:this.contact,etag:this.conflict}).then(()=>{this.contact.conflict=!1})},closeQrModal(){this.qrcode=""},async updateLocalContact(e){const i=Object.assign(Object.create(Object.getPrototypeOf(e)),e);this.fixed=Td(i),this.localContact=i,this.newGroupsValue=[...this.localContact.groups]},onCtrlSave(e){this.editMode&&e.keyCode===83&&(navigator.platform.match("Mac")?e.metaKey:e.ctrlKey)&&(e.preventDefault(),this.onSave())},async cloneContact(){this.pickedAddressbook&&this.addressbooks.find(e=>e.id===this.pickedAddressbook.id)?(this.logger.debug("Cloning contact to",{name:this.pickedAddressbook.name}),await this.copyContactToAddressbook(this.pickedAddressbook.id),this.closePickAddressbookModal()):this.addressbooksOptions.length===1?(this.logger.debug("Cloning contact to",{name:this.addressbooksOptions[0].name}),await this.copyContactToAddressbook(this.addressbooksOptions[0].id)):this.showPickAddressbookModal=!0},closePickAddressbookModal(){this.showPickAddressbookModal=!1,this.pickedAddressbook=null},canDisplay(e){const i=xn.properties[e.name.split(".").pop()],a=i&&i.force?i.force:e.getDefaultType();return i&&a!=="unknown"},async onSave(){try{this.localContact.groups=[...this.newGroupsValue],await this.$store.dispatch("updateContactGroups",{groupNames:this.newGroupsValue,contact:this.contact}),await this.updateContact(),this.newAddressBook&&this.newAddressBook!==this.contact.addressbook.id&&(this.moveContactToAddressbook(this.newAddressBook),this.newAddressBook=null),this.editMode=!1}catch(e){this.logger.error("error while saving contact",{error:e}),J(t("contacts","Unable to update contact"))}}}};var $_=function(){var e=this,i=e._self._c;return i("AppContentDetails",[e.contact?[i("DetailsHeader",{scopedSlots:e._u([{key:"avatar",fn:function(){return[i("ContactAvatar",{attrs:{contact:e.contact,"is-read-only":e.isReadOnly,"reload-bus":e.reloadBus},on:{"update-local-contact":e.updateLocalContact}})]},proxy:!0},{key:"title",fn:function(){return[e.isReadOnly?i("div",{staticClass:"contact-title"},[e._v(" "+e._s(e.contact.fullName)+" ")]):i("input",{directives:[{name:"model",rawName:"v-model",value:e.contact.fullName,expression:"contact.fullName"}],ref:"fullname",attrs:{id:"contact-fullname",placeholder:e.t("contacts","Name"),type:"text",autocomplete:"off",autocorrect:"off",spellcheck:"false",name:"fullname"},domProps:{value:e.contact.fullName},on:{click:e.selectInput,input:function(a){a.target.composing||e.$set(e.contact,"fullName",a.target.value)}}})]},proxy:!0},{key:"subtitle",fn:function(){return[e.isReadOnly?[i("span",{domProps:{innerHTML:e._s(e.formattedSubtitle)}})]:[i("input",{directives:[{name:"model",rawName:"v-model",value:e.contact.title,expression:"contact.title"}],attrs:{id:"contact-title",placeholder:e.t("contacts","Title"),type:"text",autocomplete:"off",autocorrect:"off",spellcheck:"false",name:"title"},domProps:{value:e.contact.title},on:{input:function(a){a.target.composing||e.$set(e.contact,"title",a.target.value)}}}),i("input",{directives:[{name:"model",rawName:"v-model",value:e.contact.org,expression:"contact.org"}],attrs:{id:"contact-org",placeholder:e.t("contacts","Company"),type:"text",autocomplete:"off",autocorrect:"off",spellcheck:"false",name:"org"},domProps:{value:e.contact.org},on:{input:function(a){a.target.composing||e.$set(e.contact,"org",a.target.value)}}})]]},proxy:!0},{key:"quick-actions",fn:function(){return[!e.editMode&&!e.loadingData?i("div",[i("Actions",{attrs:{inline:6,type:"secondary"}},[e.isTalkEnabled&&e.isInSystemAddressBook?i("ActionButton",{staticClass:"icon-talk quick-action",attrs:{"aria-label":e.t("contacts","Go to talk conversation"),name:e.t("contacts","Go to talk conversation"),href:e.callUrl}}):e._e(),e.profilePageLink?i("ActionButton",{staticClass:"quick-action",attrs:{"aria-label":e.t("contacts","View profile"),name:e.t("contacts","View profile"),href:e.profilePageLink},scopedSlots:e._u([{key:"icon",fn:function(){return[i("IconAccount",{attrs:{size:20}})]},proxy:!0}],null,!1,1136206178)}):e._e(),e._l(e.emailAddressList,function(a){return i("ActionLink",{key:a,staticClass:"quick-action",attrs:{href:"mailto:"+a},scopedSlots:e._u([{key:"icon",fn:function(){return[i("IconMail",{attrs:{size:20}})]},proxy:!0}],null,!0)},[e._v(" "+e._s(a)+" ")])}),e._l(e.phoneNumberList,function(a){return i("ActionLink",{key:a,staticClass:"quick-action",attrs:{href:"tel:"+a},scopedSlots:e._u([{key:"icon",fn:function(){return[i("IconCall",{attrs:{size:20}})]},proxy:!0}],null,!0)},[e._v(" "+e._s(a)+" ")])})],2)],1):e._e()]},proxy:!0},{key:"actions",fn:function(){return[e.warning?i(e.warning.icon,{directives:[{name:"tooltip",rawName:"v-tooltip.bottom",value:{content:e.warning?e.warning.msg:"",trigger:"hover focus"},expression:`{
						content: warning ? warning.msg : '',
						trigger: 'hover focus'
					}`,modifiers:{bottom:!0}}],tag:"component",staticClass:"header-icon",attrs:{classes:e.warning.classes}}):e._e(),e.conflict?i("div",{directives:[{name:"tooltip",rawName:"v-tooltip",value:{content:e.conflict,show:!0,trigger:"manual"},expression:`{
						content: conflict,
						show: true,
						trigger: 'manual',
					}`}],staticClass:"header-icon header-icon--pulse icon-history",on:{click:e.refreshContact}}):e._e(),e.fixed?i("div",{directives:[{name:"tooltip",rawName:"v-tooltip",value:{content:e.t("contacts","This contact was broken and received a fix. Please review the content and click here to save it."),show:!0,trigger:"manual"},expression:`{
						content: t('contacts', 'This contact was broken and received a fix. Please review the content and click here to save it.'),
						show: true,
						trigger: 'manual',
					}`}],staticClass:"header-icon header-icon--pulse icon-up",on:{click:e.updateContact}}):e._e(),e.addressbookIsReadOnly?e._e():[e.editMode?i("NcButton",{attrs:{type:"secondary",disabled:e.loadingUpdate||!e.isDataValid},on:{click:e.onSave},scopedSlots:e._u([{key:"icon",fn:function(){return[e.loadingUpdate?i("IconLoading",{attrs:{size:20}}):i("CheckIcon",{attrs:{size:20}})]},proxy:!0}],null,!1,3908750157)},[e._v(" "+e._s(e.t("contacts","Save"))+" ")]):i("NcButton",{attrs:{type:e.isMobile?"secondary":"tertiary"},on:{click:function(a){e.editMode=!0}},scopedSlots:e._u([{key:"icon",fn:function(){return[i("PencilIcon",{attrs:{size:20}})]},proxy:!0}],null,!1,4260349822)},[e._v(" "+e._s(e.t("contacts","Edit"))+" ")])]]},proxy:!0},{key:"actions-menu",fn:function(){return[i("ActionLink",{attrs:{href:e.contact.url,download:`${e.contact.displayName}.vcf`},scopedSlots:e._u([{key:"icon",fn:function(){return[i("IconDownload",{attrs:{size:20}})]},proxy:!0}])},[e._v(" "+e._s(e.t("contacts","Download"))+" ")]),e.isReadOnly&&e.addressbooksOptions.length>0?i("ActionButton",{ref:"cloneAction",attrs:{"close-after-click":!0},on:{click:e.cloneContact},scopedSlots:e._u([{key:"icon",fn:function(){return[i("IconCopy",{attrs:{size:20}})]},proxy:!0}],null,!1,1700567014)},[e._v(" "+e._s(e.t("contacts","Clone contact"))+" ")]):e._e(),i("ActionButton",{attrs:{"close-after-click":!0},on:{click:e.showQRcode},scopedSlots:e._u([{key:"icon",fn:function(){return[i("IconQr",{attrs:{size:20}})]},proxy:!0}])},[e._v(" "+e._s(e.t("contacts","Generate QR Code"))+" ")]),e.enableToggleBirthdayExclusion?i("ActionButton",{attrs:{"close-after-click":!0},on:{click:e.toggleBirthdayExclusionForContact},scopedSlots:e._u([{key:"icon",fn:function(){return[i("CakeIcon",{attrs:{size:20}})]},proxy:!0}],null,!1,1060251055)},[e._v(" "+e._s(e.excludeFromBirthdayLabel)+" ")]):e._e(),e.addressbookIsReadOnly?e._e():i("ActionButton",{on:{click:e.deleteContact},scopedSlots:e._u([{key:"icon",fn:function(){return[i("IconDelete",{attrs:{size:20}})]},proxy:!0}],null,!1,881161434)},[e._v(" "+e._s(e.t("contacts","Delete"))+" ")])]},proxy:!0}])}),e.qrcode?i("Modal",{attrs:{id:"qrcode-modal",size:"small","clear-view-delay":-1,name:e.contact.displayName,"close-button-contained":!1},on:{close:e.closeQrModal}},[i("img",{staticClass:"qrcode",attrs:{src:`data:image/svg+xml;base64,${e.qrcode}`,alt:e.t("contacts","Contact vCard as QR code"),width:"400"}})]):e._e(),e.showPickAddressbookModal?i("Modal",{attrs:{id:"pick-addressbook-modal","clear-view-delay":-1,name:e.t("contacts","Pick an address book")},on:{close:e.closePickAddressbookModal}},[i("NcSelect",{ref:"pickAddressbook",staticClass:"address-book",attrs:{"allow-empty":!1,options:e.copyableAddressbooksOptions,placeholder:e.t("contacts","Select address book"),"track-by":"id",label:"name"},model:{value:e.pickedAddressbook,callback:function(a){e.pickedAddressbook=a},expression:"pickedAddressbook"}}),i("button",{on:{click:e.closePickAddressbookModal}},[e._v(" "+e._s(e.t("contacts","Cancel"))+" ")]),i("button",{staticClass:"primary",on:{click:e.cloneContact}},[e._v(" "+e._s(e.t("contacts","Clone contact"))+" ")])],1):e._e(),e.loadingData?i("IconLoading",{staticClass:"contact-details",attrs:{size:20}}):e.loadingData?e._e():i("div",{staticClass:"contact-details-wrapper"},[i("section",{staticClass:"contact-details"},[e.name==="lifeEvents"?i("div",{staticClass:"life-events-group"},e._l(e.properties,function(a,o){return i("ContactDetailsProperty",{key:`${o}-${e.contact.key}-${a.name}`,attrs:{"is-first-property":o===0,"is-last-property":o===e.properties.length-1,property:a,contact:e.contact,"local-contact":e.localContact,contacts:e.contacts,bus:e.bus,"is-read-only":e.isReadOnly}})}),1):e._e(),e._l(e.groupedProperties,function(a,o){return i("div",{key:o},e._l(a,function(s,r){return i("ContactDetailsProperty",{key:`${r}-${e.contact.key}-${s.name}`,attrs:{"is-first-property":r===0,"is-last-property":r===a.length-1,property:s,contact:e.contact,"local-contact":e.localContact,contacts:e.contacts,bus:e.bus,"is-read-only":e.isReadOnly}})}),1)})],2),i("PropertySelect",{staticClass:"property--addressbooks property--last",attrs:{"prop-model":e.addressbookModel,options:e.addressbooksOptions,value:e.addressbook,"is-first-property":!0,"is-last-property":!0,property:{},"hide-actions":!0,"is-read-only":e.isReadOnly},on:{"update:value":e.updateAddressbook}}),i("PropertyGroups",{staticClass:"property--groups property--last",attrs:{"prop-model":e.groupsModel,value:e.localContact.groups,contact:e.contact,"is-read-only":e.isReadOnly},on:{"update:value":[function(a){return e.$set(e.localContact,"groups",a)},e.updateGroups]}})],1),e.nextcloudVersionAtLeast28&&!e.editMode?i("div",{staticClass:"related-resources"},[e.filesPanelHasError?e._e():i("NcRelatedResourcesPanel",{attrs:{"provider-id":"account","resource-type":"files",description:e.desc,limit:5,header:e.t("contacts","Media shares with you"),"item-id":e.contact.uid,primary:!0},on:{"has-resources":a=>e.hasFilesResources=a,"has-error":a=>e.filesPanelHasError=a}}),e.talkPanelHasError?e._e():i("NcRelatedResourcesPanel",{attrs:{"provider-id":"account","resource-type":"talk",description:e.desc,limit:5,header:e.t("contacts","Talk conversations with you"),"item-id":e.contact.uid,primary:!0},on:{"has-resources":a=>e.hasTalkResources=a,"has-error":a=>e.talkPanelHasError=a}}),e.calendarPanelHasError?e._e():i("NcRelatedResourcesPanel",{attrs:{"provider-id":"account","resource-type":"calendar",description:e.desc,limit:5,header:e.t("contacts","Calendar events with you"),"item-id":e.contact.uid,primary:!0},on:{"has-resources":a=>e.hasCalendarResources=a,"has-error":a=>e.calendarPanelHasError=a}}),e.deckPanelHasError?e._e():i("NcRelatedResourcesPanel",{attrs:{"provider-id":"account","resource-type":"deck",description:e.desc,limit:5,header:e.t("contacts","Deck cards with you"),"item-id":e.contact.uid,primary:!0},on:{"has-resources":a=>e.hasDeckResources=a,"has-error":a=>e.deckPanelHasError=a}}),!e.hasRelatedResources&&!e.loadingData?i("NcEmptyContent",{attrs:{name:e.t("contacts","No shared items with this contact")},scopedSlots:e._u([{key:"icon",fn:function(){return[i("FolderMultipleImage",{attrs:{size:20}})]},proxy:!0}],null,!1,3645725449)}):e._e()],1):e._e(),e.isReadOnly?e._e():i("AddNewProp",{staticClass:"last-edit",attrs:{bus:e.bus,contact:e.contact}}),e.contact.rev?i("PropertyRev",{staticClass:"last-edit",attrs:{value:e.contact.rev}}):e._e()]:i("EmptyContent",{staticClass:"empty-content",attrs:{name:e.t("contacts","No contact selected"),description:e.t("contacts","Select a contact on the list to begin")},scopedSlots:e._u([{key:"icon",fn:function(){return[i("IconContact",{attrs:{size:20}})]},proxy:!0}],null,!1,3494319139)})],2)},z_=[],P_=U(I_,$_,z_,!1,null,"05da441c");const B_=P_.exports,R_={name:"ContactsListItem",components:{ListItem:Yo,NcAvatar:$n,CheckIcon:Vo},props:{index:{type:Number,required:!0},source:{type:Object,required:!0},reloadBus:{type:Object,required:!0},onSelectMultipleFromParent:{type:Function,default:()=>{}}},data(){return{avatarUrl:void 0,hoveringAvatar:!1}},computed:{selectedGroup(){return this.$route.params.selectedGroup},selectedContact(){return this.$route.params.selectedContact},isDraggable(){return!!this.source.dav&&this.source.addressbook.id!=="z-server-generated--system"},id(){return window.btoa(this.source.key).slice(0,-2)},getTel(){return this.source.properties.find(e=>e.name==="tel")?.getFirstValue()}},created(){this.reloadBus.on("reload-avatar",this.reloadAvatarUrl),this.reloadBus.on("delete-avatar",this.deleteAvatar)},destroyed(){this.reloadBus.off("reload-avatar",this.reloadAvatarUrl),this.reloadBus.off("delete-avatar",this.deleteAvatar)},async mounted(){await this.loadAvatarUrl()},methods:{startDrag(e,i){e.dataTransfer.dropEffect="move",e.dataTransfer.effectAllowed="move",e.dataTransfer.setData("item",JSON.stringify({addressbookId:i.addressbook.id,displayName:i.displayName,groups:i.groups,url:i.url,uid:i.uid}))},reloadAvatarUrl(e){e===this.source.key&&this.loadAvatarUrl()},deleteAvatar(e){e===this.source.key&&(this.avatarUrl=void 0)},async loadAvatarUrl(){if(this.avatarUrl=void 0,this.source.photo){const e=await this.source.getPhotoUrl();if(!e){console.warn("contact has an invalid photo");return}this.avatarUrl=e}else this.source.hasPhoto&&this.source.url&&(this.avatarUrl=`${this.source.url}?photo`)},selectContact(){this.$router.push({name:"contact",params:{selectedGroup:this.selectedGroup,selectedContact:this.source.key}})},onSelectMultiple(){this.onSelectMultipleFromParent(this.source,this.index)},onSelectMultipleRange(){this.onSelectMultipleFromParent(this.source,this.index,!0)}}};var H_=function(){var e=this,i=e._self._c;return i("div",{staticClass:"contacts-list__item-wrapper",attrs:{draggable:e.isDraggable},on:{dragstart:function(a){return e.startDrag(a,e.source)},click:function(a){return!a.shiftKey||a.ctrlKey||a.altKey||a.metaKey?null:(a.preventDefault(),e.onSelectMultipleRange.apply(null,arguments))}}},[i("ListItem",{key:e.source.key,staticClass:"list-item-style envelope",attrs:{id:e.id,name:e.source.displayName,to:{name:"contact",params:{selectedGroup:e.selectedGroup,selectedContact:e.source.key}}},scopedSlots:e._u([{key:"icon",fn:function(){return[i("div",{staticClass:"contacts-list__item-icon",on:{click:function(a){return a.ctrlKey||a.shiftKey||a.altKey||a.metaKey?null:(a.preventDefault(),e.onSelectMultiple.apply(null,arguments))},mouseenter:function(a){e.hoveringAvatar=!0},mouseleave:function(a){e.hoveringAvatar=!1}}},[!e.source.isMultiSelected&&!e.hoveringAvatar&&e.source.addressbook.id==="z-server-generated--system"?i("NcAvatar",{attrs:{user:e.source.uid,"show-user-status":!1,size:40}}):e._e(),!e.source.isMultiSelected&&!e.hoveringAvatar&&e.source.addressbook.id!=="z-server-generated--system"?i("NcAvatar",{attrs:{"display-name":e.source.displayName,url:e.avatarUrl,size:40}}):e._e(),e.source.isMultiSelected||e.hoveringAvatar?i("CheckIcon",{class:{"contacts-list__item-avatar-selected":e.source.isMultiSelected,"contacts-list__item-avatar-hovered":!e.source.isMultiSelected},attrs:{size:28}}):e._e()],1)]},proxy:!0},{key:"subname",fn:function(){return[i("div",{staticClass:"envelope__subtitle"},[i("span",{staticClass:"envelope__subtitle__subject"},[e._v(" "+e._s(e.source.email?e.source.email:e.getTel)+" ")])])]},proxy:!0}])})],1)},Y_=[],U_=U(R_,H_,Y_,!1,null,"159f1562");const G_=U_.exports,F_={name:"CloseThickIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}};var V_=function(){var e=this,i=e._self._c;return i("span",e._b({staticClass:"material-design-icon close-thick-icon",attrs:{"aria-hidden":e.title?null:"true","aria-label":e.title,role:"img"},on:{click:function(a){return e.$emit("click",a)}}},"span",e.$attrs,!1),[i("svg",{staticClass:"material-design-icon__svg",attrs:{fill:e.fillColor,width:e.size,height:e.size,viewBox:"0 0 24 24"}},[i("path",{attrs:{d:"M20 6.91L17.09 4L12 9.09L6.91 4L4 6.91L9.09 12L4 17.09L6.91 20L12 14.91L17.09 20L20 17.09L14.91 12L20 6.91Z"}},[e.title?i("title",[e._v(e._s(e.title))]):e._e()])])])},j_=[],W_=U(F_,V_,j_,!1,null,null);const q_=W_.exports,X_='<svg xmlns="http://www.w3.org/2000/svg" id="mdi-cancel" viewBox="0 0 24 24"><path d="M12 2C17.5 2 22 6.5 22 12S17.5 22 12 22 2 17.5 2 12 6.5 2 12 2M12 4C10.1 4 8.4 4.6 7.1 5.7L18.3 16.9C19.3 15.5 20 13.8 20 12C20 7.6 16.4 4 12 4M16.9 18.3L5.7 7.1C4.6 8.4 4 10.1 4 12C4 16.4 7.6 20 12 20C13.9 20 15.6 19.4 16.9 18.3Z" /></svg>',Z_='<svg xmlns="http://www.w3.org/2000/svg" id="mdi-delete" viewBox="0 0 24 24"><path d="M19,4H15.5L14.5,3H9.5L8.5,4H5V6H19M6,19A2,2 0 0,0 8,21H16A2,2 0 0,0 18,19V7H6V19Z" /></svg>',K_={name:"ContactsList",components:{AppContentList:rh,NcNoteCard:Ed,VirtualList:pc,NcButton:Kt,IconSelect:q_,IconDelete:Ie,NcDialog:sd},props:{list:{type:Array,required:!0},contacts:{type:Object,required:!0},searchQuery:{type:String,default:""},reloadBus:{type:Object,required:!0}},data(){return{ContactsListItem:G_,query:"",multiSelectedContacts:new Map,showDeleteConfirmationDialog:!1,buttons:[{label:t("contacts","Cancel"),icon:X_,callback:()=>{this.showDeleteConfirmationDialog=!1}},{label:t("contacts","Delete"),type:"primary",icon:Z_,callback:()=>{this.deleteAllMultiSelected()}}],lastToggledIndex:void 0}},computed:{selectedContact(){return this.$route.params.selectedContact},selectedGroup(){return this.$route.params.selectedGroup},filteredList(){const e=this.list.filter(i=>this.matchSearch(this.contacts[i.key])).map(i=>this.contacts[i.key]);return e.forEach((i,a)=>{i.isMultiSelected=this.multiSelectedContacts.has(a)}),e},isMultiSelecting(){return this.multiSelectedContacts.size>0},readOnlyMultiSelectedCount(){let e=0;return this.multiSelectedContacts.forEach(i=>{i.addressbook.readOnly&&e++}),e},isAtLeastOneEditable(){return this.readOnlyMultiSelectedCount!==this.multiSelectedContacts.size},deleteActionTitle(){return this.isAtLeastOneEditable?n("contacts","Delete {number} contact","Delete {number} contacts",this.multiSelectedContacts.size,{number:this.multiSelectedContacts.size}):t("contacts","Please select at least one editable contact to delete")}},watch:{selectedContact(e){this.$nextTick(()=>{this.scrollToContact(e)})},list(e,i){e.length!==0&&i.length===0&&this.selectedContact&&this.$nextTick(()=>{this.scrollToContact(this.selectedContact)})}},mounted(){this.query=this.searchQuery},methods:{selectContact(e){if(this.list.length>0&&e<this.list.length){const i=e===0?this.list[e+1]:this.list[e-1];i&&this.$router.push({name:"contact",params:{selectedGroup:this.selectedGroup,selectedContact:i.key}})}},scrollToContact(e){const i=this.$el.querySelector("#"+btoa(e).slice(0,-2));if(!(i&&i.getBoundingClientRect().y>50)){const a=this.list.findIndex(o=>o.key===e);a>-1&&this.$refs.scroller.scrollToIndex(a)}if(i){const a=i.getBoundingClientRect().y+this.itemHeight-(this.$el.offsetHeight+50);if(a>0){const o=this.$refs.scroller.$el;o.scrollToOffset(o.scrollTop+a)}}},matchSearch(e){return this.query.trim()!==""?e.searchData.toString().toLowerCase().search(this.query.trim().toLowerCase())!==-1:!0},onSelectMultiple(e,i,a=!1){a&&this.lastToggledIndex!==i&&this.onSelectRange(i)||(this.multiSelectedContacts.has(i)?this.multiSelectedContacts.delete(i):this.multiSelectedContacts.set(i,e),this.lastToggledIndex=i,this.$set(this,"multiSelectedContacts",new Map(this.multiSelectedContacts)))},onSelectRange(e){const i=this.lastToggledIndex??void 0;if(i===void 0)return!1;const a=Math.min(i,e),o=Math.max(i,e),s=this.multiSelectedContacts.has(e),r=new Map(this.multiSelectedContacts);for(let c=a;c<=o;c++)s?r.delete(c):r.set(c,this.filteredList[c]);return this.lastToggledIndex=e,this.$set(this,"multiSelectedContacts",r),!0},unselectAllMultiSelected(){this.$set(this,"multiSelectedContacts",new Map),this.lastToggledIndex=void 0},attemptDeleteAllMultiSelected(){this.showDeleteConfirmationDialog=!0},deleteAllMultiSelected(){this.multiSelectedContacts.forEach(async e=>{e.addressbook.readOnly||(await new Promise(i=>setTimeout(i,500)),await this.$store.dispatch("deleteContact",{contact:e}))}),this.unselectAllMultiSelected(),this.showDeleteConfirmationDialog=!1}}};var J_=function(){var e=this,i=e._self._c;return i("AppContentList",{staticClass:"content-list",attrs:{"data-testid":"contacts-list"}},[i("NcDialog",{attrs:{open:e.showDeleteConfirmationDialog,name:e.n("contacts","Delete {number} contact","Delete {number} contacts",e.multiSelectedContacts.size,{number:e.multiSelectedContacts.size}),buttons:e.buttons,"no-close":""}},[e._v(" "+e._s(e.t("contacts","Are you sure you want to proceed?"))+" "),e.readOnlyMultiSelectedCount?i("NcNoteCard",{attrs:{type:"info",text:e.n("contacts","Please note that {number} contact is read only and will not be deleted","Please note that {number} contacts are read only and will not be deleted",e.readOnlyMultiSelectedCount,{number:e.readOnlyMultiSelectedCount})}}):e._e()],1),i("div",{staticClass:"contacts-list__header"},[i("div",{staticClass:"search-contacts-field"},[i("input",{directives:[{name:"model",rawName:"v-model",value:e.query,expression:"query"}],attrs:{type:"text",placeholder:e.t("contacts","Search contacts …")},domProps:{value:e.query},on:{input:function(a){a.target.composing||(e.query=a.target.value)}}})])]),i("transition",{attrs:{name:"contacts-list__multiselect-header"}},[e.isMultiSelecting?i("div",{staticClass:"contacts-list__multiselect-header"},[i("NcButton",{attrs:{type:"tertiary",title:e.t("contacts","Unselect {number}",{number:e.multiSelectedContacts.size}),"close-after-click":!0},on:{click:function(a){return a.preventDefault(),e.unselectAllMultiSelected.apply(null,arguments)}}},[i("IconSelect",{attrs:{size:16}})],1),i("NcButton",{attrs:{type:"tertiary",disabled:!e.isAtLeastOneEditable,title:e.deleteActionTitle,"close-after-click":!0},on:{click:function(a){return a.preventDefault(),e.attemptDeleteAllMultiSelected.apply(null,arguments)}}},[i("IconDelete",{attrs:{size:16}})],1)],1):e._e()]),i("VirtualList",{ref:"scroller",staticClass:"contacts-list",attrs:{"data-key":"key","data-sources":e.filteredList,"data-component":e.ContactsListItem,"estimate-size":68,"extra-props":{reloadBus:e.reloadBus,onSelectMultipleFromParent:e.onSelectMultiple,onSelectRangeFromParent:e.onSelectRange}}})],1)},Q_=[],tb=U(K_,J_,Q_,!1,null,"12b8f712");const eb=tb.exports,nb={name:"ContactsContent",components:{AppContent:$o,Button:Kt,ContactDetails:B_,ContactsList:eb,EmptyContent:We,IconContact:hn,IconLoading:ee},mixins:[ui],props:{loading:{type:Boolean,default:!0},contactsList:{type:Array,required:!0}},data(){return{searchQuery:"",reloadBus:ic()}},computed:{contacts(){return this.$store.getters.getContacts},groups(){return this.$store.getters.getGroups},sortedContacts(){return this.$store.getters.getSortedContacts},selectedContact(){return this.$route.params.selectedContact},isRealGroup(){return this.groups.findIndex(e=>e.name===this.selectedGroup)>-1},isEmptyGroup(){return this.contactsList.length===0},showDetails(){return!!this.selectedContact}},methods:{addContactsToGroup(e){De("contacts:group:append",e)},newContact(){this.$emit("new-contact")},hideDetails(){this.$router.push({name:"group",params:{selectedGroup:this.selectedGroup}})}}};var ib=function(){var e=this,i=e._self._c;return e.loading?i("AppContent",[i("EmptyContent",{staticClass:"empty-content",attrs:{name:e.t("contacts","Loading contacts …")},scopedSlots:e._u([{key:"icon",fn:function(){return[i("IconLoading",{attrs:{size:20}})]},proxy:!0}],null,!1,3081367109)})],1):e.isEmptyGroup&&!e.isRealGroup?i("AppContent",[i("EmptyContent",{staticClass:"empty-content",attrs:{name:e.t("contacts","There are no contacts yet")},scopedSlots:e._u([{key:"icon",fn:function(){return[i("IconContact",{attrs:{size:20}})]},proxy:!0},{key:"desc",fn:function(){return[i("Button",{attrs:{type:"primary"},on:{click:e.newContact}},[e._v(" "+e._s(e.t("contacts","Create contact"))+" ")])]},proxy:!0}])})],1):e.isEmptyGroup&&e.isRealGroup?i("AppContent",[i("EmptyContent",{staticClass:"empty-content",attrs:{name:e.t("contacts","There are no contacts in this group")},scopedSlots:e._u([{key:"icon",fn:function(){return[i("IconContact",{attrs:{size:20}})]},proxy:!0},{key:"desc",fn:function(){return[e.contacts.length===0?i("Button",{attrs:{type:"primary"},on:{click:function(a){return e.addContactsToGroup(e.selectedGroup)}}},[e._v(" "+e._s(e.t("contacts","Create contacts"))+" ")]):i("Button",{attrs:{type:"primary"},on:{click:function(a){return e.addContactsToGroup(e.selectedGroup)}}},[e._v(" "+e._s(e.t("contacts","Add contacts"))+" ")])]},proxy:!0}])})],1):i("AppContent",{attrs:{"show-details":e.showDetails},on:{"update:showDetails":e.hideDetails},scopedSlots:e._u([{key:"list",fn:function(){return[i("ContactsList",{attrs:{list:e.contactsList,contacts:e.contacts,"search-query":e.searchQuery,"reload-bus":e.reloadBus}})]},proxy:!0}])},[i("ContactDetails",{attrs:{"contact-key":e.selectedContact,contacts:e.sortedContacts,"reload-bus":e.reloadBus}})],1)},ab=[],ob=U(nb,ib,ab,!1,null,"d3c63676");const sb=ob.exports,rb={name:"ProcessingScreen",components:{EmptyContent:We,IconContact:hn},props:{total:{type:Number,required:!0},progress:{type:Number,required:!0},desc:{type:String,required:!0},title:{type:String,required:!0}}};var cb=function(){var e=this,i=e._self._c;return i("div",[i("EmptyContent",{staticClass:"processing-screen__wrapper",attrs:{description:e.desc,name:e.title},scopedSlots:e._u([{key:"icon",fn:function(){return[i("IconContact",{attrs:{size:20}})]},proxy:!0}])}),i("div",{staticClass:"processing-screen__progress"},[i("progress",{attrs:{max:e.total},domProps:{value:e.progress}})])],1)},lb=[],ub=U(rb,cb,lb,!1,null,"7b0ed3c4");const bl=ub.exports,db={name:"AddToGroupView",components:{ProcessingScreen:bl,Button:Kt},props:{failed:{type:Number,default:0},progress:{type:Number,default:0},success:{type:Number,default:0},total:{type:Number,default:0},name:{type:String,default:""}},computed:{progressHeader(){return n("contacts","{success} contact added to {name}","{success} contacts added to {name}",this.success,{success:this.success,name:this.name})},finishedHeader(){return n("contacts","Adding {success} contact to {name}","Adding {success} contacts to {name}",this.success,{success:this.success,name:this.name})},messageFailed(){return n("contacts","{count} error","{count} errors",this.failed,{count:this.failed})}},methods:{onClose(){this.$emit("close")}}};var hb=function(){var e=this,i=e._self._c;return i("div",[i("ProcessingScreen",{attrs:{progress:e.progress,total:e.total,desc:e.failed>0?e.messageFailed:"",title:e.total===e.progress?e.finishedHeader:e.progressHeader}}),i("div",{staticClass:"close__button"},[e.total===e.progress?i("Button",{staticClass:"primary",on:{click:e.onClose}},[e._v(" "+e._s(e.t("contacts","Close"))+" ")]):e._e()],1)],1)},pb=[],fb=U(db,hb,pb,!1,null,"13da812b");const mb=fb.exports,gb=async function(e,i){const a=e.groups;return a.push(i),re.patch(e.url,{},{headers:{"X-PROPERTY":"CATEGORIES","X-PROPERTY-REPLACE":a.map(o=>encodeURIComponent(o)).join(",")}})},yb={name:"ContactsPicker",components:{AddToGroupView:mb,EntityPicker:fc,Modal:Xe},data(){return{showPicker:!1,pickerforGroup:null,pickerData:[],pickerTypes:[{id:"contact",label:t("contacts","Contacts")}],isProcessing:!1,isProcessDone:!1,processStatus:{failed:0,progress:0,success:0,total:0,name:""},passedGroupName:""}},computed:{contacts(){return this.$store.getters.getContacts},groups(){return this.$store.getters.getGroups},sortedContacts(){return this.$store.getters.getSortedContacts}},mounted(){To("contacts:group:append",this.addContactsToGroup)},methods:{addContactsToGroup(e){if(console.debug("Contacts picker opened for group",e),this.passedGroupName=e.name?e.name:e,typeof e=="string"&&(e=this.groups.find(i=>i.name===e),!e)){console.error("Cannot add contact to an undefined group",e);return}this.pickerData=this.sortedContacts.map(({key:i})=>{const a=this.contacts[i];return{id:a.key,label:a.displayName,type:"contact",readOnly:a.addressbook.readOnly,groups:a.groups}}).filter(i=>!i.readOnly).filter(i=>i.groups.indexOf(e.name)===-1),this.showPicker=!0,this.pickerforGroup=e},onContactPickerClose(){this.pickerData=[],this.showPicker=!1},onContactPickerPick(e){console.debug("Adding",e,"to group",this.pickerforGroup);const i=this.pickerforGroup.name;this.isProcessing=!0,this.showPicker=!1,this.processStatus.total=e.length,this.processStatus.name=this.pickerforGroup.name,this.processStatus.progress=0,this.processStatus.failed=0;const a=Ld(3),o=[];e.map(async s=>{try{const r=this.contacts[s.id];o.push(a(()=>gb(r,i).then(()=>{this.$store.dispatch("addContactToGroup",{contact:r,groupName:i}),this.processStatus.progress++,this.processStatus.success++}).catch(c=>{this.processStatus.progress++,this.processStatus.error++,console.error(c)})))}catch(r){console.error(r)}}),Promise.all(o).then(()=>{this.isProcessDone=!0,this.showPicker=!1,this.$router.push({name:"group",params:{selectedGroup:typeof this.passedGroupName=="string"?this.passedGroupName:this.passedGroupName.name}}),this.processStatus.failed===0&&setTimeout(this.closeProcess,3e3)})},closeProcess(){this.pickerforGroup=null,this.isProcessing=!1,this.isProcessDone=!1,this.processStatus.failed=0,this.processStatus.progress=0,this.processStatus.success=0,this.processStatus.total=0,!(this.passedGroupName===""||this.passedGroupName===void 0)&&this.$router.push({name:"group",params:{selectedGroup:typeof this.passedGroupName=="string"?this.passedGroupName:this.passedGroupName.name}})}}};var vb=function(){var e=this,i=e._self._c;return e.isProcessing||e.isProcessDone?i("Modal",{attrs:{"clear-view-delay":-1,"can-close":e.isProcessDone},on:{close:e.closeProcess}},[i("AddToGroupView",e._b({on:{close:e.closeProcess}},"AddToGroupView",e.processStatus,!1))],1):e.showPicker?i("EntityPicker",{attrs:{"confirm-label":e.t("contacts","Add to {group}",{group:e.pickerforGroup.name}),"data-types":e.pickerTypes,"data-set":e.pickerData,"empty-data-set-description":e.t("contacts","Please note that you can only add contacts from writable address books to contact groups. Contacts from read-only address books, such as the system address book, cannot be added.")},on:{close:e.onContactPickerClose,submit:e.onContactPickerPick}}):e._e()},_b=[],bb=U(yb,vb,_b,!1,null,null);const wb=bb.exports,Cb={name:"ImportView",components:{ProcessingScreen:bl,Button:Kt},computed:{importState(){return this.$store.getters.getImportState},addressbook(){return this.importState.addressbook},total(){return this.importState.total},accepted(){return this.importState.accepted},failed(){return this.importState.denied},progress(){return this.accepted+this.failed},importingHeader(){return n("contacts","Importing %n contact into {addressbook}","Importing %n contacts into {addressbook}",this.total,{addressbook:this.addressbook})},importedHeader(){return n("contacts","Done importing %n contact into {addressbook}","Done importing %n contacts into {addressbook}",this.total,{addressbook:this.addressbook})},importFailed(){return n("contacts","{count} error","{count} errors",this.failed,{count:this.failed})}},methods:{onClose(){this.$emit("close")}}};var kb=function(){var e=this,i=e._self._c;return i("div",[i("ProcessingScreen",{attrs:{progress:e.progress,total:e.total,desc:e.failed>0?e.importFailed:"",title:e.total===e.progress?e.importedHeader:e.importingHeader}}),i("div",{staticClass:"close__button"},[e.total===e.progress?i("Button",{staticClass:"primary",on:{click:e.onClose}},[e._v(" "+e._s(e.t("contacts","Close"))+" ")]):e._e()],1)],1)},xb=[],Sb=U(Cb,kb,xb,!1,null,"bb652b08");const Mb=Sb.exports,Ab={name:"LocationEnterIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}};var Nb=function(){var e=this,i=e._self._c;return i("span",e._b({staticClass:"material-design-icon location-enter-icon",attrs:{"aria-hidden":e.title?null:"true","aria-label":e.title,role:"img"},on:{click:function(a){return e.$emit("click",a)}}},"span",e.$attrs,!1),[i("svg",{staticClass:"material-design-icon__svg",attrs:{fill:e.fillColor,width:e.size,height:e.size,viewBox:"0 0 24 24"}},[i("path",{attrs:{d:"M14 12L10 8V11H2V13H10V16M22 12A10 10 0 0 1 2.46 15H4.59A8 8 0 1 0 4.59 9H2.46A10 10 0 0 1 22 12Z"}},[e.title?i("title",[e._v(e._s(e.title))]):e._e()])])])},Db=[],Ob=U(Ab,Nb,Db,!1,null,null);const Tb=Ob.exports,Eb={name:"AccountStarIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}};var Lb=function(){var e=this,i=e._self._c;return i("span",e._b({staticClass:"material-design-icon account-star-icon",attrs:{"aria-hidden":e.title?null:"true","aria-label":e.title,role:"img"},on:{click:function(a){return e.$emit("click",a)}}},"span",e.$attrs,!1),[i("svg",{staticClass:"material-design-icon__svg",attrs:{fill:e.fillColor,width:e.size,height:e.size,viewBox:"0 0 24 24"}},[i("path",{attrs:{d:"M15,14C12.33,14 7,15.33 7,18V20H23V18C23,15.33 17.67,14 15,14M15,12A4,4 0 0,0 19,8A4,4 0 0,0 15,4A4,4 0 0,0 11,8A4,4 0 0,0 15,12M5,13.28L7.45,14.77L6.8,11.96L9,10.08L6.11,9.83L5,7.19L3.87,9.83L1,10.08L3.18,11.96L2.5,14.77L5,13.28Z"}},[e.title?i("title",[e._v(e._s(e.title))]):e._e()])])])},Ib=[],$b=U(Eb,Lb,Ib,!1,null,null);const zb=$b.exports,Pb={name:"AccountGroupOutlineIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}};var Bb=function(){var e=this,i=e._self._c;return i("span",e._b({staticClass:"material-design-icon account-group-outline-icon",attrs:{"aria-hidden":e.title?null:"true","aria-label":e.title,role:"img"},on:{click:function(a){return e.$emit("click",a)}}},"span",e.$attrs,!1),[i("svg",{staticClass:"material-design-icon__svg",attrs:{fill:e.fillColor,width:e.size,height:e.size,viewBox:"0 0 24 24"}},[i("path",{attrs:{d:"M12,5A3.5,3.5 0 0,0 8.5,8.5A3.5,3.5 0 0,0 12,12A3.5,3.5 0 0,0 15.5,8.5A3.5,3.5 0 0,0 12,5M12,7A1.5,1.5 0 0,1 13.5,8.5A1.5,1.5 0 0,1 12,10A1.5,1.5 0 0,1 10.5,8.5A1.5,1.5 0 0,1 12,7M5.5,8A2.5,2.5 0 0,0 3,10.5C3,11.44 3.53,12.25 4.29,12.68C4.65,12.88 5.06,13 5.5,13C5.94,13 6.35,12.88 6.71,12.68C7.08,12.47 7.39,12.17 7.62,11.81C6.89,10.86 6.5,9.7 6.5,8.5C6.5,8.41 6.5,8.31 6.5,8.22C6.2,8.08 5.86,8 5.5,8M18.5,8C18.14,8 17.8,8.08 17.5,8.22C17.5,8.31 17.5,8.41 17.5,8.5C17.5,9.7 17.11,10.86 16.38,11.81C16.5,12 16.63,12.15 16.78,12.3C16.94,12.45 17.1,12.58 17.29,12.68C17.65,12.88 18.06,13 18.5,13C18.94,13 19.35,12.88 19.71,12.68C20.47,12.25 21,11.44 21,10.5A2.5,2.5 0 0,0 18.5,8M12,14C9.66,14 5,15.17 5,17.5V19H19V17.5C19,15.17 14.34,14 12,14M4.71,14.55C2.78,14.78 0,15.76 0,17.5V19H3V17.07C3,16.06 3.69,15.22 4.71,14.55M19.29,14.55C20.31,15.22 21,16.06 21,17.07V19H24V17.5C24,15.76 21.22,14.78 19.29,14.55M12,16C13.53,16 15.24,16.5 16.23,17H7.77C8.76,16.5 10.47,16 12,16Z"}},[e.title?i("title",[e._v(e._s(e.title))]):e._e()])])])},Rb=[],Hb=U(Pb,Bb,Rb,!1,null,null);const Yb=Hb.exports,Ub={name:"CircleNavigationItem",components:{ActionButton:qe,ActionLink:pa,ActionText:Io,NcCounterBubble:ma,AppNavigationItem:zo,ExitToApp:dc,IconCog:Go,IconDelete:Ie,LocationEnter:Tb,AccountStar:zb,AccountGroup:Uo,AccountGroupOutline:Yb,IconLoading:ee},mixins:[lc],props:{circle:{type:Bo,required:!0}},computed:{memberCount(){const e=Object.keys(this.circle?.members||[]).length;return e===0&&this.circle.population>0?this.circle.population:e}}};var Gb=function(){var e=this,i=e._self._c;return i("AppNavigationItem",{key:e.circle.key,attrs:{name:e.circle.displayName,to:e.circle.router},scopedSlots:e._u([{key:"icon",fn:function(){return[e.circle.isOwner?i("AccountStar",{attrs:{size:20}}):e.circle.isMember?i("AccountGroup",{attrs:{size:20}}):i("AccountGroupOutline",{attrs:{size:20}})]},proxy:!0},{key:"actions",fn:function(){return[e.loadingAction?i("ActionText",{scopedSlots:e._u([{key:"icon",fn:function(){return[i("IconLoading",{attrs:{size:20}})]},proxy:!0}],null,!1,3081367109)},[e._v(" "+e._s(e.t("contacts","Loading …"))+" ")]):[e.circle.canManageMembers?i("ActionButton",{attrs:{"close-after-click":!0},on:{click:e.addMemberToCircle},scopedSlots:e._u([{key:"icon",fn:function(){return[i("IconCog",{attrs:{size:20}})]},proxy:!0}],null,!1,4087142664)},[e._v(" "+e._s(e.t("contacts","Manage team"))+" ")]):e._e(),i("ActionLink",{attrs:{href:e.circleUrl,icon:e.copyLinkIcon},on:{click:function(a){return a.stopPropagation(),a.preventDefault(),e.copyToClipboard(e.circleUrl)}}},[e._v(" "+e._s(e.copyButtonText)+" ")]),e.circle.canLeave?i("ActionButton",{on:{click:e.confirmLeaveCircle},scopedSlots:e._u([{key:"icon",fn:function(){return[i("ExitToApp",{attrs:{size:16}})]},proxy:!0}],null,!1,3893118231)},[e._v(" "+e._s(e.t("contacts","Leave team"))+" ")]):!e.circle.isMember&&e.circle.canJoin?i("ActionButton",{attrs:{disabled:e.loadingJoin},on:{click:e.joinCircle},scopedSlots:e._u([{key:"icon",fn:function(){return[i("LocationEnter",{attrs:{size:16}})]},proxy:!0}])},[e._v(" "+e._s(e.joinButtonTitle)+" ")]):e._e(),e.circle.canDelete?i("ActionButton",{on:{click:e.confirmDeleteCircle},scopedSlots:e._u([{key:"icon",fn:function(){return[i("IconDelete",{attrs:{size:20}})]},proxy:!0}],null,!1,881161434)},[e._v(" "+e._s(e.t("contacts","Delete team"))+" ")]):e._e()]]},proxy:!0},{key:"counter",fn:function(){return[e.memberCount>0?i("NcCounterBubble",[e._v(" "+e._s(e.memberCount)+" ")]):e._e()]},proxy:!0}])})},Fb=[],Vb=U(Ub,Gb,Fb,!1,null,null);const jb=Vb.exports,Wb={name:"AccountMultiplePlusIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}};var qb=function(){var e=this,i=e._self._c;return i("span",e._b({staticClass:"material-design-icon account-multiple-plus-icon",attrs:{"aria-hidden":e.title?null:"true","aria-label":e.title,role:"img"},on:{click:function(a){return e.$emit("click",a)}}},"span",e.$attrs,!1),[i("svg",{staticClass:"material-design-icon__svg",attrs:{fill:e.fillColor,width:e.size,height:e.size,viewBox:"0 0 24 24"}},[i("path",{attrs:{d:"M19 17V19H7V17S7 13 13 13 19 17 19 17M16 8A3 3 0 1 0 13 11A3 3 0 0 0 16 8M19.2 13.06A5.6 5.6 0 0 1 21 17V19H24V17S24 13.55 19.2 13.06M18 5A2.91 2.91 0 0 0 17.11 5.14A5 5 0 0 1 17.11 10.86A2.91 2.91 0 0 0 18 11A3 3 0 0 0 18 5M8 10H5V7H3V10H0V12H3V15H5V12H8Z"}},[e.title?i("title",[e._v(e._s(e.title))]):e._e()])])])},Xb=[],Zb=U(Wb,qb,Xb,!1,null,null);const Kb=Zb.exports,Jb={name:"ShareVariantIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}};var Qb=function(){var e=this,i=e._self._c;return i("span",e._b({staticClass:"material-design-icon share-variant-icon",attrs:{"aria-hidden":e.title?null:"true","aria-label":e.title,role:"img"},on:{click:function(a){return e.$emit("click",a)}}},"span",e.$attrs,!1),[i("svg",{staticClass:"material-design-icon__svg",attrs:{fill:e.fillColor,width:e.size,height:e.size,viewBox:"0 0 24 24"}},[i("path",{attrs:{d:"M18,16.08C17.24,16.08 16.56,16.38 16.04,16.85L8.91,12.7C8.96,12.47 9,12.24 9,12C9,11.76 8.96,11.53 8.91,11.3L15.96,7.19C16.5,7.69 17.21,8 18,8A3,3 0 0,0 21,5A3,3 0 0,0 18,2A3,3 0 0,0 15,5C15,5.24 15.04,5.47 15.09,5.7L8.04,9.81C7.5,9.31 6.79,9 6,9A3,3 0 0,0 3,12A3,3 0 0,0 6,15C6.79,15 7.5,14.69 8.04,14.19L15.16,18.34C15.11,18.55 15.08,18.77 15.08,19C15.08,20.61 16.39,21.91 18,21.91C19.61,21.91 20.92,20.61 20.92,19A2.92,2.92 0 0,0 18,16.08Z"}},[e.title?i("title",[e._v(e._s(e.title))]):e._e()])])])},tw=[],ew=U(Jb,Qb,tw,!1,null,null);const nw=ew.exports,Nr=ln("contacts","isGroupSharingEnabled",!1),iw={name:"SettingsAddressbookSharee",components:{Button:Kt,IconDelete:Ie,IconGroup:hn,IconLoading:ee,IconUser:Ho},props:{addressbook:{type:Object,required:!0},sharee:{type:Object,required:!0}},data(){return{loading:!1}},computed:{writeable(){return this.sharee.writeable},uid(){return this.sharee.id+this.addressbook.id+Math.floor(Math.random()*1e3)}},methods:{async deleteSharee(){if(this.loading)return!1;this.loading=!0;try{await this.$store.dispatch("removeSharee",{addressbook:this.addressbook,uri:this.sharee.uri})}catch(e){console.error(e),J(t("contacts","Unable to delete the share"))}finally{this.loading=!1}},async editSharee(){if(this.loading)return!1;this.loading=!0;try{await this.$store.dispatch("toggleShareeWritable",{addressbook:this.addressbook,uri:this.sharee.uri,writeable:!this.sharee.writeable})}catch(e){console.error(e),J(t("contacts","Unable to change permissions"))}finally{this.loading=!1}}}};var aw=function(){var e=this,i=e._self._c;return i("li",{staticClass:"addressbook-sharee"},[e.loading?i("IconLoading",{attrs:{size:20}}):e.sharee.isGroup&&!e.loading?i("IconGroup"):!e.sharee.isGroup&&!e.loading?i("IconUser"):e._e(),i("span",{staticClass:"addressbook-sharee__identifier",attrs:{title:e.sharee.displayName}},[e._v(" "+e._s(e.sharee.displayName)+" ")]),i("span",{staticClass:"addressbook-sharee__utils"},[i("input",{staticClass:"checkbox",attrs:{id:e.uid,disabled:e.loading,name:"editable",type:"checkbox"},domProps:{checked:e.writeable},on:{change:e.editSharee}}),i("label",{attrs:{for:e.uid,title:e.t("contacts","can edit")}},[e._v(" "+e._s(e.t("contacts","can edit"))+" ")]),i("Button",{class:{"addressbook-sharee__utils--disabled":e.loading},attrs:{href:"#",title:"Delete"},on:{click:e.deleteSharee},scopedSlots:e._u([{key:"icon",fn:function(){return[i("IconDelete",{attrs:{size:20}})]},proxy:!0}])})],1)],1)},ow=[],sw=U(iw,aw,ow,!1,null,"dc0cbef7");const rw=sw.exports;function Dr(e){return decodeURIComponent(e.replace(/\+/g," "))}const cw={name:"SettingsAddressbookShare",components:{NcSelect:zn,addressBookSharee:rw},props:{addressbook:{type:Object,default(){return{}}}},data(){return{isLoading:!1,inputGiven:!1,usersOrGroups:[]}},computed:{placeholder(){return Nr?t("contacts","Share with users or groups"):t("contacts","Share with users")},noResult(){return t("contacts","No users or groups")}},mounted(){document.getElementById("users-groups-search").focus()},methods:{shareAddressbook({user:e,displayName:i,uri:a,isGroup:o}){this.$store.dispatch("shareAddressbook",{addressbook:this.addressbook,user:e,displayName:i,uri:a,isGroup:o})},findSharee:ji(async function(e){if(this.isLoading=!0,this.usersOrGroups=[],e.length>0){const i=await Oi.principalPropertySearchByDisplayname(e);this.usersOrGroups=i.filter(a=>{const o=["INDIVIDUAL"];return Nr&&o.push("GROUP"),o.includes(a.calendarUserType)&&!this.addressbook.shares.some(s=>s.uri===a.principalScheme)}).map(a=>{const o=a.calendarUserType==="GROUP";return{user:Dr(a[o?"groupId":"userId"]),displayName:a.displayname,icon:o?"icon-group":"icon-user",uri:Dr(a.principalScheme),isGroup:o}}),this.isLoading=!1,this.inputGiven=!0}else this.inputGiven=!1,this.isLoading=!1},500)}};var lw=function(){var e=this,i=e._self._c;return i("div",{staticClass:"addressbook-shares"},[i("NcSelect",{class:{showContent:e.inputGiven,"icon-loading":e.isLoading},attrs:{id:"users-groups-search",options:e.usersOrGroups,searchable:!0,"internal-search":!1,"max-height":600,"show-no-results":!0,placeholder:e.placeholder,"user-select":!0,"open-direction":"bottom","track-by":"user",label:"displayName"},on:{search:e.findSharee,input:e.shareAddressbook}}),e.addressbook.shares.length>0?i("ul",{staticClass:"addressbook-shares__list"},e._l(e.addressbook.shares,function(a){return i("address-book-sharee",{key:a.uri,attrs:{sharee:a,addressbook:e.addressbook}})}),1):e._e()],1)},uw=[],dw=U(cw,lw,uw,!1,null,"20508be5");const hw=dw.exports,pw={name:"SettingsAddressbook",components:{ActionButton:qe,ActionCheckbox:Id,ActionInput:Po,ActionLink:pa,Actions:dn,Button:Kt,IconDelete:Ie,IconDownload:_a,IconRename:nc,IconContactPlus:Kb,IconShare:nw,IconLoading:ee,ShareAddressBook:hw},mixins:[cc],props:{addressbook:{type:Object,default(){return{}}}},data(){return{deleteAddressbookLoading:!1,editingName:!1,menuOpen:!1,renameLoading:!1,shareOpen:!1,toggleEnabledLoading:!1}},computed:{enabled(){return this.addressbook.enabled},hasShares(){return this.addressbook.shares.length>0},addressbooks(){return this.$store.getters.getAddressbooks},hasMultipleAddressbooks(){return this.addressbooks.length>1},sharedWithTooltip(){return this.hasShares?n("contacts","Shared with {num} entity","Shared with {num} entities",this.addressbook.shares.length,{num:this.addressbook.shares.length}):""},copyButtonText(){return this.copied?this.copySuccess?t("contacts","Copied"):t("contacts","Cannot copy"):t("contacts","Copy link")},addressbookUrl(){return window.location.origin+this.addressbook.url},contacts(){return Object.values(this.addressbook.contacts)},groups(){const e=this.contacts.flatMap(i=>i.vCard.getAllProperties("categories").map(a=>a.getFirstValue()));return[...new Set(e)]},contactsCount(){return this.contacts.length},groupsCount(){return this.groups.length},principalUrl(){return ac().currentUserPrincipal.principalUrl}},watch:{menuOpen(){this.menuOpen===!1&&(this.editingName=!1)}},mounted(){this.popupItem=this.$el},methods:{closeMenu(){this.menuOpen=!1},toggleMenu(){this.menuOpen=!this.menuOpen},toggleShare(){this.shareOpen=!this.shareOpen},async toggleAddressbookEnabled(){this.toggleEnabledLoading=!0;try{await this.$store.dispatch("toggleAddressbookEnabled",this.addressbook)}catch(e){console.error(e),J(t("contacts","Toggling of address book was not successful"))}finally{this.toggleEnabledLoading=!1}},confirmDeletion(){window.OC.dialogs.confirm(t("contacts","This will delete the address book and every contacts within it"),t("contacts","Delete {addressbook}?",{addressbook:this.addressbook.displayName}),this.deleteAddressbook,!0)},confirmUnshare(){window.OC.dialogs.confirm(t("contacts","This will unshare the address book and every contacts within it"),t("contacts","Unshare {addressbook}?",{addressbook:this.addressbook.displayName}),this.deleteAddressbook,!0)},async deleteAddressbook(e){if(e){this.deleteAddressbookLoading=!0;try{await this.$store.dispatch("deleteAddressbook",this.addressbook)}catch(i){console.error(i),J(t("contacts","Deletion of address book was not successful."))}finally{this.deleteAddressbookLoading=!1}}},renameAddressbook(){this.editingName=!0},async updateAddressbookName(){const e=this.addressbook,i=this.$refs.renameInput.$el.querySelector('input[type="text"]').value;this.renameLoading=!0;try{await this.$store.dispatch("renameAddressbook",{addressbook:e,newName:i})}catch(a){console.error(a),J(t("contacts","Renaming of address book was not successful."))}finally{this.editingName=!1,this.renameLoading=!1,this.menuOpen=!1}}}};var fw=function(){var e=this,i=e._self._c;return i("div",{staticClass:"settings-addressbook-list"},[i("IconContactPlus",{staticClass:"settings-line__icon"}),i("li",{staticClass:"addressbook",class:{"addressbook--disabled":!e.addressbook.enabled}},[i("div",{staticClass:"addressbook__content"},[i("span",{staticClass:"addressbook__name",attrs:{title:e.addressbook.displayName}},[e._v(" "+e._s(e.addressbook.enabled?e.addressbook.displayName:e.t("contacts","{addressbookname} (Disabled)",{addressbookname:e.addressbook.displayName}))+" ")]),e.addressbook.dav.description?i("div",{staticClass:"addressbook__description"},[e._v(" "+e._s(e.addressbook.dav.description)+" ")]):e._e(),e.addressbook.enabled?i("div",{staticClass:"addressbook__count-wrapper"},[i("span",{staticClass:"addressbook__count"},[e._v(e._s(e.n("contacts","%n contact","%n contacts",e.contactsCount)))]),i("span",{staticClass:"addressbook__count"},[e._v("- "+e._s(e.n("contacts","%n group","%n groups",e.groupsCount)))])]):e._e()]),e.addressbook.readOnly?e._e():i("Button",{directives:[{name:"tooltip",rawName:"v-tooltip.top",value:e.sharedWithTooltip,expression:"sharedWithTooltip",modifiers:{top:!0}}],staticClass:"addressbook__share",class:{"addressbook__share--shared":e.hasShares},attrs:{name:e.sharedWithTooltip,href:"#"},on:{click:e.toggleShare},scopedSlots:e._u([{key:"icon",fn:function(){return[i("IconShare",{attrs:{size:20}})]},proxy:!0}],null,!1,165512238)}),i("Actions",{staticClass:"addressbook__menu",attrs:{"menu-align":"right"}},[i("ActionLink",{attrs:{href:e.addressbook.url,icon:e.copyLinkIcon},on:{click:function(a){return a.stopPropagation(),a.preventDefault(),e.copyToClipboard(e.addressbookUrl)}}},[e._v(" "+e._s(e.copyButtonText)+" ")]),i("ActionLink",{attrs:{href:e.addressbook.url+"?export"},scopedSlots:e._u([{key:"icon",fn:function(){return[i("IconDownload",{attrs:{size:20}})]},proxy:!0}])},[e._v(" "+e._s(e.t("contacts","Download"))+" ")]),e.addressbook.writeProps?[e.toggleEnabledLoading?i("ActionButton",{scopedSlots:e._u([{key:"icon",fn:function(){return[i("IconLoading",{attrs:{size:20}})]},proxy:!0}],null,!1,3081367109)},[e._v(" "+e._s(e.t("contacts","Show"))+" ")]):i("ActionCheckbox",{attrs:{checked:e.enabled},on:{change:function(a){return a.stopPropagation(),a.preventDefault(),e.toggleAddressbookEnabled.apply(null,arguments)}}},[e._v(" "+e._s(e.t("contacts","Show"))+" ")])]:e._e(),e.addressbook.readOnly?e._e():[e.editingName?i("ActionInput",{ref:"renameInput",attrs:{disabled:e.renameLoading,value:e.addressbook.displayName},on:{submit:e.updateAddressbookName},scopedSlots:e._u([{key:"icon",fn:function(){return[e.renameLoading?i("IconLoading",{attrs:{size:20}}):e._e(),i("IconRename",{attrs:{size:20}})]},proxy:!0}],null,!1,1193466029)}):i("ActionButton",{on:{click:function(a){return a.stopPropagation(),a.preventDefault(),e.renameAddressbook.apply(null,arguments)}},scopedSlots:e._u([{key:"icon",fn:function(){return[i("IconRename",{attrs:{size:20}})]},proxy:!0}],null,!1,4207163347)},[e._v(" "+e._s(e.t("contacts","Rename"))+" ")])],e.hasMultipleAddressbooks&&e.addressbook.owner!==e.principalUrl&&e.addressbook.owner!=="/remote.php/dav/principals/system/system/"?i("ActionButton",{on:{click:e.confirmUnshare},scopedSlots:e._u([{key:"icon",fn:function(){return[e.deleteAddressbookLoading?i("IconLoading",{attrs:{size:20}}):e._e(),i("IconDelete",{attrs:{size:20}})]},proxy:!0}],null,!1,4278421522)},[e._v(" "+e._s(e.t("contacts","Unshare from me"))+" ")]):e.hasMultipleAddressbooks&&e.addressbook.owner!=="/remote.php/dav/principals/system/system/"?i("ActionButton",{on:{click:e.confirmDeletion},scopedSlots:e._u([{key:"icon",fn:function(){return[e.deleteAddressbookLoading?i("IconLoading",{attrs:{size:20}}):e._e(),i("IconDelete",{attrs:{size:20}})]},proxy:!0}])},[e._v(" "+e._s(e.t("contacts","Delete"))+" ")]):e._e()],2),e.shareOpen&&!e.addressbook.readOnly?i("ShareAddressBook",{attrs:{addressbook:e.addressbook}}):e._e()],1)],1)},mw=[],gw=U(pw,fw,mw,!1,null,"bd27e9c2");const yw=gw.exports,vw={name:"LoadingIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}};var _w=function(){var e=this,i=e._self._c;return i("span",e._b({staticClass:"material-design-icon loading-icon",attrs:{"aria-hidden":e.title?null:"true","aria-label":e.title,role:"img"},on:{click:function(a){return e.$emit("click",a)}}},"span",e.$attrs,!1),[i("svg",{staticClass:"material-design-icon__svg",attrs:{fill:e.fillColor,width:e.size,height:e.size,viewBox:"0 0 24 24"}},[i("path",{attrs:{d:"M12,4V2A10,10 0 0,0 2,12H4A8,8 0 0,1 12,4Z"}},[e.title?i("title",[e._v(e._s(e.title))]):e._e()])])])},bw=[],ww=U(vw,_w,bw,!1,null,null);const Cw=ww.exports,kw={name:"SettingsNewAddressbook",components:{NcTextField:rd,IconAdd:Pn,IconLoading:Cw},data(){return{loading:!1,displayName:"",addressBookRegex:"[^/\\\\]+"}},methods:{addAddressbook(){this.displayName!==""&&(this.loading=!0,this.$store.dispatch("appendAddressbook",{displayName:this.displayName}).then(()=>{this.displayName="",this.loading=!1}).catch(e=>{console.error(e),J(t("contacts","An error occurred, unable to create the address book")),this.loading=!1}))}}};var xw=function(){var e=this,i=e._self._c;return i("div",{staticClass:"new-addressbook-entry"},[e.loading?i("IconLoading",{attrs:{size:20}}):e._e(),i("NcTextField",{staticClass:"new-addressbook",attrs:{value:e.displayName,disabled:e.loading,label:e.t("contacts","Add new address book"),pattern:e.addressBookRegex,"show-trailing-button":!0,"trailing-button-label":e.t("contacts","Add"),"trailing-button-icon":"arrowRight",type:"text",autocomplete:"off",autocorrect:"off",spellcheck:"false"},on:{"update:value":function(a){e.displayName=a},"trailing-button-click":e.addAddressbook}},[i("IconAdd",{attrs:{size:20}})],1)],1)},Sw=[],Mw=U(kw,xw,Sw,!1,null,null);const Aw=Mw.exports,Nw={name:"AlertCircleIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}};var Dw=function(){var e=this,i=e._self._c;return i("span",e._b({staticClass:"material-design-icon alert-circle-icon",attrs:{"aria-hidden":e.title?null:"true","aria-label":e.title,role:"img"},on:{click:function(a){return e.$emit("click",a)}}},"span",e.$attrs,!1),[i("svg",{staticClass:"material-design-icon__svg",attrs:{fill:e.fillColor,width:e.size,height:e.size,viewBox:"0 0 24 24"}},[i("path",{attrs:{d:"M13,13H11V7H13M13,17H11V15H13M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2Z"}},[e.title?i("title",[e._v(e._s(e.title))]):e._e()])])])},Ow=[],Tw=U(Nw,Dw,Ow,!1,null,null);const wl=Tw.exports,Ew=re.CancelToken,Lw=Qr(t("contacts","Choose a vCard file to import")).setMultiSelect(!1).setType(1).allowDirectories(!1).addMimeTypeFilter("text/vcard").build(),Iw={name:"SettingsImportContacts",components:{Button:Kt,Modal:Xe,NcSelect:zn,IconUpload:gl,IconError:wl,IconFolder:yl,IconLoading:ee},data(){return{cancelRequest:()=>{},importDestination:!1,isOpened:!1,loading:!1}},computed:{addressbooks(){return this.$store.getters.getAddressbooks},availableAddressbooks(){return this.addressbooks.filter(e=>!e.readOnly&&e.enabled)},options(){return this.availableAddressbooks.map(e=>({id:e.id,displayName:e.displayName}))},selectedAddressbook:{get(){return this.importDestination?this.availableAddressbooks.find(e=>e.id===this.importDestination.id):this.availableAddressbooks[0]},set(e){this.importDestination=e}},selectedAddressbookOption:{get(){return this.options.find(e=>e.id===this.selectedAddressbook.id)},set(e){this.selectedAddressbook=this.availableAddressbooks.find(i=>i.id===e.id)}},isSingleAddressbook(){return this.options.length===1},isNoAddressbookAvailable(){return this.options.length<1},importState(){return this.$store.getters.getImportState},isImporting(){return this.importState.stage!=="default"}},async mounted(){if(this.$route.name==="import"){const e=this.$route.query.file;await this.processLocalFile(e),this.$router.push({name:"group",params:{selectedGroup:t("contacts","All contacts")}})}},methods:{processFile(e){this.loading=!0,this.$store.dispatch("changeStage","parsing");const i=e.target.files[0],a=new FileReader,o=this.selectedAddressbook;this.$store.dispatch("setAddressbook",o.displayName),a.onload=()=>{this.isOpened=!1,this.$store.dispatch("importContactsIntoAddressbook",{vcf:a.result,addressbook:o}),e.target.value="",this.resetState()},a.readAsText(i)},async processLocalFile(e){console.debug("Importing",e);try{this.cancelRequest();const i=Ew.source();this.cancelRequest=i.cancel;const a=await re.get(Xr(`dav/files/${Zr().uid}`)+Hd(e),{cancelToken:i.token}),o=this.selectedAddressbook;this.$store.dispatch("changeStage","parsing"),this.$store.dispatch("setAddressbook",o.displayName),a.data&&await this.$store.dispatch("importContactsIntoAddressbook",{vcf:a.data,addressbook:o})}catch(i){console.error("Something wrong happened while processing local file",i)}},toggleModal(){this.isOpened=!this.isOpened,this.isOpened||this.cancelRequest()},clickImportInput(){this.$refs["contact-import-input"].click()},async openPicker(){try{this.cancelRequest();const e=await Lw.pick();e&&(this.loading=!0,await this.processLocalFile(e)),this.resetState()}catch(e){this.loading=!1,console.error("Something wrong happened while picking a file",e)}},resetState(){this.cancelRequest=()=>{},this.importDestination=!1,this.isOpened=!1,this.loading=!1}}};var $w=function(){var e=this,i=e._self._c;return i("div",{staticClass:"import-contact"},[e.isNoAddressbookAvailable?i("Button",{staticClass:"button import-contact__button-disabled import-contact__multiselect-label import-contact__multiselect--no-select",attrs:{id:"upload",for:"contact-import"},scopedSlots:e._u([{key:"icon",fn:function(){return[i("IconError",{attrs:{size:20}})]},proxy:!0}])},[e._v(" "+e._s(e.t("contacts","Importing is disabled because there are no address books available"))+" ")]):[i("Button",{staticClass:"import-contact__button-main",on:{click:e.toggleModal},scopedSlots:e._u([{key:"icon",fn:function(){return[i("IconUpload",{attrs:{size:20}})]},proxy:!0}],null,!1,337456192)},[e._v(" "+e._s(e.t("contacts","Import contacts"))+" ")]),e.isOpened?i("Modal",{ref:"modal",staticClass:"import-contact__modal",attrs:{name:e.t("contacts","Import contacts")},on:{close:e.toggleModal}},[i("section",{staticClass:"import-contact__modal-addressbook"},[i("h2",[e._v(e._s(e.t("contacts","Import contacts")))]),e.isSingleAddressbook?e._e():i("NcSelect",{staticClass:"import-contact__modal-addressbook__select",attrs:{id:"select-addressbook","allow-empty":!1,clearable:!1,options:e.options,disabled:e.isSingleAddressbook||e.isImporting,placeholder:e.t("contacts","Contacts"),label:"displayName"},scopedSlots:e._u([{key:"selected-option",fn:function({displayName:a}){return[i("span",[e._v(e._s(e.t("contacts","Import into the {addressbookName} address book",{addressbookName:a})))])]}}],null,!1,3598663645),model:{value:e.selectedAddressbookOption,callback:function(a){e.selectedAddressbookOption=a},expression:"selectedAddressbookOption"}})],1),i("section",{staticClass:"import-contact__modal-pick"},[i("input",{ref:"contact-import-input",staticClass:"hidden-visually",attrs:{id:"contact-import",disabled:e.loading||e.isImporting,type:"file"},on:{change:e.processFile}}),i("Button",{staticClass:"import-contact__button import-contact__button--local",attrs:{disabled:e.loading},on:{click:e.clickImportInput},scopedSlots:e._u([{key:"icon",fn:function(){return[i("IconUpload",{attrs:{size:20}})]},proxy:!0}],null,!1,337456192)},[e._v(" "+e._s(e.t("contacts","Select local file"))+" ")]),i("Button",{staticClass:"import-contact__button import-contact__button--files",attrs:{type:"primary",disabled:e.loading},on:{click:e.openPicker},scopedSlots:e._u([{key:"icon",fn:function(){return[e.loading?i("IconLoading",{attrs:{size:20}}):e._e(),i("IconFolder",{attrs:{size:20}})]},proxy:!0}],null,!1,457734779)},[e._v(" "+e._s(e.t("contacts","Import from files"))+" ")])],1)]):e._e()]],2)},zw=[],Pw=U(Iw,$w,zw,!1,null,"b70bf2ba");const Cl=Pw.exports,Bw={name:"FormatListBulletedSquareIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}};var Rw=function(){var e=this,i=e._self._c;return i("span",e._b({staticClass:"material-design-icon format-list-bulleted-square-icon",attrs:{"aria-hidden":e.title?null:"true","aria-label":e.title,role:"img"},on:{click:function(a){return e.$emit("click",a)}}},"span",e.$attrs,!1),[i("svg",{staticClass:"material-design-icon__svg",attrs:{fill:e.fillColor,width:e.size,height:e.size,viewBox:"0 0 24 24"}},[i("path",{attrs:{d:"M3,4H7V8H3V4M9,5V7H21V5H9M3,10H7V14H3V10M9,11V13H21V11H9M3,16H7V20H3V16M9,17V19H21V17H9"}},[e.title?i("title",[e._v(e._s(e.title))]):e._e()])])])},Hw=[],Yw=U(Bw,Rw,Hw,!1,null,null);const Uw=Yw.exports,Gw={name:"SettingsSortContacts",components:{NcSelect:zn,IconList:Uw},computed:{options(){return[{label:t("contacts","First name"),key:"firstName"},{label:t("contacts","Last name"),key:"lastName"},{label:t("contacts","Phonetic first name"),key:"phoneticFirstName"},{label:t("contacts","Phonetic last name"),key:"phoneticLastName"},{label:t("contacts","Display name"),key:"displayName"},{label:t("contacts","Last modified"),key:"rev"}]},orderKey(){return this.$store.getters.getOrderKey},orderKeyOption(){return this.options.filter(e=>e.key===this.orderKey)[0]}},methods:{sortContacts(e){const i=e&&e.key?e.key:"displayName";this.$store.commit("setOrder",i),this.$store.commit("sortContacts"),localStorage.setItem("orderKey",i)},formatSortByLabel(e){return t("contacts","Sort by {sorting}",{sorting:e.label})}}};var Fw=function(){var e=this,i=e._self._c;return i("div",{staticClass:"sort-contacts"},[i("IconList",{staticClass:"settings-line__icon"}),i("NcSelect",{attrs:{id:"sort-by",value:e.orderKeyOption,searchable:!1,"allow-empty":!1,options:e.options,"custom-label":e.formatSortByLabel,"track-by":"key",label:"label"},on:{input:e.sortContacts}})],1)},Vw=[],jw=U(Gw,Fw,Vw,!1,null,"8819b273");const Ww=jw.exports,qw={name:"ContactsSettings",components:{AppSettingsDialog:cd,AppSettingsSection:Ah,SettingsAddressbook:yw,SettingsNewAddressbook:Aw,SettingsImportContacts:Cl,SettingsSortContacts:Ww,CheckboxRadioSwitch:ha},props:{open:{required:!0,type:Boolean}},data(){return{CONTACTS_SETTINGS:oc,allowSocialSync:ln("contacts","allowSocialSync")!=="no",enableSocialSync:ln("contacts","enableSocialSync")!=="no",enableSocialSyncLoading:!1,showSettings:!1}},computed:{addressbooks(){return this.$store.getters.getAddressbooks}},watch:{showSettings(e){e||this.$emit("update:open",e)},async open(e){e&&await this.onOpen()}},methods:{onClickImport(e){this.$emit("clicked",e)},async toggleSocialSync(){this.enableSocialSync=!this.enableSocialSync,this.enableSocialSyncLoading=!0;let e="yes";this.enableSocialSync?e="yes":e="no";try{await re.put(da("apps/contacts/api/v1/social/config/user/enableSocialSync"),{allow:e})}finally{this.enableSocialSyncLoading=!1}},onLoad(){this.$emit("file-loaded",!1)},async onOpen(){this.showSettings=!0}}};var Xw=function(){var e=this,i=e._self._c;return i("AppSettingsDialog",{attrs:{id:"app-settings-dialog",name:e.t("contacts","Contacts settings"),"show-navigation":!0,open:e.showSettings},on:{"update:open":function(a){e.showSettings=a}}},[i("AppSettingsSection",{attrs:{id:"general-settings",name:e.t("contacts","General settings")}},[i("CheckboxRadioSwitch",{staticClass:"social-sync__checkbox contacts-settings-modal__form__row",attrs:{checked:e.enableSocialSync,loading:e.enableSocialSyncLoading,disabled:e.enableSocialSyncLoading},on:{"update:checked":e.toggleSocialSync}},[i("div",{staticClass:"social-sync__checkbox__label"},[i("span",[e._v(" "+e._s(e.t("contacts","Update avatars from social media"))+" "),i("em",[e._v(e._s(e.t("contacts","(refreshed once per week)")))])])])]),i("SettingsSortContacts",{staticClass:"contacts-settings-modal__form__row"})],1),i("AppSettingsSection",{attrs:{id:"address-books",name:e.t("contacts","Address books")}},[i("div",{staticClass:"contacts-settings-modal__form"},[i("div",{staticClass:"contacts-settings-modal__form__row"},[i("ul",{staticClass:"addressbook-list",attrs:{id:"addressbook-list"}},e._l(e.addressbooks,function(a){return i("SettingsAddressbook",{key:a.id,attrs:{addressbook:a}})}),1)]),i("SettingsNewAddressbook",{staticClass:"contacts-settings-modal__form__row settings-new-addressbook",attrs:{addressbooks:e.addressbooks}}),i("SettingsImportContacts",{staticClass:"contacts-settings-modal__form__row",attrs:{addressbooks:e.addressbooks},on:{clicked:e.onClickImport,"file-loaded":e.onLoad}})],1)])],1)},Zw=[],Kw=U(qw,Xw,Zw,!1,null,"96a6fb67");const Jw=Kw.exports;var kl={exports:{}};(function(e,i){(function(a,o){e.exports=o()})(Eo,function(){return function a(o,s,r){var c=window,l="application/octet-stream",h=r||l,d=o,m=!s&&!r&&d,g=document.createElement("a"),b=function(it){return String(it)},k=c.Blob||c.MozBlob||c.WebKitBlob||b,N=s||"download",L,B;if(k=k.call?k.bind(c):Blob,String(this)==="true"&&(d=[d,h],h=d[0],d=d[1]),m&&m.length<2048&&(N=m.split("/").pop().split("?")[0],g.href=m,g.href.indexOf(m)!==-1)){var z=new XMLHttpRequest;return z.open("GET",m,!0),z.responseType="blob",z.onload=function(it){a(it.target.response,N,l)},setTimeout(function(){z.send()},0),z}if(/^data:([\w+-]+\/[\w+.-]+)?[,;]/.test(d))if(d.length>1024*1024*1.999&&k!==b)d=ut(d),h=d.type||l;else return navigator.msSaveBlob?navigator.msSaveBlob(ut(d),N):lt(d);else if(/([\x80-\xff])/.test(d)){var j=0,V=new Uint8Array(d.length),X=V.length;for(j;j<X;++j)V[j]=d.charCodeAt(j);d=new k([V],{type:h})}L=d instanceof k?d:new k([d],{type:h});function ut(it){var yt=it.split(/[:;,]/),vt=yt[1],_t=yt[2]=="base64"?atob:decodeURIComponent,S=_t(yt.pop()),x=S.length,C=0,y=new Uint8Array(x);for(C;C<x;++C)y[C]=S.charCodeAt(C);return new k([y],{type:vt})}function lt(it,yt){if("download"in g)return g.href=it,g.setAttribute("download",N),g.className="download-js-link",g.innerHTML="downloading...",g.style.display="none",document.body.appendChild(g),setTimeout(function(){g.click(),document.body.removeChild(g),yt===!0&&setTimeout(function(){c.URL.revokeObjectURL(g.href)},250)},66),!0;if(/(Version)\/(\d+)\.(\d+)(?:\.(\d+))?.*Safari\//.test(navigator.userAgent))return/^data:/.test(it)&&(it="data:"+it.replace(/^data:([\w\/\-\+]+)/,l)),window.open(it)||confirm(`Displaying New Document

Use Save As... to download, then click back to return to this page.`)&&(location.href=it),!0;var vt=document.createElement("iframe");document.body.appendChild(vt),!yt&&/^data:/.test(it)&&(it="data:"+it.replace(/^data:([\w\/\-\+]+)/,l)),vt.src=it,setTimeout(function(){document.body.removeChild(vt)},333)}if(navigator.msSaveBlob)return navigator.msSaveBlob(L,N);if(c.URL)lt(c.URL.createObjectURL(L),!0);else{if(typeof L=="string"||L.constructor===b)try{return lt("data:"+h+";base64,"+c.btoa(L))}catch{return lt("data:"+h+","+encodeURIComponent(L))}B=new FileReader,B.onload=function(it){lt(this.result)},B.readAsDataURL(L)}return!0}})})(kl);var Qw=kl.exports;const tC=ua(Qw);var xl;function Y(){return xl.apply(null,arguments)}function eC(e){xl=e}function ce(e){return e instanceof Array||Object.prototype.toString.call(e)==="[object Array]"}function cn(e){return e!=null&&Object.prototype.toString.call(e)==="[object Object]"}function ct(e,i){return Object.prototype.hasOwnProperty.call(e,i)}function as(e){if(Object.getOwnPropertyNames)return Object.getOwnPropertyNames(e).length===0;var i;for(i in e)if(ct(e,i))return!1;return!0}function Gt(e){return e===void 0}function Le(e){return typeof e=="number"||Object.prototype.toString.call(e)==="[object Number]"}function hi(e){return e instanceof Date||Object.prototype.toString.call(e)==="[object Date]"}function Sl(e,i){var a=[],o,s=e.length;for(o=0;o<s;++o)a.push(i(e[o],o));return a}function Fe(e,i){for(var a in i)ct(i,a)&&(e[a]=i[a]);return ct(i,"toString")&&(e.toString=i.toString),ct(i,"valueOf")&&(e.valueOf=i.valueOf),e}function be(e,i,a,o){return Ul(e,i,a,o,!0).utc()}function nC(){return{empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidEra:null,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1,parsedDateParts:[],era:null,meridiem:null,rfc2822:!1,weekdayMismatch:!1}}function K(e){return e._pf==null&&(e._pf=nC()),e._pf}var Co;Array.prototype.some?Co=Array.prototype.some:Co=function(e){var i=Object(this),a=i.length>>>0,o;for(o=0;o<a;o++)if(o in i&&e.call(this,i[o],o,i))return!0;return!1};function os(e){var i=null,a=!1,o=e._d&&!isNaN(e._d.getTime());if(o&&(i=K(e),a=Co.call(i.parsedDateParts,function(s){return s!=null}),o=i.overflow<0&&!i.empty&&!i.invalidEra&&!i.invalidMonth&&!i.invalidWeekday&&!i.weekdayMismatch&&!i.nullInput&&!i.invalidFormat&&!i.userInvalidated&&(!i.meridiem||i.meridiem&&a),e._strict&&(o=o&&i.charsLeftOver===0&&i.unusedTokens.length===0&&i.bigHour===void 0)),Object.isFrozen==null||!Object.isFrozen(e))e._isValid=o;else return o;return e._isValid}function ba(e){var i=be(NaN);return e!=null?Fe(K(i),e):K(i).userInvalidated=!0,i}var Or=Y.momentProperties=[],ja=!1;function ss(e,i){var a,o,s,r=Or.length;if(Gt(i._isAMomentObject)||(e._isAMomentObject=i._isAMomentObject),Gt(i._i)||(e._i=i._i),Gt(i._f)||(e._f=i._f),Gt(i._l)||(e._l=i._l),Gt(i._strict)||(e._strict=i._strict),Gt(i._tzm)||(e._tzm=i._tzm),Gt(i._isUTC)||(e._isUTC=i._isUTC),Gt(i._offset)||(e._offset=i._offset),Gt(i._pf)||(e._pf=K(i)),Gt(i._locale)||(e._locale=i._locale),r>0)for(a=0;a<r;a++)o=Or[a],s=i[o],Gt(s)||(e[o]=s);return e}function pi(e){ss(this,e),this._d=new Date(e._d!=null?e._d.getTime():NaN),this.isValid()||(this._d=new Date(NaN)),ja===!1&&(ja=!0,Y.updateOffset(this),ja=!1)}function le(e){return e instanceof pi||e!=null&&e._isAMomentObject!=null}function Ml(e){Y.suppressDeprecationWarnings===!1&&typeof console<"u"&&console.warn&&console.warn("Deprecation warning: "+e)}function te(e,i){var a=!0;return Fe(function(){if(Y.deprecationHandler!=null&&Y.deprecationHandler(null,e),a){var o=[],s,r,c,l=arguments.length;for(r=0;r<l;r++){if(s="",typeof arguments[r]=="object"){s+=`
[`+r+"] ";for(c in arguments[0])ct(arguments[0],c)&&(s+=c+": "+arguments[0][c]+", ");s=s.slice(0,-2)}else s=arguments[r];o.push(s)}Ml(e+`
Arguments: `+Array.prototype.slice.call(o).join("")+`
`+new Error().stack),a=!1}return i.apply(this,arguments)},i)}var Tr={};function Al(e,i){Y.deprecationHandler!=null&&Y.deprecationHandler(e,i),Tr[e]||(Ml(i),Tr[e]=!0)}Y.suppressDeprecationWarnings=!1,Y.deprecationHandler=null;function we(e){return typeof Function<"u"&&e instanceof Function||Object.prototype.toString.call(e)==="[object Function]"}function iC(e){var i,a;for(a in e)ct(e,a)&&(i=e[a],we(i)?this[a]=i:this["_"+a]=i);this._config=e,this._dayOfMonthOrdinalParseLenient=new RegExp((this._dayOfMonthOrdinalParse.source||this._ordinalParse.source)+"|"+/\d{1,2}/.source)}function ko(e,i){var a=Fe({},e),o;for(o in i)ct(i,o)&&(cn(e[o])&&cn(i[o])?(a[o]={},Fe(a[o],e[o]),Fe(a[o],i[o])):i[o]!=null?a[o]=i[o]:delete a[o]);for(o in e)ct(e,o)&&!ct(i,o)&&cn(e[o])&&(a[o]=Fe({},a[o]));return a}function rs(e){e!=null&&this.set(e)}var xo;Object.keys?xo=Object.keys:xo=function(e){var i,a=[];for(i in e)ct(e,i)&&a.push(i);return a};var aC={sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"};function oC(e,i,a){var o=this._calendar[e]||this._calendar.sameElse;return we(o)?o.call(i,a):o}function ge(e,i,a){var o=""+Math.abs(e),s=i-o.length,r=e>=0;return(r?a?"+":"":"-")+Math.pow(10,Math.max(0,s)).toString().substr(1)+o}var cs=/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|N{1,5}|YYYYYY|YYYYY|YYYY|YY|y{2,4}|yo?|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g,Mi=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,Wa={},An={};function W(e,i,a,o){var s=o;typeof o=="string"&&(s=function(){return this[o]()}),e&&(An[e]=s),i&&(An[i[0]]=function(){return ge(s.apply(this,arguments),i[1],i[2])}),a&&(An[a]=function(){return this.localeData().ordinal(s.apply(this,arguments),e)})}function sC(e){return e.match(/\[[\s\S]/)?e.replace(/^\[|\]$/g,""):e.replace(/\\/g,"")}function rC(e){var i=e.match(cs),a,o;for(a=0,o=i.length;a<o;a++)An[i[a]]?i[a]=An[i[a]]:i[a]=sC(i[a]);return function(s){var r="",c;for(c=0;c<o;c++)r+=we(i[c])?i[c].call(s,e):i[c];return r}}function Hi(e,i){return e.isValid()?(i=Nl(i,e.localeData()),Wa[i]=Wa[i]||rC(i),Wa[i](e)):e.localeData().invalidDate()}function Nl(e,i){var a=5;function o(s){return i.longDateFormat(s)||s}for(Mi.lastIndex=0;a>=0&&Mi.test(e);)e=e.replace(Mi,o),Mi.lastIndex=0,a-=1;return e}var cC={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"};function lC(e){var i=this._longDateFormat[e],a=this._longDateFormat[e.toUpperCase()];return i||!a?i:(this._longDateFormat[e]=a.match(cs).map(function(o){return o==="MMMM"||o==="MM"||o==="DD"||o==="dddd"?o.slice(1):o}).join(""),this._longDateFormat[e])}var uC="Invalid date";function dC(){return this._invalidDate}var hC="%d",pC=/\d{1,2}/;function fC(e){return this._ordinal.replace("%d",e)}var mC={future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",w:"a week",ww:"%d weeks",M:"a month",MM:"%d months",y:"a year",yy:"%d years"};function gC(e,i,a,o){var s=this._relativeTime[a];return we(s)?s(e,i,a,o):s.replace(/%d/i,e)}function yC(e,i){var a=this._relativeTime[e>0?"future":"past"];return we(a)?a(i):a.replace(/%s/i,i)}var Er={D:"date",dates:"date",date:"date",d:"day",days:"day",day:"day",e:"weekday",weekdays:"weekday",weekday:"weekday",E:"isoWeekday",isoweekdays:"isoWeekday",isoweekday:"isoWeekday",DDD:"dayOfYear",dayofyears:"dayOfYear",dayofyear:"dayOfYear",h:"hour",hours:"hour",hour:"hour",ms:"millisecond",milliseconds:"millisecond",millisecond:"millisecond",m:"minute",minutes:"minute",minute:"minute",M:"month",months:"month",month:"month",Q:"quarter",quarters:"quarter",quarter:"quarter",s:"second",seconds:"second",second:"second",gg:"weekYear",weekyears:"weekYear",weekyear:"weekYear",GG:"isoWeekYear",isoweekyears:"isoWeekYear",isoweekyear:"isoWeekYear",w:"week",weeks:"week",week:"week",W:"isoWeek",isoweeks:"isoWeek",isoweek:"isoWeek",y:"year",years:"year",year:"year"};function ne(e){return typeof e=="string"?Er[e]||Er[e.toLowerCase()]:void 0}function ls(e){var i={},a,o;for(o in e)ct(e,o)&&(a=ne(o),a&&(i[a]=e[o]));return i}var vC={date:9,day:11,weekday:11,isoWeekday:11,dayOfYear:4,hour:13,millisecond:16,minute:14,month:8,quarter:7,second:15,weekYear:1,isoWeekYear:1,week:5,isoWeek:5,year:1};function _C(e){var i=[],a;for(a in e)ct(e,a)&&i.push({unit:a,priority:vC[a]});return i.sort(function(o,s){return o.priority-s.priority}),i}var Dl=/\d/,qt=/\d\d/,Ol=/\d{3}/,So=/\d{4}/,na=/[+-]?\d{6}/,bt=/\d\d?/,Lr=/\d\d\d\d?/,Ir=/\d\d\d\d\d\d?/,Yi=/\d{1,3}/,Mo=/\d{1,4}/,ia=/[+-]?\d{1,6}/,Cn=/\d+/,aa=/[+-]?\d+/,bC=/Z|[+-]\d\d:?\d\d/gi,Ui=/Z|[+-]\d\d(?::?\d\d)?/gi,wC=/[+-]?\d+(\.\d{1,3})?/,fi=/[0-9]{0,256}['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFF07\uFF10-\uFFEF]{1,256}|[\u0600-\u06FF\/]{1,256}(\s*?[\u0600-\u06FF]{1,256}){1,2}/i,In=/^[1-9]\d?/,us=/^([1-9]\d|\d)/,oa;oa={};function G(e,i,a){oa[e]=we(i)?i:function(o,s){return o&&a?a:i}}function CC(e,i){return ct(oa,e)?oa[e](i._strict,i._locale):new RegExp(kC(e))}function kC(e){return Oe(e.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(i,a,o,s,r){return a||o||s||r}))}function Oe(e){return e.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}function Qt(e){return e<0?Math.ceil(e)||0:Math.floor(e)}function nt(e){var i=+e,a=0;return i!==0&&isFinite(i)&&(a=Qt(i)),a}var Ao={};function ft(e,i){var a,o=i,s;for(typeof e=="string"&&(e=[e]),Le(i)&&(o=function(r,c){c[i]=nt(r)}),s=e.length,a=0;a<s;a++)Ao[e[a]]=o}function oi(e,i){ft(e,function(a,o,s,r){s._w=s._w||{},i(a,s._w,s,r)})}function xC(e,i,a){i!=null&&ct(Ao,e)&&Ao[e](i,a._a,a,e)}function wa(e){return e%4===0&&e%100!==0||e%400===0}var Ht=0,Ae=1,ye=2,Lt=3,se=4,Ne=5,sn=6,SC=7,MC=8;W("Y",0,0,function(){var e=this.year();return e<=9999?ge(e,4):"+"+e}),W(0,["YY",2],0,function(){return this.year()%100}),W(0,["YYYY",4],0,"year"),W(0,["YYYYY",5],0,"year"),W(0,["YYYYYY",6,!0],0,"year"),G("Y",aa),G("YY",bt,qt),G("YYYY",Mo,So),G("YYYYY",ia,na),G("YYYYYY",ia,na),ft(["YYYYY","YYYYYY"],Ht),ft("YYYY",function(e,i){i[Ht]=e.length===2?Y.parseTwoDigitYear(e):nt(e)}),ft("YY",function(e,i){i[Ht]=Y.parseTwoDigitYear(e)}),ft("Y",function(e,i){i[Ht]=parseInt(e,10)});function ti(e){return wa(e)?366:365}Y.parseTwoDigitYear=function(e){return nt(e)+(nt(e)>68?1900:2e3)};var $r=Rn("FullYear",!0);function AC(){return wa(this.year())}function Rn(e,i){return function(a){return a!=null?(Tl(this,e,a),Y.updateOffset(this,i),this):si(this,e)}}function si(e,i){if(!e.isValid())return NaN;var a=e._d,o=e._isUTC;switch(i){case"Milliseconds":return o?a.getUTCMilliseconds():a.getMilliseconds();case"Seconds":return o?a.getUTCSeconds():a.getSeconds();case"Minutes":return o?a.getUTCMinutes():a.getMinutes();case"Hours":return o?a.getUTCHours():a.getHours();case"Date":return o?a.getUTCDate():a.getDate();case"Day":return o?a.getUTCDay():a.getDay();case"Month":return o?a.getUTCMonth():a.getMonth();case"FullYear":return o?a.getUTCFullYear():a.getFullYear();default:return NaN}}function Tl(e,i,a){var o,s,r,c,l;if(!(!e.isValid()||isNaN(a))){switch(o=e._d,s=e._isUTC,i){case"Milliseconds":return void(s?o.setUTCMilliseconds(a):o.setMilliseconds(a));case"Seconds":return void(s?o.setUTCSeconds(a):o.setSeconds(a));case"Minutes":return void(s?o.setUTCMinutes(a):o.setMinutes(a));case"Hours":return void(s?o.setUTCHours(a):o.setHours(a));case"Date":return void(s?o.setUTCDate(a):o.setDate(a));case"FullYear":break;default:return}r=a,c=e.month(),l=e.date(),l=l===29&&c===1&&!wa(r)?28:l,s?o.setUTCFullYear(r,c,l):o.setFullYear(r,c,l)}}function NC(e){return e=ne(e),we(this[e])?this[e]():this}function DC(e,i){if(typeof e=="object"){e=ls(e);var a=_C(e),o,s=a.length;for(o=0;o<s;o++)this[a[o].unit](e[a[o].unit])}else if(e=ne(e),we(this[e]))return this[e](i);return this}function OC(e,i){return(e%i+i)%i}var At;Array.prototype.indexOf?At=Array.prototype.indexOf:At=function(e){var i;for(i=0;i<this.length;++i)if(this[i]===e)return i;return-1};function ds(e,i){if(isNaN(e)||isNaN(i))return NaN;var a=OC(i,12);return e+=(i-a)/12,a===1?wa(e)?29:28:31-a%7%2}W("M",["MM",2],"Mo",function(){return this.month()+1}),W("MMM",0,0,function(e){return this.localeData().monthsShort(this,e)}),W("MMMM",0,0,function(e){return this.localeData().months(this,e)}),G("M",bt,In),G("MM",bt,qt),G("MMM",function(e,i){return i.monthsShortRegex(e)}),G("MMMM",function(e,i){return i.monthsRegex(e)}),ft(["M","MM"],function(e,i){i[Ae]=nt(e)-1}),ft(["MMM","MMMM"],function(e,i,a,o){var s=a._locale.monthsParse(e,o,a._strict);s!=null?i[Ae]=s:K(a).invalidMonth=e});var TC="January_February_March_April_May_June_July_August_September_October_November_December".split("_"),El="Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),Ll=/D[oD]?(\[[^\[\]]*\]|\s)+MMMM?/,EC=fi,LC=fi;function IC(e,i){return e?ce(this._months)?this._months[e.month()]:this._months[(this._months.isFormat||Ll).test(i)?"format":"standalone"][e.month()]:ce(this._months)?this._months:this._months.standalone}function $C(e,i){return e?ce(this._monthsShort)?this._monthsShort[e.month()]:this._monthsShort[Ll.test(i)?"format":"standalone"][e.month()]:ce(this._monthsShort)?this._monthsShort:this._monthsShort.standalone}function zC(e,i,a){var o,s,r,c=e.toLocaleLowerCase();if(!this._monthsParse)for(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[],o=0;o<12;++o)r=be([2e3,o]),this._shortMonthsParse[o]=this.monthsShort(r,"").toLocaleLowerCase(),this._longMonthsParse[o]=this.months(r,"").toLocaleLowerCase();return a?i==="MMM"?(s=At.call(this._shortMonthsParse,c),s!==-1?s:null):(s=At.call(this._longMonthsParse,c),s!==-1?s:null):i==="MMM"?(s=At.call(this._shortMonthsParse,c),s!==-1?s:(s=At.call(this._longMonthsParse,c),s!==-1?s:null)):(s=At.call(this._longMonthsParse,c),s!==-1?s:(s=At.call(this._shortMonthsParse,c),s!==-1?s:null))}function PC(e,i,a){var o,s,r;if(this._monthsParseExact)return zC.call(this,e,i,a);for(this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]),o=0;o<12;o++)if(s=be([2e3,o]),a&&!this._longMonthsParse[o]&&(this._longMonthsParse[o]=new RegExp("^"+this.months(s,"").replace(".","")+"$","i"),this._shortMonthsParse[o]=new RegExp("^"+this.monthsShort(s,"").replace(".","")+"$","i")),!a&&!this._monthsParse[o]&&(r="^"+this.months(s,"")+"|^"+this.monthsShort(s,""),this._monthsParse[o]=new RegExp(r.replace(".",""),"i")),a&&i==="MMMM"&&this._longMonthsParse[o].test(e)||a&&i==="MMM"&&this._shortMonthsParse[o].test(e)||!a&&this._monthsParse[o].test(e))return o}function Il(e,i){if(!e.isValid())return e;if(typeof i=="string"){if(/^\d+$/.test(i))i=nt(i);else if(i=e.localeData().monthsParse(i),!Le(i))return e}var a=i,o=e.date();return o=o<29?o:Math.min(o,ds(e.year(),a)),e._isUTC?e._d.setUTCMonth(a,o):e._d.setMonth(a,o),e}function zr(e){return e!=null?(Il(this,e),Y.updateOffset(this,!0),this):si(this,"Month")}function BC(){return ds(this.year(),this.month())}function RC(e){return this._monthsParseExact?(ct(this,"_monthsRegex")||$l.call(this),e?this._monthsShortStrictRegex:this._monthsShortRegex):(ct(this,"_monthsShortRegex")||(this._monthsShortRegex=EC),this._monthsShortStrictRegex&&e?this._monthsShortStrictRegex:this._monthsShortRegex)}function HC(e){return this._monthsParseExact?(ct(this,"_monthsRegex")||$l.call(this),e?this._monthsStrictRegex:this._monthsRegex):(ct(this,"_monthsRegex")||(this._monthsRegex=LC),this._monthsStrictRegex&&e?this._monthsStrictRegex:this._monthsRegex)}function $l(){function e(h,d){return d.length-h.length}var i=[],a=[],o=[],s,r,c,l;for(s=0;s<12;s++)r=be([2e3,s]),c=Oe(this.monthsShort(r,"")),l=Oe(this.months(r,"")),i.push(c),a.push(l),o.push(l),o.push(c);i.sort(e),a.sort(e),o.sort(e),this._monthsRegex=new RegExp("^("+o.join("|")+")","i"),this._monthsShortRegex=this._monthsRegex,this._monthsStrictRegex=new RegExp("^("+a.join("|")+")","i"),this._monthsShortStrictRegex=new RegExp("^("+i.join("|")+")","i")}function YC(e,i,a,o,s,r,c){var l;return e<100&&e>=0?(l=new Date(e+400,i,a,o,s,r,c),isFinite(l.getFullYear())&&l.setFullYear(e)):l=new Date(e,i,a,o,s,r,c),l}function ri(e){var i,a;return e<100&&e>=0?(a=Array.prototype.slice.call(arguments),a[0]=e+400,i=new Date(Date.UTC.apply(null,a)),isFinite(i.getUTCFullYear())&&i.setUTCFullYear(e)):i=new Date(Date.UTC.apply(null,arguments)),i}function sa(e,i,a){var o=7+i-a,s=(7+ri(e,0,o).getUTCDay()-i)%7;return-s+o-1}function zl(e,i,a,o,s){var r=(7+a-o)%7,c=sa(e,o,s),l=1+7*(i-1)+r+c,h,d;return l<=0?(h=e-1,d=ti(h)+l):l>ti(e)?(h=e+1,d=l-ti(e)):(h=e,d=l),{year:h,dayOfYear:d}}function ci(e,i,a){var o=sa(e.year(),i,a),s=Math.floor((e.dayOfYear()-o-1)/7)+1,r,c;return s<1?(c=e.year()-1,r=s+Te(c,i,a)):s>Te(e.year(),i,a)?(r=s-Te(e.year(),i,a),c=e.year()+1):(c=e.year(),r=s),{week:r,year:c}}function Te(e,i,a){var o=sa(e,i,a),s=sa(e+1,i,a);return(ti(e)-o+s)/7}W("w",["ww",2],"wo","week"),W("W",["WW",2],"Wo","isoWeek"),G("w",bt,In),G("ww",bt,qt),G("W",bt,In),G("WW",bt,qt),oi(["w","ww","W","WW"],function(e,i,a,o){i[o.substr(0,1)]=nt(e)});function UC(e){return ci(e,this._week.dow,this._week.doy).week}var GC={dow:0,doy:6};function FC(){return this._week.dow}function VC(){return this._week.doy}function jC(e){var i=this.localeData().week(this);return e==null?i:this.add((e-i)*7,"d")}function WC(e){var i=ci(this,1,4).week;return e==null?i:this.add((e-i)*7,"d")}W("d",0,"do","day"),W("dd",0,0,function(e){return this.localeData().weekdaysMin(this,e)}),W("ddd",0,0,function(e){return this.localeData().weekdaysShort(this,e)}),W("dddd",0,0,function(e){return this.localeData().weekdays(this,e)}),W("e",0,0,"weekday"),W("E",0,0,"isoWeekday"),G("d",bt),G("e",bt),G("E",bt),G("dd",function(e,i){return i.weekdaysMinRegex(e)}),G("ddd",function(e,i){return i.weekdaysShortRegex(e)}),G("dddd",function(e,i){return i.weekdaysRegex(e)}),oi(["dd","ddd","dddd"],function(e,i,a,o){var s=a._locale.weekdaysParse(e,o,a._strict);s!=null?i.d=s:K(a).invalidWeekday=e}),oi(["d","e","E"],function(e,i,a,o){i[o]=nt(e)});function qC(e,i){return typeof e!="string"?e:isNaN(e)?(e=i.weekdaysParse(e),typeof e=="number"?e:null):parseInt(e,10)}function XC(e,i){return typeof e=="string"?i.weekdaysParse(e)%7||7:isNaN(e)?null:e}function hs(e,i){return e.slice(i,7).concat(e.slice(0,i))}var ZC="Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),Pl="Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),KC="Su_Mo_Tu_We_Th_Fr_Sa".split("_"),JC=fi,QC=fi,tk=fi;function ek(e,i){var a=ce(this._weekdays)?this._weekdays:this._weekdays[e&&e!==!0&&this._weekdays.isFormat.test(i)?"format":"standalone"];return e===!0?hs(a,this._week.dow):e?a[e.day()]:a}function nk(e){return e===!0?hs(this._weekdaysShort,this._week.dow):e?this._weekdaysShort[e.day()]:this._weekdaysShort}function ik(e){return e===!0?hs(this._weekdaysMin,this._week.dow):e?this._weekdaysMin[e.day()]:this._weekdaysMin}function ak(e,i,a){var o,s,r,c=e.toLocaleLowerCase();if(!this._weekdaysParse)for(this._weekdaysParse=[],this._shortWeekdaysParse=[],this._minWeekdaysParse=[],o=0;o<7;++o)r=be([2e3,1]).day(o),this._minWeekdaysParse[o]=this.weekdaysMin(r,"").toLocaleLowerCase(),this._shortWeekdaysParse[o]=this.weekdaysShort(r,"").toLocaleLowerCase(),this._weekdaysParse[o]=this.weekdays(r,"").toLocaleLowerCase();return a?i==="dddd"?(s=At.call(this._weekdaysParse,c),s!==-1?s:null):i==="ddd"?(s=At.call(this._shortWeekdaysParse,c),s!==-1?s:null):(s=At.call(this._minWeekdaysParse,c),s!==-1?s:null):i==="dddd"?(s=At.call(this._weekdaysParse,c),s!==-1||(s=At.call(this._shortWeekdaysParse,c),s!==-1)?s:(s=At.call(this._minWeekdaysParse,c),s!==-1?s:null)):i==="ddd"?(s=At.call(this._shortWeekdaysParse,c),s!==-1||(s=At.call(this._weekdaysParse,c),s!==-1)?s:(s=At.call(this._minWeekdaysParse,c),s!==-1?s:null)):(s=At.call(this._minWeekdaysParse,c),s!==-1||(s=At.call(this._weekdaysParse,c),s!==-1)?s:(s=At.call(this._shortWeekdaysParse,c),s!==-1?s:null))}function ok(e,i,a){var o,s,r;if(this._weekdaysParseExact)return ak.call(this,e,i,a);for(this._weekdaysParse||(this._weekdaysParse=[],this._minWeekdaysParse=[],this._shortWeekdaysParse=[],this._fullWeekdaysParse=[]),o=0;o<7;o++)if(s=be([2e3,1]).day(o),a&&!this._fullWeekdaysParse[o]&&(this._fullWeekdaysParse[o]=new RegExp("^"+this.weekdays(s,"").replace(".","\\.?")+"$","i"),this._shortWeekdaysParse[o]=new RegExp("^"+this.weekdaysShort(s,"").replace(".","\\.?")+"$","i"),this._minWeekdaysParse[o]=new RegExp("^"+this.weekdaysMin(s,"").replace(".","\\.?")+"$","i")),this._weekdaysParse[o]||(r="^"+this.weekdays(s,"")+"|^"+this.weekdaysShort(s,"")+"|^"+this.weekdaysMin(s,""),this._weekdaysParse[o]=new RegExp(r.replace(".",""),"i")),a&&i==="dddd"&&this._fullWeekdaysParse[o].test(e)||a&&i==="ddd"&&this._shortWeekdaysParse[o].test(e)||a&&i==="dd"&&this._minWeekdaysParse[o].test(e)||!a&&this._weekdaysParse[o].test(e))return o}function sk(e){if(!this.isValid())return e!=null?this:NaN;var i=si(this,"Day");return e!=null?(e=qC(e,this.localeData()),this.add(e-i,"d")):i}function rk(e){if(!this.isValid())return e!=null?this:NaN;var i=(this.day()+7-this.localeData()._week.dow)%7;return e==null?i:this.add(e-i,"d")}function ck(e){if(!this.isValid())return e!=null?this:NaN;if(e!=null){var i=XC(e,this.localeData());return this.day(this.day()%7?i:i-7)}else return this.day()||7}function lk(e){return this._weekdaysParseExact?(ct(this,"_weekdaysRegex")||ps.call(this),e?this._weekdaysStrictRegex:this._weekdaysRegex):(ct(this,"_weekdaysRegex")||(this._weekdaysRegex=JC),this._weekdaysStrictRegex&&e?this._weekdaysStrictRegex:this._weekdaysRegex)}function uk(e){return this._weekdaysParseExact?(ct(this,"_weekdaysRegex")||ps.call(this),e?this._weekdaysShortStrictRegex:this._weekdaysShortRegex):(ct(this,"_weekdaysShortRegex")||(this._weekdaysShortRegex=QC),this._weekdaysShortStrictRegex&&e?this._weekdaysShortStrictRegex:this._weekdaysShortRegex)}function dk(e){return this._weekdaysParseExact?(ct(this,"_weekdaysRegex")||ps.call(this),e?this._weekdaysMinStrictRegex:this._weekdaysMinRegex):(ct(this,"_weekdaysMinRegex")||(this._weekdaysMinRegex=tk),this._weekdaysMinStrictRegex&&e?this._weekdaysMinStrictRegex:this._weekdaysMinRegex)}function ps(){function e(m,g){return g.length-m.length}var i=[],a=[],o=[],s=[],r,c,l,h,d;for(r=0;r<7;r++)c=be([2e3,1]).day(r),l=Oe(this.weekdaysMin(c,"")),h=Oe(this.weekdaysShort(c,"")),d=Oe(this.weekdays(c,"")),i.push(l),a.push(h),o.push(d),s.push(l),s.push(h),s.push(d);i.sort(e),a.sort(e),o.sort(e),s.sort(e),this._weekdaysRegex=new RegExp("^("+s.join("|")+")","i"),this._weekdaysShortRegex=this._weekdaysRegex,this._weekdaysMinRegex=this._weekdaysRegex,this._weekdaysStrictRegex=new RegExp("^("+o.join("|")+")","i"),this._weekdaysShortStrictRegex=new RegExp("^("+a.join("|")+")","i"),this._weekdaysMinStrictRegex=new RegExp("^("+i.join("|")+")","i")}function qa(){return this.hours()%12||12}function hk(){return this.hours()||24}W("H",["HH",2],0,"hour"),W("h",["hh",2],0,qa),W("k",["kk",2],0,hk),W("hmm",0,0,function(){return""+qa.apply(this)+ge(this.minutes(),2)}),W("hmmss",0,0,function(){return""+qa.apply(this)+ge(this.minutes(),2)+ge(this.seconds(),2)}),W("Hmm",0,0,function(){return""+this.hours()+ge(this.minutes(),2)}),W("Hmmss",0,0,function(){return""+this.hours()+ge(this.minutes(),2)+ge(this.seconds(),2)});function Pr(e,i){W(e,0,0,function(){return this.localeData().meridiem(this.hours(),this.minutes(),i)})}Pr("a",!0),Pr("A",!1);function Br(e,i){return i._meridiemParse}G("a",Br),G("A",Br),G("H",bt,us),G("h",bt,In),G("k",bt,In),G("HH",bt,qt),G("hh",bt,qt),G("kk",bt,qt),G("hmm",Lr),G("hmmss",Ir),G("Hmm",Lr),G("Hmmss",Ir),ft(["H","HH"],Lt),ft(["k","kk"],function(e,i,a){var o=nt(e);i[Lt]=o===24?0:o}),ft(["a","A"],function(e,i,a){a._isPm=a._locale.isPM(e),a._meridiem=e}),ft(["h","hh"],function(e,i,a){i[Lt]=nt(e),K(a).bigHour=!0}),ft("hmm",function(e,i,a){var o=e.length-2;i[Lt]=nt(e.substr(0,o)),i[se]=nt(e.substr(o)),K(a).bigHour=!0}),ft("hmmss",function(e,i,a){var o=e.length-4,s=e.length-2;i[Lt]=nt(e.substr(0,o)),i[se]=nt(e.substr(o,2)),i[Ne]=nt(e.substr(s)),K(a).bigHour=!0}),ft("Hmm",function(e,i,a){var o=e.length-2;i[Lt]=nt(e.substr(0,o)),i[se]=nt(e.substr(o))}),ft("Hmmss",function(e,i,a){var o=e.length-4,s=e.length-2;i[Lt]=nt(e.substr(0,o)),i[se]=nt(e.substr(o,2)),i[Ne]=nt(e.substr(s))});function pk(e){return(e+"").toLowerCase().charAt(0)==="p"}var fk=/[ap]\.?m?\.?/i,mk=Rn("Hours",!0);function gk(e,i,a){return e>11?a?"pm":"PM":a?"am":"AM"}var Bl={calendar:aC,longDateFormat:cC,invalidDate:uC,ordinal:hC,dayOfMonthOrdinalParse:pC,relativeTime:mC,months:TC,monthsShort:El,week:GC,weekdays:ZC,weekdaysMin:KC,weekdaysShort:Pl,meridiemParse:fk},kt={},qn={},li;function yk(e,i){var a,o=Math.min(e.length,i.length);for(a=0;a<o;a+=1)if(e[a]!==i[a])return a;return o}function Rr(e){return e&&e.toLowerCase().replace("_","-")}function vk(e){for(var i=0,a,o,s,r;i<e.length;){for(r=Rr(e[i]).split("-"),a=r.length,o=Rr(e[i+1]),o=o?o.split("-"):null;a>0;){if(s=Ca(r.slice(0,a).join("-")),s)return s;if(o&&o.length>=a&&yk(r,o)>=a-1)break;a--}i++}return li}function _k(e){return!!(e&&e.match("^[^/\\\\]*$"))}function Ca(e){var i=null,a;if(kt[e]===void 0&&typeof module<"u"&&module&&module.exports&&_k(e))try{i=li._abbr,a=require,a("./locale/"+e),je(i)}catch{kt[e]=null}return kt[e]}function je(e,i){var a;return e&&(Gt(i)?a=$e(e):a=fs(e,i),a?li=a:typeof console<"u"&&console.warn&&console.warn("Locale "+e+" not found. Did you forget to load it?")),li._abbr}function fs(e,i){if(i!==null){var a,o=Bl;if(i.abbr=e,kt[e]!=null)Al("defineLocaleOverride","use moment.updateLocale(localeName, config) to change an existing locale. moment.defineLocale(localeName, config) should only be used for creating a new locale See http://momentjs.com/guides/#/warnings/define-locale/ for more info."),o=kt[e]._config;else if(i.parentLocale!=null)if(kt[i.parentLocale]!=null)o=kt[i.parentLocale]._config;else if(a=Ca(i.parentLocale),a!=null)o=a._config;else return qn[i.parentLocale]||(qn[i.parentLocale]=[]),qn[i.parentLocale].push({name:e,config:i}),null;return kt[e]=new rs(ko(o,i)),qn[e]&&qn[e].forEach(function(s){fs(s.name,s.config)}),je(e),kt[e]}else return delete kt[e],null}function bk(e,i){if(i!=null){var a,o,s=Bl;kt[e]!=null&&kt[e].parentLocale!=null?kt[e].set(ko(kt[e]._config,i)):(o=Ca(e),o!=null&&(s=o._config),i=ko(s,i),o==null&&(i.abbr=e),a=new rs(i),a.parentLocale=kt[e],kt[e]=a),je(e)}else kt[e]!=null&&(kt[e].parentLocale!=null?(kt[e]=kt[e].parentLocale,e===je()&&je(e)):kt[e]!=null&&delete kt[e]);return kt[e]}function $e(e){var i;if(e&&e._locale&&e._locale._abbr&&(e=e._locale._abbr),!e)return li;if(!ce(e)){if(i=Ca(e),i)return i;e=[e]}return vk(e)}function wk(){return xo(kt)}function ms(e){var i,a=e._a;return a&&K(e).overflow===-2&&(i=a[Ae]<0||a[Ae]>11?Ae:a[ye]<1||a[ye]>ds(a[Ht],a[Ae])?ye:a[Lt]<0||a[Lt]>24||a[Lt]===24&&(a[se]!==0||a[Ne]!==0||a[sn]!==0)?Lt:a[se]<0||a[se]>59?se:a[Ne]<0||a[Ne]>59?Ne:a[sn]<0||a[sn]>999?sn:-1,K(e)._overflowDayOfYear&&(i<Ht||i>ye)&&(i=ye),K(e)._overflowWeeks&&i===-1&&(i=SC),K(e)._overflowWeekday&&i===-1&&(i=MC),K(e).overflow=i),e}var Ck=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,kk=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d|))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,xk=/Z|[+-]\d\d(?::?\d\d)?/,Ai=[["YYYYYY-MM-DD",/[+-]\d{6}-\d\d-\d\d/],["YYYY-MM-DD",/\d{4}-\d\d-\d\d/],["GGGG-[W]WW-E",/\d{4}-W\d\d-\d/],["GGGG-[W]WW",/\d{4}-W\d\d/,!1],["YYYY-DDD",/\d{4}-\d{3}/],["YYYY-MM",/\d{4}-\d\d/,!1],["YYYYYYMMDD",/[+-]\d{10}/],["YYYYMMDD",/\d{8}/],["GGGG[W]WWE",/\d{4}W\d{3}/],["GGGG[W]WW",/\d{4}W\d{2}/,!1],["YYYYDDD",/\d{7}/],["YYYYMM",/\d{6}/,!1],["YYYY",/\d{4}/,!1]],Xa=[["HH:mm:ss.SSSS",/\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss,SSSS",/\d\d:\d\d:\d\d,\d+/],["HH:mm:ss",/\d\d:\d\d:\d\d/],["HH:mm",/\d\d:\d\d/],["HHmmss.SSSS",/\d\d\d\d\d\d\.\d+/],["HHmmss,SSSS",/\d\d\d\d\d\d,\d+/],["HHmmss",/\d\d\d\d\d\d/],["HHmm",/\d\d\d\d/],["HH",/\d\d/]],Sk=/^\/?Date\((-?\d+)/i,Mk=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),?\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|([+-]\d{4}))$/,Ak={UT:0,GMT:0,EDT:-4*60,EST:-5*60,CDT:-5*60,CST:-6*60,MDT:-6*60,MST:-7*60,PDT:-7*60,PST:-8*60};function Rl(e){var i,a,o=e._i,s=Ck.exec(o)||kk.exec(o),r,c,l,h,d=Ai.length,m=Xa.length;if(s){for(K(e).iso=!0,i=0,a=d;i<a;i++)if(Ai[i][1].exec(s[1])){c=Ai[i][0],r=Ai[i][2]!==!1;break}if(c==null){e._isValid=!1;return}if(s[3]){for(i=0,a=m;i<a;i++)if(Xa[i][1].exec(s[3])){l=(s[2]||" ")+Xa[i][0];break}if(l==null){e._isValid=!1;return}}if(!r&&l!=null){e._isValid=!1;return}if(s[4])if(xk.exec(s[4]))h="Z";else{e._isValid=!1;return}e._f=c+(l||"")+(h||""),ys(e)}else e._isValid=!1}function Nk(e,i,a,o,s,r){var c=[Dk(e),El.indexOf(i),parseInt(a,10),parseInt(o,10),parseInt(s,10)];return r&&c.push(parseInt(r,10)),c}function Dk(e){var i=parseInt(e,10);return i<=49?2e3+i:i<=999?1900+i:i}function Ok(e){return e.replace(/\([^()]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").replace(/^\s\s*/,"").replace(/\s\s*$/,"")}function Tk(e,i,a){if(e){var o=Pl.indexOf(e),s=new Date(i[0],i[1],i[2]).getDay();if(o!==s)return K(a).weekdayMismatch=!0,a._isValid=!1,!1}return!0}function Ek(e,i,a){if(e)return Ak[e];if(i)return 0;var o=parseInt(a,10),s=o%100,r=(o-s)/100;return r*60+s}function Hl(e){var i=Mk.exec(Ok(e._i)),a;if(i){if(a=Nk(i[4],i[3],i[2],i[5],i[6],i[7]),!Tk(i[1],a,e))return;e._a=a,e._tzm=Ek(i[8],i[9],i[10]),e._d=ri.apply(null,e._a),e._d.setUTCMinutes(e._d.getUTCMinutes()-e._tzm),K(e).rfc2822=!0}else e._isValid=!1}function Lk(e){var i=Sk.exec(e._i);if(i!==null){e._d=new Date(+i[1]);return}if(Rl(e),e._isValid===!1)delete e._isValid;else return;if(Hl(e),e._isValid===!1)delete e._isValid;else return;e._strict?e._isValid=!1:Y.createFromInputFallback(e)}Y.createFromInputFallback=te("value provided is not in a recognized RFC2822 or ISO format. moment construction falls back to js Date(), which is not reliable across all browsers and versions. Non RFC2822/ISO date formats are discouraged. Please refer to http://momentjs.com/guides/#/warnings/js-date/ for more info.",function(e){e._d=new Date(e._i+(e._useUTC?" UTC":""))});function wn(e,i,a){return e??i??a}function Ik(e){var i=new Date(Y.now());return e._useUTC?[i.getUTCFullYear(),i.getUTCMonth(),i.getUTCDate()]:[i.getFullYear(),i.getMonth(),i.getDate()]}function gs(e){var i,a,o=[],s,r,c;if(!e._d){for(s=Ik(e),e._w&&e._a[ye]==null&&e._a[Ae]==null&&$k(e),e._dayOfYear!=null&&(c=wn(e._a[Ht],s[Ht]),(e._dayOfYear>ti(c)||e._dayOfYear===0)&&(K(e)._overflowDayOfYear=!0),a=ri(c,0,e._dayOfYear),e._a[Ae]=a.getUTCMonth(),e._a[ye]=a.getUTCDate()),i=0;i<3&&e._a[i]==null;++i)e._a[i]=o[i]=s[i];for(;i<7;i++)e._a[i]=o[i]=e._a[i]==null?i===2?1:0:e._a[i];e._a[Lt]===24&&e._a[se]===0&&e._a[Ne]===0&&e._a[sn]===0&&(e._nextDay=!0,e._a[Lt]=0),e._d=(e._useUTC?ri:YC).apply(null,o),r=e._useUTC?e._d.getUTCDay():e._d.getDay(),e._tzm!=null&&e._d.setUTCMinutes(e._d.getUTCMinutes()-e._tzm),e._nextDay&&(e._a[Lt]=24),e._w&&typeof e._w.d<"u"&&e._w.d!==r&&(K(e).weekdayMismatch=!0)}}function $k(e){var i,a,o,s,r,c,l,h,d;i=e._w,i.GG!=null||i.W!=null||i.E!=null?(r=1,c=4,a=wn(i.GG,e._a[Ht],ci(wt(),1,4).year),o=wn(i.W,1),s=wn(i.E,1),(s<1||s>7)&&(h=!0)):(r=e._locale._week.dow,c=e._locale._week.doy,d=ci(wt(),r,c),a=wn(i.gg,e._a[Ht],d.year),o=wn(i.w,d.week),i.d!=null?(s=i.d,(s<0||s>6)&&(h=!0)):i.e!=null?(s=i.e+r,(i.e<0||i.e>6)&&(h=!0)):s=r),o<1||o>Te(a,r,c)?K(e)._overflowWeeks=!0:h!=null?K(e)._overflowWeekday=!0:(l=zl(a,o,s,r,c),e._a[Ht]=l.year,e._dayOfYear=l.dayOfYear)}Y.ISO_8601=function(){},Y.RFC_2822=function(){};function ys(e){if(e._f===Y.ISO_8601){Rl(e);return}if(e._f===Y.RFC_2822){Hl(e);return}e._a=[],K(e).empty=!0;var i=""+e._i,a,o,s,r,c,l=i.length,h=0,d,m;for(s=Nl(e._f,e._locale).match(cs)||[],m=s.length,a=0;a<m;a++)r=s[a],o=(i.match(CC(r,e))||[])[0],o&&(c=i.substr(0,i.indexOf(o)),c.length>0&&K(e).unusedInput.push(c),i=i.slice(i.indexOf(o)+o.length),h+=o.length),An[r]?(o?K(e).empty=!1:K(e).unusedTokens.push(r),xC(r,o,e)):e._strict&&!o&&K(e).unusedTokens.push(r);K(e).charsLeftOver=l-h,i.length>0&&K(e).unusedInput.push(i),e._a[Lt]<=12&&K(e).bigHour===!0&&e._a[Lt]>0&&(K(e).bigHour=void 0),K(e).parsedDateParts=e._a.slice(0),K(e).meridiem=e._meridiem,e._a[Lt]=zk(e._locale,e._a[Lt],e._meridiem),d=K(e).era,d!==null&&(e._a[Ht]=e._locale.erasConvertYear(d,e._a[Ht])),gs(e),ms(e)}function zk(e,i,a){var o;return a==null?i:e.meridiemHour!=null?e.meridiemHour(i,a):(e.isPM!=null&&(o=e.isPM(a),o&&i<12&&(i+=12),!o&&i===12&&(i=0)),i)}function Pk(e){var i,a,o,s,r,c,l=!1,h=e._f.length;if(h===0){K(e).invalidFormat=!0,e._d=new Date(NaN);return}for(s=0;s<h;s++)r=0,c=!1,i=ss({},e),e._useUTC!=null&&(i._useUTC=e._useUTC),i._f=e._f[s],ys(i),os(i)&&(c=!0),r+=K(i).charsLeftOver,r+=K(i).unusedTokens.length*10,K(i).score=r,l?r<o&&(o=r,a=i):(o==null||r<o||c)&&(o=r,a=i,c&&(l=!0));Fe(e,a||i)}function Bk(e){if(!e._d){var i=ls(e._i),a=i.day===void 0?i.date:i.day;e._a=Sl([i.year,i.month,a,i.hour,i.minute,i.second,i.millisecond],function(o){return o&&parseInt(o,10)}),gs(e)}}function Rk(e){var i=new pi(ms(Yl(e)));return i._nextDay&&(i.add(1,"d"),i._nextDay=void 0),i}function Yl(e){var i=e._i,a=e._f;return e._locale=e._locale||$e(e._l),i===null||a===void 0&&i===""?ba({nullInput:!0}):(typeof i=="string"&&(e._i=i=e._locale.preparse(i)),le(i)?new pi(ms(i)):(hi(i)?e._d=i:ce(a)?Pk(e):a?ys(e):Hk(e),os(e)||(e._d=null),e))}function Hk(e){var i=e._i;Gt(i)?e._d=new Date(Y.now()):hi(i)?e._d=new Date(i.valueOf()):typeof i=="string"?Lk(e):ce(i)?(e._a=Sl(i.slice(0),function(a){return parseInt(a,10)}),gs(e)):cn(i)?Bk(e):Le(i)?e._d=new Date(i):Y.createFromInputFallback(e)}function Ul(e,i,a,o,s){var r={};return(i===!0||i===!1)&&(o=i,i=void 0),(a===!0||a===!1)&&(o=a,a=void 0),(cn(e)&&as(e)||ce(e)&&e.length===0)&&(e=void 0),r._isAMomentObject=!0,r._useUTC=r._isUTC=s,r._l=a,r._i=e,r._f=i,r._strict=o,Rk(r)}function wt(e,i,a,o){return Ul(e,i,a,o,!1)}var Yk=te("moment().min is deprecated, use moment.max instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var e=wt.apply(null,arguments);return this.isValid()&&e.isValid()?e<this?this:e:ba()}),Uk=te("moment().max is deprecated, use moment.min instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var e=wt.apply(null,arguments);return this.isValid()&&e.isValid()?e>this?this:e:ba()});function Gl(e,i){var a,o;if(i.length===1&&ce(i[0])&&(i=i[0]),!i.length)return wt();for(a=i[0],o=1;o<i.length;++o)(!i[o].isValid()||i[o][e](a))&&(a=i[o]);return a}function Gk(){var e=[].slice.call(arguments,0);return Gl("isBefore",e)}function Fk(){var e=[].slice.call(arguments,0);return Gl("isAfter",e)}var Vk=function(){return Date.now?Date.now():+new Date},Xn=["year","quarter","month","week","day","hour","minute","second","millisecond"];function jk(e){var i,a=!1,o,s=Xn.length;for(i in e)if(ct(e,i)&&!(At.call(Xn,i)!==-1&&(e[i]==null||!isNaN(e[i]))))return!1;for(o=0;o<s;++o)if(e[Xn[o]]){if(a)return!1;parseFloat(e[Xn[o]])!==nt(e[Xn[o]])&&(a=!0)}return!0}function Wk(){return this._isValid}function qk(){return ue(NaN)}function ka(e){var i=ls(e),a=i.year||0,o=i.quarter||0,s=i.month||0,r=i.week||i.isoWeek||0,c=i.day||0,l=i.hour||0,h=i.minute||0,d=i.second||0,m=i.millisecond||0;this._isValid=jk(i),this._milliseconds=+m+d*1e3+h*6e4+l*1e3*60*60,this._days=+c+r*7,this._months=+s+o*3+a*12,this._data={},this._locale=$e(),this._bubble()}function Gi(e){return e instanceof ka}function No(e){return e<0?Math.round(-1*e)*-1:Math.round(e)}function Xk(e,i,a){var o=Math.min(e.length,i.length),s=Math.abs(e.length-i.length),r=0,c;for(c=0;c<o;c++)nt(e[c])!==nt(i[c])&&r++;return r+s}function Hr(e,i){W(e,0,0,function(){var a=this.utcOffset(),o="+";return a<0&&(a=-a,o="-"),o+ge(~~(a/60),2)+i+ge(~~a%60,2)})}Hr("Z",":"),Hr("ZZ",""),G("Z",Ui),G("ZZ",Ui),ft(["Z","ZZ"],function(e,i,a){a._useUTC=!0,a._tzm=vs(Ui,e)});var Zk=/([\+\-]|\d\d)/gi;function vs(e,i){var a=(i||"").match(e),o,s,r;return a===null?null:(o=a[a.length-1]||[],s=(o+"").match(Zk)||["-",0,0],r=+(s[1]*60)+nt(s[2]),r===0?0:s[0]==="+"?r:-r)}function _s(e,i){var a,o;return i._isUTC?(a=i.clone(),o=(le(e)||hi(e)?e.valueOf():wt(e).valueOf())-a.valueOf(),a._d.setTime(a._d.valueOf()+o),Y.updateOffset(a,!1),a):wt(e).local()}function Do(e){return-Math.round(e._d.getTimezoneOffset())}Y.updateOffset=function(){};function Kk(e,i,a){var o=this._offset||0,s;if(!this.isValid())return e!=null?this:NaN;if(e!=null){if(typeof e=="string"){if(e=vs(Ui,e),e===null)return this}else Math.abs(e)<16&&!a&&(e=e*60);return!this._isUTC&&i&&(s=Do(this)),this._offset=e,this._isUTC=!0,s!=null&&this.add(s,"m"),o!==e&&(!i||this._changeInProgress?Vl(this,ue(e-o,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,Y.updateOffset(this,!0),this._changeInProgress=null)),this}else return this._isUTC?o:Do(this)}function Jk(e,i){return e!=null?(typeof e!="string"&&(e=-e),this.utcOffset(e,i),this):-this.utcOffset()}function Qk(e){return this.utcOffset(0,e)}function t5(e){return this._isUTC&&(this.utcOffset(0,e),this._isUTC=!1,e&&this.subtract(Do(this),"m")),this}function e5(){if(this._tzm!=null)this.utcOffset(this._tzm,!1,!0);else if(typeof this._i=="string"){var e=vs(bC,this._i);e!=null?this.utcOffset(e):this.utcOffset(0,!0)}return this}function n5(e){return this.isValid()?(e=e?wt(e).utcOffset():0,(this.utcOffset()-e)%60===0):!1}function i5(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()}function a5(){if(!Gt(this._isDSTShifted))return this._isDSTShifted;var e={},i;return ss(e,this),e=Yl(e),e._a?(i=e._isUTC?be(e._a):wt(e._a),this._isDSTShifted=this.isValid()&&Xk(e._a,i.toArray())>0):this._isDSTShifted=!1,this._isDSTShifted}function o5(){return this.isValid()?!this._isUTC:!1}function s5(){return this.isValid()?this._isUTC:!1}function Yr(){return this.isValid()?this._isUTC&&this._offset===0:!1}var r5=/^(-|\+)?(?:(\d*)[. ])?(\d+):(\d+)(?::(\d+)(\.\d*)?)?$/,c5=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/;function ue(e,i){var a=e,o=null,s,r,c;return Gi(e)?a={ms:e._milliseconds,d:e._days,M:e._months}:Le(e)||!isNaN(+e)?(a={},i?a[i]=+e:a.milliseconds=+e):(o=r5.exec(e))?(s=o[1]==="-"?-1:1,a={y:0,d:nt(o[ye])*s,h:nt(o[Lt])*s,m:nt(o[se])*s,s:nt(o[Ne])*s,ms:nt(No(o[sn]*1e3))*s}):(o=c5.exec(e))?(s=o[1]==="-"?-1:1,a={y:nn(o[2],s),M:nn(o[3],s),w:nn(o[4],s),d:nn(o[5],s),h:nn(o[6],s),m:nn(o[7],s),s:nn(o[8],s)}):a==null?a={}:typeof a=="object"&&("from"in a||"to"in a)&&(c=l5(wt(a.from),wt(a.to)),a={},a.ms=c.milliseconds,a.M=c.months),r=new ka(a),Gi(e)&&ct(e,"_locale")&&(r._locale=e._locale),Gi(e)&&ct(e,"_isValid")&&(r._isValid=e._isValid),r}ue.fn=ka.prototype,ue.invalid=qk;function nn(e,i){var a=e&&parseFloat(e.replace(",","."));return(isNaN(a)?0:a)*i}function Ur(e,i){var a={};return a.months=i.month()-e.month()+(i.year()-e.year())*12,e.clone().add(a.months,"M").isAfter(i)&&--a.months,a.milliseconds=+i-+e.clone().add(a.months,"M"),a}function l5(e,i){var a;return e.isValid()&&i.isValid()?(i=_s(i,e),e.isBefore(i)?a=Ur(e,i):(a=Ur(i,e),a.milliseconds=-a.milliseconds,a.months=-a.months),a):{milliseconds:0,months:0}}function Fl(e,i){return function(a,o){var s,r;return o!==null&&!isNaN(+o)&&(Al(i,"moment()."+i+"(period, number) is deprecated. Please use moment()."+i+"(number, period). See http://momentjs.com/guides/#/warnings/add-inverted-param/ for more info."),r=a,a=o,o=r),s=ue(a,o),Vl(this,s,e),this}}function Vl(e,i,a,o){var s=i._milliseconds,r=No(i._days),c=No(i._months);e.isValid()&&(o=o??!0,c&&Il(e,si(e,"Month")+c*a),r&&Tl(e,"Date",si(e,"Date")+r*a),s&&e._d.setTime(e._d.valueOf()+s*a),o&&Y.updateOffset(e,r||c))}var u5=Fl(1,"add"),d5=Fl(-1,"subtract");function jl(e){return typeof e=="string"||e instanceof String}function h5(e){return le(e)||hi(e)||jl(e)||Le(e)||f5(e)||p5(e)||e===null||e===void 0}function p5(e){var i=cn(e)&&!as(e),a=!1,o=["years","year","y","months","month","M","days","day","d","dates","date","D","hours","hour","h","minutes","minute","m","seconds","second","s","milliseconds","millisecond","ms"],s,r,c=o.length;for(s=0;s<c;s+=1)r=o[s],a=a||ct(e,r);return i&&a}function f5(e){var i=ce(e),a=!1;return i&&(a=e.filter(function(o){return!Le(o)&&jl(e)}).length===0),i&&a}function m5(e){var i=cn(e)&&!as(e),a=!1,o=["sameDay","nextDay","lastDay","nextWeek","lastWeek","sameElse"],s,r;for(s=0;s<o.length;s+=1)r=o[s],a=a||ct(e,r);return i&&a}function g5(e,i){var a=e.diff(i,"days",!0);return a<-6?"sameElse":a<-1?"lastWeek":a<0?"lastDay":a<1?"sameDay":a<2?"nextDay":a<7?"nextWeek":"sameElse"}function y5(e,i){arguments.length===1&&(arguments[0]?h5(arguments[0])?(e=arguments[0],i=void 0):m5(arguments[0])&&(i=arguments[0],e=void 0):(e=void 0,i=void 0));var a=e||wt(),o=_s(a,this).startOf("day"),s=Y.calendarFormat(this,o)||"sameElse",r=i&&(we(i[s])?i[s].call(this,a):i[s]);return this.format(r||this.localeData().calendar(s,this,wt(a)))}function v5(){return new pi(this)}function _5(e,i){var a=le(e)?e:wt(e);return this.isValid()&&a.isValid()?(i=ne(i)||"millisecond",i==="millisecond"?this.valueOf()>a.valueOf():a.valueOf()<this.clone().startOf(i).valueOf()):!1}function b5(e,i){var a=le(e)?e:wt(e);return this.isValid()&&a.isValid()?(i=ne(i)||"millisecond",i==="millisecond"?this.valueOf()<a.valueOf():this.clone().endOf(i).valueOf()<a.valueOf()):!1}function w5(e,i,a,o){var s=le(e)?e:wt(e),r=le(i)?i:wt(i);return this.isValid()&&s.isValid()&&r.isValid()?(o=o||"()",(o[0]==="("?this.isAfter(s,a):!this.isBefore(s,a))&&(o[1]===")"?this.isBefore(r,a):!this.isAfter(r,a))):!1}function C5(e,i){var a=le(e)?e:wt(e),o;return this.isValid()&&a.isValid()?(i=ne(i)||"millisecond",i==="millisecond"?this.valueOf()===a.valueOf():(o=a.valueOf(),this.clone().startOf(i).valueOf()<=o&&o<=this.clone().endOf(i).valueOf())):!1}function k5(e,i){return this.isSame(e,i)||this.isAfter(e,i)}function x5(e,i){return this.isSame(e,i)||this.isBefore(e,i)}function S5(e,i,a){var o,s,r;if(!this.isValid())return NaN;if(o=_s(e,this),!o.isValid())return NaN;switch(s=(o.utcOffset()-this.utcOffset())*6e4,i=ne(i),i){case"year":r=Fi(this,o)/12;break;case"month":r=Fi(this,o);break;case"quarter":r=Fi(this,o)/3;break;case"second":r=(this-o)/1e3;break;case"minute":r=(this-o)/6e4;break;case"hour":r=(this-o)/36e5;break;case"day":r=(this-o-s)/864e5;break;case"week":r=(this-o-s)/6048e5;break;default:r=this-o}return a?r:Qt(r)}function Fi(e,i){if(e.date()<i.date())return-Fi(i,e);var a=(i.year()-e.year())*12+(i.month()-e.month()),o=e.clone().add(a,"months"),s,r;return i-o<0?(s=e.clone().add(a-1,"months"),r=(i-o)/(o-s)):(s=e.clone().add(a+1,"months"),r=(i-o)/(s-o)),-(a+r)||0}Y.defaultFormat="YYYY-MM-DDTHH:mm:ssZ",Y.defaultFormatUtc="YYYY-MM-DDTHH:mm:ss[Z]";function M5(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")}function A5(e){if(!this.isValid())return null;var i=e!==!0,a=i?this.clone().utc():this;return a.year()<0||a.year()>9999?Hi(a,i?"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYYYY-MM-DD[T]HH:mm:ss.SSSZ"):we(Date.prototype.toISOString)?i?this.toDate().toISOString():new Date(this.valueOf()+this.utcOffset()*60*1e3).toISOString().replace("Z",Hi(a,"Z")):Hi(a,i?"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYY-MM-DD[T]HH:mm:ss.SSSZ")}function N5(){if(!this.isValid())return"moment.invalid(/* "+this._i+" */)";var e="moment",i="",a,o,s,r;return this.isLocal()||(e=this.utcOffset()===0?"moment.utc":"moment.parseZone",i="Z"),a="["+e+'("]',o=0<=this.year()&&this.year()<=9999?"YYYY":"YYYYYY",s="-MM-DD[T]HH:mm:ss.SSS",r=i+'[")]',this.format(a+o+s+r)}function D5(e){e||(e=this.isUtc()?Y.defaultFormatUtc:Y.defaultFormat);var i=Hi(this,e);return this.localeData().postformat(i)}function O5(e,i){return this.isValid()&&(le(e)&&e.isValid()||wt(e).isValid())?ue({to:this,from:e}).locale(this.locale()).humanize(!i):this.localeData().invalidDate()}function T5(e){return this.from(wt(),e)}function E5(e,i){return this.isValid()&&(le(e)&&e.isValid()||wt(e).isValid())?ue({from:this,to:e}).locale(this.locale()).humanize(!i):this.localeData().invalidDate()}function L5(e){return this.to(wt(),e)}function Wl(e){var i;return e===void 0?this._locale._abbr:(i=$e(e),i!=null&&(this._locale=i),this)}var ql=te("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",function(e){return e===void 0?this.localeData():this.locale(e)});function Xl(){return this._locale}var ra=1e3,Nn=60*ra,ca=60*Nn,Zl=(365*400+97)*24*ca;function Dn(e,i){return(e%i+i)%i}function Kl(e,i,a){return e<100&&e>=0?new Date(e+400,i,a)-Zl:new Date(e,i,a).valueOf()}function Jl(e,i,a){return e<100&&e>=0?Date.UTC(e+400,i,a)-Zl:Date.UTC(e,i,a)}function I5(e){var i,a;if(e=ne(e),e===void 0||e==="millisecond"||!this.isValid())return this;switch(a=this._isUTC?Jl:Kl,e){case"year":i=a(this.year(),0,1);break;case"quarter":i=a(this.year(),this.month()-this.month()%3,1);break;case"month":i=a(this.year(),this.month(),1);break;case"week":i=a(this.year(),this.month(),this.date()-this.weekday());break;case"isoWeek":i=a(this.year(),this.month(),this.date()-(this.isoWeekday()-1));break;case"day":case"date":i=a(this.year(),this.month(),this.date());break;case"hour":i=this._d.valueOf(),i-=Dn(i+(this._isUTC?0:this.utcOffset()*Nn),ca);break;case"minute":i=this._d.valueOf(),i-=Dn(i,Nn);break;case"second":i=this._d.valueOf(),i-=Dn(i,ra);break}return this._d.setTime(i),Y.updateOffset(this,!0),this}function $5(e){var i,a;if(e=ne(e),e===void 0||e==="millisecond"||!this.isValid())return this;switch(a=this._isUTC?Jl:Kl,e){case"year":i=a(this.year()+1,0,1)-1;break;case"quarter":i=a(this.year(),this.month()-this.month()%3+3,1)-1;break;case"month":i=a(this.year(),this.month()+1,1)-1;break;case"week":i=a(this.year(),this.month(),this.date()-this.weekday()+7)-1;break;case"isoWeek":i=a(this.year(),this.month(),this.date()-(this.isoWeekday()-1)+7)-1;break;case"day":case"date":i=a(this.year(),this.month(),this.date()+1)-1;break;case"hour":i=this._d.valueOf(),i+=ca-Dn(i+(this._isUTC?0:this.utcOffset()*Nn),ca)-1;break;case"minute":i=this._d.valueOf(),i+=Nn-Dn(i,Nn)-1;break;case"second":i=this._d.valueOf(),i+=ra-Dn(i,ra)-1;break}return this._d.setTime(i),Y.updateOffset(this,!0),this}function z5(){return this._d.valueOf()-(this._offset||0)*6e4}function P5(){return Math.floor(this.valueOf()/1e3)}function B5(){return new Date(this.valueOf())}function R5(){var e=this;return[e.year(),e.month(),e.date(),e.hour(),e.minute(),e.second(),e.millisecond()]}function H5(){var e=this;return{years:e.year(),months:e.month(),date:e.date(),hours:e.hours(),minutes:e.minutes(),seconds:e.seconds(),milliseconds:e.milliseconds()}}function Y5(){return this.isValid()?this.toISOString():null}function U5(){return os(this)}function G5(){return Fe({},K(this))}function F5(){return K(this).overflow}function V5(){return{input:this._i,format:this._f,locale:this._locale,isUTC:this._isUTC,strict:this._strict}}W("N",0,0,"eraAbbr"),W("NN",0,0,"eraAbbr"),W("NNN",0,0,"eraAbbr"),W("NNNN",0,0,"eraName"),W("NNNNN",0,0,"eraNarrow"),W("y",["y",1],"yo","eraYear"),W("y",["yy",2],0,"eraYear"),W("y",["yyy",3],0,"eraYear"),W("y",["yyyy",4],0,"eraYear"),G("N",Za),G("NN",Za),G("NNN",Za),G("NNNN",nx),G("NNNNN",ix),ft(["N","NN","NNN","NNNN","NNNNN"],function(e,i,a,o){var s=a._locale.erasParse(e,o,a._strict);s?K(a).era=s:K(a).invalidEra=e}),G("y",Cn),G("yy",Cn),G("yyy",Cn),G("yyyy",Cn),G("yo",ax),ft(["y","yy","yyy","yyyy"],Ht),ft(["yo"],function(e,i,a,o){var s;a._locale._eraYearOrdinalRegex&&(s=e.match(a._locale._eraYearOrdinalRegex)),a._locale.eraYearOrdinalParse?i[Ht]=a._locale.eraYearOrdinalParse(e,s):i[Ht]=parseInt(e,10)});function j5(e,i){var a,o,s,r=this._eras||$e("en")._eras;for(a=0,o=r.length;a<o;++a){switch(typeof r[a].since){case"string":s=Y(r[a].since).startOf("day"),r[a].since=s.valueOf();break}switch(typeof r[a].until){case"undefined":r[a].until=1/0;break;case"string":s=Y(r[a].until).startOf("day").valueOf(),r[a].until=s.valueOf();break}}return r}function W5(e,i,a){var o,s,r=this.eras(),c,l,h;for(e=e.toUpperCase(),o=0,s=r.length;o<s;++o)if(c=r[o].name.toUpperCase(),l=r[o].abbr.toUpperCase(),h=r[o].narrow.toUpperCase(),a)switch(i){case"N":case"NN":case"NNN":if(l===e)return r[o];break;case"NNNN":if(c===e)return r[o];break;case"NNNNN":if(h===e)return r[o];break}else if([c,l,h].indexOf(e)>=0)return r[o]}function q5(e,i){var a=e.since<=e.until?1:-1;return i===void 0?Y(e.since).year():Y(e.since).year()+(i-e.offset)*a}function X5(){var e,i,a,o=this.localeData().eras();for(e=0,i=o.length;e<i;++e)if(a=this.clone().startOf("day").valueOf(),o[e].since<=a&&a<=o[e].until||o[e].until<=a&&a<=o[e].since)return o[e].name;return""}function Z5(){var e,i,a,o=this.localeData().eras();for(e=0,i=o.length;e<i;++e)if(a=this.clone().startOf("day").valueOf(),o[e].since<=a&&a<=o[e].until||o[e].until<=a&&a<=o[e].since)return o[e].narrow;return""}function K5(){var e,i,a,o=this.localeData().eras();for(e=0,i=o.length;e<i;++e)if(a=this.clone().startOf("day").valueOf(),o[e].since<=a&&a<=o[e].until||o[e].until<=a&&a<=o[e].since)return o[e].abbr;return""}function J5(){var e,i,a,o,s=this.localeData().eras();for(e=0,i=s.length;e<i;++e)if(a=s[e].since<=s[e].until?1:-1,o=this.clone().startOf("day").valueOf(),s[e].since<=o&&o<=s[e].until||s[e].until<=o&&o<=s[e].since)return(this.year()-Y(s[e].since).year())*a+s[e].offset;return this.year()}function Q5(e){return ct(this,"_erasNameRegex")||bs.call(this),e?this._erasNameRegex:this._erasRegex}function tx(e){return ct(this,"_erasAbbrRegex")||bs.call(this),e?this._erasAbbrRegex:this._erasRegex}function ex(e){return ct(this,"_erasNarrowRegex")||bs.call(this),e?this._erasNarrowRegex:this._erasRegex}function Za(e,i){return i.erasAbbrRegex(e)}function nx(e,i){return i.erasNameRegex(e)}function ix(e,i){return i.erasNarrowRegex(e)}function ax(e,i){return i._eraYearOrdinalRegex||Cn}function bs(){var e=[],i=[],a=[],o=[],s,r,c,l,h,d=this.eras();for(s=0,r=d.length;s<r;++s)c=Oe(d[s].name),l=Oe(d[s].abbr),h=Oe(d[s].narrow),i.push(c),e.push(l),a.push(h),o.push(c),o.push(l),o.push(h);this._erasRegex=new RegExp("^("+o.join("|")+")","i"),this._erasNameRegex=new RegExp("^("+i.join("|")+")","i"),this._erasAbbrRegex=new RegExp("^("+e.join("|")+")","i"),this._erasNarrowRegex=new RegExp("^("+a.join("|")+")","i")}W(0,["gg",2],0,function(){return this.weekYear()%100}),W(0,["GG",2],0,function(){return this.isoWeekYear()%100});function Ni(e,i){W(0,[e,e.length],0,i)}Ni("gggg","weekYear"),Ni("ggggg","weekYear"),Ni("GGGG","isoWeekYear"),Ni("GGGGG","isoWeekYear"),G("G",aa),G("g",aa),G("GG",bt,qt),G("gg",bt,qt),G("GGGG",Mo,So),G("gggg",Mo,So),G("GGGGG",ia,na),G("ggggg",ia,na),oi(["gggg","ggggg","GGGG","GGGGG"],function(e,i,a,o){i[o.substr(0,2)]=nt(e)}),oi(["gg","GG"],function(e,i,a,o){i[o]=Y.parseTwoDigitYear(e)});function ox(e){return Ql.call(this,e,this.week(),this.weekday()+this.localeData()._week.dow,this.localeData()._week.dow,this.localeData()._week.doy)}function sx(e){return Ql.call(this,e,this.isoWeek(),this.isoWeekday(),1,4)}function rx(){return Te(this.year(),1,4)}function cx(){return Te(this.isoWeekYear(),1,4)}function lx(){var e=this.localeData()._week;return Te(this.year(),e.dow,e.doy)}function ux(){var e=this.localeData()._week;return Te(this.weekYear(),e.dow,e.doy)}function Ql(e,i,a,o,s){var r;return e==null?ci(this,o,s).year:(r=Te(e,o,s),i>r&&(i=r),dx.call(this,e,i,a,o,s))}function dx(e,i,a,o,s){var r=zl(e,i,a,o,s),c=ri(r.year,0,r.dayOfYear);return this.year(c.getUTCFullYear()),this.month(c.getUTCMonth()),this.date(c.getUTCDate()),this}W("Q",0,"Qo","quarter"),G("Q",Dl),ft("Q",function(e,i){i[Ae]=(nt(e)-1)*3});function hx(e){return e==null?Math.ceil((this.month()+1)/3):this.month((e-1)*3+this.month()%3)}W("D",["DD",2],"Do","date"),G("D",bt,In),G("DD",bt,qt),G("Do",function(e,i){return e?i._dayOfMonthOrdinalParse||i._ordinalParse:i._dayOfMonthOrdinalParseLenient}),ft(["D","DD"],ye),ft("Do",function(e,i){i[ye]=nt(e.match(bt)[0])});var Gr=Rn("Date",!0);W("DDD",["DDDD",3],"DDDo","dayOfYear"),G("DDD",Yi),G("DDDD",Ol),ft(["DDD","DDDD"],function(e,i,a){a._dayOfYear=nt(e)});function px(e){var i=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864e5)+1;return e==null?i:this.add(e-i,"d")}W("m",["mm",2],0,"minute"),G("m",bt,us),G("mm",bt,qt),ft(["m","mm"],se);var fx=Rn("Minutes",!1);W("s",["ss",2],0,"second"),G("s",bt,us),G("ss",bt,qt),ft(["s","ss"],Ne);var mx=Rn("Seconds",!1);W("S",0,0,function(){return~~(this.millisecond()/100)}),W(0,["SS",2],0,function(){return~~(this.millisecond()/10)}),W(0,["SSS",3],0,"millisecond"),W(0,["SSSS",4],0,function(){return this.millisecond()*10}),W(0,["SSSSS",5],0,function(){return this.millisecond()*100}),W(0,["SSSSSS",6],0,function(){return this.millisecond()*1e3}),W(0,["SSSSSSS",7],0,function(){return this.millisecond()*1e4}),W(0,["SSSSSSSS",8],0,function(){return this.millisecond()*1e5}),W(0,["SSSSSSSSS",9],0,function(){return this.millisecond()*1e6}),G("S",Yi,Dl),G("SS",Yi,qt),G("SSS",Yi,Ol);var Ve,tu;for(Ve="SSSS";Ve.length<=9;Ve+="S")G(Ve,Cn);function gx(e,i){i[sn]=nt(("0."+e)*1e3)}for(Ve="S";Ve.length<=9;Ve+="S")ft(Ve,gx);tu=Rn("Milliseconds",!1),W("z",0,0,"zoneAbbr"),W("zz",0,0,"zoneName");function yx(){return this._isUTC?"UTC":""}function vx(){return this._isUTC?"Coordinated Universal Time":""}var P=pi.prototype;P.add=u5,P.calendar=y5,P.clone=v5,P.diff=S5,P.endOf=$5,P.format=D5,P.from=O5,P.fromNow=T5,P.to=E5,P.toNow=L5,P.get=NC,P.invalidAt=F5,P.isAfter=_5,P.isBefore=b5,P.isBetween=w5,P.isSame=C5,P.isSameOrAfter=k5,P.isSameOrBefore=x5,P.isValid=U5,P.lang=ql,P.locale=Wl,P.localeData=Xl,P.max=Uk,P.min=Yk,P.parsingFlags=G5,P.set=DC,P.startOf=I5,P.subtract=d5,P.toArray=R5,P.toObject=H5,P.toDate=B5,P.toISOString=A5,P.inspect=N5,typeof Symbol<"u"&&Symbol.for!=null&&(P[Symbol.for("nodejs.util.inspect.custom")]=function(){return"Moment<"+this.format()+">"}),P.toJSON=Y5,P.toString=M5,P.unix=P5,P.valueOf=z5,P.creationData=V5,P.eraName=X5,P.eraNarrow=Z5,P.eraAbbr=K5,P.eraYear=J5,P.year=$r,P.isLeapYear=AC,P.weekYear=ox,P.isoWeekYear=sx,P.quarter=P.quarters=hx,P.month=zr,P.daysInMonth=BC,P.week=P.weeks=jC,P.isoWeek=P.isoWeeks=WC,P.weeksInYear=lx,P.weeksInWeekYear=ux,P.isoWeeksInYear=rx,P.isoWeeksInISOWeekYear=cx,P.date=Gr,P.day=P.days=sk,P.weekday=rk,P.isoWeekday=ck,P.dayOfYear=px,P.hour=P.hours=mk,P.minute=P.minutes=fx,P.second=P.seconds=mx,P.millisecond=P.milliseconds=tu,P.utcOffset=Kk,P.utc=Qk,P.local=t5,P.parseZone=e5,P.hasAlignedHourOffset=n5,P.isDST=i5,P.isLocal=o5,P.isUtcOffset=s5,P.isUtc=Yr,P.isUTC=Yr,P.zoneAbbr=yx,P.zoneName=vx,P.dates=te("dates accessor is deprecated. Use date instead.",Gr),P.months=te("months accessor is deprecated. Use month instead",zr),P.years=te("years accessor is deprecated. Use year instead",$r),P.zone=te("moment().zone is deprecated, use moment().utcOffset instead. http://momentjs.com/guides/#/warnings/zone/",Jk),P.isDSTShifted=te("isDSTShifted is deprecated. See http://momentjs.com/guides/#/warnings/dst-shifted/ for more information",a5);function _x(e){return wt(e*1e3)}function bx(){return wt.apply(null,arguments).parseZone()}function Fr(e){return e}var rt=rs.prototype;rt.calendar=oC,rt.longDateFormat=lC,rt.invalidDate=dC,rt.ordinal=fC,rt.preparse=Fr,rt.postformat=Fr,rt.relativeTime=gC,rt.pastFuture=yC,rt.set=iC,rt.eras=j5,rt.erasParse=W5,rt.erasConvertYear=q5,rt.erasAbbrRegex=tx,rt.erasNameRegex=Q5,rt.erasNarrowRegex=ex,rt.months=IC,rt.monthsShort=$C,rt.monthsParse=PC,rt.monthsRegex=HC,rt.monthsShortRegex=RC,rt.week=UC,rt.firstDayOfYear=VC,rt.firstDayOfWeek=FC,rt.weekdays=ek,rt.weekdaysMin=ik,rt.weekdaysShort=nk,rt.weekdaysParse=ok,rt.weekdaysRegex=lk,rt.weekdaysShortRegex=uk,rt.weekdaysMinRegex=dk,rt.isPM=pk,rt.meridiem=gk;function la(e,i,a,o){var s=$e(),r=be().set(o,i);return s[a](r,e)}function eu(e,i,a){if(Le(e)&&(i=e,e=void 0),e=e||"",i!=null)return la(e,i,a,"month");var o,s=[];for(o=0;o<12;o++)s[o]=la(e,o,a,"month");return s}function ws(e,i,a,o){typeof e=="boolean"?(Le(i)&&(a=i,i=void 0),i=i||""):(i=e,a=i,e=!1,Le(i)&&(a=i,i=void 0),i=i||"");var s=$e(),r=e?s._week.dow:0,c,l=[];if(a!=null)return la(i,(a+r)%7,o,"day");for(c=0;c<7;c++)l[c]=la(i,(c+r)%7,o,"day");return l}function wx(e,i){return eu(e,i,"months")}function Cx(e,i){return eu(e,i,"monthsShort")}function kx(e,i,a){return ws(e,i,a,"weekdays")}function xx(e,i,a){return ws(e,i,a,"weekdaysShort")}function Sx(e,i,a){return ws(e,i,a,"weekdaysMin")}je("en",{eras:[{since:"0001-01-01",until:1/0,offset:1,name:"Anno Domini",narrow:"AD",abbr:"AD"},{since:"0000-12-31",until:-1/0,offset:1,name:"Before Christ",narrow:"BC",abbr:"BC"}],dayOfMonthOrdinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(e){var i=e%10,a=nt(e%100/10)===1?"th":i===1?"st":i===2?"nd":i===3?"rd":"th";return e+a}}),Y.lang=te("moment.lang is deprecated. Use moment.locale instead.",je),Y.langData=te("moment.langData is deprecated. Use moment.localeData instead.",$e);var xe=Math.abs;function Mx(){var e=this._data;return this._milliseconds=xe(this._milliseconds),this._days=xe(this._days),this._months=xe(this._months),e.milliseconds=xe(e.milliseconds),e.seconds=xe(e.seconds),e.minutes=xe(e.minutes),e.hours=xe(e.hours),e.months=xe(e.months),e.years=xe(e.years),this}function nu(e,i,a,o){var s=ue(i,a);return e._milliseconds+=o*s._milliseconds,e._days+=o*s._days,e._months+=o*s._months,e._bubble()}function Ax(e,i){return nu(this,e,i,1)}function Nx(e,i){return nu(this,e,i,-1)}function Vr(e){return e<0?Math.floor(e):Math.ceil(e)}function Dx(){var e=this._milliseconds,i=this._days,a=this._months,o=this._data,s,r,c,l,h;return e>=0&&i>=0&&a>=0||e<=0&&i<=0&&a<=0||(e+=Vr(Oo(a)+i)*864e5,i=0,a=0),o.milliseconds=e%1e3,s=Qt(e/1e3),o.seconds=s%60,r=Qt(s/60),o.minutes=r%60,c=Qt(r/60),o.hours=c%24,i+=Qt(c/24),h=Qt(iu(i)),a+=h,i-=Vr(Oo(h)),l=Qt(a/12),a%=12,o.days=i,o.months=a,o.years=l,this}function iu(e){return e*4800/146097}function Oo(e){return e*146097/4800}function Ox(e){if(!this.isValid())return NaN;var i,a,o=this._milliseconds;if(e=ne(e),e==="month"||e==="quarter"||e==="year")switch(i=this._days+o/864e5,a=this._months+iu(i),e){case"month":return a;case"quarter":return a/3;case"year":return a/12}else switch(i=this._days+Math.round(Oo(this._months)),e){case"week":return i/7+o/6048e5;case"day":return i+o/864e5;case"hour":return i*24+o/36e5;case"minute":return i*1440+o/6e4;case"second":return i*86400+o/1e3;case"millisecond":return Math.floor(i*864e5)+o;default:throw new Error("Unknown unit "+e)}}function ze(e){return function(){return this.as(e)}}var au=ze("ms"),Tx=ze("s"),Ex=ze("m"),Lx=ze("h"),Ix=ze("d"),$x=ze("w"),zx=ze("M"),Px=ze("Q"),Bx=ze("y"),Rx=au;function Hx(){return ue(this)}function Yx(e){return e=ne(e),this.isValid()?this[e+"s"]():NaN}function pn(e){return function(){return this.isValid()?this._data[e]:NaN}}var Ux=pn("milliseconds"),Gx=pn("seconds"),Fx=pn("minutes"),Vx=pn("hours"),jx=pn("days"),Wx=pn("months"),qx=pn("years");function Xx(){return Qt(this.days()/7)}var Se=Math.round,kn={ss:44,s:45,m:45,h:22,d:26,w:null,M:11};function Zx(e,i,a,o,s){return s.relativeTime(i||1,!!a,e,o)}function Kx(e,i,a,o){var s=ue(e).abs(),r=Se(s.as("s")),c=Se(s.as("m")),l=Se(s.as("h")),h=Se(s.as("d")),d=Se(s.as("M")),m=Se(s.as("w")),g=Se(s.as("y")),b=r<=a.ss&&["s",r]||r<a.s&&["ss",r]||c<=1&&["m"]||c<a.m&&["mm",c]||l<=1&&["h"]||l<a.h&&["hh",l]||h<=1&&["d"]||h<a.d&&["dd",h];return a.w!=null&&(b=b||m<=1&&["w"]||m<a.w&&["ww",m]),b=b||d<=1&&["M"]||d<a.M&&["MM",d]||g<=1&&["y"]||["yy",g],b[2]=i,b[3]=+e>0,b[4]=o,Zx.apply(null,b)}function Jx(e){return e===void 0?Se:typeof e=="function"?(Se=e,!0):!1}function Qx(e,i){return kn[e]===void 0?!1:i===void 0?kn[e]:(kn[e]=i,e==="s"&&(kn.ss=i-1),!0)}function t4(e,i){if(!this.isValid())return this.localeData().invalidDate();var a=!1,o=kn,s,r;return typeof e=="object"&&(i=e,e=!1),typeof e=="boolean"&&(a=e),typeof i=="object"&&(o=Object.assign({},kn,i),i.s!=null&&i.ss==null&&(o.ss=i.s-1)),s=this.localeData(),r=Kx(this,!a,o,s),a&&(r=s.pastFuture(+this,r)),s.postformat(r)}var Ka=Math.abs;function _n(e){return(e>0)-(e<0)||+e}function Di(){if(!this.isValid())return this.localeData().invalidDate();var e=Ka(this._milliseconds)/1e3,i=Ka(this._days),a=Ka(this._months),o,s,r,c,l=this.asSeconds(),h,d,m,g;return l?(o=Qt(e/60),s=Qt(o/60),e%=60,o%=60,r=Qt(a/12),a%=12,c=e?e.toFixed(3).replace(/\.?0+$/,""):"",h=l<0?"-":"",d=_n(this._months)!==_n(l)?"-":"",m=_n(this._days)!==_n(l)?"-":"",g=_n(this._milliseconds)!==_n(l)?"-":"",h+"P"+(r?d+r+"Y":"")+(a?d+a+"M":"")+(i?m+i+"D":"")+(s||o||e?"T":"")+(s?g+s+"H":"")+(o?g+o+"M":"")+(e?g+c+"S":"")):"P0D"}var at=ka.prototype;at.isValid=Wk,at.abs=Mx,at.add=Ax,at.subtract=Nx,at.as=Ox,at.asMilliseconds=au,at.asSeconds=Tx,at.asMinutes=Ex,at.asHours=Lx,at.asDays=Ix,at.asWeeks=$x,at.asMonths=zx,at.asQuarters=Px,at.asYears=Bx,at.valueOf=Rx,at._bubble=Dx,at.clone=Hx,at.get=Yx,at.milliseconds=Ux,at.seconds=Gx,at.minutes=Fx,at.hours=Vx,at.days=jx,at.weeks=Xx,at.months=Wx,at.years=qx,at.humanize=t4,at.toISOString=Di,at.toString=Di,at.toJSON=Di,at.locale=Wl,at.localeData=Xl,at.toIsoString=te("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",Di),at.lang=ql,W("X",0,0,"unix"),W("x",0,0,"valueOf"),G("x",aa),G("X",wC),ft("X",function(e,i,a){a._d=new Date(parseFloat(e)*1e3)}),ft("x",function(e,i,a){a._d=new Date(nt(e))});Y.version="2.30.1",eC(wt),Y.fn=P,Y.min=Gk,Y.max=Fk,Y.now=Vk,Y.utc=be,Y.unix=_x,Y.months=wx,Y.isDate=hi,Y.locale=je,Y.invalid=ba,Y.duration=ue,Y.isMoment=le,Y.weekdays=kx,Y.parseZone=bx,Y.localeData=$e,Y.isDuration=Gi,Y.monthsShort=Cx,Y.weekdaysMin=Sx,Y.defineLocale=fs,Y.updateLocale=bk,Y.locales=wk,Y.weekdaysShort=xx,Y.normalizeUnits=ne,Y.relativeTimeRounding=Jx,Y.relativeTimeThreshold=Qx,Y.calendarFormat=g5,Y.prototype=P,Y.HTML5_FMT={DATETIME_LOCAL:"YYYY-MM-DDTHH:mm",DATETIME_LOCAL_SECONDS:"YYYY-MM-DDTHH:mm:ss",DATETIME_LOCAL_MS:"YYYY-MM-DDTHH:mm:ss.SSS",DATE:"YYYY-MM-DD",TIME:"HH:mm",TIME_SECONDS:"HH:mm:ss",TIME_MS:"HH:mm:ss.SSS",WEEK:"GGGG-[W]WW",MONTH:"YYYY-MM"};const e4=async function(e,i,a){const o=e.groups;o.push(a);let s=o.map(r=>encodeURIComponent(r));return s=s.filter(r=>r!==encodeURIComponent(i)),re.patch(e.url,{},{headers:{"X-PROPERTY":"CATEGORIES","X-PROPERTY-REPLACE":s.join(",")}})},n4=async function(e,i){let a=e.groups.map(o=>encodeURIComponent(o));return a=a.filter(o=>o!==encodeURIComponent(i)),re.patch(e.url,{},{headers:{"X-PROPERTY":"CATEGORIES","X-PROPERTY-REPLACE":a.join(",")}})},i4={name:"FolderEditIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}};var a4=function(){var e=this,i=e._self._c;return i("span",e._b({staticClass:"material-design-icon folder-edit-icon",attrs:{"aria-hidden":e.title?null:"true","aria-label":e.title,role:"img"},on:{click:function(a){return e.$emit("click",a)}}},"span",e.$attrs,!1),[i("svg",{staticClass:"material-design-icon__svg",attrs:{fill:e.fillColor,width:e.size,height:e.size,viewBox:"0 0 24 24"}},[i("path",{attrs:{d:"M19.39 10.74L11 19.13V20H4C2.9 20 2 19.11 2 18V6C2 4.89 2.89 4 4 4H10L12 6H20C21.1 6 22 6.89 22 8V10.15C21.74 10.06 21.46 10 21.17 10C20.5 10 19.87 10.26 19.39 10.74M13 19.96V22H15.04L21.17 15.88L19.13 13.83L13 19.96M22.85 13.47L21.53 12.15C21.33 11.95 21 11.95 20.81 12.15L19.83 13.13L21.87 15.17L22.85 14.19C23.05 14 23.05 13.67 22.85 13.47Z"}},[e.title?i("title",[e._v(e._s(e.title))]):e._e()])])])},o4=[],s4=U(i4,a4,o4,!1,null,null);const r4=s4.exports,c4={name:"GroupNavigationItem",components:{ActionButton:qe,NcCounterBubble:ma,AppNavigationItem:zo,ActionInput:Po,IconContact:hn,IconAdd:Pn,IconDownload:_a,IconEmail:ec,IconRename:r4,IconDelete:Ie,IconLoading:ee},props:{group:{type:Object,required:!0}},data(){return{newGroupName:"",renaming:!1,deleting:!1}},computed:{contacts(){return this.$store.getters.getContacts},isEmpty(){return this.group.contacts.length===0}},methods:{isInGroup(e,i){return e.includes(i)},async onDrop(e,i){try{const a=JSON.parse(e.dataTransfer.getData("item")),o=this.$store.getters.getContact(`${a.uid}~${a.addressbookId}`);if(o&&!this.isInGroup(o.groups,i.id)){const s=this.$store.getters.getContact(`${a.uid}~${a.addressbookId}`);await this.$store.dispatch("updateContactGroups",{groupNames:[...o.groups,i.id],contact:s});const r=Object.assign(Object.create(Object.getPrototypeOf(s)),s);r.groups=[...o.groups,i.id],await this.$store.dispatch("updateContact",r)}}catch(a){console.error(a),J("Tried to drop an invalid contact!")}finally{e.target.closest(".group-drop-area").removeAttribute("drop-active")}},onDragOver(e){e.preventDefault(),e.target.closest(".group-drop-area").setAttribute("drop-active",!0)},onDragLeave(e){e.target.closest(".group-drop-area").removeAttribute("drop-active")},addContactsToGroup(){De("contacts:group:append",this.group.name)},downloadGroup(e){let i={};e.contacts.forEach(o=>{const s=this.contacts[o].addressbook.id;i=Object.assign({[s]:{addressbook:this.contacts[o].addressbook,contacts:[]}},i),i[s].contacts.push(this.contacts[o].url)});const a=Promise.all(Object.keys(i).map(o=>i[o].addressbook.dav.addressbookMultigetExport(i[o].contacts))).then(o=>({groupName:e.name,data:o.map(s=>s.body).join("")}));this.downloadVcardPromise(a)},async downloadVcardPromise(e){e.then(i=>{const a=Y().format("YYYY-MM-DD_HH-mm")+"_"+i.groupName+".vcf",o="data:text/plain;charset=utf-8,"+window.encodeURIComponent(i.data);tC(o,a,"text/vcard")})},emailGroup(e,i="to"){const a=[];e.contacts.filter(o=>this.contacts[o].email!==null).forEach(o=>{const s=this.contacts[o].email.replace(/(.*<)([^>]*)(>)/g,"$2").trim(),r=this.contacts[o].fullName.replace(/[,<>]/g,"").trim();if(s!==""){if(r===null||r===""){a.push(s);return}a.push(`${r} <${s}>`)}}),window.location.href=`mailto:?${i}=${a.map(encodeURIComponent).join(",")}`},async renameGroup(){if(this.newGroupName!==""){this.renaming=!0;for(const e of this.group.contacts){const i=this.$store.getters.getContact(e);if(i===void 0)return;try{await e4(i,this.group.name,this.newGroupName)}catch(a){console.error("Error renaming group",a)}}this.$store.commit("renameGroup",{oldGroupName:this.group.name,newGroupName:this.newGroupName}),this.renaming=!1}},async deleteGroup(){this.deleting=!0;for(const e of this.group.contacts){const i=this.$store.getters.getContact(e);if(i===void 0)return;try{await n4(i,this.group.name)}catch(a){console.error("Error deleting group",a)}}this.$store.commit("removeGroup",this.group.name),this.deleting=!1}}};var l4=function(){var e=this,i=e._self._c;return e.isEmpty?e._e():i("div",{staticClass:"group-drop-area",attrs:{"data-testid":"group-drop-area"},on:{drop:function(a){return e.onDrop(a,e.group)},dragenter:function(a){a.preventDefault()},dragover:function(a){return e.onDragOver(a)},dragleave:function(a){return e.onDragLeave(a)}}},[i("AppNavigationItem",{key:e.group.key,attrs:{to:e.group.router,name:e.group.name},scopedSlots:e._u([{key:"icon",fn:function(){return[i("IconContact",{attrs:{size:20}})]},proxy:!0},{key:"actions",fn:function(){return[i("ActionButton",{attrs:{"close-after-click":!0},on:{click:function(a){return e.addContactsToGroup(e.group)}},scopedSlots:e._u([{key:"icon",fn:function(){return[i("IconAdd",{attrs:{size:20}})]},proxy:!0}],null,!1,2388353250)},[e._v(" "+e._s(e.t("contacts","Add contacts"))+" ")]),i("ActionInput",{attrs:{value:e.newGroupName,disabled:e.renaming},on:{"update:value":function(a){e.newGroupName=a},submit:e.renameGroup},scopedSlots:e._u([{key:"icon",fn:function(){return[e.renaming?i("IconLoading",{attrs:{size:20}}):i("IconRename",{attrs:{size:20}})]},proxy:!0}],null,!1,1268619769)},[e._v(" "+e._s(e.t("contacts","Rename"))+" ")]),i("ActionButton",{attrs:{"close-after-click":!0},on:{click:function(a){return e.downloadGroup(e.group)}},scopedSlots:e._u([{key:"icon",fn:function(){return[i("IconDownload",{attrs:{size:20}})]},proxy:!0}],null,!1,2487097783)},[e._v(" "+e._s(e.t("contacts","Export"))+" ")]),i("ActionButton",{on:{click:function(a){return e.emailGroup(e.group)}},scopedSlots:e._u([{key:"icon",fn:function(){return[i("IconEmail",{attrs:{size:20}})]},proxy:!0}],null,!1,984773423)},[e._v(" "+e._s(e.t("contacts","Send email"))+" ")]),i("ActionButton",{on:{click:function(a){return e.emailGroup(e.group,"bcc")}},scopedSlots:e._u([{key:"icon",fn:function(){return[i("IconEmail",{attrs:{size:20}})]},proxy:!0}],null,!1,984773423)},[e._v(" "+e._s(e.t("contacts","Send email as BCC"))+" ")]),i("ActionButton",{attrs:{disabled:e.deleting},on:{click:e.deleteGroup},scopedSlots:e._u([{key:"icon",fn:function(){return[e.deleting?i("IconLoading",{attrs:{size:20}}):i("IconDelete",{attrs:{size:20}})]},proxy:!0}],null,!1,411196473)},[e._v(" "+e._s(e.t("contacts","Delete"))+" ")])]},proxy:!0},{key:"counter",fn:function(){return[e.group.contacts.length>0?i("NcCounterBubble",[e._v(" "+e._s(e.group.contacts.length)+" ")]):e._e()]},proxy:!0}],null,!1,2818531691)})],1)},u4=[],d4=U(c4,l4,u4,!1,null,"dc69e4be");const h4=d4.exports,p4={name:"NewCircleIntro",components:{CheckboxRadioSwitch:ha,Modal:Xe},props:{loading:{type:Boolean,default:!1}},data(){return{circleName:"",isPersonal:!1,isLocal:!1,CIRCLE_DESC:sc}},computed:{isEmptyName(){return this.circleName.trim()===""},isGlobalScale(){return ld().circles?.status?.globalScale!==!1}},mounted(){this.$nextTick(()=>{this.$refs.input.focus(),this.$refs.input.select()})},methods:{onCancel(){this.$emit("close")},onSubmit(){this.$emit("submit",this.circleName,this.isPersonal,this.isLocal)}}};var f4=function(){var e=this,i=e._self._c;return i("Modal",{attrs:{size:"normal"},on:{close:e.onCancel}},[i("div",{staticClass:"entity-picker"},[i("div",{staticClass:"entity-picker__new"},[i("input",{directives:[{name:"model",rawName:"v-model",value:e.circleName,expression:"circleName"}],ref:"input",staticClass:"entity-picker__new-input",attrs:{placeholder:e.t("contacts","New team name"),type:"text"},domProps:{value:e.circleName},on:{keypress:function(a){return!a.type.indexOf("key")&&e._k(a.keyCode,"enter",13,a.key,"Enter")?null:e.onSubmit.apply(null,arguments)},input:function(a){a.target.composing||(e.circleName=a.target.value)}}})]),i("div",{staticClass:"entity-picker__content"},[i("p",[e._v(" "+e._s(e.CIRCLE_DESC))]),i("br"),e._e(),e.isGlobalScale?[i("CheckboxRadioSwitch",{attrs:{checked:e.isLocal,disabled:e.loading!==!1},on:{"update:checked":function(a){e.isLocal=a}}},[e._v(" "+e._s(e.t("contacts","Local team"))+" ")]),i("p",[e._v(" "+e._s(e.t("contacts","This team will not be shared with the other instances of the global scale"))+" ")])]:e._e()],2),i("div",{staticClass:"entity-picker__navigation"},[i("button",{staticClass:"navigation__button-left",attrs:{disabled:e.loading},on:{click:e.onCancel}},[e._v(" "+e._s(e.t("contacts","Cancel"))+" ")]),i("button",{staticClass:"navigation__button-right primary",attrs:{disabled:e.isEmptyName||e.loading},on:{click:e.onSubmit}},[e._v(" "+e._s(e.t("contacts","Create team"))+" ")])])])])},m4=[],g4=U(p4,f4,m4,!1,null,"7a3f4598");const y4=g4.exports,v4=ln("contacts","isContactsInteractionEnabled",!1),_4={name:"IconRecentlyContacted",props:{title:{type:String,default:""},size:{type:Number,default:20},fillColor:{type:String,default:"currentColor"}}};var b4=function(e,i){return e("span",i._g(i._b({staticClass:"material-design-icon icon-recently-contacted",class:[i.data.class,i.data.staticClass],attrs:{"aria-hidden":!i.props.title,"aria-label":i.props.title,role:"img"}},"span",i.data.attrs,!1),i.listeners),[e("svg",{staticClass:"material-design-icon__svg",attrs:{fill:i.props.fillColor,width:i.props.size,height:i.props.size,viewBox:"0 0 16 16"}},[e("path",{attrs:{d:"M0 0h24v24H0V0z",fill:"none"}}),e("path",{attrs:{d:"M14 3v10h1V3zM12 13h1V3h-1zM1.7 3a.7.7 0 00-.7.7v8.6c0 .4.3.7.7.7h8.6c.4 0 .7-.3.7-.7V3.7a.7.7 0 00-.7-.7zM6 5a1.6 1.6 0 010 3.2A1.6 1.6 0 016 5zm0 4.4c1 0 3.2.6 3.2 1.6v.6H2.8V11c0-1 2.1-1.6 3.2-1.6z"}})])])},w4=[],C4=U(_4,b4,w4,!0,null,null);const k4=C4.exports,x4={name:"RootNavigation",components:{ActionInput:Po,ActionText:Io,NcActionButton:qe,AppNavigation:yh,NcCounterBubble:ma,AppNavigationItem:zo,AppNavigationCaption:Ch,CircleNavigationItem:jb,Cog:Go,ContactsSettings:Jw,GroupNavigationItem:h4,IconContact:hn,IconUser:Ho,IconAdd:Pn,IconError:wl,IconLoading:ee,IconRecentlyContacted:k4,NewCircleIntro:y4},mixins:[ui],props:{loading:{type:Boolean,default:!0},contactsList:{type:Array,required:!0}},data(){return{CIRCLE_DESC:sc,CONTACTS_SETTINGS:oc,ELLIPSIS_COUNT:La,GROUP_ALL_CONTACTS:Ti,CHART_ALL_CONTACTS:$d,GROUP_NO_GROUP_CONTACTS:Ei,GROUP_RECENTLY_CONTACTED:Ia,isNewGroupMenuOpen:!1,createGroupError:null,isNewCircleModalOpen:!1,createCircleLoading:!1,createCircleError:null,isCirclesEnabled:eo,isContactsInteractionEnabled:v4,collapsedGroups:!0,collapsedCircles:!0,showSettings:!1}},computed:{circles(){return this.$store.getters.getCircles},contacts(){return this.$store.getters.getContacts},groups(){return this.$store.getters.getGroups},sortedContacts(){return this.$store.getters.getSortedContacts},ungroupedContacts(){return this.sortedContacts.filter(e=>this.contacts[e.key].groups&&this.contacts[e.key].groups.length===0)},existChart(){return!!Object.keys(this.contacts).filter(e=>this.contacts[e].managersName).length},groupsMenu(){const e=this.groups.map(a=>Object.assign({},a,{id:a.name.replace(" ","_"),key:a.name.replace(" ","_"),router:{name:"group",params:{selectedGroup:a.name}},toString:()=>a.name}));e.sort((a,o)=>wo(a.toString(),o.toString(),{caseInsensitive:!0}));const i=e.findIndex(a=>a.name===Ia);return i>=0&&e.splice(i,1),e},ellipsisGroupsMenu(){return this.isCirclesEnabled&&this.collapsedGroups?this.groupsMenu.slice(0,La):this.groupsMenu},circlesMenu(){const e=this.circles||[];return e.sort((i,a)=>i?.initiator?.level!==a?.initiator?.level&&i?.initiator?.level&&a?.initiator?.level?a.initiator.level-i.initiator.level:i.initiator&&!a.initiator?-1:!i.initiator&&a.initiator?1:wo(i.toString(),a.toString(),{caseInsensitive:!0})),e},ellipsisCirclesMenu(){return this.collapsedCircles?this.circlesMenu.slice(0,La):this.circlesMenu},recentlyContactedContacts(){return this.groups.find(e=>e.name===Ia)},collapseGroupsTitle(){return this.collapsedGroups?t("contacts","Show all groups"):t("contacts","Collapse groups")},collapseCirclesTitle(){return this.collapsedCircles?t("contacts","Show all teams"):t("contacts","Collapse teams")}},methods:{toggleNewGroupMenu(){this.isNewGroupMenuOpen=!this.isNewGroupMenuOpen},createNewGroup(e){const i=e.target.querySelector("input[type=text]").value.trim();if(i.length===0){J(t("contacts","Group name cannot be empty"));return}if(this.logger.debug("Creating new group",{groupName:i}),this.groups.find(a=>a.name===i)){this.createGroupError=t("contacts","This group already exists"),De("contacts:group:append",this.groups.find(a=>a.name===i).name);return}this.createGroupError=null,this.logger.debug("Created new local group",{groupName:i});try{this.$store.dispatch("addGroup",i),this.isNewGroupMenuOpen=!1,De("contacts:group:append",i)}catch{J(t("contacts","An error occurred while creating the group"))}},onToggleGroups(){this.collapsedGroups=!this.collapsedGroups},onToggleCircles(){this.collapsedCircles=!this.collapsedCircles},toggleNewCircleModal(){this.isNewCircleModalOpen=!0},async createNewCircle(e,i,a){if(this.logger.debug("Creating new team",{circleName:e}),this.createCircleLoading=!0,this.circles.find(o=>o.name===e)){this.createCircleError=t("contacts","This team already exists");return}this.createCircleError=null;try{const o=await this.$store.dispatch("createCircle",{circleName:e,isPersonal:i,isLocal:a});this.closeNewCircleIntro(),this.$router.push({name:"circle",params:{selectedCircle:o.id}})}catch{J(t("contacts","An error happened during the creation of the team"))}finally{this.createCircleLoading=!1}},closeNewCircleIntro(){this.isNewCircleModalOpen=!1},showContactsSettings(){this.showSettings=!0}}};var S4=function(){var e=this,i=e._self._c;return i("AppNavigation",{scopedSlots:e._u([{key:"icon",fn:function(){return[e.loading?i("IconLoading",{attrs:{size:20}}):e._e()]},proxy:!0},{key:"search",fn:function(){return[i("header",{staticClass:"header"},[e._t("default")],2)]},proxy:!0},{key:"list",fn:function(){return[i("AppNavigationItem",{attrs:{id:"everyone",name:e.GROUP_ALL_CONTACTS,to:{name:"group",params:{selectedGroup:e.GROUP_ALL_CONTACTS}}},scopedSlots:e._u([{key:"icon",fn:function(){return[i("IconContact",{attrs:{size:20}})]},proxy:!0},{key:"counter",fn:function(){return[e.sortedContacts.length?i("NcCounterBubble",[e._v(" "+e._s(e.sortedContacts.length)+" ")]):e._e()]},proxy:!0}])}),e.existChart?i("AppNavigationItem",{attrs:{id:"chart",name:e.CHART_ALL_CONTACTS,to:{name:"chart",params:{selectedChart:e.GROUP_ALL_CONTACTS}},icon:"icon-category-monitoring"}}):e._e(),e.ungroupedContacts.length>0?i("AppNavigationItem",{attrs:{id:"notgrouped",name:e.GROUP_NO_GROUP_CONTACTS,to:{name:"group",params:{selectedGroup:e.GROUP_NO_GROUP_CONTACTS}}},scopedSlots:e._u([{key:"icon",fn:function(){return[i("IconUser",{attrs:{size:20}})]},proxy:!0},{key:"counter",fn:function(){return[e.ungroupedContacts.length?i("NcCounterBubble",[e._v(" "+e._s(e.ungroupedContacts.length)+" ")]):e._e()]},proxy:!0}],null,!1,754420496)}):e._e(),e.isContactsInteractionEnabled&&e.recentlyContactedContacts&&e.recentlyContactedContacts.contacts.length>0?i("AppNavigationItem",{attrs:{id:"recentlycontacted",name:e.GROUP_RECENTLY_CONTACTED,to:{name:"group",params:{selectedGroup:e.GROUP_RECENTLY_CONTACTED}}},scopedSlots:e._u([{key:"icon",fn:function(){return[i("IconRecentlyContacted",{attrs:{size:20}})]},proxy:!0},{key:"counter",fn:function(){return[e.recentlyContactedContacts.contacts.length?i("NcCounterBubble",[e._v(" "+e._s(e.recentlyContactedContacts.contacts.length)+" ")]):e._e()]},proxy:!0}],null,!1,1951174078)}):e._e(),i("AppNavigationCaption",{attrs:{id:"newgroup","force-menu":!0,"menu-open":e.isNewGroupMenuOpen,name:e.t("contacts","Contact groups")},on:{"update:menuOpen":function(a){e.isNewGroupMenuOpen=a},"update:menu-open":function(a){e.isNewGroupMenuOpen=a},click:function(a){return a.preventDefault(),a.stopPropagation(),e.toggleNewGroupMenu.apply(null,arguments)}},scopedSlots:e._u([{key:"actionsTriggerIcon",fn:function(){return[i("IconAdd",{attrs:{size:20}})]},proxy:!0},{key:"actions",fn:function(){return[i("ActionText",{directives:[{name:"show",rawName:"v-show",value:e.isNewGroupMenuOpen,expression:"isNewGroupMenuOpen"}],scopedSlots:e._u([{key:"icon",fn:function(){return[e.createGroupError?i("IconError",{attrs:{size:20}}):e.createGroupError?e._e():i("IconContact",{attrs:{size:20}})]},proxy:!0}])},[e._v(" "+e._s(e.createGroupError?e.createGroupError:e.t("contacts","Create a new contact group"))+" ")]),i("ActionInput",{directives:[{name:"show",rawName:"v-show",value:e.isNewGroupMenuOpen,expression:"isNewGroupMenuOpen"}],attrs:{icon:"",placeholder:e.t("contacts","Contact group name")},on:{submit:function(a){return a.preventDefault(),a.stopPropagation(),e.createNewGroup.apply(null,arguments)}}})]},proxy:!0}])}),e._l(e.ellipsisGroupsMenu,function(a){return i("GroupNavigationItem",{key:a.key,attrs:{group:a}})}),e.isCirclesEnabled?[e.groupsMenu.length>e.ELLIPSIS_COUNT?i("AppNavigationItem",{staticClass:"app-navigation__collapse",attrs:{name:e.collapseGroupsTitle,icon:""},on:{click:e.onToggleGroups}}):e._e(),i("AppNavigationCaption",{attrs:{id:"newcircle",name:e.t("contacts","Teams")},scopedSlots:e._u([{key:"actions",fn:function(){return[i("NcActionButton",{on:{click:e.toggleNewCircleModal},scopedSlots:e._u([{key:"icon",fn:function(){return[i("IconAdd",{attrs:{size:20}})]},proxy:!0}],null,!1,2388353250)},[e._v(" "+e._s(e.t("contacts","Create a new team"))+" ")])]},proxy:!0}],null,!1,640863801)}),e.isNewCircleModalOpen?i("NewCircleIntro",{attrs:{loading:e.createCircleLoading},on:{close:e.closeNewCircleIntro,submit:e.createNewCircle}}):e._e(),e.circlesMenu.length>0?[e._l(e.ellipsisCirclesMenu,function(a){return i("CircleNavigationItem",{key:a.key,attrs:{circle:a}})}),e.circlesMenu.length>e.ELLIPSIS_COUNT?i("AppNavigationItem",{staticClass:"app-navigation__collapse",attrs:{name:e.collapseCirclesTitle,icon:""},on:{click:e.onToggleCircles}}):e._e()]:e._e(),i("p",{staticClass:"app-navigation__circle-desc"},[e._v(" "+e._s(e.CIRCLE_DESC)+" ")])]:e._e()]},proxy:!0},{key:"footer",fn:function(){return[i("div",{staticClass:"contacts-settings"},[i("AppNavigationItem",{attrs:{"aria-label":e.t("contacts","Open the contacts app settings"),name:e.CONTACTS_SETTINGS},on:{click:e.showContactsSettings}},[i("Cog",{attrs:{slot:"icon",size:20},slot:"icon"})],1)],1)]},proxy:!0}],null,!0)},[i("ContactsSettings",{attrs:{open:e.showSettings},on:{"update:open":function(a){e.showSettings=a}}})],1)},M4=[],A4=U(x4,S4,M4,!1,null,"76fa343d");const N4=A4.exports,D4={name:"Contacts",components:{Button:Kt,CircleContent:Hf,ChartContent:uv,ContactsContent:sb,ContactsPicker:wb,Content:ud,ImportView:Mb,IconAdd:Pn,Modal:Xe,RootNavigation:N4,SettingsImportContacts:Cl},mixins:[fa],props:{selectedCircle:{type:String,default:void 0},selectedGroup:{type:String,default:void 0},selectedContact:{type:String,default:void 0},selectedChart:{type:String,default:void 0}},data(){return{appName:jr,loadingCircles:eo,loadingContacts:!0}},computed:{addressbooks(){return this.$store.getters.getAddressbooks},contacts(){return this.$store.getters.getContacts},sortedContacts(){return this.$store.getters.getSortedContacts},groups(){return this.$store.getters.getGroups},circles(){return this.$store.getters.getCircles},orderKey(){return this.$store.getters.getOrderKey},importState(){return this.$store.getters.getImportState},isEmptyGroup(){return this.contactsList.length===0},isChartView(){return!!this.selectedChart},isImporting(){return this.importState.stage!=="default"},isImportDone(){return this.importState.stage==="done"},defaultAddressbook(){return this.addressbooks.find(e=>!e.readOnly&&e.enabled)},contactsList(){if(this.selectedGroup===Ti)return this.sortedContacts;if(this.selectedGroup===Ei)return this.ungroupedContacts.map(i=>this.sortedContacts.find(a=>a.key===i.key));if(this.selectedGroup===Li)return[];const e=this.groups.filter(i=>i.name===this.selectedGroup)[0];return e?this.sortedContacts.filter(i=>e.contacts.indexOf(i.key)>=0):[]},isCirclesView(){return this.selectedGroup===Li},ungroupedContacts(){return this.sortedContacts.filter(e=>this.contacts[e.key].groups&&this.contacts[e.key].groups.length===0)}},watch:{selectedGroup(){!this.isMobile&&!this.selectedChart&&this.selectFirstContactIfNone()},selectedContact(){!this.isMobile&&!this.selectedChart&&this.selectFirstContactIfNone()}},mounted(){this.isCirclesEnabled?this.logger.info("Circles frontend enabled"):this.logger.info("No compatible version of circles found")},async beforeMount(){Oi.connect({enableCardDAV:!0}).then(()=>{this.logger.debug("Connected to dav!",{client:Oi}),ac().setCurrentUserPrincipal(Oi),this.$store.dispatch("getAddressbooks").then(e=>{e.filter(i=>!i.readOnly).length===0?this.$store.dispatch("appendAddressbook",{displayName:t("contacts","Contacts")}).then(()=>{this.fetchContacts()}):this.fetchContacts()}),localStorage.getItem("orderKey")&&this.$store.commit("setOrder",localStorage.getItem("orderKey"))}),eo&&this.$store.dispatch("getCircles").then(()=>{this.loadingCircles=!1})},methods:{async newContact(){if(this.isCirclesView){De("contacts:circles:append",this.selectedCircle.id);return}const e=new Ro(`
				BEGIN:VCARD
				VERSION:4.0
				PRODID:-//Nextcloud Contacts v${Wr}
				END:VCARD
			`.trim().replace(/\t/gm,""),this.defaultAddressbook);e.fullName=t("contacts","Name"),e.rev=Wi.VCardTime.now().convertToZone(Wi.Timezone.utcTimezone);const i=xn.properties;for(const a in i)if(i[a].default){const o=i[a].defaultValue;let s=o.value;Array.isArray(s)&&(s=[...s]);const r=e.vCard.addPropertyWithValue(a,s);o.type&&r.setParameter("type",o.type)}[Ti,Ei].indexOf(this.selectedGroup)===-1&&(e.groups=[this.selectedGroup]);try{await this.$store.dispatch("addContact",e),await this.$router.push({name:"contact",params:{selectedGroup:this.selectedGroup,selectedContact:e.key}})}catch(a){J(t("contacts","Unable to create the contact.")),console.error(a)}},updateSorting(e="displayName"){this.$store.commit("setOrder",e),this.$store.commit("sortContacts")},fetchContacts(){Promise.all(this.addressbooks.map(e=>e.enabled?this.$store.dispatch("getContactsFromAddressBook",{addressbook:e}):Promise.resolve())).then(()=>{this.loadingContacts=!1,!this.isMobile&&!this.selectedChart&&this.selectFirstContactIfNone()})},selectFirstContactIfNone(){if(this.$route.name==="import")return;const e=this.contactsList.findIndex(i=>i.key===this.selectedContact)>-1;if(this.selectedContact===void 0||!e){if(this.selectedContact&&!e&&(J(t("contacts","Contact not found")),this.$router.push({name:"group",params:{selectedGroup:this.selectedGroup}})),!this.selectedCircle&&!this.groups.find(i=>i.name===this.selectedGroup)&&Ti!==this.selectedGroup&&Ei!==this.selectedGroup&&Li!==this.selectedGroup){J(t("contacts","Group {group} not found",{group:this.selectedGroup})),console.error("Group not found",this.selectedGroup),this.$router.push({name:"root"});return}Object.keys(this.contactsList).length&&this.$router.push({name:"contact",params:{selectedGroup:this.selectedGroup,selectedContact:Object.values(this.contactsList)[0].key}})}},closeImport(){this.$store.dispatch("changeStage","default")}}};var O4=function(){var e=this,i=e._self._c;return i("Content",{attrs:{"app-name":e.appName}},[i("RootNavigation",{attrs:{"contacts-list":e.contactsList,loading:e.loadingContacts||e.loadingCircles,"selected-group":e.selectedGroup,"selected-contact":e.selectedContact}},[i("div",{staticClass:"import-and-new-contact-buttons"},[!e.loadingContacts&&e.isEmptyGroup&&!e.isChartView&&!e.isCirclesView?i("SettingsImportContacts"):e._e(),e.loadingContacts?e._e():i("Button",{attrs:{disabled:!e.defaultAddressbook,type:"secondary",wide:""},on:{click:e.newContact},scopedSlots:e._u([{key:"icon",fn:function(){return[i("IconAdd",{attrs:{size:20}})]},proxy:!0}],null,!1,2388353250)},[e._v(" "+e._s(e.isCirclesView?e.t("contacts","Add member"):e.t("contacts","New contact"))+" ")])],1)]),e.selectedCircle?i("CircleContent",{attrs:{loading:e.loadingCircles}}):e.selectedChart?i("ChartContent",{attrs:{"contacts-list":e.contacts}}):i("ContactsContent",{attrs:{"contacts-list":e.contactsList,loading:e.loadingContacts},on:{"new-contact":e.newContact}}),e.isImporting?i("Modal",{attrs:{"clear-view-delay":-1,"can-close":e.isImportDone},on:{close:e.closeImport}},[i("ImportView",{on:{close:e.closeImport}})],1):e._e(),i("ContactsPicker")],1)},T4=[],E4=U(D4,O4,T4,!1,null,"565c4487");const bn=E4.exports;Rt.use(Kr);const Vi=new Kr({mode:"history",base:da("/apps/contacts",""),linkActiveClass:"active",routes:[{path:"/",component:bn,props:!0,name:"root",redirect:{name:"group",params:{selectedGroup:t("contacts","All contacts")}},children:[{path:`/${zd}/:selectedChart`,name:"chart",component:bn},{path:"import",name:"import",component:bn},{path:`${Li}/:selectedCircle`,name:"circle",component:bn},{path:":selectedGroup",name:"group",component:bn},{path:":selectedGroup/:selectedContact",name:"contact",component:bn}]}]});Rt.use(Pd);const L4=Bd();Rt.directive("ClickOutside",Rd),Rt.directive("Tooltip",dd),Yd(qs,Vi),Rt.prototype.t=t,Rt.prototype.n=n,Rt.prototype.appName=jr,Rt.prototype.appVersion=Wr,Rt.prototype.logger=tc,Rt.prototype.OC=window.OC,Rt.prototype.OCA=window.OCA,window.location.pathname.split("/")[1]==="index.php"&&window.OC.config.modRewriteWorking&&Vi.push({name:"group",params:{selectedGroup:t("contacts","All contacts")}}),new Rt({el:"#content",name:"ContactsApp",router:Vi,store:qs,render:e=>e(jd),pinia:L4});
//# sourceMappingURL=contacts-main.mjs.map
