(self.webpackChunknextcloud_mail=self.webpackChunknextcloud_mail||[]).push([[400,471],{1673:(t,e,n)=>{"use strict";n.d(e,{A:()=>s});var i=n(71354),a=n.n(i),o=n(76314),r=n.n(o)()(a());r.push([t.id,".counter-bubble__counter[data-v-0a721347]{max-width:initial}","",{version:3,sources:["webpack://./src/components/NavigationMailbox.vue"],names:[],mappings:"AACA,0CACC,iBAAA",sourcesContent:["\n.counter-bubble__counter {\n\tmax-width: initial;\n}\n"],sourceRoot:""}]);const s=r},4728:(t,e,n)=>{"use strict";n.d(e,{Ay:()=>r,TB:()=>o,Xu:()=>a});var i=n(13069);const a="change_alias",o="editor_ready";class r extends i.A{removeSignatureElement(t,e){const n=t.model.createRangeIn(t.model.document.getRoot());for(const t of n.getWalker({shallow:!0}))t.item.is("element")&&"signature"===t.item.name&&e.remove(t.item)}insertSignatureElement(t,e,n,i){if(0===n.length)return;const a=t.data.processor.toView(n),o=t.data.toModel(a),r=e.createElement("signature");e.append(e.createText("-- "),r),e.append(e.createElement("paragraph"),r),e.append(o,r),i&&e.append(e.createElement("paragraph"),r);const s=this.findPosition(t,e,i);t.model.insertContent(r,s)}findPosition(t,e,n){if(n){const n=t.model.createRangeIn(t.model.document.getRoot());for(const t of n.getWalker({shallow:!0}))if(t.item.is("element")&&"quote"===t.item.name)return e.createPositionBefore(t.item)}return e.createPositionAt(t.model.document.getRoot(),"end")}hasSignatureElement(t){const e=t.model.createRangeIn(t.model.document.getRoot());for(const t of e.getWalker({shallow:!0}))if(t.item.is("element")){if("quote"===t.item.name)continue;if("signature"===t.item.name)return!0}return!1}execute(t,e,n){this.editor.model.change((i=>{t===a&&(this.removeSignatureElement(this.editor,i),this.insertSignatureElement(this.editor,i,e,n)),t!==o||this.hasSignatureElement(this.editor)||this.insertSignatureElement(this.editor,i,e,n)}))}refresh(){this.isEnabled=!0}}},6791:(t,e,n)=>{"use strict";n.d(e,{LG:()=>s,Np:()=>o,Zd:()=>l,bq:()=>r});var i=n(70715),a=n(63814);const o=t=>{const e=(0,a.Jv)("/apps/mail/api/contactIntegration/match/{mail}",{mail:t});return i.Ay.get(e).then((t=>t.data))},r=(t,e)=>{const n=(0,a.Jv)("/apps/mail/api/contactIntegration/add");return i.Ay.put(n,{uid:t,mail:e}).then((t=>t.data))},s=(t,e)=>{const n=(0,a.Jv)("/apps/mail/api/contactIntegration/new");return i.Ay.put(n,{contactName:t,mail:e}).then((t=>t.data))},l=t=>{const e=(0,a.Jv)("/apps/mail/api/contactIntegration/autoComplete/{term}",{term:t});return i.Ay.get(e).then((t=>t.data))}},12027:(t,e,n)=>{"use strict";n.d(e,{A:()=>s});var i=n(71354),a=n.n(i),o=n(76314),r=n.n(o)()(a());r.push([t.id,".header[data-v-04f95a3c]{display:flex;align-items:center;justify-content:space-between;padding:calc(var(--default-grid-baseline, 4px)*2);gap:var(--default-grid-baseline)}.refresh__button[data-v-04f95a3c]{background-color:rgba(0,0,0,0)}","",{version:3,sources:["webpack://./src/components/NewMessageButtonHeader.vue"],names:[],mappings:"AACA,yBACC,YAAA,CACA,kBAAA,CACA,6BAAA,CACA,iDAAA,CACA,gCAAA,CAGD,kCACC,8BAAA",sourcesContent:["\n.header {\n\tdisplay: flex;\n\talign-items: center;\n\tjustify-content: space-between;\n\tpadding: calc(var(--default-grid-baseline, 4px) * 2);\n\tgap: var(--default-grid-baseline);\n}\n\n.refresh__button {\n\tbackground-color: transparent;\n}\n"],sourceRoot:""}]);const s=r},14714:(t,e,n)=>{"use strict";n.d(e,{A:()=>s});var i=n(71354),a=n.n(i),o=n(76314),r=n.n(o)()(a());r.push([t.id,"[data-v-1a3766c1] .modal-container{width:calc(100vw - 120px) !important;height:calc(100vh - 120px) !important;max-width:600px !important;max-height:500px !important}.modal-content[data-v-1a3766c1]{display:flex;box-sizing:border-box;width:100%;height:100%;flex-direction:column;padding:calc(var(--default-grid-baseline)*4)}.crumbs[data-v-1a3766c1]{display:inline-flex;padding-inline-end:0;flex-wrap:wrap}.crumbs .level[data-v-1a3766c1]{display:inline-flex;height:44px;min-width:0px;flex:0 0 auto;order:1;padding-inline-end:calc(var(--default-grid-baseline)*2);background-position:right center;background-size:auto 24px;margin-top:calc(var(--default-grid-baseline)*-2.5)}.crumbs a[data-v-1a3766c1]{position:relative;padding:calc(var(--default-grid-baseline)*3);opacity:.5;text-overflow:ellipsis;white-space:nowrap;overflow:hidden;flex:0 0 auto;min-width:0px;max-width:200px}.crumbs a[data-v-1a3766c1]:hover{opacity:.7}.crumbs a.icon-home[data-v-1a3766c1]{width:0px;background-position:left center}.mailbox-list[data-v-1a3766c1]{display:inline-block;width:100%;height:100%;overflow-y:auto;flex:1}.mailbox-list li[data-v-1a3766c1]{display:flex;cursor:pointer}.mailbox-list li[data-v-1a3766c1]:hover{background-color:var(--color-background-hover)}.mailbox-list li[data-v-1a3766c1]:not(:last-child){border-bottom:var(--border-width-input) solid var(--color-border)}.mailbox-list h2[data-v-1a3766c1]{width:100%;color:var(--color-text-maxcontrast);text-align:center;margin-top:80px;opacity:.4;background-size:64px;height:64px}.mailbox-list .mailbox-icon[data-v-1a3766c1]{width:24px;height:24px;padding:calc(var(--default-grid-baseline)*3);opacity:.9;background-size:24px}.mailbox-list .mailbox-title[data-v-1a3766c1]{padding:calc(var(--default-grid-baseline)*3) calc(var(--default-grid-baseline)*3) calc(var(--default-grid-baseline)*3) 0;flex:1;overflow:hidden;white-space:nowrap;text-overflow:ellipsis}.buttons[data-v-1a3766c1]{display:flex;justify-content:flex-end;padding-top:calc(var(--default-grid-baseline)*2)}.buttons .spinner[data-v-1a3766c1]{margin-inline-end:var(--default-grid-baseline)}.material-design-icon[data-v-1a3766c1]{opacity:.7;margin-inline-end:calc(var(--default-grid-baseline)*1.5)}","",{version:3,sources:["webpack://./src/components/MailboxPicker.vue"],names:[],mappings:"AACA,mCACC,oCAAA,CACA,qCAAA,CACA,0BAAA,CACA,2BAAA,CAGD,gCACC,YAAA,CACA,qBAAA,CACA,UAAA,CACA,WAAA,CACA,qBAAA,CACA,4CAAA,CAGD,yBACC,mBAAA,CACA,oBAAA,CACA,cAAA,CAEA,gCACC,mBAAA,CACA,WAAA,CACA,aAAA,CACA,aAAA,CACA,OAAA,CACA,uDAAA,CACA,gCAAA,CACA,yBAAA,CACA,kDAAA,CAGD,2BACC,iBAAA,CACA,4CAAA,CACA,UAAA,CACA,sBAAA,CACA,kBAAA,CACA,eAAA,CACA,aAAA,CACA,aAAA,CACA,eAAA,CAEA,iCACC,UAAA,CAIF,qCACC,SAAA,CACA,+BAAA,CAIF,+BACC,oBAAA,CACA,UAAA,CACA,WAAA,CACA,eAAA,CACA,MAAA,CAEA,kCACC,YAAA,CACA,cAAA,CAEA,wCACC,8CAAA,CAGD,mDACC,iEAAA,CAIF,kCACC,UAAA,CACA,mCAAA,CACA,iBAAA,CACA,eAAA,CACA,UAAA,CACA,oBAAA,CACA,WAAA,CAGD,6CACC,UAAA,CACA,WAAA,CACA,4CAAA,CACA,UAAA,CACA,oBAAA,CAGD,8CACC,wHAAA,CACA,MAAA,CACA,eAAA,CACA,kBAAA,CACA,sBAAA,CAIF,0BACC,YAAA,CACA,wBAAA,CACA,gDAAA,CAEA,mCACC,8CAAA,CAIF,uCACC,UAAA,CACA,wDAAA",sourcesContent:["\n:deep(.modal-container) {\n\twidth: calc(100vw - 120px) !important;\n\theight: calc(100vh - 120px) !important;\n\tmax-width: 600px !important;\n\tmax-height: 500px !important;\n}\n\n.modal-content {\n\tdisplay: flex;\n\tbox-sizing: border-box;\n\twidth: 100%;\n\theight: 100%;\n\tflex-direction: column;\n\tpadding: calc(var(--default-grid-baseline) * 4);\n}\n\n.crumbs {\n\tdisplay: inline-flex;\n\tpadding-inline-end: 0;\n\tflex-wrap: wrap;\n\n\t.level {\n\t\tdisplay: inline-flex;\n\t\theight: 44px;\n\t\tmin-width: 0px;\n\t\tflex: 0 0 auto;\n\t\torder: 1;\n\t\tpadding-inline-end: calc(var(--default-grid-baseline) * 2);\n\t\tbackground-position: right center;\n\t\tbackground-size: auto 24px;\n\t\tmargin-top: calc(var(--default-grid-baseline) * -2.5);\n\t}\n\n\ta {\n\t\tposition: relative;\n\t\tpadding: calc(var(--default-grid-baseline) * 3);\n\t\topacity: 0.5;\n\t\ttext-overflow: ellipsis;\n\t\twhite-space: nowrap;\n\t\toverflow: hidden;\n\t\tflex: 0 0 auto;\n\t\tmin-width: 0px;\n\t\tmax-width: 200px;\n\n\t\t&:hover {\n\t\t\topacity: 0.7;\n\t\t}\n\t}\n\n\ta.icon-home {\n\t\twidth: 0px;\n\t\tbackground-position: left center;\n\t}\n}\n\n.mailbox-list {\n\tdisplay: inline-block;\n\twidth: 100%;\n\theight: 100%;\n\toverflow-y: auto;\n\tflex: 1;\n\n\tli {\n\t\tdisplay: flex;\n\t\tcursor: pointer;\n\n\t\t&:hover {\n\t\t\tbackground-color: var(--color-background-hover);\n\t\t}\n\n\t\t&:not(:last-child) {\n\t\t\tborder-bottom: var(--border-width-input) solid var(--color-border);\n\t\t}\n\t}\n\n\th2 {\n\t\twidth: 100%;\n\t\tcolor: var(--color-text-maxcontrast);\n\t\ttext-align: center;\n\t\tmargin-top: 80px;\n\t\topacity: 0.4;\n\t\tbackground-size: 64px;\n\t\theight: 64px;\n\t}\n\n\t.mailbox-icon {\n\t\twidth: 24px;\n\t\theight: 24px;\n\t\tpadding: calc(var(--default-grid-baseline) * 3);\n\t\topacity: 0.9;\n\t\tbackground-size: 24px;\n\t}\n\n\t.mailbox-title {\n\t\tpadding: calc(var(--default-grid-baseline) * 3) calc(var(--default-grid-baseline) * 3) calc(var(--default-grid-baseline) * 3) 0;\n\t\tflex: 1;\n\t\toverflow: hidden;\n\t\twhite-space: nowrap;\n\t\ttext-overflow: ellipsis;\n\t}\n}\n\n.buttons {\n\tdisplay: flex;\n\tjustify-content: flex-end;\n\tpadding-top: calc(var(--default-grid-baseline) * 2);\n\n\t.spinner {\n\t\tmargin-inline-end: var(--default-grid-baseline);\n\t}\n}\n\n.material-design-icon {\n\topacity: .7;\n\tmargin-inline-end: calc(var(--default-grid-baseline) * 1.5);\n}\n"],sourceRoot:""}]);const s=r},18068:(t,e,n)=>{"use strict";n.d(e,{A:()=>s});var i=n(71354),a=n.n(i),o=n(76314),r=n.n(o)()(a());r.push([t.id,"[data-v-2f1e2a14] .app-navigation-entry__title{color:var(--color-text-maxcontrast)}","",{version:3,sources:["webpack://./src/components/NavigationAccountExpandCollapse.vue"],names:[],mappings:"AACA,+CACC,mCAAA",sourcesContent:["\n:deep(.app-navigation-entry__title) {\n\tcolor: var(--color-text-maxcontrast);\n}\n"],sourceRoot:""}]);const s=r},23256:(t,e,n)=>{"use strict";n.d(e,{A:()=>s});var i=n(71354),a=n.n(i),o=n(76314),r=n.n(o)()(a());r.push([t.id,".button-vue[data-v-0cf1c097] {display:inline-block !important}","",{version:3,sources:["webpack://./src/components/TrustedSenders.vue"],names:[],mappings:"AACA,8BACC,+BAAA",sourcesContent:["\n.button-vue:deep() {\n\tdisplay: inline-block !important;\n}\n"],sourceRoot:""}]);const s=r},25724:(t,e,n)=>{"use strict";n.d(e,{A:()=>s});var i=n(71354),a=n.n(i),o=n(76314),r=n.n(o)()(a());r.push([t.id,"@keyframes rotation-3f279782{from{transform:rotate(0deg)}to{transform:rotate(-360deg)}}.outbox[data-v-3f279782]{padding:calc(var(--default-grid-baseline, 4px)*2);padding-bottom:0;width:auto}.outbox__border[data-v-3f279782]{border-top:1px solid var(--color-background-darker)}.mail-settings[data-v-3f279782]{padding:calc(var(--default-grid-baseline, 4px)*2);padding-top:0}.mail-settings__button[data-v-3f279782]{display:flex;width:100% !important;justify-content:start !important}.v-popper__inner[data-v-3f279782]{height:unset !important}","",{version:3,sources:["webpack://./src/components/Navigation.vue"],names:[],mappings:"AACA,6BACA,KACC,sBAAA,CAED,GACE,yBAAA,CAAA,CAIF,yBACC,iDAAA,CACA,gBAAA,CAEA,UAAA,CACA,iCACC,mDAAA,CAIF,gCACC,iDAAA,CACA,aAAA,CAEA,wCACC,YAAA,CACA,qBAAA,CACA,gCAAA,CAIF,kCACC,uBAAA",sourcesContent:["\n@keyframes rotation {\nfrom {\n\ttransform: rotate(-0deg);\n}\nto {\n\t\ttransform: rotate(-360deg);\n\t}\n}\n\n.outbox {\n\tpadding: calc(var(--default-grid-baseline, 4px) * 2);\n\tpadding-bottom: 0;\n\n\twidth: auto;\n\t&__border {\n\t\tborder-top: 1px solid var(--color-background-darker);\n\t}\n}\n\n.mail-settings {\n\tpadding: calc(var(--default-grid-baseline, 4px) * 2);\n\tpadding-top: 0;\n\n\t&__button {\n\t\tdisplay: flex;\n\t\twidth: 100% !important;\n\t\tjustify-content: start !important;\n\t}\n}\n\n.v-popper__inner {\n\theight: unset !important;\n}\n\n"],sourceRoot:""}]);const s=r},26430:(t,e,n)=>{"use strict";n.d(e,{A:()=>w});var i=n(4658),a=n(49954),o=n(41936),r=n(59892),s=n(85745),l=n(51849),c=n(49519);const d={name:"NewMessageButtonHeader",components:{ButtonVue:i.x1,IconAdd:a.A,IconRefresh:o.A,IconLoading:r.A},data:()=>({refreshing:!1}),computed:{...(0,l.n2)(c.A),currentMailbox(){if("message"===this.$route.name||"mailbox"===this.$route.name)return this.mainStore.getMailbox(this.$route.params.mailboxId)}},methods:{async refreshMailbox(){if(!0!==this.refreshing){this.refreshing=!0;try{await this.mainStore.syncEnvelopes({mailboxId:this.currentMailbox.databaseId}),s.A.debug("Current folder is sync'ing ")}catch(t){s.A.error("could not sync current folder",{error:t})}finally{this.refreshing=!1}}else s.A.debug("already sync'ing mailbox.. aborting")},async onNewMessage(){await this.mainStore.startComposerSession({isBlankMessage:!0})}}};var u=n(85072),m=n.n(u),A=n(97825),p=n.n(A),h=n(77659),g=n.n(h),b=n(55056),f=n.n(b),v=n(10540),x=n.n(v),C=n(41113),y=n.n(C),_=n(12027),k={};k.styleTagTransform=y(),k.setAttributes=f(),k.insert=g().bind(null,"head"),k.domAPI=p(),k.insertStyleElement=x(),m()(_.A,k),_.A&&_.A.locals&&_.A.locals;const w=(0,n(14486).A)(d,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"header"},[e("ButtonVue",{attrs:{"aria-label":t.t("mail","New message"),type:"secondary","button-id":"mail_new_message",wide:!0},on:{click:t.onNewMessage},scopedSlots:t._u([{key:"icon",fn:function(){return[e("IconAdd",{attrs:{size:20}})]},proxy:!0}])},[t._v("\n\t\t"+t._s(t.t("mail","New message"))+"\n\t")]),t._v(" "),t.currentMailbox?e("ButtonVue",{staticClass:"refresh__button",attrs:{"aria-label":t.t("mail","Refresh"),type:"tertiary-no-background",disabled:t.refreshing},on:{click:t.refreshMailbox},scopedSlots:t._u([{key:"icon",fn:function(){return[t.refreshing?t._e():e("IconRefresh",{attrs:{size:20}}),t._v(" "),t.refreshing?e("IconLoading",{attrs:{size:20}}):t._e()]},proxy:!0}],null,!1,2669673868)}):t._e()],1)}),[],!1,null,"04f95a3c",null).exports},27514:t=>{"use strict";t.exports="data:image/svg+xml,%3c%21--%20-%20SPDX-FileCopyrightText:%202020%20Google%20Inc.%20-%20SPDX-License-Identifier:%20Apache-2.0%20--%3e%3csvg%20xmlns=%27http://www.w3.org/2000/svg%27%20width=%2724%27%20height=%2724%27%20fill=%27%23222%27%3e%3cpath%20d=%27M18.4%207.4L17%206l-6%206%206%206%201.4-1.4-4.6-4.6%204.6-4.6m-6%200L11%206l-6%206%206%206%201.4-1.4L7.8%2012l4.6-4.6z%27/%3e%3c/svg%3e"},27518:t=>{"use strict";t.exports="data:image/svg+xml,%3c%21--%20-%20SPDX-FileCopyrightText:%202020%20Google%20Inc.%20-%20SPDX-License-Identifier:%20Apache-2.0%20--%3e%3csvg%20xmlns=%27http://www.w3.org/2000/svg%27%20width=%2724%27%20height=%2724%27%20fill=%27%23222%27%3e%3cpath%20d=%27M15.4%2016.6L10.8%2012l4.6-4.6L14%206l-6%206%206%206%201.4-1.4z%27/%3e%3c/svg%3e"},28290:(t,e,n)=>{"use strict";function i(t,e){if(!t.myAcls)return!0;const n=[...t.myAcls];for(const t of[...e])if(!n.includes(t))return!1;return!0}n.d(e,{w:()=>i})},30412:(t,e,n)=>{"use strict";n.d(e,{A:()=>s});var i=n(71354),a=n.n(i),o=n(76314),r=n.n(o)()(a());r.push([t.id,".empty-content[data-v-101b9c05]{height:100%;display:flex}.certificate-modal[data-v-101b9c05]{padding:calc(var(--default-grid-baseline)*5)}.certificate-modal__list table[data-v-101b9c05]{table-layout:fixed;width:100%}.certificate-modal__list table th[data-v-101b9c05]{color:var(--color-text-maxcontrast)}.certificate-modal__list table th[data-v-101b9c05],.certificate-modal__list table td[data-v-101b9c05]{padding:calc(var(--default-grid-baseline)*.5);text-overflow:ellipsis;white-space:nowrap;overflow:hidden;flex:5 1 0px}.certificate-modal__list table th[data-v-101b9c05]:last-child,.certificate-modal__list table td[data-v-101b9c05]:last-child{flex:1 1 0px}.certificate-modal__list table span[data-v-101b9c05]{text-overflow:ellipsis}.certificate-modal__list table tr[data-v-101b9c05]{display:flex;flex-direction:row;align-items:center}.certificate-modal__list table tr[data-v-101b9c05]:hover{background-color:unset}.certificate-modal__list__actions[data-v-101b9c05]{margin:calc(var(--default-grid-baseline)*3);float:inline-end}.certificate-modal__import[data-v-101b9c05]{display:flex;flex-direction:column;gap:calc(var(--default-grid-baseline)*2)}.certificate-modal__import input[type=file][data-v-101b9c05]{display:flex;width:100%}.certificate-modal__import__type[data-v-101b9c05]{display:flex;gap:0 calc(var(--default-grid-baseline)*5);flex-wrap:wrap}.certificate-modal__import__type>div[data-v-101b9c05]{display:flex;gap:var(--default-grid-baseline);align-items:center}.certificate-modal__import__hints[data-v-101b9c05]{color:var(--color-text-maxcontrast)}.certificate-modal__import__actions[data-v-101b9c05]{display:flex;justify-content:space-between;gap:calc(var(--default-grid-baseline)*4)}","",{version:3,sources:["webpack://./src/components/smime/SmimeCertificateModal.vue"],names:[],mappings:"AACA,gCACC,WAAA,CACA,YAAA,CAGD,oCACC,4CAAA,CAGC,gDACC,kBAAA,CACA,UAAA,CAEA,mDACC,mCAAA,CAGD,sGACC,6CAAA,CACA,sBAAA,CACA,kBAAA,CACA,eAAA,CACA,YAAA,CAGD,4HACC,YAAA,CAGD,qDACC,sBAAA,CAGD,mDACC,YAAA,CACA,kBAAA,CACA,kBAAA,CAID,yDACC,sBAAA,CAIF,mDACC,2CAAA,CACA,gBAAA,CAIF,4CACC,YAAA,CACA,qBAAA,CACA,wCAAA,CAEA,6DACC,YAAA,CACA,UAAA,CAGD,kDACC,YAAA,CACA,0CAAA,CACA,cAAA,CAEA,sDACC,YAAA,CACA,gCAAA,CACA,kBAAA,CAIF,mDACC,mCAAA,CAGD,qDACC,YAAA,CACA,6BAAA,CACA,wCAAA",sourcesContent:["\n.empty-content{\n\theight: 100%;\n\tdisplay: flex;\n}\n\n.certificate-modal {\n\tpadding: calc(var(--default-grid-baseline) * 5);\n\n\t&__list {\n\t\ttable {\n\t\t\ttable-layout: fixed;\n\t\t\twidth: 100%;\n\n\t\t\tth {\n\t\t\t\tcolor: var(--color-text-maxcontrast);\n\t\t\t}\n\n\t\t\tth, td {\n\t\t\t\tpadding: calc(var(--default-grid-baseline) * 0.5);\n\t\t\t\ttext-overflow: ellipsis;\n\t\t\t\twhite-space: nowrap;\n\t\t\t\toverflow: hidden;\n\t\t\t\tflex: 5 1 0px;\n\t\t\t}\n\n\t\t\tth:last-child, td:last-child {\n\t\t\t\tflex: 1 1 0px;\n\t\t\t}\n\n\t\t\tspan {\n\t\t\t\ttext-overflow: ellipsis;\n\t\t\t}\n\n\t\t\ttr {\n\t\t\t\tdisplay: flex;\n\t\t\t\tflex-direction: row;\n\t\t\t\talign-items: center;\n\t\t\t}\n\n\t\t\t// Disable default hover style\n\t\t\ttr:hover {\n\t\t\t\tbackground-color: unset;\n\t\t\t}\n\t\t}\n\n\t\t&__actions {\n\t\t\tmargin: calc(var(--default-grid-baseline) * 3);\n\t\t\tfloat: inline-end;\n\t\t}\n\t}\n\n\t&__import {\n\t\tdisplay: flex;\n\t\tflex-direction: column;\n\t\tgap: calc(var(--default-grid-baseline) * 2);\n\n\t\tinput[type=file] {\n\t\t\tdisplay: flex;\n\t\t\twidth: 100%;\n\t\t}\n\n\t\t&__type {\n\t\t\tdisplay: flex;\n\t\t\tgap: 0 calc(var(--default-grid-baseline) * 5);\n\t\t\tflex-wrap: wrap;\n\n\t\t\t> div {\n\t\t\t\tdisplay: flex;\n\t\t\t\tgap: var(--default-grid-baseline);\n\t\t\t\talign-items: center;\n\t\t\t}\n\t\t}\n\n\t\t&__hints {\n\t\t\tcolor: var(--color-text-maxcontrast);\n\t\t}\n\n\t\t&__actions {\n\t\t\tdisplay: flex;\n\t\t\tjustify-content: space-between;\n\t\t\tgap: calc(var(--default-grid-baseline) * 4);\n\t\t}\n\t}\n}\n"],sourceRoot:""}]);const s=r},32300:(t,e,n)=>{"use strict";n.d(e,{A:()=>s});var i=n(71354),a=n.n(i),o=n(76314),r=n.n(o)()(a());r.push([t.id,"p.app-settings[data-v-e23a82f4]{padding:calc(var(--default-grid-baseline)*2) 0}.app-settings-button[data-v-e23a82f4]{display:inline-flex;background-position:10px center;text-align:start;margin-top:calc(var(--default-grid-baseline)*2)}.app-settings-button.button.primary.new-button[data-v-e23a82f4]{color:var(--color-primary-element-text);padding-inline-start:34px;gap:var(--default-grid-baseline);width:fit-content}.app-settings-link[data-v-e23a82f4]{text-decoration:underline}[data-v-e23a82f4] .button-vue__text{text-overflow:clip;white-space:normal}[data-v-e23a82f4] .button-vue__wrapper{justify-content:flex-start}.mailvelope-section[data-v-e23a82f4]{padding-top:calc(var(--default-grid-baseline)*4)}.mailvelope-section a.button[data-v-e23a82f4]{display:flex;align-items:center;line-height:normal;min-height:calc(var(--default-grid-baseline)*11);font-size:unset;color:var(--color-primary-element-light-text);width:fit-content}.mailvelope-section a.button[data-v-e23a82f4]:focus-visible,.mailvelope-section a.button[data-v-e23a82f4]:hover{box-shadow:0 0 0 1px var(--color-primary-element)}.material-design-icon.lock-icon[data-v-e23a82f4]{margin-inline-end:calc(var(--default-grid-baseline)*2)}.section-title[data-v-e23a82f4]{margin-top:calc(var(--default-grid-baseline)*5);margin-bottom:calc(var(--default-grid-baseline)*2)}.sorting[data-v-e23a82f4]{display:flex;width:100%}.sorting__switch[data-v-e23a82f4]{width:50%}.mail-creation-button[data-v-e23a82f4]{width:100%}.settings-hint[data-v-e23a82f4]{margin-top:calc(var(--default-grid-baseline)*-3);margin-bottom:calc(var(--default-grid-baseline)*2);color:var(--color-text-maxcontrast)}.app-settings-section[data-v-e23a82f4]{list-style:none}.text-block-buttons[data-v-e23a82f4]{width:100%;justify-self:end;display:flex;justify-content:flex-end}.text-block-buttons__button[data-v-e23a82f4]{margin:var(--default-grid-baseline)}","",{version:3,sources:["webpack://./src/components/AppSettingsMenu.vue"],names:[],mappings:"AACA,gCACC,8CAAA,CAGD,sCACC,mBAAA,CACA,+BAAA,CACA,gBAAA,CACA,+CAAA,CAGD,gEACC,uCAAA,CAEA,yBAAA,CACA,gCAAA,CACA,iBAAA,CAGD,oCACC,yBAAA,CAGD,oCACC,kBAAA,CACA,kBAAA,CAGD,uCACC,0BAAA,CAGD,qCACC,gDAAA,CAEA,8CACC,YAAA,CACA,kBAAA,CACA,kBAAA,CACA,gDAAA,CACA,eAAA,CACA,6CAAA,CACA,iBAAA,CAEA,gHAEC,iDAAA,CAMF,iDACC,sDAAA,CAKF,gCACC,+CAAA,CACA,kDAAA,CAGD,0BACC,YAAA,CACA,UAAA,CACA,kCACC,SAAA,CAIF,uCACC,UAAA,CAGD,gCACC,gDAAA,CACA,kDAAA,CACA,mCAAA,CAGD,uCACC,eAAA,CAGD,qCACC,UAAA,CACA,gBAAA,CACA,YAAA,CACA,wBAAA,CACA,6CACC,mCAAA",sourcesContent:["\np.app-settings {\n\tpadding: calc(var(--default-grid-baseline) * 2) 0;\n}\n\n.app-settings-button {\n\tdisplay: inline-flex;\n\tbackground-position: 10px center;\n\ttext-align: start;\n\tmargin-top: calc(var(--default-grid-baseline) * 2);\n}\n\n.app-settings-button.button.primary.new-button {\n\tcolor: var(--color-primary-element-text);\n\t//this style will be removed after we migrate also the  'add mail account' to material design\n\tpadding-inline-start: 34px;\n\tgap: var(--default-grid-baseline);\n\twidth: fit-content;\n}\n\n.app-settings-link {\n\ttext-decoration: underline;\n}\n\n:deep(.button-vue__text) {\n\ttext-overflow: clip;\n\twhite-space: normal;\n}\n\n:deep(.button-vue__wrapper) {\n\tjustify-content: flex-start;\n}\n\n.mailvelope-section {\n\tpadding-top: calc(var(--default-grid-baseline) * 4);\n\n\ta.button {\n\t\tdisplay: flex;\n\t\talign-items: center;\n\t\tline-height: normal;\n\t\tmin-height: calc(var(--default-grid-baseline) * 11);\n\t\tfont-size: unset;\n\t\tcolor: var(--color-primary-element-light-text);\n\t\twidth: fit-content;\n\n\t\t&:focus-visible,\n\t\t&:hover {\n\t\t\tbox-shadow: 0 0 0 1px var(--color-primary-element);\n\t\t}\n\t}\n}\n\n.material-design-icon {\n\t&.lock-icon {\n\t\tmargin-inline-end: calc(var(--default-grid-baseline) * 2);\n\t}\n\n}\n\n.section-title {\n\tmargin-top: calc(var(--default-grid-baseline) * 5);\n\tmargin-bottom: calc(var(--default-grid-baseline) * 2);\n}\n\n.sorting {\n\tdisplay: flex;\n\twidth: 100%;\n\t&__switch{\n\t\twidth: 50%;\n\t}\n}\n\n.mail-creation-button {\n\twidth: 100%;\n}\n\n.settings-hint {\n\tmargin-top: calc(var(--default-grid-baseline) * -3);\n\tmargin-bottom: calc(var(--default-grid-baseline) * 2);\n\tcolor: var(--color-text-maxcontrast);\n}\n\n.app-settings-section {\n\tlist-style: none;\n}\n\n.text-block-buttons {\n\twidth: 100%;\n\tjustify-self: end;\n\tdisplay: flex;\n\tjustify-content: flex-end;\n\t&__button {\n\t\tmargin: var(--default-grid-baseline);\n\t}\n}\n"],sourceRoot:""}]);const s=r},35630:(t,e,n)=>{"use strict";n.d(e,{A:()=>i});const i=(0,n(27380).A)()},37528:(t,e,n)=>{"use strict";n.d(e,{E:()=>r,I:()=>o});var i=n(63814),a=n(70715);async function o(t,e,n){const o=(0,i.Jv)("/apps/mail/api/trustedsenders/{email}?type={type}",{email:t,type:e});n?await a.Ay.put(o):await a.Ay.delete(o)}async function r(){const t=(0,i.Jv)("/apps/mail/api/trustedsenders");return(await a.Ay.get(t)).data.data}},38366:(t,e,n)=>{"use strict";n.d(e,{A:()=>s});var i=n(71354),a=n.n(i),o=n(76314),r=n.n(o)()(a());r.push([t.id,".address[data-v-92c95fe2]{display:flex;align-items:center}.address__type[data-v-92c95fe2]{color:var(--color-text-maxcontrast)}","",{version:3,sources:["webpack://./src/components/InternalAddress.vue"],names:[],mappings:"AACA,0BACC,YAAA,CACA,kBAAA,CACA,gCACC,mCAAA",sourcesContent:["\n.address {\n\tdisplay: flex;\n\talign-items: center;\n\t&__type{\n\t\tcolor: var(--color-text-maxcontrast);\n\t}\n}\n\n"],sourceRoot:""}]);const s=r},44924:(t,e,n)=>{"use strict";n.d(e,{A:()=>lt});var i=n(10349),a=n.n(i),o=n(30482),r=n(6167),s=n(5055),l=n(75289),c=n(33924),d=n(7752),u=n(43375),m=n(68587),A=n(35120),p=n(85355),h=n(15982),g=n(92917),b=n(13860),f=n(80463),v=n(49504),x=n(70951),C=n(46060),y=n(58693),_=n(4728);class k extends y.A{init(){this._defineSchema(),this._defineConverters(),this.editor.commands.add("insertSignature",new _.Ay(this.editor))}_defineSchema(){this.editor.model.schema.register("signature",{inheritAllFrom:"$container"})}_defineConverters(){this.editor.conversion.elementToElement({model:"signature",view:{name:"div",classes:"signature"}})}}var w=n(66898);class S extends y.A{init(){this._defineSchema(),this._defineConverters()}_defineSchema(){this.editor.model.schema.register("quote",{inheritAllFrom:"$container"})}_defineConverters(){this.editor.conversion.elementToElement({model:"quote",view:{name:"div",classes:"quote"}})}}var I=n(38754),B=n(89478),M=n(37793),T=n(94802),E=n(68468),D=n(89765),P=n(69006),N=n(40960);class R extends y.A{static get requires(){return[N.f]}init(){this._overwriteParagraphConversion()}_overwriteParagraphConversion(){this.editor.conversion.elementToElement({model:"paragraph",view:{name:"p",styles:{margin:0}},converterPriority:"high"})}}var j=n(64508),L=n(53334),O=n(85745),F=n(13069);class z extends F.A{insertItem(t,e,n,i){const a=t.model.document.selection.getLastPosition();if(null===a)return;const o=t.model.createRange(a.getShiftedBy(-5),a).getWalker({shallow:!1,direction:"backward"});for(const a of o)if("text"===a.type&&a.item.data.includes(i)){e.remove(a.item);const o=a.item.data,r=o.lastIndexOf(i),s=e.createElement("paragraph");if(e.insertText(o.substring(0,r),s),t.model.insertContent(s),"@"===i){const i=`mailto:${n.email}`,a=`@${n.label}`,o=e.createText(a,{linkHref:i});t.model.insertContent(o)}else if("!"===i)if(n.isHtml){const e=t.data.processor.toView(n.content),i=t.data.toModel(e);t.model.insertContent(i)}else{const i=e.createElement("paragraph");e.insertText(n.content,i),t.model.insertContent(i)}else{const i=e.createElement("paragraph");e.insertText(n,i),t.model.insertContent(i)}return}}execute(t,e){this.editor.model.change((n=>{this.insertItem(this.editor,n,t,e)}))}refresh(){this.isEnabled=!0}}class U extends y.A{init(){this.editor.commands.add("insertItem",new z(this.editor))}}var $=n(6791),q=n(4658),V=n(18446);const W={name:"TextEditor",components:{ckeditor:a().component},props:{value:{type:String,required:!0},html:{type:Boolean,default:!1},placeholder:{type:String,default:""},focus:{type:Boolean,default:!1},bus:{type:Object,required:!0},disabled:{type:Boolean,default:!1},textBlocks:{type:Array,default:()=>[]},isBordered:{type:Boolean,default:!1},readOnly:{type:Boolean,default:!1}},data(){const t=[l.A,m.A,k,S,U,r.PX,f.A,M.A,D.A],e=["undo","redo"];return this.html&&(t.push(A.A,o.A,d.A,p.A,h.A,w.A,b.A,g.A,c.A,v.A,B.A,E.A,T.A,x.A,u.A,C.A,I.A,R),e.unshift("heading","fontFamily","fontSize","bold","italic","underline","strikethrough","fontColor","subscript","superscript","fontBackgroundColor","insertImage","alignment","bulletedList","numberedList","blockquote","link","removeFormat","findAndReplace")),{linkTribute:null,emojiTribute:null,textSmiles:[],ready:!1,editor:s.A,config:{licenseKey:"GPL",placeholder:this.placeholder,plugins:t,toolbar:{items:e},language:"en",mention:{feeds:[{marker:":",feed:this.getEmoji,itemRenderer:this.customEmojiRenderer},{marker:"/",feed:this.getLink,itemRenderer:this.customLinkRenderer},{marker:"@",feed:this.getContact,itemRenderer:this.customRenderer},{marker:"!",feed:this.getTextBlock,itemRenderer:this.customRenderer}]}}}},beforeMount(){this.loadEditorTranslations((0,L.Z0)())},methods:{getLink(t){const e=(0,j.kr)(t);return 1!==e.length||e[0].title.toLowerCase().includes(t.toLowerCase())?e:[]},getEmoji(t){const e=(0,q.Fo)(t);return this.textSmiles.includes(":"+t)&&e.unshift(":"+t),e},async getContact(t){if(0===t.length)return[];let e=await(0,$.Zd)(t);return e=e.filter((t=>t.email.length>0)),e},getTextBlock(t){return 0===t.length?[]:this.textBlocks.filter((e=>e.title.toLowerCase().includes(t.toLowerCase())))},customEmojiRenderer(t){const e=document.createElement("span");e.classList.add("custom-item"),e.id=`mention-list-item-id-${t.colons}`,e.textContent=`${t.native} `;const n=document.createElement("span");return n.classList.add("custom-item-username"),n.textContent=t.colons,e.appendChild(n),e},customLinkRenderer(t){const e=document.createElement("span");e.classList.add("link-container");const n=document.createElement("img");n.classList.add("link-icon"),n.src=`${t.icon_url} `;const i=document.createElement("span");return i.classList.add("link-title"),i.textContent=`${t.title} `,e.appendChild(n),e.appendChild(i),e},customRenderer(t,e){const n=document.createElement("span");n.classList.add("custom-item"),n.id=`mention-list-item-id-${t.id}`;const i=document.createElement("p"),a="contact"===e?t.label:t.title;return i.classList.add("custom-item-username"),i.textContent=a,n.appendChild(i),n},overrideDropdownPositionsToNorth(t,e){const{south:n,north:i,southEast:a,southWest:o,northEast:r,northWest:s,southMiddleEast:l,southMiddleWest:c,northMiddleEast:d,northMiddleWest:u}=P.BO.defaultPanelPositions;let m;m="rtl"!==t.locale.uiLanguageDirection?[r,s,d,u,i,a,o,l,c,n]:[s,r,u,d,i,o,a,c,l,n];for(const t of e.items)t instanceof P.BO&&t.on("change:isOpen",(()=>{t.isOpen&&(t.panelView.position=P.BO._getOptimalPosition({element:t.panelView.element,target:t.buttonView.element,fitInViewport:!0,positions:m}).name)}))},overrideTooltipPositions(t){for(const e of t.items)e.buttonView?e.buttonView.tooltipPosition="n":e.tooltipPosition&&(e.tooltipPosition="n")},async loadEditorTranslations(t){if("en"===t)return this.showEditor("en");try{O.A.debug(`loading ${t} translations for CKEditor`),await n(57092)(`./${t}`),this.showEditor(t)}catch(e){O.A.error(`could not find CKEditor translations for "${t}"`,{error:e}),this.showEditor("en")}},showEditor(t){O.A.debug(`using "${t}" as CKEditor language`),this.config.language=t,this.ready=!0},onEditorReady(t){O.A.debug("TextEditor is ready",{editor:t}),this.$refs.toolbarContainer.appendChild(t.ui.view.toolbar.element),this.$refs.editableContainer.appendChild(t.ui.view.editable.element),this.readOnly&&(t.ui.view.toolbar.element.style.display="none",t.enableReadOnlyMode("text-block")),t.ui&&(this.overrideDropdownPositionsToNorth(t,t.ui.view.toolbar),this.overrideTooltipPositions(t.ui.view.toolbar)),t.commands.get("mention")?.on("execute",((t,e)=>{t.stop();const n=e[0],i=n.mention;":"===n.marker&&((0,q.ZR)(i),this.editorInstance.execute("insertItem",i.native,":")),"/"===n.marker&&(0,j.J4)(i.id).then((t=>{this.editorInstance.execute("insertItem",t,"/"),this.editorInstance.editing.view.focus()})).catch((t=>{console.debug("Smart picker promise rejected:",t)})),"@"===n.marker&&(this.editorInstance.execute("insertItem",{email:i.email[0],label:i.label},"@"),this.$emit("mention",{email:i.email[0],label:i.label})),"!"===n.marker&&this.insertTextBlock(i,!1)}),{priority:"high"}),this.editorInstance=t,this.focus&&(O.A.debug("focusing TextEditor"),t.editing.view.focus()),this.html&&this.$emit("show-toolbar",t.ui._focusableToolbarDefinitions[0].toolbarView.element),this.bus.on("append-to-body-at-cursor",this.appendToBodyAtCursor),this.bus.on("insert-text-block",this.insertTextBlock),this.$emit("ready",t)},onEditorInput(t){t!==this.value&&(O.A.debug(`TextEditor input changed to <${t}>`),this.$emit("input",t))},appendToBodyAtCursor(t){const e=this.editorInstance.data.processor.toView(t),n=this.editorInstance.data.toModel(e);this.editorInstance.model.insertContent(n)},editorExecute(t){if(!this.editorInstance)throw new Error("Impossible to execute a command before editor is ready.");for(var e=arguments.length,n=new Array(e>1?e-1:0),i=1;i<e;i++)n[i-1]=arguments[i];this.editorInstance.execute(t,...n)},insertTextBlock(t){(!(arguments.length>1&&void 0!==arguments[1])||arguments[1])&&this.appendToBodyAtCursor("!");let e=t.content;if(!this.html){const t=new V.EY("html",e);e=(0,V.Ul)(t).value}this.editorInstance.execute("insertItem",{content:e,isHtml:this.html},"!")}}};var G=n(85072),K=n.n(G),Y=n(97825),H=n.n(Y),Q=n(77659),J=n.n(Q),X=n(55056),Z=n.n(X),tt=n(10540),et=n.n(tt),nt=n(41113),it=n.n(nt),at=n(75292),ot={};ot.styleTagTransform=it(),ot.setAttributes=Z(),ot.insert=J().bind(null,"head"),ot.domAPI=H(),ot.insertStyleElement=et(),K()(at.A,ot),at.A&&at.A.locals&&at.A.locals;var rt=n(96153),st={};st.styleTagTransform=it(),st.setAttributes=Z(),st.insert=J().bind(null,"head"),st.domAPI=H(),st.insertStyleElement=et(),K()(rt.A,st),rt.A&&rt.A.locals&&rt.A.locals;const lt=(0,n(14486).A)(W,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"editor-wrapper",class:{"editor-wrapper--bordered":t.isBordered}},[e("div",{ref:"toolbarContainer",staticClass:"toolbar"}),t._v(" "),e("div",{ref:"editableContainer",staticClass:"editable"}),t._v(" "),t.ready?e("ckeditor",{staticClass:"editor",attrs:{value:t.value,config:t.config,editor:t.editor,disabled:t.disabled},on:{input:t.onEditorInput,ready:t.onEditorReady}}):t._e()],1)}),[],!1,null,"caf9c680",null).exports},46212:(t,e,n)=>{"use strict";n.d(e,{A:()=>s});var i=n(71354),a=n.n(i),o=n(76314),r=n.n(o)()(a());r.push([t.id,".navigation-outbox__unread-counter[data-v-57607280]{margin-inline-end:calc(var(--default-grid-baseline)*2)}.outbox-opacity-icon[data-v-57607280]{opacity:.7}.outbox-opacity-icon[data-v-57607280]:hover{opacity:1}","",{version:3,sources:["webpack://./src/components/NavigationOutbox.vue"],names:[],mappings:"AAEC,oDACC,sDAAA,CAIF,sCACC,UAAA,CACA,4CACC,SAAA",sourcesContent:["\n.navigation-outbox {\n\t&__unread-counter {\n\t\tmargin-inline-end: calc(var(--default-grid-baseline) * 2);\n\t}\n}\n\n.outbox-opacity-icon {\n\topacity: .7;\n\t&:hover {\n\t\topacity: 1;\n\t}\n}\n"],sourceRoot:""}]);const s=r},46388:(t,e,n)=>{"use strict";n.d(e,{A:()=>s});var i=n(71354),a=n.n(i),o=n(76314),r=n.n(o)()(a());r.push([t.id,".dialog__actions{flex-wrap:wrap}.dialog__actions>button{flex:1 auto}","",{version:3,sources:["webpack://./src/components/NavigationAccount.vue"],names:[],mappings:"AAGC,iBACC,cAAA,CAEA,wBACC,WAAA",sourcesContent:["\n// Fix very long button labels overflowing the modal\n.dialog {\n\t&__actions {\n\t\tflex-wrap: wrap;\n\n\t\t> button {\n\t\t\tflex: 1 auto;\n\t\t}\n\t}\n}\n"],sourceRoot:""}]);const s=r},48642:(e,n,i)=>{"use strict";i.d(n,{A:()=>L});var a=i(4658),o=i(51849),r=i(27380),s=i(49519),l=i(81430),c=i(44924),d=i(85168),u=i(30787),m=i(56702),A=i(90629),p=i(5493),h=i(12572),g=i.n(h),b=i(286),f=i(63814),v=i(21777),x=i(85745),C=i(70715);const y={name:"ListItem",components:{NcActionButton:a.Ko,NcLoadingIcon:a.ne,NcSelect:a.EQ,NcDialog:a.i$,TextEditor:c.A,NcButton:a.x1,NcAvatar:a.Bx,NcInputField:a.Es,AccountMultiple:u.A,IconClose:m.A,IconPencil:p.A,IconCheck:A.A,NcListItem:a.l},props:{textBlock:{type:Object,required:!0},shared:{type:Boolean,default:!1},isViewMode:{type:Boolean,default:!1},picked:{type:Boolean,default:!1}},data(){return{shares:[],localTextBlock:JSON.parse(JSON.stringify(this.textBlock)),editModalOpen:!1,loading:!1,saveLoading:!1,share:null,suggestions:[],bus:(0,r.A)()}},computed:{...(0,o.n2)(s.A),options(){return this.suggestions.filter((t=>!this.shares.find((e=>e.name===t.shareWith))&&t.shareWith!==(0,v.HW)().uid))},sortedShares(){return[...this.shares].sort(((t,e)=>"user"===t.type&&"group"===e.type?-1:"group"===t.type&&"user"===e.type?1:0))}},async mounted(){this.shared||this.isViewMode||(this.shares=await(0,l.PI)(this.textBlock.id))},methods:{async deleteTextBlock(){await this.mainStore.deleteTextBlock({id:this.textBlock.id}).then((()=>{(0,d.Te)(t("mail","Text block deleted"))})).catch((()=>{(0,d.Qg)(t("mail","Failed to delete text block"))}))},async shareTextBlock(e){try{await(0,l.CM)(this.textBlock.id,e.shareWith,e.shareType===b.I.User?"user":"group"),this.shares.push({shareWith:e.shareWith,type:e.isNoUser?"group":"user",displayName:e.displayName}),(0,d.Te)(t("mail","Text block shared with {sharee}",{sharee:e.shareWith})),this.share=null}catch(n){(0,d.Qg)(t("mail","Failed to share text block with {sharee}",{sharee:e.shareWith}))}},async removeShare(e){try{await(0,l.xn)(this.textBlock.id,e.shareWith),this.shares=this.shares.filter((t=>t.shareWith!==e.shareWith)),(0,d.Te)(t("mail","Share deleted for {name}",{name:e.shareWith}))}catch(n){(0,d.Qg)(t("mail","Failed to delete share with {name}",{name:e.shareWith}))}},async asyncFind(t){this.loading=!0,await this.debounceGetSuggestions(t.trim())},async getSuggestions(t){this.loading=!0;const e=[b.I.User,b.I.Group];let n=null;try{n=await C.Ay.get((0,f.KT)("apps/files_sharing/api/v1/sharees"),{params:{format:"json",itemType:"file",search:t,shareTypes:e}})}catch(t){return void x.A.error("Error fetching suggestions",t)}const i=n.data.ocs.data,a=n.data.ocs.data.exact;i.exact=[];const o=a.users.concat(a.groups),r=i.users.concat(i.groups),s=o.map((t=>this.formatForMultiselect(t))),l=r.map((t=>this.formatForMultiselect(t))).sort(((t,e)=>t.shareType-e.shareType)),c=s.concat(l).sort(((t,e)=>t.shareType-e.shareType)),d=c.reduce(((t,e)=>e.displayName?(t[e.displayName]||(t[e.displayName]=0),t[e.displayName]++,t):t),{});this.suggestions=c.map((t=>d[t.displayName]>1&&!t.desc?{...t,desc:t.shareWithDisplayNameUnique}:t)),this.loading=!1,x.A.info("suggestions",this.suggestions)},shareTypeToIcon(e){switch(e){case b.I.User:return{icon:"icon-user",iconTitle:t("files_sharing","Guest")};case b.I.Group:return{icon:"icon-group",iconTitle:t("files_sharing","Group")};default:return{}}},formatForMultiselect(t){return{shareWith:t.value.shareWith,shareType:t.value.shareType,user:t.uuid||t.value.shareWith,isNoUser:t.value.shareType!==b.I.User,displayName:t.name||t.label,shareWithDisplayNameUnique:t.shareWithDisplayNameUnique||"",...this.shareTypeToIcon(t.value.shareType)}},debounceGetSuggestions:g()(300,(function(){this.getSuggestions(...arguments)})),handleListItemClick(){this.isViewMode?this.$emit("click",this.textBlock):this.editModalOpen=!0},closeTextBlockDialog(){this.editModalOpen=!1,this.localTextBlock=JSON.parse(JSON.stringify(this.textBlock))},async saveTextBlock(){this.saveLoading=!0;try{await this.mainStore.patchTextBlock(this.localTextBlock),this.saveLoading=!1,this.editModalOpen=!1}catch(e){(0,d.Qg)(t("mail","Failed to save text block")),x.A.error("Failed to save text block",e)}}}};var _=i(85072),k=i.n(_),w=i(97825),S=i.n(w),I=i(77659),B=i.n(I),M=i(55056),T=i.n(M),E=i(10540),D=i.n(E),P=i(41113),N=i.n(P),R=i(93246),j={};j.styleTagTransform=N(),j.setAttributes=T(),j.insert=B().bind(null,"head"),j.domAPI=S(),j.insertStyleElement=D(),k()(R.A,j),R.A&&R.A.locals&&R.A.locals;const L=(0,i(14486).A)(y,(function(){var t=this,e=t._self._c;return e("div",[e("NcListItem",{staticClass:"text-block-list-item",attrs:{active:t.picked},on:{click:t.handleListItemClick},scopedSlots:t._u([{key:"name",fn:function(){return[t._v("\n\t\t\t"+t._s(t.textBlock.title)+"\n\t\t")]},proxy:!0},{key:"subname",fn:function(){return[t._v("\n\t\t\t"+t._s(t.textBlock.preview)+"\n\t\t")]},proxy:!0},t.shares.length>0?{key:"extra-actions",fn:function(){return[e("AccountMultiple",{attrs:{title:t.t("mail","Shared"),size:20}})]},proxy:!0}:null,t.shared?null:{key:"actions",fn:function(){return[e("NcActionButton",{on:{click:function(e){t.editModalOpen=!0}},scopedSlots:t._u([{key:"icon",fn:function(){return[e("IconPencil",{attrs:{size:20}})]},proxy:!0}],null,!1,291764094)},[t._v("\n\t\t\t\t"+t._s(t.t("mail","Edit {title}",{title:t.textBlock.title}))+"\n\t\t\t")]),t._v(" "),t.isViewMode?t._e():e("NcActionButton",{attrs:{icon:"icon-delete"},on:{click:function(e){return t.deleteTextBlock()}}},[t._v("\n\t\t\t\t"+t._s(t.t("mail","Delete {title}",{title:t.textBlock.title}))+"\n\t\t\t")])]},proxy:!0}],null,!0)}),t._v(" "),e("NcDialog",{attrs:{open:t.editModalOpen,name:t.t("mail","Edit text block"),size:"normal","is-form":!0},on:{"update:open":function(e){t.editModalOpen=e}}},[t.shared?e("p",[t._v("\n\t\t\t"+t._s(t.localTextBlock.title)+"\n\t\t")]):e("NcInputField",{attrs:{value:t.localTextBlock.title,label:t.t("mail","Title of the text block")},on:{"update:value":function(e){return t.$set(t.localTextBlock,"title",e)}}}),t._v(" "),e("TextEditor",{attrs:{"is-bordered":!t.shared,html:!0,"read-only":t.shared,placeholder:t.t("mail","Content of the text block"),bus:t.bus},model:{value:t.localTextBlock.content,callback:function(e){t.$set(t.localTextBlock,"content",e)},expression:"localTextBlock.content"}}),t._v(" "),t.shared?t._e():[e("h3",[t._v("\n\t\t\t\t"+t._s(t.t("mail","Shares"))+"\n\t\t\t")]),t._v(" "),e("NcSelect",{staticClass:"text-block-list-item__shares",attrs:{placeholder:t.t("mail","Search for users or groups"),"label-outside":!0,loading:t.loading,"user-select":!0,options:t.options,"get-option-label":t=>t.displayName},on:{"option:selecting":t.shareTextBlock,search:t.asyncFind},model:{value:t.share,callback:function(e){t.share=e},expression:"share"}}),t._v(" "),t._l(t.sortedShares,(function(n){return e("NcListItem",{key:n.shareWith,attrs:{name:n.displayName,compact:!0},scopedSlots:t._u([{key:"icon",fn:function(){return["group"===n.type?e("NcAvatar",{scopedSlots:t._u([{key:"icon",fn:function(){return[e("AccountMultiple",{attrs:{size:20}})]},proxy:!0}],null,!0)}):e("NcAvatar",{attrs:{user:n.shareWith,"display-name":n.displayName}})]},proxy:!0},{key:"extra-actions",fn:function(){return[e("NcButton",{attrs:{type:"tertiary-no-background"},on:{click:function(e){return t.removeShare(n)}},scopedSlots:t._u([{key:"icon",fn:function(){return[e("IconClose",{attrs:{size:20}})]},proxy:!0}],null,!0)})]},proxy:!0}],null,!0)})})),t._v(" "),e("div",{staticClass:"text-block-buttons"},[e("NcButton",{staticClass:"text-block-buttons__button",attrs:{type:"tertiary",disabled:t.saveLoading},on:{click:t.closeTextBlockDialog},scopedSlots:t._u([{key:"icon",fn:function(){return[e("IconClose",{attrs:{size:20}})]},proxy:!0}],null,!1,2888946197)},[t._v("\n\t\t\t\t\t"+t._s(t.t("mail","Cancel"))+"\n\t\t\t\t")]),t._v(" "),e("NcButton",{staticClass:"text-block-buttons__button",attrs:{type:"primary",disabled:!t.localTextBlock.title||!t.localTextBlock.content||t.saveLoading},on:{click:t.saveTextBlock},scopedSlots:t._u([{key:"icon",fn:function(){return[t.saveLoading?e("NcLoadingIcon",{attrs:{size:20}}):e("IconCheck",{attrs:{size:20}})]},proxy:!0}],null,!1,1468414576)},[t._v("\n\t\t\t\t\t"+t._s(t.t("mail","Ok"))+"\n\t\t\t\t")])],1)]],2)],1)}),[],!1,null,"51280ad6",null).exports},50310:()=>{},51648:(t,e,n)=>{"use strict";n.d(e,{T:()=>a});var i=n(53334);const a=t=>{if(t.specialUse.length>0)try{return(t=>{if(t.specialUse.includes("all"))return(0,i.Tl)("mail","All");if(t.specialUse.includes("archive"))return(0,i.Tl)("mail","Archive");if(t.specialUse.includes("drafts"))return(0,i.Tl)("mail","Drafts");if(t.specialUse.includes("flagged"))return(0,i.Tl)("mail","Favorites");if(t.specialUse.includes("inbox"))return t.isPriorityInbox?(0,i.Tl)("mail","Priority inbox"):t.isUnified?(0,i.Tl)("mail","All inboxes"):(0,i.Tl)("mail","Inbox");if(t.specialUse.includes("junk"))return(0,i.Tl)("mail","Junk");if(t.specialUse.includes("sent"))return(0,i.Tl)("mail","Sent");if(t.specialUse.includes("trash"))return(0,i.Tl)("mail","Trash");throw new Error(`unknown special use ${t.specialUse}`)})(t)}catch(t){console.error("could not translate special mailbox",t)}return t.displayName}},57092:(t,e,n)=>{var i={"./af":18474,"./af.js":18474,"./ar":14630,"./ar.js":14630,"./ast":34117,"./ast.js":34117,"./az":17614,"./az.js":17614,"./bg":33442,"./bg.js":33442,"./bn":94217,"./bn.js":94217,"./bs":87710,"./bs.js":87710,"./ca":76477,"./ca.js":76477,"./cs":30315,"./cs.js":30315,"./da":21630,"./da.js":21630,"./de":13842,"./de-ch":32172,"./de-ch.js":32172,"./de.js":13842,"./el":90908,"./el.js":90908,"./en-au":4661,"./en-au.js":4661,"./en-gb":8966,"./en-gb.js":8966,"./eo":20645,"./eo.js":20645,"./es":58017,"./es-co":37096,"./es-co.js":37096,"./es.js":58017,"./et":46772,"./et.js":46772,"./eu":94715,"./eu.js":94715,"./fa":37232,"./fa.js":37232,"./fi":56536,"./fi.js":56536,"./fr":84505,"./fr.js":84505,"./gl":2878,"./gl.js":2878,"./gu":91173,"./gu.js":91173,"./he":32214,"./he.js":32214,"./hi":89810,"./hi.js":89810,"./hr":78951,"./hr.js":78951,"./hu":1798,"./hu.js":1798,"./hy":62562,"./hy.js":62562,"./id":15976,"./id.js":15976,"./it":27032,"./it.js":27032,"./ja":22668,"./ja.js":22668,"./jv":43881,"./jv.js":43881,"./kk":87083,"./kk.js":87083,"./km":45713,"./km.js":45713,"./kn":54680,"./kn.js":54680,"./ko":17839,"./ko.js":17839,"./ku":76761,"./ku.js":76761,"./lt":82873,"./lt.js":82873,"./lv":52311,"./lv.js":52311,"./ms":31049,"./ms.js":31049,"./nb":94609,"./nb.js":94609,"./ne":64484,"./ne.js":64484,"./nl":53027,"./nl.js":53027,"./no":47622,"./no.js":47622,"./oc":7807,"./oc.js":7807,"./pl":56949,"./pl.js":56949,"./pt":4557,"./pt-br":77494,"./pt-br.js":77494,"./pt.js":4557,"./ro":80554,"./ro.js":80554,"./ru":31608,"./ru.js":31608,"./si":82917,"./si.js":82917,"./sk":73955,"./sk.js":73955,"./sl":96442,"./sl.js":96442,"./sq":20893,"./sq.js":20893,"./sr":22772,"./sr-latn":76220,"./sr-latn.js":76220,"./sr.js":22772,"./sv":90152,"./sv.js":90152,"./th":11813,"./th.js":11813,"./ti":9894,"./ti.js":9894,"./tk":82076,"./tk.js":82076,"./tr":28411,"./tr.js":28411,"./tt":49185,"./tt.js":49185,"./ug":54813,"./ug.js":54813,"./uk":37977,"./uk.js":37977,"./ur":65218,"./ur.js":65218,"./uz":14010,"./uz.js":14010,"./vi":58824,"./vi.js":58824,"./zh":78251,"./zh-cn":91773,"./zh-cn.js":91773,"./zh.js":78251};function a(t){return o(t).then((t=>n.t(t,23)))}function o(t){return n.e(552).then((()=>{if(!n.o(i,t)){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}return i[t]}))}a.keys=()=>Object.keys(i),a.resolve=o,a.id=57092,t.exports=a},61069:(e,n,i)=>{"use strict";i.d(n,{A:()=>xe});var a=i(4658),o=i(26430),r=i(64708),s=i(63814),l=i(54914),c=i(85745),d=i(97627),u=i(25216),m=i(86883),A=i(71561),p=i(6961),h=i(39487),g=i(99495),b=i(85168),f=i(51849),v=i(49519);const x={name:"NavigationAccount",components:{NcAppNavigationCaption:a.dL,Fragment:l.F,ActionButton:a.Ko,ActionCheckbox:a.RI,ActionInput:a.Az,ActionText:a.HO,AccountSettings:()=>Promise.all([i.e(219),i.e(165),i.e(432),i.e(563),i.e(730)]).then(i.bind(i,72594)),IconInfo:u.A,IconSettings:m.A,IconFolderAdd:A.A,MenuDown:p.A,MenuUp:h.A,IconDelete:g.A,IconLoading:a.ne},props:{account:{type:Object,required:!0},firstMailbox:{type:Object,default:()=>{}},isFirst:{type:Boolean,default:!1},isLast:{type:Boolean,default:!1},isDisabled:{type:Boolean,default:!1}},data:()=>({menuOpen:!1,loading:{delete:!1},savingShowOnlySubscribed:!1,quota:void 0,editing:!1,showSaving:!1,createMailboxName:"",showMailboxes:!1,nameInput:!1,nameLabel:!0}),computed:{...(0,f.n2)(v.A),showSettings(){return this.mainStore.showSettingsForAccount(this.account.id)},visible(){return!0!==this.account.isUnified&&!1!==this.account.visible},id(){return"account-"+this.account.id},quotaText(){return this.quota?t("mail","Used quota: {quota}% ({limit})",{quota:Math.ceil(this.quota.usage/this.quota.limit*100),limit:(0,r.v7)(this.quota.limit)}):this.account.quotaPercentage?t("mail","Used quota: {quota}%",{quota:this.account.quotaPercentage}):""}},methods:{async createMailbox(e){this.nameInput=!1,this.showSaving=!0;const n=this.createMailboxName;c.A.info("creating mailbox "+n),this.menuOpen=!1;try{await this.mainStore.createMailbox({account:this.account,name:n})}catch(e){throw(0,b.Qg)(t("mail","Unable to create mailbox. The name likely contains invalid characters. Please try another name.")),c.A.error("could not create folder",{error:e}),e}finally{this.showSaving=!1,this.nameInput=!1,this.editing=!1,this.createMailboxName=""}c.A.info(`mailbox ${n} created`)},openCreateMailbox(){this.editing=!0,this.nameInput=!0,this.showSaving=!1},async removeAccount(){const e=this.account.id;c.A.info("delete account",{account:this.account});const n=(new b.ik).setName(t("mail","Remove account")).setText(t("mail","The account for {email} and cached email data will be removed from Nextcloud, but not from your email provider.",{email:this.account.emailAddress})).setButtons([{label:t("mail","Cancel")},{label:t("mail","Remove {email}",{email:this.account.emailAddress}),type:"error",callback:async()=>{this.loading.delete=!0;try{await this.mainStore.deleteAccount(this.account),c.A.info(`account ${e} deleted, redirecting …`),location.href=(0,s.Jv)("/apps/mail")}catch(t){c.A.error("could not delete account",{error:t})}finally{this.loading.delete=!1}}}]).build();await n.show()},changeAccountOrderUp(){this.mainStore.moveAccount({account:this.account,up:!0}).catch((t=>c.A.error("could not move account up",{error:t})))},changeAccountOrderDown(){this.mainStore.moveAccount({account:this.account}).catch((t=>c.A.error("could not move account down",{error:t})))},changeShowSubscribedOnly(t){this.savingShowOnlySubscribed=!0,this.mainStore.patchAccount({account:this.account,data:{showSubscribedOnly:t}}).then((()=>{this.savingShowOnlySubscribed=!1,c.A.info("show only subscribed folders updated to "+t)})).catch((t=>{throw c.A.error("could not update subscription mode",{error:t}),this.savingShowOnlySubscribed=!1,t}))},onMenuToggle(t){t&&null!==this.account.quotaPercentage&&(console.debug("accounts menu opened, fetching quota"),this.fetchQuota())},async fetchQuota(){const t=await(0,d.FY)(this.account.id);console.debug("quota fetched",{quota:t}),this.quota=void 0!==t&&t},showAccountSettings(t){t?this.mainStore.showSettingsForAccountMutation(this.account.id):this.mainStore.showSettingsForAccountMutation(null)}}};var C=i(85072),y=i.n(C),_=i(97825),k=i.n(_),w=i(77659),S=i.n(w),I=i(55056),B=i.n(I),M=i(10540),T=i.n(M),E=i(41113),D=i.n(E),P=i(46388),N={};N.styleTagTransform=D(),N.setAttributes=B(),N.insert=S().bind(null,"head"),N.domAPI=k(),N.insertStyleElement=T(),y()(P.A,N),P.A&&P.A.locals&&P.A.locals;var R=i(14486);const j=(0,R.A)(x,(function(){var t=this,e=t._self._c;return e("Fragment",[t.visible?e("NcAppNavigationCaption",{key:t.id,attrs:{id:t.id,name:t.account.emailAddress},on:{"update:open":t.onMenuToggle},scopedSlots:t._u([{key:"actions",fn:function(){return[t.isDisabled?[e("ActionText",{attrs:{name:t.t("mail","Provisioned account is disabled")},scopedSlots:t._u([{key:"icon",fn:function(){return[e("IconInfo",{attrs:{size:20}})]},proxy:!0}],null,!1,3812223437)},[t._v("\n\t\t\t\t\t"+t._s(t.t("mail","Please login using a password to enable this account. The current session is using passwordless authentication, e.g. SSO or WebAuthn."))+"\n\t\t\t\t")])]:[t.account.isUnified||null===t.account.quotaPercentage?t._e():e("ActionText",{scopedSlots:t._u([{key:"icon",fn:function(){return[e("IconInfo",{attrs:{size:20}})]},proxy:!0}],null,!1,3812223437)},[t._v("\n\t\t\t\t\t"+t._s(t.quotaText)+"\n\t\t\t\t")]),t._v(" "),e("ActionButton",{attrs:{"close-after-click":!0},on:{click:function(e){return t.showAccountSettings(!0)}},scopedSlots:t._u([{key:"icon",fn:function(){return[e("IconSettings",{attrs:{size:20}})]},proxy:!0}],null,!1,408832678)},[t._v("\n\t\t\t\t\t"+t._s(t.t("mail","Account settings"))+"\n\t\t\t\t")]),t._v(" "),e("ActionCheckbox",{attrs:{checked:t.account.showSubscribedOnly,disabled:t.savingShowOnlySubscribed},on:{"update:checked":t.changeShowSubscribedOnly}},[t._v("\n\t\t\t\t\t"+t._s(t.t("mail","Show only subscribed folders"))+"\n\t\t\t\t")]),t._v(" "),!t.editing&&t.nameLabel?e("ActionButton",{on:{click:t.openCreateMailbox},scopedSlots:t._u([{key:"icon",fn:function(){return[e("IconFolderAdd",{attrs:{size:20}})]},proxy:!0}],null,!1,2169509812)},[t._v("\n\t\t\t\t\t"+t._s(t.t("mail","Add folder"))+"\n\t\t\t\t")]):t._e(),t._v(" "),t.editing&&t.nameInput?e("ActionInput",{attrs:{value:t.createMailboxName},on:{"update:value":function(e){t.createMailboxName=e},submit:function(e){return e.preventDefault(),e.stopPropagation(),t.createMailbox.apply(null,arguments)}},scopedSlots:t._u([{key:"icon",fn:function(){return[e("IconFolderAdd",{attrs:{size:20}})]},proxy:!0}],null,!1,2169509812)},[t._v("\n\t\t\t\t\t"+t._s(t.t("mail","Folder name"))+"\n\t\t\t\t")]):t._e(),t._v(" "),t.showSaving?e("ActionText",{scopedSlots:t._u([{key:"icon",fn:function(){return[e("IconLoading",{attrs:{size:20}})]},proxy:!0}],null,!1,3081367109)},[t._v("\n\t\t\t\t\t"+t._s(t.t("mail","Saving"))+"\n\t\t\t\t")]):t._e(),t._v(" "),t.isFirst?t._e():e("ActionButton",{on:{click:t.changeAccountOrderUp},scopedSlots:t._u([{key:"icon",fn:function(){return[e("MenuUp",{attrs:{size:20}})]},proxy:!0}],null,!1,859424094)},[t._v("\n\t\t\t\t\t"+t._s(t.t("mail","Move up"))+"\n\t\t\t\t")]),t._v(" "),t.isLast?t._e():e("ActionButton",{on:{click:t.changeAccountOrderDown},scopedSlots:t._u([{key:"icon",fn:function(){return[e("MenuDown",{attrs:{size:20}})]},proxy:!0}],null,!1,3657048169)},[t._v("\n\t\t\t\t\t"+t._s(t.t("mail","Move down"))+"\n\t\t\t\t")]),t._v(" "),t.account.provisioningId?t._e():e("ActionButton",{on:{click:t.removeAccount},scopedSlots:t._u([{key:"icon",fn:function(){return[e("IconDelete",{attrs:{size:20}})]},proxy:!0}],null,!1,881161434)},[t._v("\n\t\t\t\t\t"+t._s(t.t("mail","Remove account"))+"\n\t\t\t\t")])]]},proxy:!0}],null,!1,4051550634)}):t._e(),t._v(" "),e("AccountSettings",{attrs:{open:t.showSettings,account:t.account},on:{"update:open":function(e){return t.showAccountSettings(e)}}})],1)}),[],!1,null,null,null).exports,L={name:"NavigationAccountExpandCollapse",components:{AppNavigationItem:a.G_},props:{account:{type:Object,required:!0}},computed:{...(0,f.n2)(v.A),id(){return"collapse-"+this.account.id},title(){return this.account.collapsed&&this.account.showSubscribedOnly?t("mail","Show all subscribed folders"):this.account.collapsed&&!this.account.showSubscribedOnly?t("mail","Show all folders"):t("mail","Collapse folders")}},methods:{async toggleCollapse(){c.A.debug("toggling collapsed mailboxes for account "+this.account.id);try{await this.mainStore.toggleAccountCollapsedMutation(this.account.id),await this.mainStore.setAccountSetting({accountId:this.account.id,key:"collapsed",value:this.account.collapsed})}catch(t){c.A.error("could not update account settings",{error:t})}}}};var O=i(18068),F={};F.styleTagTransform=D(),F.setAttributes=B(),F.insert=S().bind(null,"head"),F.domAPI=k(),F.insertStyleElement=T(),y()(O.A,F),O.A&&O.A.locals&&O.A.locals;const z=(0,R.A)(L,(function(){var t=this;return(0,t._self._c)("AppNavigationItem",{attrs:{name:t.title},on:{click:t.toggleCollapse}})}),[],!1,null,"2f1e2a14",null).exports;var U=i(90913),$=i(35195),q=i(97101),V=i(56417),W=i(42622),G=i(29689),K=i(95790),Y=i(86791),H=i(71229),Q=i(10578),J=i(42882),X=i(21726),Z=i(95797),tt=i(6178),et=i(18896),nt=i(3477);const it={name:"MoveMailboxModal",components:{MailboxPicker:i(64678).A},props:{account:{type:Object,required:!0},mailbox:{type:Object,required:!0}},data:()=>({moving:!1,destMailboxId:void 0}),computed:{...(0,f.n2)(v.A)},methods:{onClose(){this.$emit("close")},async onMove(){if(this.moving=!0,this.mailbox.id!==this.destMailboxId)try{if(this.destMailboxId){const t=this.mainStore.getMailbox(this.destMailboxId).name+this.mailbox.delimiter+this.mailbox.displayName;await this.mainStore.renameMailbox({account:this.account,mailbox:this.mailbox,newName:t})}else{const t=this.mailbox.displayName;await this.mainStore.renameMailbox({account:this.account,mailbox:this.mailbox,newName:t})}}catch(t){c.A.error("could not move folder",{error:t})}finally{this.moving=!1,this.$emit("close")}},genId:t=>"mailbox-"+t.databaseId}},at=(0,R.A)(it,(function(){var t=this;return(0,t._self._c)("MailboxPicker",{attrs:{account:t.account,selected:t.destMailboxId,loading:t.moving,"picked-mailbox":t.mailbox,"allow-root":!0,"label-select":t.t("mail","Move"),"label-select-loading":t.t("mail","Moving")},on:{"update:selected":function(e){t.destMailboxId=e},select:t.onMove,close:t.onClose}})}),[],!1,null,null,null).exports;var ot=i(87314),rt=i(28290),st=i(1468),lt=i(50966),ct=i(53334),dt=i(51648),ut=i(35630);class mt{constructor(t,e,n){this.el=t,this.options=n,this.mainStore=n.mainStore,this.registerListeners.bind(this)(t),this.setInitialAttributes()}setInitialAttributes(){this.draggableInfo={},this.setStatus("enabled")}update(t,e){this.setInitialAttributes(),this.options=e.options}registerListeners(t){ut.A.on("drag-start",this.onDragStart.bind(this)),ut.A.on("drag-end",this.onDragEnd.bind(this)),t.firstChild.addEventListener("dragover",this.onDragOver.bind(this)),t.firstChild.addEventListener("dragleave",this.onDragLeave.bind(this)),t.firstChild.addEventListener("drop",this.onDrop.bind(this))}removeListeners(t){ut.A.off("drag-start",this.onDragStart),ut.A.off("drag-end",this.onDragEnd),t.firstChild.removeEventListener("dragover",this.onDragOver),t.firstChild.removeEventListener("dragleave",this.onDragLeave),t.firstChild.removeEventListener("drop",this.onDrop)}setStatus(t){this.el.setAttribute("droppable-mailbox",t)}onDragStart(t){this.draggableInfo=t,this.canBeDropped()||this.setStatus("disabled")}canBeDropped(){return this.isSameAccount()&&this.options.isValidDropTarget}isSameAccount(){return this.draggableInfo.accountId===this.options.accountId}get isCurrentlyDragging(){return Object.keys(this.draggableInfo).length>0}onDragEnd(){this.setInitialAttributes()}onDragOver(t){this.isCurrentlyDragging&&(t.preventDefault(),this.draggableInfo.mailboxId!==this.options.mailboxId&&(this.options.isValidDropTarget&&this.setStatus("dragover"),t.dataTransfer.dropEffect="move"))}onDragLeave(t){this.isCurrentlyDragging&&(t.preventDefault(),this.setStatus("enabled"))}async onDrop(t){if(!this.isCurrentlyDragging)return;if(t.preventDefault(),this.draggableInfo.mailboxId===this.options.mailboxId)return;this.setInitialAttributes();const e=JSON.parse(t.dataTransfer.getData("text"));ut.A.emit("envelopes-dropped",{envelopes:e});try{const t=e.map((async t=>await this.processDroppedItem(t)));await Promise.all(t)}catch(t){c.A.error("could not process dropped messages",t)}finally{ut.A.emit("envelopes-moved",{mailboxId:this.options.mailboxId,movedEnvelopes:e})}}async processDroppedItem(t){const e=document.querySelector(`[data-envelope-id="${t.databaseId}"]`);e.setAttribute("draggable-envelope","pending");try{"threaded"===this.mainStore.getPreference("layout-message-view")?await this.mainStore.moveThread({envelope:t,destMailboxId:this.options.mailboxId}):await this.mainStore.moveMessage({id:t.databaseId,destMailboxId:this.options.mailboxId})}catch(t){e.removeAttribute("draggable-envelope"),c.A.error("could not move messages",t)}}}let At;const pt={bind(t,e,n){At=new mt(t,n.context,e.value)},componentUpdated(t,e){At.options=e.value,At.update(t,At)}};var ht=i(63508);const gt={name:"NavigationMailbox",components:{AppNavigationItem:a.G_,CounterBubble:a.E7,ActionText:a.HO,ActionButton:a.Ko,ActionCheckbox:a.RI,ActionInput:a.Az,IconSend:et.A,IconDelete:g.A,IconEmailCheck:U.A,IconExternal:$.A,IconFolderAdd:V.A,IconFolderRename:G.A,IconFolderSync:K.A,IconInfo:u.A,IconAllInboxes:X.A,IconFavorite:W.A,IconFolder:A.A,IconFolderShared:q.A,IconDraft:Y.A,IconArchive:H.A,IconJunk:J.A,IconInbox:Q.A,IconWrench:nt.A,EraserIcon:Z.A,ImportantIcon:tt.A,IconLoading:a.ne,MoveMailboxModal:at,AlarmIcon:ht.A},directives:{droppableMailbox:pt},props:{account:{type:Object,required:!0},mailbox:{type:Object,required:!0},filter:{type:String,default:"",required:!1}},data(){return{debug:window?.OC?.debug||!1,mailboxStats:void 0,loadingMarkAsRead:!1,clearingCache:!1,showSaving:!1,changeSubscription:!1,changingSyncInBackground:!1,editing:!1,showSubMailboxes:!1,menuOpen:!1,renameLabel:!0,renameInput:!1,mailboxName:this.mailbox.displayName,showMoveModal:!1,hasDelimiter:!!this.mailbox.delimiter,UNIFIED_INBOX_ID:ot.mH,createMailboxName:"",repairing:!1}},computed:{...(0,f.n2)(v.A),visible(){return(!1===this.account.showSubscribedOnly||this.mailbox.attributes&&this.mailbox.attributes.includes("\\subscribed"))&&this.isUnifiedButOnlyInbox},notInbox(){return"inbox"!==this.mailbox.name.toLowerCase()},notVirtual(){return!this.account.isUnified&&"flagged"!==this.mailbox.specialRole&&!this.filter},title(){return"starred"===this.filter?(0,dt.T)({...this.mailbox,specialUse:["flagged"]}):(0,dt.T)(this.mailbox)},to(){return{name:"mailbox",params:{mailboxId:this.mailbox.databaseId,filter:this.filter?this.filter:void 0}}},hasSubMailboxes(){return this.subMailboxes.length>0},subMailboxes(){return this.mainStore.getSubMailboxes(this.mailbox.databaseId)},statsText(){return this.mailboxStats&&"total"in this.mailboxStats&&"unread"in this.mailboxStats?0===this.mailboxStats.unread?(0,ct.zw)("mail","{total} message","{total} messages",this.mailboxStats.total,{total:this.mailboxStats.total}):(0,ct.zw)("mail","{unread} unread of {total}","{unread} unread of {total}",this.mailboxStats.unread,{total:this.mailboxStats.total,unread:this.mailboxStats.unread}):t("mail","Loading …")},isDroppableSpecialMailbox(){return"starred"!==this.filter&&![this.account.draftsMailboxId,this.account.sentMailboxId].includes(this.mailbox.databaseId)},isActive(){return this.$route.params.mailboxId===this.mailbox.databaseId},isValidDropTarget(){return!(this.isActive||!this.hasInsertAcl)&&(this.isDroppableSpecialMailbox||!this.mailbox.specialRole&&!this.account.isUnified)},isUnifiedButOnlyInbox(){return!this.mailbox.isUnified||this.mailbox.specialUse.includes("inbox")&&this.mainStore.getAccounts.length>2},showUnreadCounter(){return"starred"!==this.filter&&"trash"!==this.mailbox.specialRole&&(this.mailbox.unread>0||this.subCounter>0)},subCounter(){return this.subMailboxes.reduce(((t,e)=>t+e.unread),0)},hasRenameAcl(){if(!this.mailbox.myAcls)return!0;const t=this.mainStore.getParentMailbox(this.mailbox.databaseId);return t&&t.myAcls?(0,rt.w)(this.mailbox,"x")&&(0,rt.w)(t,"k"):(0,rt.w)(this.mailbox,"x")},hasInsertAcl(){return(0,rt.w)(this.mailbox,"i")},hasSeenAcl(){return(0,rt.w)(this.mailbox,"s")},hasSubmailboxActionAcl(){return(0,rt.w)(this.mailbox,"k")},hasDeleteAcl(){return(0,rt.w)(this.mailbox,"x")},hasClearMailboxAcl(){return(0,rt.w)(this.mailbox,"te")}},mounted(){ut.A.on("drag-start",this.onDragStart),ut.A.on("drag-end",this.onDragEnd),ut.A.on("envelopes-moved",this.onEnvelopesMoved)},beforeDestroy(){ut.A.off("drag-start",this.onDragStart),ut.A.off("drag-end",this.onDragEnd),ut.A.off("envelopes-moved",this.onEnvelopesMoved)},methods:{genId:t=>"folder-"+t.databaseId,onMenuToggle(t){t&&this.fetchMailboxStats()},async fetchMailboxStats(){if(this.mailboxStats=null,!this.account.isUnified&&"flagged"!==this.mailbox.specialRole)try{const t=await(0,lt.Np)(this.mailbox.databaseId);c.A.debug(`loaded mailbox stats for ${this.mailbox.databaseId}`,{stats:t}),this.mailboxStats=t}catch(t){this.mailboxStats={error:!0},c.A.error(`could not load mailbox stats for ${this.mailbox.databaseId}`,t)}},async createMailbox(t){this.editing=!0;const e=this.createMailboxName,n=this.mailbox.name+this.mailbox.delimiter+e;c.A.info(`creating mailbox ${n} as submailbox of ${this.mailbox.databaseId}`),this.menuOpen=!1;try{await this.mainStore.createMailbox({account:this.account,name:n})}catch(t){throw c.A.error(`could not create mailbox ${n}`,{error:t}),t}finally{this.editing=!1,this.showSaving=!1}c.A.info(`mailbox ${n} created`),this.showSubMailboxes=!0},openCreateMailbox(){this.editing=!0,this.showSaving=!1},markAsRead(){this.loadingMarkAsRead=!0,this.mainStore.markMailboxRead({accountId:this.account.id,mailboxId:this.mailbox.databaseId}).then((()=>c.A.info(`mailbox ${this.mailbox.databaseId} marked as read`))).catch((t=>c.A.error(`could not mark mailbox ${this.mailbox.databaseId} as read`,{error:t}))).then((()=>this.loadingMarkAsRead=!1))},async changeFolderSubscription(t){try{this.changeSubscription=!0,await this.mainStore.changeMailboxSubscription({mailbox:this.mailbox,subscribed:t})}catch(t){throw c.A.error(`could not update subscription of mailbox ${this.mailbox.databaseId}`,{error:t}),t}finally{this.changeSubscription=!1}},async changeSyncInBackground(t){try{this.changingSyncInBackground=!0,await this.mainStore.patchMailbox({mailbox:this.mailbox,attributes:{syncInBackground:t}})}catch(t){throw c.A.error(`could not update background sync flag of mailbox ${this.mailbox.databaseId}`,{error:t}),t}finally{this.changingSyncInBackground=!1}},async clearCache(){try{this.clearingCache=!0,c.A.debug("clearing message cache",{accountId:this.account.id,mailboxId:this.mailbox.databaseId}),await(0,st.IL)(this.account.id,this.mailbox.databaseId),window.location.reload(!1)}finally{this.clearCache=!1}},clearMailbox(){const e=this.mailbox.databaseId;OC.dialogs.confirmDestructive(t("mail","All messages in mailbox will be deleted."),t("mail","Clear mailbox {name}",{name:this.mailbox.displayName}),{type:OC.dialogs.YES_NO_BUTTONS,confirm:t("mail","Clear folder"),confirmClasses:"error",cancel:t("mail","Cancel")},(t=>{if(t)return this.mainStore.clearMailbox({mailbox:this.mailbox}).then((()=>{c.A.info(`mailbox ${e} cleared`)})).catch((t=>c.A.error("could not clear folder",{error:t})))}))},deleteMailbox(){const e=this.mailbox.databaseId;c.A.info("delete folder",{mailbox:this.mailbox}),OC.dialogs.confirmDestructive(t("mail","The folder and all messages in it will be deleted."),t("mail","Delete folder"),{type:OC.dialogs.YES_NO_BUTTONS,confirm:t("mail","Delete folder {name}",{name:this.mailbox.displayName}),confirmClasses:"error",cancel:t("mail","Cancel")},(t=>{if(t)return this.mainStore.deleteMailbox({mailbox:this.mailbox}).then((()=>{c.A.info(`mailbox ${e} deleted`),parseInt(this.$route.params.mailboxId,10)===this.mailbox.databaseId&&this.$router.push({name:"mailbox",params:{mailboxId:ot.U8}})})).catch((t=>c.A.error("could not delete folder",{error:t})))}))},async renameMailbox(){this.renameInput=!1,this.showSaving=!0;try{let t=this.mailboxName;this.mailbox.path&&(t=this.mailbox.path+this.mailbox.delimiter+t),await this.mainStore.renameMailbox({account:this.account,mailbox:this.mailbox,newName:t}),this.renameLabel=!0,this.renameInput=!1}catch(e){(0,b.cf)(t("mail","An error occurred, unable to rename the mailbox.")),console.error(e)}finally{this.showSaving=!1}},openRenameInput(){this.renameLabel=!1,this.renameInput=!0,this.showSaving=!1},onOpenMoveModal(){this.showMoveModal=!0},onCloseMoveModal(){this.showMoveModal=!1},onDragStart(t){let{accountId:e}=t;e===this.mailbox.accountId&&(this.mainStore.expandAccountMutation(e),this.showSubMailboxes=!0)},onDragEnd(t){let{accountId:e}=t;e===this.mailbox.accountId&&(this.showSubMailboxes=!1)},onEnvelopesMoved(t){let{mailboxId:e,movedEnvelopes:n}=t;if(this.mailbox.databaseId!==e)return;const i=n.find((t=>t.envelopeId===this.$route.params.threadId));"message"===this.$route.name&&i&&this.$router.push({name:"mailbox",params:{mailboxId:this.$route.params.mailboxId,filter:this.$route.params?.filter}})},async repair(){this.repairing=!0;const e=this.mailbox.databaseId;try{await(0,lt.AF)(e),await this.$router.push({name:"mailbox",params:{mailboxId:this.$route.params.mailboxId}}),window.location.reload()}catch(e){if(this.repairing=!1,429!==e.response?.status)throw e;(0,b.Qg)(t("mail","Please wait 10 minutes before repairing again"))}}}};var bt=i(1673),ft={};ft.styleTagTransform=D(),ft.setAttributes=B(),ft.insert=S().bind(null,"head"),ft.domAPI=k(),ft.insertStyleElement=T(),y()(bt.A,ft),bt.A&&bt.A.locals&&bt.A.locals;const vt=(0,R.A)(gt,(function(){var t=this,e=t._self._c;return t.visible?e("AppNavigationItem",{directives:[{name:"droppable-mailbox",rawName:"v-droppable-mailbox",value:{mainStore:t.mainStore,mailboxId:t.mailbox.databaseId,accountId:t.mailbox.accountId,isValidDropTarget:t.isValidDropTarget},expression:"{\n\t\tmainStore: mainStore,\n\t\tmailboxId: mailbox.databaseId,\n\t\taccountId: mailbox.accountId,\n\t\tisValidDropTarget,\n\t}"}],key:t.genId(t.mailbox),attrs:{id:t.genId(t.mailbox),"allow-collapse":t.hasSubMailboxes,"menu-open":t.menuOpen,"force-menu":!0,name:t.title,to:t.to,open:t.showSubMailboxes},on:{"update:menuOpen":[function(e){t.menuOpen=e},t.onMenuToggle],"update:menu-open":function(e){t.menuOpen=e},"update:open":function(e){t.showSubMailboxes=e}},scopedSlots:t._u([{key:"icon",fn:function(){return[e("div",[t.mailbox.isPriorityInbox?e("ImportantIcon",{attrs:{size:20}}):t.mailbox.id===t.UNIFIED_INBOX_ID?e("IconAllInboxes",{attrs:{size:20}}):"inbox"!==t.mailbox.specialRole||t.mailbox.isPriorityInbox||"starred"===t.filter?"starred"===t.filter?e("IconFavorite",{attrs:{size:20}}):t.mailbox.databaseId===t.account.draftsMailboxId?e("IconDraft",{attrs:{size:20}}):t.mailbox.databaseId===t.account.sentMailboxId?e("IconSend",{attrs:{size:20}}):t.mailbox.databaseId===t.account.archiveMailboxId?e("IconArchive",{attrs:{size:20}}):t.mailbox.databaseId===t.account.trashMailboxId?e("IconDelete",{attrs:{size:20}}):t.mailbox.databaseId===t.account.junkMailboxId?e("IconJunk",{attrs:{size:20}}):t.mailbox.databaseId===t.account.snoozeMailboxId?e("AlarmIcon",{attrs:{size:20}}):t.mailbox.shared?e("IconFolderShared",{attrs:{size:20}}):e("IconFolder",{attrs:{size:20}}):e("IconInbox",{attrs:{size:20}})],1)]},proxy:!0},{key:"actions",fn:function(){return[t.account.isUnified||"flagged"===t.mailbox.specialRole?t._e():e("ActionText",{attrs:{name:t.mailbox.name},scopedSlots:t._u([{key:"icon",fn:function(){return[e("IconInfo",{attrs:{title:t.statsText,size:20}})]},proxy:!0}],null,!1,3059915399)},[t._v("\n\t\t\t"+t._s(t.statsText)+"\n\t\t")]),t._v(" "),"flagged"!==t.mailbox.specialRole&&!t.account.isUnified&&t.hasSeenAcl?e("ActionButton",{attrs:{name:t.t("mail","Mark all as read"),disabled:t.loadingMarkAsRead},on:{click:t.markAsRead},scopedSlots:t._u([{key:"icon",fn:function(){return[e("IconEmailCheck",{attrs:{size:20}})]},proxy:!0}],null,!1,46646313)},[t._v("\n\t\t\t"+t._s(t.t("mail","Mark all messages of this folder as read"))+"\n\t\t")]):t._e(),t._v(" "),!t.editing&&!t.account.isUnified&&t.hasDelimiter&&"flagged"!==t.mailbox.specialRole&&t.hasSubmailboxActionAcl?e("ActionButton",{on:{click:t.openCreateMailbox},scopedSlots:t._u([{key:"icon",fn:function(){return[e("IconFolderAdd",{attrs:{size:20}})]},proxy:!0}],null,!1,2169509812)},[t._v("\n\t\t\t"+t._s(t.t("mail","Add subfolder"))+"\n\t\t")]):t._e(),t._v(" "),t.editing?e("ActionInput",{attrs:{value:t.createMailboxName},on:{"update:value":function(e){t.createMailboxName=e},submit:function(e){return e.preventDefault(),e.stopPropagation(),t.createMailbox.apply(null,arguments)}},scopedSlots:t._u([{key:"icon",fn:function(){return[e("IconFolderAdd",{attrs:{size:20}})]},proxy:!0}],null,!1,2169509812)}):t._e(),t._v(" "),t.renameLabel&&!t.hasSubMailboxes&&!t.account.isUnified&&t.hasRenameAcl?e("ActionButton",{on:{click:function(e){return e.preventDefault(),e.stopPropagation(),t.openRenameInput.apply(null,arguments)}},scopedSlots:t._u([{key:"icon",fn:function(){return[e("IconFolderRename",{attrs:{size:20}})]},proxy:!0}],null,!1,2880355077)},[t._v("\n\t\t\t"+t._s(t.t("mail","Rename"))+"\n\t\t")]):t._e(),t._v(" "),t.renameInput?e("ActionInput",{attrs:{value:t.mailboxName},on:{"update:value":function(e){t.mailboxName=e},submit:function(e){return e.preventDefault(),e.stopPropagation(),t.renameMailbox.apply(null,arguments)}},scopedSlots:t._u([{key:"icon",fn:function(){return[e("IconFolderRename",{attrs:{title:t.t("mail","Rename"),size:20}})]},proxy:!0}],null,!1,990908275)}):t._e(),t._v(" "),t.showSaving?e("ActionText",{scopedSlots:t._u([{key:"icon",fn:function(){return[e("IconLoading",{attrs:{size:20}})]},proxy:!0}],null,!1,3081367109)},[t._v("\n\t\t\t"+t._s(t.t("mail","Saving"))+"\n\t\t")]):t._e(),t._v(" "),t.account.isUnified||!t.hasDelimiter||t.mailbox.specialRole||t.hasSubMailboxes||!t.hasDeleteAcl?t._e():e("ActionButton",{attrs:{id:t.genId(t.mailbox),"close-after-click":!0},on:{click:function(e){return e.preventDefault(),t.onOpenMoveModal.apply(null,arguments)}},scopedSlots:t._u([{key:"icon",fn:function(){return[e("IconExternal",{attrs:{size:20}})]},proxy:!0}],null,!1,1464797790)},[t._v("\n\t\t\t"+t._s(t.t("mail","Move folder"))+"\n\t\t")]),t._v(" "),t.account.isUnified||"flagged"===t.mailbox.specialRole?t._e():e("ActionButton",{attrs:{disabled:t.repairing},on:{click:t.repair},scopedSlots:t._u([{key:"icon",fn:function(){return[e("IconWrench",{attrs:{size:20}})]},proxy:!0}],null,!1,4061649702)},[t._v("\n\t\t\t"+t._s(t.t("mail","Repair folder"))+"\n\t\t")]),t._v(" "),t.debug&&!t.account.isUnified&&"flagged"!==t.mailbox.specialRole?e("ActionButton",{attrs:{name:t.t("mail","Clear cache"),disabled:t.clearingCache},on:{click:t.clearCache},scopedSlots:t._u([{key:"icon",fn:function(){return[e("IconFolderSync",{attrs:{size:20}})]},proxy:!0}],null,!1,3488227250)},[t._v("\n\t\t\t"+t._s(t.t("mail","Clear locally cached data, in case there are issues with synchronization."))+"\n\t\t")]):t._e(),t._v(" "),t.notVirtual?e("ActionCheckbox",{attrs:{checked:t.mailbox.isSubscribed,disabled:t.changeSubscription},on:{"update:checked":t.changeFolderSubscription}},[t._v("\n\t\t\t"+t._s(t.t("mail","Subscribed"))+"\n\t\t")]):t._e(),t._v(" "),t.notVirtual&&t.notInbox?e("ActionCheckbox",{attrs:{checked:t.mailbox.syncInBackground,disabled:t.changingSyncInBackground},on:{"update:checked":t.changeSyncInBackground}},[t._v("\n\t\t\t"+t._s(t.t("mail","Sync in background"))+"\n\t\t")]):t._e(),t._v(" "),"flagged"!==t.mailbox.specialRole&&!t.account.isUnified&&t.hasClearMailboxAcl?e("ActionButton",{attrs:{"close-after-click":!0},on:{click:t.clearMailbox},scopedSlots:t._u([{key:"icon",fn:function(){return[e("EraserIcon",{attrs:{size:20}})]},proxy:!0}],null,!1,55307409)},[t._v("\n\t\t\t"+t._s(t.t("mail","Clear folder"))+"\n\t\t")]):t._e(),t._v(" "),t.account.isUnified||t.mailbox.specialRole||t.hasSubMailboxes||!t.hasDeleteAcl?t._e():e("ActionButton",{on:{click:t.deleteMailbox},scopedSlots:t._u([{key:"icon",fn:function(){return[e("IconDelete",{attrs:{size:20}})]},proxy:!0}],null,!1,881161434)},[t._v("\n\t\t\t"+t._s(t.t("mail","Delete folder"))+"\n\t\t")])]},proxy:!0},{key:"counter",fn:function(){return[t.showUnreadCounter&&t.subCounter?e("CounterBubble",[t._v("\n\t\t\t"+t._s(t.mailbox.unread)+" ("+t._s(t.subCounter)+")\n\t\t")]):t.showUnreadCounter?e("CounterBubble",[t._v("\n\t\t\t"+t._s(t.mailbox.unread)+"\n\t\t")]):t._e()]},proxy:!0},{key:"extra",fn:function(){return[t.showMoveModal?e("MoveMailboxModal",{attrs:{account:t.account,mailbox:t.mailbox},on:{close:t.onCloseMoveModal}}):t._e()]},proxy:!0}],null,!1,1839194898)},[t._v(" "),t._v(" "),t._v(" "),t._v(" "),t._l(t.subMailboxes,(function(n){return e("NavigationMailbox",{key:t.genId(n),attrs:{account:t.account,mailbox:n}})}))],2):t._e()}),[],!1,null,"0a721347",null).exports;var xt=i(58841),Ct=i(56872);const yt={name:"NavigationOutbox",components:{AppNavigationItem:a.G_,CounterBubble:a.E7,IconOutbox:xt.A},computed:{...(0,f.n2)(Ct.A),count(){return this.outboxStore.getAllMessages.length},to:()=>({name:"outbox"})}};var _t=i(46212),kt={};kt.styleTagTransform=D(),kt.setAttributes=B(),kt.insert=S().bind(null,"head"),kt.domAPI=k(),kt.insertStyleElement=T(),y()(_t.A,kt),_t.A&&_t.A.locals&&_t.A.locals;const wt=(0,R.A)(yt,(function(){var t=this,e=t._self._c;return e("AppNavigationItem",{key:"navigation-outbox",attrs:{id:"navigation-outbox",name:t.t("mail","Outbox"),to:t.to},scopedSlots:t._u([{key:"icon",fn:function(){return[e("IconOutbox",{staticClass:"outbox-opacity-icon",attrs:{size:20}})]},proxy:!0},{key:"counter",fn:function(){return[t.count?e("CounterBubble",{staticClass:"navigation-outbox__unread-counter"},[t._v("\n\t\t\t"+t._s(t.count)+"\n\t\t")]):t._e()]},proxy:!0}])})}),[],!1,null,"57607280",null).exports;var St=i(62149),It=i(44924),Bt=i(49954),Mt=i(5652),Tt=i(81972),Et=i(56702),Dt=i(90629),Pt=i(11225),Nt=i(91738),Rt=i(51651),jt=i(39547),Lt=i.n(jt);class Ot extends Error{constructor(){super(),this.name=Ot.name}}const Ft="pkcs12",zt={name:"SmimeCertificateModal",components:{NcModal:a.FH,NcButton:a.x1,NcPasswordField:a.b9,NcEmptyContent:a.yI,DeleteIcon:g.A},data:()=>({TYPE_PKCS12:Ft,TYPE_PEM:"pem",moment:Rt.A,showImportScreen:!1,loading:!1,certificateType:Ft,certificate:void 0,privateKey:void 0,password:""}),computed:{...(0,f.n2)(v.A),...(0,f.aH)(v.A,{certificates:"getSmimeCertificates"}),inputFormIsValid(){return!!this.certificate}},async mounted(){await this.mainStore.fetchSmimeCertificates()},methods:{async deleteCertificate(t){await this.mainStore.deleteSmimeCertificate(t)},async uploadCertificate(){let e,n=this.$refs.certificate.files[0];if(this.certificateType===Ft)try{const t=function(t,e){const n=new(Lt().util.ByteBuffer)(t),i=Lt().asn1.fromDer(n),a=Lt().pkcs12.pkcs12FromAsn1(i,e),o=t=>a.getBags({bagType:t})[t],r=o(Lt().pki.oids.certBag),s=o(Lt().pki.oids.pkcs8ShroudedKeyBag);if(0===r.length)throw new Ot("The PKCS #12 certificate must contain at least one certificate");if(1!==s.length)throw new Ot("The PKCS #12 certificate must contain a single key");return{certificate:r.map((t=>Lt().pki.certificateToPem(t.cert))).join("\r\n"),privateKey:Lt().pki.privateKeyToPem(s[0].key)}}(await n.arrayBuffer(),this.password);n=new Blob([t.certificate]),e=new Blob([t.privateKey])}catch(e){return void(e.name===Ot.name?(c.A.error("PKCS #12 certificate contains multiple certs or keys",{error:e}),(0,b.Qg)(t("mail","The provided PKCS #12 certificate must contain at least one certificate and exactly one private key."))):(c.A.debug("Is probably not a PKCS #12 certificate or the password is wrong",{error:e}),(0,b.Qg)(t("mail","Failed to import the certificate. Please check the password."))))}else{if("pem"!==this.certificateType)return;e=this.$refs.privateKey.files[0]}this.loading=!0;try{await this.mainStore.createSmimeCertificate({certificate:n,privateKey:e}),(0,b.Te)(t("mail","Certificate imported successfully")),this.resetImportForm()}catch(n){c.A.error(`Failed to import a S/MIME certificate: ${n.response?.data?.data}`,{error:n}),e?(0,b.Qg)(t("mail","Failed to import the certificate. Please make sure that the private key matches the certificate and is not protected by a passphrase.")):(0,b.Qg)(t("mail","Failed to import the certificate"))}finally{this.loading=!1}},resetImportForm(){this.certificateType=Ft,this.showImportScreen=!1,this.certificate=void 0,this.privateKey=void 0,this.password=""}}};var Ut=i(30412),$t={};$t.styleTagTransform=D(),$t.setAttributes=B(),$t.insert=S().bind(null,"head"),$t.domAPI=k(),$t.insertStyleElement=T(),y()(Ut.A,$t),Ut.A&&Ut.A.locals&&Ut.A.locals;const qt=(0,R.A)(zt,(function(){var t=this,e=t._self._c;return e("NcModal",{on:{close:function(e){return t.$emit("close")}}},[e("div",{staticClass:"certificate-modal"},[t.showImportScreen?e("form",{staticClass:"certificate-modal__import",on:{submit:function(e){return e.preventDefault(),t.uploadCertificate.apply(null,arguments)}}},[e("h2",[t._v(t._s(t.t("mail","Import S/MIME certificate")))]),t._v(" "),e("fieldset",{staticClass:"certificate-modal__import__type"},[e("div",[e("input",{directives:[{name:"model",rawName:"v-model",value:t.certificateType,expression:"certificateType"}],attrs:{id:"certificate-type-pkcs12",name:"certificate-type",type:"radio"},domProps:{value:t.TYPE_PKCS12,checked:t._q(t.certificateType,t.TYPE_PKCS12)},on:{change:function(e){t.certificateType=t.TYPE_PKCS12}}}),t._v(" "),e("label",{attrs:{for:"certificate-type-pkcs12"}},[t._v("\n\t\t\t\t\t\t"+t._s(t.t("mail","PKCS #12 Certificate"))+"\n\t\t\t\t\t")])]),t._v(" "),e("div",[e("input",{directives:[{name:"model",rawName:"v-model",value:t.certificateType,expression:"certificateType"}],attrs:{id:"certificate-type-pem",name:"certificate-type",type:"radio"},domProps:{value:t.TYPE_PEM,checked:t._q(t.certificateType,t.TYPE_PEM)},on:{change:function(e){t.certificateType=t.TYPE_PEM}}}),t._v(" "),e("label",{attrs:{for:"certificate-type-pem"}},[t._v("\n\t\t\t\t\t\t"+t._s(t.t("mail","PEM Certificate"))+"\n\t\t\t\t\t")])])]),t._v(" "),e("fieldset",[e("label",{attrs:{for:"certificate"}},[t._v(t._s(t.t("mail","Certificate")))]),t._v(" "),e("input",{ref:"certificate",attrs:{id:"certificate",type:"file",accept:".p12,.crt,.pem",required:""},on:{change:function(e){t.certificate=e.target.files[0]}}})]),t._v(" "),t.certificateType===t.TYPE_PEM?e("fieldset",[e("label",{attrs:{for:"private-key"}},[t._v(t._s(t.t("mail","Private key (optional)")))]),t._v(" "),e("input",{ref:"privateKey",attrs:{id:"private-key",type:"file",accept:".key,.pem"},on:{change:function(e){t.privateKey=e.target.files[0]}}})]):t._e(),t._v(" "),t.certificateType===t.TYPE_PKCS12?e("fieldset",[e("label",{attrs:{for:"password"}},[t._v(t._s(t.t("mail","Password")))]),t._v(" "),e("NcPasswordField",{attrs:{value:t.password,label:t.t("mail","Password")},on:{"update:value":function(e){t.password=e}}})],1):t._e(),t._v(" "),e("div",{staticClass:"certificate-modal__import__hints"},[t.certificateType===t.TYPE_PEM?e("p",[t._v("\n\t\t\t\t\t"+t._s(t.t("mail","The private key is only required if you intend to send signed and encrypted emails using this certificate."))+"\n\t\t\t\t")]):t._e()]),t._v(" "),e("div",{staticClass:"certificate-modal__import__actions"},[e("NcButton",{attrs:{type:"tertiary-no-background","aria-label":t.t("mail","Back")},on:{click:t.resetImportForm}},[t._v("\n\t\t\t\t\t"+t._s(t.t("mail","Back"))+"\n\t\t\t\t")]),t._v(" "),e("NcButton",{attrs:{type:"primary","aria-label":t.t("mail","Submit"),"native-type":"submit",disabled:t.loading||!t.inputFormIsValid}},[t._v("\n\t\t\t\t\t"+t._s(t.t("mail","Submit"))+"\n\t\t\t\t")])],1)]):e("div",{staticClass:"certificate-modal__list"},[e("h2",[t._v(t._s(t.t("mail","S/MIME certificates")))]),t._v(" "),e("table",{staticClass:"certificate-modal__list__table"},[e("thead",[e("tr",[e("th",[t._v(t._s(t.t("mail","Certificate name")))]),t._v(" "),e("th",[t._v(t._s(t.t("mail","E-mail address")))]),t._v(" "),e("th",[t._v(t._s(t.t("mail","Valid until")))]),t._v(" "),e("th")])]),t._v(" "),e("tbody",t._l(t.certificates,(function(n){return e("tr",{key:n.id},[e("td",{attrs:{title:n.info.commonName}},[t._v("\n\t\t\t\t\t\t\t"+t._s(n.info.commonName)+"\n\t\t\t\t\t\t")]),t._v(" "),e("td",{attrs:{title:n.info.emailAddress}},[t._v("\n\t\t\t\t\t\t\t"+t._s(n.info.emailAddress)+"\n\t\t\t\t\t\t")]),t._v(" "),e("td",{attrs:{title:t.moment.unix(n.info.notAfter).format("LL")}},[t._v("\n\t\t\t\t\t\t\t"+t._s(t.moment.unix(n.info.notAfter).format("LL"))+"\n\t\t\t\t\t\t")]),t._v(" "),e("td",[e("NcButton",{attrs:{type:"tertiary-no-background","aria-label":t.t("mail","Delete certificate")},on:{click:function(e){return t.deleteCertificate(n.id)}},scopedSlots:t._u([{key:"icon",fn:function(){return[e("DeleteIcon",{attrs:{title:t.t("mail","Delete certificate"),size:20}})]},proxy:!0}],null,!0)})],1)])})),0)]),t._v(" "),0===t.certificates.length?e("NcEmptyContent",{staticClass:"certificate__empty",attrs:{name:t.t("mail","No certificate imported yet")}}):t._e(),t._v(" "),e("div",{staticClass:"certificate-modal__list__actions"},[e("NcButton",{attrs:{type:"primary","aria-label":t.t("mail","Import certificate")},on:{click:function(e){t.showImportScreen=!0}}},[t._v("\n\t\t\t\t\t"+t._s(t.t("mail","Import certificate"))+"\n\t\t\t\t")])],1)],1)])])}),[],!1,null,"101b9c05",null).exports;var Vt=i(37528),Wt=i(27742),Gt=i.n(Wt),Kt=i(10854),Yt=i.n(Kt);const Ht=Yt()(Gt()("email")),Qt={name:"TrustedSenders",components:{ButtonVue:a.x1},data:()=>({list:[]}),computed:{sortedSenders(){return Ht(this.list)}},async mounted(){this.list=await(0,Vt.E)()},methods:{async removeSender(e){this.list=this.list.filter((t=>t.id!==e.id));try{await(0,Vt.I)(e.email,e.type,!1)}catch(n){c.A.error(`Could not remove trusted sender ${e.email}`,{error:n}),(0,b.Qg)(t("mail","Could not remove trusted sender {sender}",{sender:e.email})),this.list.push(e)}},senderType(e){switch(e){case"individual":return t("mail","individual");case"domain":return t("mail","domain")}return e}}};var Jt=i(23256),Xt={};Xt.styleTagTransform=D(),Xt.setAttributes=B(),Xt.insert=S().bind(null,"head"),Xt.domAPI=k(),Xt.insertStyleElement=T(),y()(Jt.A,Xt),Jt.A&&Jt.A.locals&&Jt.A.locals;const Zt=(0,R.A)(Qt,(function(){var t=this,e=t._self._c;return e("div",[t._l(t.sortedSenders,(function(n){return e("div",{key:n.email},[t._v("\n\t\t"+t._s(n.email)+"\n\t\t"+t._s(t.senderType(n.type))+"\n\t\t"),e("ButtonVue",{staticClass:"button",attrs:{type:"tertiary","aria-label":t.t("mail","Remove")},on:{click:function(e){return t.removeSender(n)}}},[t._v("\n\t\t\t"+t._s(t.t("mail","Remove"))+"\n\t\t")])],1)})),t._v(" "),t.sortedSenders.length?t._e():e("span",[t._v(" "+t._s(t.t("mail","No senders are trusted at the moment.")))])],2)}),[],!1,null,"0cf1c097",null).exports;var te=i(67123),ee=i.n(te),ne=i(53630),ie=i.n(ne);const ae=Yt()(Gt()("address")),oe={name:"InternalAddress",components:{ButtonVue:a.x1,NcDialog:a.i$,NcTextField:a.v,IconAdd:Bt.A},data(){return{openDialog:!1,newAddress:"",buttons:[{label:"Cancel",icon:ee(),callback:()=>{this.openDialog=!1}},{label:"Ok",type:"primary",icon:ie(),callback:()=>{this.addInternalAddress()}}]}},computed:{...(0,f.n2)(v.A),list(){return this.mainStore.getInternalAddresses},sortedDomains(){return ae(this.list.filter((t=>"domain"===t.type)))},sortedEmails(){return ae(this.list.filter((t=>"individual"===t.type)))}},methods:{async removeInternalAddress(e){try{await this.mainStore.removeInternalAddress({id:e.id,address:e.address,type:e.type})}catch(n){c.A.error(`Could not remove internal address ${e.email}`,{error:n}),(0,b.Qg)(t("mail","Could not remove internal address {sender}",{sender:e.address}))}},async addInternalAddress(){const e=this.checkType();try{await this.mainStore.addInternalAddress({address:this.newAddress,type:e}).then((async()=>{this.newAddress="",this.openDialog=!1}))}catch(e){c.A.error(`Could not add internal address ${this.newAddress}`,{error:e}),(0,b.Qg)(t("mail","Could not add internal address {address}",{address:this.newAddress}))}},checkType(){const t=this.newAddress.split("@");return 2!==t.length?"domain":0===t[0].length?(this.newAddress=t[1],"domain"):"individual"},senderType(e){switch(e){case"individual":return t("mail","individual");case"domain":return t("mail","domain")}return e}}};var re=i(38366),se={};se.styleTagTransform=D(),se.setAttributes=B(),se.insert=S().bind(null,"head"),se.domAPI=k(),se.insertStyleElement=T(),y()(re.A,se),re.A&&re.A.locals&&re.A.locals;const le=(0,R.A)(oe,(function(){var t=this,e=t._self._c;return e("div",[t._l(t.sortedDomains,(function(n){return e("div",{key:n.address,staticClass:"address"},[t._v("\n\t\t"+t._s(n.address)+"\n\t\t"),e("p",{staticClass:"address__type"},[t._v("\n\t\t\t("+t._s(t.t("mail","domain"))+")\n\t\t")]),t._v(" "),e("ButtonVue",{staticClass:"button",attrs:{type:"tertiary","aria-label":t.t("mail","Remove")},on:{click:function(e){return t.removeInternalAddress(n)}}},[t._v("\n\t\t\t"+t._s(t.t("mail","Remove"))+"\n\t\t")])],1)})),t._v(" "),t._l(t.sortedEmails,(function(n){return e("div",{key:n.address,staticClass:"address"},[t._v("\n\t\t"+t._s(n.address)+"\n\t\t"),e("p",{staticClass:"address__type"},[t._v("\n\t\t\t("+t._s(t.t("mail","email"))+")\n\t\t")]),t._v(" "),e("ButtonVue",{staticClass:"button",attrs:{type:"tertiary","aria-label":t.t("mail","Remove")},on:{click:function(e){return t.removeInternalAddress(n)}}},[t._v("\n\t\t\t"+t._s(t.t("mail","Remove"))+"\n\t\t")])],1)})),t._v(" "),e("ButtonVue",{attrs:{type:"primary"},on:{click:function(e){t.openDialog=!0}},scopedSlots:t._u([{key:"icon",fn:function(){return[e("IconAdd",{attrs:{size:20}})]},proxy:!0}])},[t._v("\n\t\t"+t._s(t.t("mail","Add internal address"))+"\n\t")]),t._v(" "),e("NcDialog",{attrs:{open:t.openDialog,buttons:t.buttons,name:t.t("mail","Add internal address")},on:{"update:open":function(e){t.openDialog=e},close:function(e){t.openDialog=!1}}},[e("NcTextField",{staticClass:"input",attrs:{label:t.t("mail","Add internal email or domain"),value:t.newAddress},on:{"update:value":function(e){t.newAddress=e}}})],1)],2)}),[],!1,null,"92c95fe2",null).exports;var ce=i(16406);const de={name:"List",components:{ListItem:i(48642).A},props:{shared:{type:Boolean,default:!1},textBlocks:{type:Array,required:!0}},methods:{}},ue=(0,R.A)(de,(function(){var t=this,e=t._self._c;return e("div",[t._l(t.textBlocks,(function(n){return e("ListItem",{key:n.id,attrs:{"text-block":n,shared:t.shared}})})),t._v(" "),t.textBlocks.length?t._e():e("span",[t._v(" "+t._s(t.t("mail","No text blocks available"))+" ")])],2)}),[],!1,null,null,null).exports;var me=i(27380);const Ae={name:"AppSettingsMenu",components:{TrustedSenders:Zt,InternalAddress:le,NcButton:a.x1,IconEmail:Mt.A,IconAdd:Bt.A,IconLock:Tt.A,IconClose:Et.A,IconCheck:Dt.A,SmimeCertificateModal:qt,NcCheckboxRadioSwitch:a.AO,NcAppSettingsDialog:a.q4,NcAppSettingsSection:a.Te,CompactMode:St.A,VerticalSplit:Pt.A,HorizontalSplit:Nt.A,List:ue,NcDialog:a.i$,NcInputField:a.Es,TextEditor:It.A},mixins:[ce.A],props:{open:{required:!0,type:Boolean}},data:()=>({loadingAvatarSettings:!1,prioritySettingsText:t("mail","Search in the body of messages in priority Inbox"),loadingPrioritySettings:!1,optOutSettingsText:t("mail","Activate"),loadingOptOutSettings:!1,loadingInternalAddresses:!1,replySettingsText:t("mail","Put my text to the bottom of a reply instead of on top of it."),loadingReplySettings:!1,autoTaggingText:t("mail","Mark as important"),followUpReminderText:t("mail","Remind about messages that require a reply but received none"),internalAddressText:t("mail","Use internal addresses"),toggleAutoTagging:!1,loadingFollowUpReminders:!1,displaySmimeCertificateModal:!1,sortOrder:"newest",showSettings:!1,showAccountSettings:!1,showMailSettings:!0,selectedAccount:null,mailvelopeIsAvailable:!1,trapElements:[],bus:(0,me.A)(),textBlockDialogOpen:!1,localTextBlock:{title:"",content:""}}),computed:{...(0,f.n2)(v.A),...(0,f.aH)(v.A,["getAccounts","followUpFeatureAvailable","getMyTextBlocks","getSharedTextBlocks"]),searchPriorityBody(){return"true"===this.mainStore.getPreference("search-priority-body","false")},useBottomReplies(){return"bottom"===this.mainStore.getPreference("reply-mode","top")},useExternalAvatars(){return"true"===this.mainStore.getPreference("external-avatars","true")},useDataCollection(){return"true"===this.mainStore.getPreference("collect-data","true")},useAutoTagging(){return"true"===this.mainStore.getPreference("tag-classified-messages","true")},useInternalAddresses(){return"true"===this.mainStore.getPreference("internal-addresses","false")},useFollowUpReminders(){return"true"===this.mainStore.getPreference("follow-up-reminders","true")},allowNewMailAccounts(){return this.mainStore.getPreference("allow-new-accounts",!0)},layoutMode(){return this.mainStore.getPreference("layout-mode","vertical-split")},layoutMessageView(){return this.mainStore.getPreference("layout-message-view")}},watch:{showSettings(t){t||this.$emit("update:open",t)},async open(t){t&&await this.onOpen()}},mounted(){this.sortOrder=this.mainStore.getPreference("sort-order","newest"),document.addEventListener.call(window,"mailvelope",(()=>this.checkMailvelope())),this.mainStore.areTextBlocksFetched()||(this.mainStore.fetchMyTextBlocks(),this.mainStore.fetchSharedTextBlocks())},updated(){this.checkMailvelope()},methods:{closeAccountSettings(){this.showAccountSettings=!1},openAccountSettings(t){this.mainStore.showSettingsForAccountMutation(t),this.showSettings=!1},checkMailvelope(){this.mailvelopeIsAvailable=!!window.mailvelope},async setLayout(t){try{await this.mainStore.savePreference({key:"layout-mode",value:t})}catch(t){c.A.error("Could not save preferences",{error:t})}},async setLayoutMessageView(t){try{await this.mainStore.savePreference({key:"layout-message-view",value:t})}catch(t){c.A.error("Could not save preferences",{error:t})}},async onOpen(){this.showSettings=!0},onToggleButtonReplies(t){this.loadingReplySettings=!0,this.mainStore.savePreference({key:"reply-mode",value:t?"bottom":"top"}).catch((t=>c.A.error("could not save preferences",{error:t}))).then((()=>{this.loadingReplySettings=!1}))},onToggleExternalAvatars(t){this.loadingAvatarSettings=!0,this.mainStore.savePreference({key:"external-avatars",value:t?"true":"false"}).catch((t=>c.A.error("could not save preferences",{error:t}))).then((()=>{this.loadingAvatarSettings=!1}))},async onToggleSearchPriorityBody(t){this.loadingPrioritySettings=!0;try{await this.mainStore.savePreference({key:"search-priority-body",value:t?"true":"false"})}catch(t){c.A.error("could not save preferences",{error:t})}finally{this.loadingPrioritySettings=!1}},onToggleCollectData(t){this.loadingOptOutSettings=!0,this.mainStore.savePreference({key:"collect-data",value:t?"true":"false"}).catch((t=>c.A.error("could not save preferences",{error:t}))).then((()=>{this.loadingOptOutSettings=!1}))},async onSortByDate(e){const n=this.sortOrder;try{this.sortOrder=e,await this.mainStore.savePreference({key:"sort-order",value:e}),this.mainStore.removeAllEnvelopesMutation()}catch(e){c.A.error("could not save preferences",{error:e}),this.sortOrder=n,(0,b.Qg)(t("mail","Could not update preference"))}},async onToggleAutoTagging(e){this.toggleAutoTagging=!0;try{await this.mainStore.savePreference({key:"tag-classified-messages",value:e?"true":"false"})}catch(e){c.A.error("could not save preferences",{error:e}),(0,b.Qg)(t("mail","Could not update preference"))}finally{this.toggleAutoTagging=!1}},async onToggleFollowUpReminders(e){this.loadingFollowUpReminders=!0;try{await this.mainStore.savePreference({key:"follow-up-reminders",value:e?"true":"false"})}catch(e){c.A.error("Could not save preferences",{error:e}),(0,b.Qg)(t("mail","Could not update preference"))}finally{this.loadingFollowUpReminders=!1}},async onToggleInternalAddress(e){this.loadingInternalAddresses=!0;try{await this.mainStore.savePreference({key:"internal-addresses",value:e?"true":"false"})}catch(e){c.A.error("Could not save preferences",{error:e}),(0,b.Qg)(t("mail","Could not update preference"))}finally{this.loadingInternalAddresses=!1}},registerProtocolHandler(){if(window.navigator.registerProtocolHandler){const t=window.location.protocol+"//"+window.location.host+(0,s.Jv)("apps/mail/compose?uri=%s");try{window.navigator.registerProtocolHandler("mailto",t,OC.theme.name+" Mail")}catch(t){c.A.error("could not register protocol handler",{err:t})}}},mailvelopeAuthorizeDomain(){const t=document.createElement("iframe");t.style="display: none",t.src="https://api.mailvelope.com/authorize-domain/?api=true",document.body.append(t)},handleShowToolbar(t){this.trapElements.push(t)},newTextBlock(){this.mainStore.createTextBlock({...this.localTextBlock}),this.textBlockDialogOpen=!1,this.localTextBlock={title:"",content:""}},closeTextBlockDialog(){this.textBlockDialogOpen=!1,this.localTextBlock={title:"",content:""}}}};var pe=i(32300),he={};he.styleTagTransform=D(),he.setAttributes=B(),he.insert=S().bind(null,"head"),he.domAPI=k(),he.insertStyleElement=T(),y()(pe.A,he),pe.A&&pe.A.locals&&pe.A.locals;const ge=(0,R.A)(Ae,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"app-settings"},[e("NcAppSettingsDialog",{attrs:{id:"app-settings-dialog",name:t.t("mail","Mail settings"),"show-navigation":!0,"additional-trap-elements":t.trapElements,open:t.showSettings},on:{"update:open":function(e){t.showSettings=e}}},[e("NcAppSettingsSection",{attrs:{id:"account-creation",name:t.t("mail","Accounts")}},[t.allowNewMailAccounts?e("NcButton",{staticClass:"app-settings-button",attrs:{type:"primary",to:"/setup","aria-label":t.t("mail","Add mail account")},scopedSlots:t._u([{key:"icon",fn:function(){return[e("IconAdd",{attrs:{size:20}})]},proxy:!0}],null,!1,2388353250)},[t._v("\n\t\t\t\t"+t._s(t.t("mail","Add mail account"))+"\n\t\t\t")]):t._e(),t._v(" "),e("h4",[t._v(t._s(t.t("mail","Account settings")))]),t._v(" "),e("p",[t._v(t._s(t.t("mail","Settings for:")))]),t._v(" "),t._l(t.getAccounts,(function(n){return e("li",{key:n.id},[n&&n.emailAddress?e("NcButton",{staticClass:"app-settings-button",attrs:{type:"secondary","aria-label":t.t("mail","Account settings")},on:{click:function(e){return t.openAccountSettings(n.id)}}},[t._v("\n\t\t\t\t\t"+t._s(n.emailAddress)+"\n\t\t\t\t")]):t._e()],1)}))],2),t._v(" "),e("NcAppSettingsSection",{attrs:{id:"appearance-and-accessibility",name:t.t("mail","General")}},[e("h4",[t._v(t._s(t.t("mail","Layout")))]),t._v(" "),e("NcCheckboxRadioSwitch",{attrs:{value:"no-split","button-variant":!0,name:"mail-layout",type:"radio",checked:t.layoutMode,"button-variant-grouped":"vertical"},on:{"update:checked":function(e){return t.setLayout("no-split")}},scopedSlots:t._u([{key:"icon",fn:function(){return[e("CompactMode",{attrs:{size:20}})]},proxy:!0}])},[t._v("\n\t\t\t\t"+t._s(t.t("mail","List"))+"\n\t\t\t")]),t._v(" "),e("NcCheckboxRadioSwitch",{attrs:{value:"vertical-split","button-variant":!0,name:"mail-layout",type:"radio",checked:t.layoutMode,"button-variant-grouped":"vertical"},on:{"update:checked":function(e){return t.setLayout("vertical-split")}},scopedSlots:t._u([{key:"icon",fn:function(){return[e("VerticalSplit",{attrs:{size:20}})]},proxy:!0}])},[t._v("\n\t\t\t\t"+t._s(t.t("mail","Vertical split"))+"\n\t\t\t")]),t._v(" "),e("NcCheckboxRadioSwitch",{attrs:{value:"horizontal-split","button-variant":!0,name:"mail-layout",type:"radio",checked:t.layoutMode,"button-variant-grouped":"vertical"},on:{"update:checked":function(e){return t.setLayout("horizontal-split")}},scopedSlots:t._u([{key:"icon",fn:function(){return[e("HorizontalSplit",{attrs:{size:20}})]},proxy:!0}])},[t._v("\n\t\t\t\t"+t._s(t.t("mail","Horizontal split"))+"\n\t\t\t")]),t._v(" "),e("h4",[t._v(t._s(t.t("mail","Message View Mode")))]),t._v(" "),e("div",{staticClass:"sorting"},[e("NcCheckboxRadioSwitch",{attrs:{type:"radio",name:"message_view_mode_radio",value:"threaded",checked:t.layoutMessageView},on:{"update:checked":function(e){return t.setLayoutMessageView("threaded")}}},[t._v("\n\t\t\t\t\t"+t._s(t.t("mail","Show all messages in thread"))+"\n\t\t\t\t")]),t._v(" "),e("NcCheckboxRadioSwitch",{attrs:{type:"radio",name:"message_view_mode_radio",value:"singleton",checked:t.layoutMessageView},on:{"update:checked":function(e){return t.setLayoutMessageView("singleton")}}},[t._v("\n\t\t\t\t\t"+t._s(t.t("mail","Show only the selected message"))+"\n\t\t\t\t")])],1),t._v(" "),e("h4",[t._v(t._s(t.t("mail","Sorting")))]),t._v(" "),e("div",{staticClass:"sorting"},[e("NcCheckboxRadioSwitch",{staticClass:"sorting__switch",attrs:{checked:t.sortOrder,value:"newest",name:"order_radio",type:"radio"},on:{"update:checked":t.onSortByDate}},[t._v("\n\t\t\t\t\t"+t._s(t.t("mail","Newest"))+"\n\t\t\t\t")]),t._v(" "),e("NcCheckboxRadioSwitch",{staticClass:"sorting__switch",attrs:{checked:t.sortOrder,value:"oldest",name:"order_radio",type:"radio"},on:{"update:checked":t.onSortByDate}},[t._v("\n\t\t\t\t\t"+t._s(t.t("mail","Oldest"))+"\n\t\t\t\t")])],1),t._v(" "),e("h4",[t._v(t._s(t.t("mail","Search in body")))]),t._v(" "),e("p",{staticClass:"app-settings"},[e("NcCheckboxRadioSwitch",{attrs:{id:"priority-inbox-toggle",checked:t.searchPriorityBody,loading:t.loadingPrioritySettings},on:{"update:checked":t.onToggleSearchPriorityBody}},[t._v("\n\t\t\t\t\t"+t._s(t.prioritySettingsText)+"\n\t\t\t\t")])],1),t._v(" "),e("h4",[t._v(t._s(t.t("mail","Reply text position")))]),t._v(" "),e("p",{staticClass:"app-settings reply-settings"},[e("NcCheckboxRadioSwitch",{attrs:{id:"bottom-reply-enabled",checked:t.useBottomReplies,loading:t.loadingReplySettings},on:{"update:checked":t.onToggleButtonReplies}},[t._v("\n\t\t\t\t\t"+t._s(t.replySettingsText)+"\n\t\t\t\t")])],1),t._v(" "),e("h4",[t._v(t._s(t.t("mail","Gravatar settings")))]),t._v(" "),e("p",{staticClass:"app-settings avatar-settings"},[e("NcCheckboxRadioSwitch",{attrs:{id:"gravatar-enabled",checked:t.useExternalAvatars,loading:t.loadingAvatarSettings},on:{"update:checked":t.onToggleExternalAvatars}},[t._v("\n\t\t\t\t\t"+t._s(t.t("mail","Use Gravatar and favicon avatars"))+"\n\t\t\t\t")])],1),t._v(" "),e("h4",[t._v(t._s(t.t("mail","Mailto")))]),t._v(" "),e("p",{staticClass:"settings-hint"},[t._v("\n\t\t\t\t"+t._s(t.t("mail","Register as application for mail links"))+"\n\t\t\t")]),t._v(" "),e("NcButton",{staticClass:"app-settings-button",attrs:{type:"secondary","aria-label":t.t("mail","Register as application for mail links")},on:{click:t.registerProtocolHandler},scopedSlots:t._u([{key:"icon",fn:function(){return[e("IconEmail",{attrs:{size:20}})]},proxy:!0}])},[t._v("\n\t\t\t\t"+t._s(t.t("mail","Register"))+"\n\t\t\t")])],1),t._v(" "),e("NcAppSettingsSection",{attrs:{id:"text-blocks",name:t.t("mail","Text blocks")}},[e("List",{attrs:{"text-blocks":t.getMyTextBlocks()},on:{"show-toolbar":t.handleShowToolbar}}),t._v(" "),e("NcButton",{attrs:{type:"primary"},on:{click:()=>t.textBlockDialogOpen=!0}},[t._v("\n\t\t\t\t"+t._s(t.t("mail","Create a new text block"))+"\n\t\t\t")]),t._v(" "),t.getSharedTextBlocks().length>0?[e("h6",[t._v(t._s(t.t("mail","Shared with me")))]),t._v(" "),e("List",{attrs:{"text-blocks":t.getSharedTextBlocks(),shared:!0},on:{"show-toolbar":t.handleShowToolbar}})]:t._e()],2),t._v(" "),e("NcAppSettingsSection",{attrs:{id:"privacy-and-security",name:t.t("mail","Privacy and security")}},[e("h4",[t._v(t._s(t.t("mail","Data collection consent")))]),t._v(" "),e("p",{staticClass:"settings-hint"},[t._v("\n\t\t\t\t"+t._s(t.t("mail","Allow the app to collect data about your interactions. Based on this data, the app will adapt to your preferences. The data will only be stored locally."))+"\n\t\t\t")]),t._v(" "),e("p",{staticClass:"app-settings"},[e("NcCheckboxRadioSwitch",{attrs:{id:"data-collection-toggle",checked:t.useDataCollection,loading:t.loadingOptOutSettings},on:{"update:checked":t.onToggleCollectData}},[t._v("\n\t\t\t\t\t"+t._s(t.optOutSettingsText)+"\n\t\t\t\t")])],1),t._v(" "),e("h4",[t._v(t._s(t.t("mail","Trusted senders")))]),t._v(" "),e("TrustedSenders"),t._v(" "),e("h4",[t._v(t._s(t.t("mail","Internal addresses")))]),t._v(" "),e("p",{staticClass:"settings-hint"},[t._v("\n\t\t\t\t"+t._s(t.t("mail","Highlight external email addresses by enabling this feature, manage your internal addresses and domains to ensure recognized contacts stay unmarked."))+"\n\t\t\t")]),t._v(" "),e("p",{staticClass:"app-settings"},[e("NcCheckboxRadioSwitch",{attrs:{id:"internal-address-toggle",checked:t.useInternalAddresses,loading:t.loadingInternalAddresses},on:{"update:checked":t.onToggleInternalAddress}},[t._v("\n\t\t\t\t\t"+t._s(t.internalAddressText)+"\n\t\t\t\t")])],1),t._v(" "),e("InternalAddress"),t._v(" "),e("h4",[t._v(t._s(t.t("mail","S/MIME")))]),t._v(" "),e("NcButton",{staticClass:"app-settings-button",attrs:{type:"secondary","aria-label":t.t("mail","Manage S/MIME certificates")},on:{click:function(e){e.preventDefault(),e.stopPropagation(),t.displaySmimeCertificateModal=!0}},scopedSlots:t._u([{key:"icon",fn:function(){return[e("IconLock",{attrs:{size:20}})]},proxy:!0}])},[t._v("\n\t\t\t\t"+t._s(t.t("mail","Manage S/MIME certificates"))+"\n\t\t\t")]),t._v(" "),t.displaySmimeCertificateModal?e("SmimeCertificateModal",{on:{close:function(e){t.displaySmimeCertificateModal=!1}}}):t._e(),t._v(" "),e("h4",[t._v(t._s(t.t("mail","Mailvelope")))]),t._v(" "),e("div",{staticClass:"mailvelope-section"},[t.mailvelopeIsAvailable?e("div",[t._v("\n\t\t\t\t\t"+t._s(t.t("mail","Mailvelope is enabled for the current domain!"))+"\n\t\t\t\t")]):e("div",[e("p",[t._v("\n\t\t\t\t\t\t"+t._s(t.t("mail","Looking for a way to encrypt your emails?"))+"\n\t\t\t\t\t")]),t._v(" "),e("p",[e("a",{staticClass:"button",attrs:{href:"https://www.mailvelope.com/",target:"_blank",rel:"noopener noreferrer"}},[t._v("\n\t\t\t\t\t\t\t"+t._s(t.t("mail","Install Mailvelope browser extension"))+"\n\t\t\t\t\t\t")])]),t._v(" "),e("p",[e("a",{staticClass:"button",on:{click:t.mailvelopeAuthorizeDomain}},[t._v("\n\t\t\t\t\t\t\t"+t._s(t.t("mail","Enable Mailvelope for the current domain"))+"\n\t\t\t\t\t\t")])])])])],1),t._v(" "),e("NcAppSettingsSection",{attrs:{id:"autotagging-settings",name:t.t("mail","Assistance features")}},[e("p",{staticClass:"app-settings"},[e("NcCheckboxRadioSwitch",{attrs:{id:"auto-tagging-toggle",checked:t.useAutoTagging,loading:t.toggleAutoTagging},on:{"update:checked":t.onToggleAutoTagging}},[t._v("\n\t\t\t\t\t"+t._s(t.autoTaggingText)+"\n\t\t\t\t")])],1),t._v(" "),t.followUpFeatureAvailable?e("p",{staticClass:"app-settings"},[e("NcCheckboxRadioSwitch",{attrs:{id:"follow-up-reminder-toggle",checked:t.useFollowUpReminders,loading:t.loadingFollowUpReminders},on:{"update:checked":t.onToggleFollowUpReminders}},[t._v("\n\t\t\t\t\t"+t._s(t.followUpReminderText)+"\n\t\t\t\t")])],1):t._e()]),t._v(" "),e("NcAppSettingsSection",{attrs:{id:"about-settings",name:t.t("mail","About")}},[e("p",[t._v(t._s(t.t("mail","This application includes CKEditor, an open-source editor. Copyright © CKEditor contributors. Licensed under GPLv2.")))])]),t._v(" "),e("NcAppSettingsSection",{attrs:{id:"keyboard-shortcut-settings",name:t.t("mail","Keyboard shortcuts")}},[e("dl",[e("div",[e("dt",[e("kbd",[t._v("C")])]),t._v(" "),e("dd",[t._v(t._s(t.t("mail","Compose new message")))])]),t._v(" "),e("div",[e("dt",[e("kbd",[t._v("←")])]),t._v(" "),e("dd",[t._v(t._s(t.t("mail","Newer message")))])]),t._v(" "),e("div",[e("dt",[e("kbd",[t._v("→")])]),t._v(" "),e("dd",[t._v(t._s(t.t("mail","Older message")))])]),t._v(" "),e("div",[e("dt",[e("kbd",[t._v("S")])]),t._v(" "),e("dd",[t._v(t._s(t.t("mail","Toggle star")))])]),t._v(" "),e("div",[e("dt",[e("kbd",[t._v("U")])]),t._v(" "),e("dd",[t._v(t._s(t.t("mail","Toggle unread")))])]),t._v(" "),e("div",[e("dt",[e("kbd",[t._v("A")])]),t._v(" "),e("dd",[t._v(t._s(t.t("mail","Archive")))])]),t._v(" "),e("div",[e("dt",[e("kbd",[t._v("Del")])]),t._v(" "),e("dd",[t._v(t._s(t.t("mail","Delete")))])]),t._v(" "),e("div",[e("dt",[e("kbd",[t._v("Ctrl")]),t._v(" + "),e("kbd",[t._v("F")])]),t._v(" "),e("dd",[t._v(t._s(t.t("mail","Search")))])]),t._v(" "),e("div",[e("dt",[e("kbd",[t._v("Ctrl")]),t._v(" + "),e("kbd",[t._v("Enter")])]),t._v(" "),e("dd",[t._v(t._s(t.t("mail","Send")))])]),t._v(" "),e("div",[e("dt",[e("kbd",[t._v("R")])]),t._v(" "),e("dd",[t._v(t._s(t.t("mail","Refresh")))])])])]),t._v(" "),e("NcDialog",{attrs:{open:t.textBlockDialogOpen,name:t.t("mail","New text block"),"is-form":!0,size:"normal"},on:{"update:open":function(e){t.textBlockDialogOpen=e}}},[e("NcInputField",{attrs:{value:t.localTextBlock.title,label:t.t("mail","Title of the text block")},on:{"update:value":function(e){return t.$set(t.localTextBlock,"title",e)}}}),t._v(" "),e("TextEditor",{attrs:{"is-bordered":!0,html:!0,placeholder:t.t("mail","Content of the text block"),bus:t.bus,"show-toolbar":t.handleShowToolbar},model:{value:t.localTextBlock.content,callback:function(e){t.$set(t.localTextBlock,"content",e)},expression:"localTextBlock.content"}}),t._v(" "),e("div",{staticClass:"text-block-buttons"},[e("NcButton",{staticClass:"text-block-buttons__button",attrs:{type:"tertiary"},on:{click:t.closeTextBlockDialog},scopedSlots:t._u([{key:"icon",fn:function(){return[e("IconClose",{attrs:{size:20}})]},proxy:!0}])},[t._v("\n\t\t\t\t\t"+t._s(t.t("mail","Cancel"))+"\n\t\t\t\t")]),t._v(" "),e("NcButton",{staticClass:"text-block-buttons__button",attrs:{type:"primary",disabled:!t.localTextBlock.title||!t.localTextBlock.content},on:{click:t.newTextBlock},scopedSlots:t._u([{key:"icon",fn:function(){return[e("IconCheck",{attrs:{size:20}})]},proxy:!0}])},[t._v("\n\t\t\t\t\t"+t._s(t.t("mail","Ok"))+"\n\t\t\t\t")])],1)],1)],1)],1)}),[],!1,null,"e23a82f4",null).exports,be={name:"Navigation",components:{AppNavigation:a.hN,AppSettingsMenu:ge,NavigationAccount:j,NavigationAccountExpandCollapse:z,NavigationMailbox:vt,NavigationOutbox:wt,NewMessageButtonHeader:o.A,IconSetting:m.A,AppNavigationItem:a.G_},data:()=>({refreshing:!1,showSettings:!1}),computed:{...(0,f.n2)(Ct.A,v.A),menu(){return this.mainStore.getAccounts.filter((t=>t.id!==ot.Hc)).map((t=>{const e=this.mainStore.getMailboxes(t.id),n=e.filter((e=>this.isCollapsed(t,e))).length>1;return{id:t.id,account:t,mailboxes:e,isCollapsible:n}}))},unifiedAccount(){return this.mainStore.getAccount(ot.Hc)},unifiedMailboxes(){return this.mainStore.getMailboxes(ot.Hc)},passwordIsUnavailable(){return this.mainStore.getPreference("password-is-unavailable",!1)},outboxMessages(){return this.outboxStore.getAllMessages}},methods:{showMailSettings(){this.showSettings=!0},isCollapsed:(t,e)=>"inbox"!==e.specialRole&&e.databaseId!==t.draftsMailboxId&&e.databaseId!==t.sentMailboxId&&e.databaseId!==t.trashMailboxId,isFirst(t){return t===this.mainStore.getAccounts[1]},isLast(t){const e=this.mainStore.getAccounts;return t===e[e.length-1]},isDisabled(t){return this.passwordIsUnavailable&&!!t.provisioningId&&!!this.mainStore.masterPasswordEnabled}}};var fe=i(25724),ve={};ve.styleTagTransform=D(),ve.setAttributes=B(),ve.insert=S().bind(null,"head"),ve.domAPI=k(),ve.insertStyleElement=T(),y()(fe.A,ve),fe.A&&fe.A.locals&&fe.A.locals;const xe=(0,R.A)(be,(function(){var t=this,e=t._self._c;return e("AppNavigation",{scopedSlots:t._u([{key:"search",fn:function(){return[e("NewMessageButtonHeader")]},proxy:!0},{key:"list",fn:function(){return[t._l(t.unifiedMailboxes,(function(n){return e("NavigationMailbox",{key:"mailbox-"+n.databaseId,attrs:{account:t.unifiedAccount,mailbox:n}})})),t._v(" "),t._l(t.menu,(function(n){return[n.account?e("NavigationAccount",{key:n.account.id,attrs:{account:n.account,"first-mailbox":n.mailboxes[0],"is-first":t.isFirst(n.account),"is-last":t.isLast(n.account),"is-disabled":t.isDisabled(n.account)}}):t._e(),t._v(" "),t.isDisabled(n.account)?t._e():[t._l(n.mailboxes,(function(i){return[e("NavigationMailbox",{directives:[{name:"show",rawName:"v-show",value:!n.isCollapsible||!n.account.collapsed||!t.isCollapsed(n.account,i),expression:"\n\t\t\t\t\t\t\t!group.isCollapsible ||\n\t\t\t\t\t\t\t\t!group.account.collapsed ||\n\t\t\t\t\t\t\t\t!isCollapsed(group.account, item)\n\t\t\t\t\t\t"}],key:"mailbox-"+i.databaseId,attrs:{account:n.account,mailbox:i}}),t._v(" "),n.account.isUnified||"inbox"!==i.specialRole?t._e():e("NavigationMailbox",{key:i.databaseId+"-starred",attrs:{account:n.account,mailbox:i,filter:"starred"}})]})),t._v(" "),!n.account.isUnified&&n.isCollapsible?e("NavigationAccountExpandCollapse",{key:"collapse-"+n.account.id,attrs:{account:n.account}}):t._e()]]}))]},proxy:!0},{key:"footer",fn:function(){return[0!==t.outboxMessages.length?e("div",{staticClass:"outbox__border"},[e("NavigationOutbox",{staticClass:"outbox"})],1):t._e(),t._v(" "),e("div",{staticClass:"mail-settings"},[e("AppNavigationItem",{staticClass:"mail-settings__button",attrs:{"close-after-click":!0,name:t.t("mail","Mail settings")},on:{click:t.showMailSettings},scopedSlots:t._u([{key:"icon",fn:function(){return[e("IconSetting",{attrs:{size:20}})]},proxy:!0}])})],1)]},proxy:!0}])},[t._v(" "),t._v(" "),t._v(" "),e("AppSettingsMenu",{attrs:{open:t.showSettings},on:{"update:open":function(e){t.showSettings=e}}})],1)}),[],!1,null,"3f279782",null).exports},64678:(t,e,n)=>{"use strict";n.d(e,{A:()=>E});var i=n(4658),a=n(57747),o=n(10578),r=n(86791),s=n(18896),l=n(71229),c=n(99495),d=n(71561),u=n(53334),m=n(51648),A=n(28290),p=n(51849),h=n(49519);const g={name:"MailboxPicker",components:{ButtonVue:i.x1,Modal:i.FH,IconInbox:o.A,IconDraft:r.A,IconSent:s.A,IconArchive:l.A,IconTrash:c.A,IconFolder:d.A,IconBreadcrumb:a.A,IconLoading:i.ne},props:{account:{type:Object,required:!0},selected:{type:Number,required:!1,default:void 0},loading:{type:Boolean,required:!1,default:!1},labelSelect:{type:String,default:(0,u.Tl)("mail","Choose")},labelSelectLoading:{type:String,default:(0,u.Tl)("mail","Choose")},pickedMailbox:{type:Object,required:!1,default:()=>{}},allowRoot:{type:Boolean,default:!1}},data:()=>({selectedMailboxId:void 0,mailboxCrumbs:[]}),computed:{...(0,p.n2)(h.A),mailboxes(){return this.selectedMailboxId?this.mainStore.getSubMailboxes(this.selectedMailboxId):this.mainStore.getMailboxes(this.account.accountId)},filteredMailboxes(){return this.pickedMailbox?this.mailboxes.filter((t=>t.databaseId!==this.pickedMailbox.databaseId&&(0,A.w)(t,"k"))):this.mailboxes.filter((t=>(0,A.w)(t,"i")))}},methods:{getMailboxIcon:t=>t.specialRole?"icon-"+t.specialRole:"icon-folder",getMailboxTitle:t=>(0,m.T)(t),onClickHome(){this.selectedMailboxId=void 0,this.$emit("update:selected",void 0),this.mailboxCrumbs=[]},onClickCrumb(t){this.selectedMailboxId=this.mailboxCrumbs[t].databaseId,this.$emit("update:selected",this.selectedMailboxId),this.mailboxCrumbs=this.mailboxCrumbs.slice(0,t+1)},onClickMailbox(t){this.selectedMailboxId=t.databaseId,this.$emit("update:selected",this.selectedMailboxId),this.mailboxCrumbs.push(t)},onSelect(){this.$emit("select",this.selectedMailboxId)},onClose(){this.$emit("close")}}};var b=n(85072),f=n.n(b),v=n(97825),x=n.n(v),C=n(77659),y=n.n(C),_=n(55056),k=n.n(_),w=n(10540),S=n.n(w),I=n(41113),B=n.n(I),M=n(14714),T={};T.styleTagTransform=B(),T.setAttributes=k(),T.insert=y().bind(null,"head"),T.domAPI=x(),T.insertStyleElement=S(),f()(M.A,T),M.A&&M.A.locals&&M.A.locals;const E=(0,n(14486).A)(g,(function(){var t=this,e=t._self._c;return e("Modal",{on:{close:t.onClose}},[e("div",{ref:"content",staticClass:"modal-content"},[e("h2",{staticClass:"oc-dialog-title"},[t._v("\n\t\t\t"+t._s(t.t("mail","Choose target folder"))+"\n\t\t")]),t._v(" "),e("span",{staticClass:"crumbs"},[e("div",{on:{click:function(e){return e.preventDefault(),t.onClickHome.apply(null,arguments)}}},[e("IconInbox",{attrs:{size:20}})],1),t._v(" "),t._l(t.mailboxCrumbs,(function(n,i){return e("div",{key:n.databaseId,staticClass:"level"},[e("IconBreadcrumb",{attrs:{size:20}}),t._v(" "),e("a",{on:{click:function(e){return e.preventDefault(),t.onClickCrumb(i)}}},[t._v("\n\t\t\t\t\t"+t._s(t.getMailboxTitle(n))+"\n\t\t\t\t")])],1)}))],2),t._v(" "),e("div",{staticClass:"mailbox-list"},[t.filteredMailboxes.length>0?e("ul",t._l(t.filteredMailboxes,(function(n){return e("li",{key:n.databaseId,on:{click:function(e){return e.preventDefault(),t.onClickMailbox(n)}}},["inbox"===n.specialRole?e("IconInbox",{attrs:{size:20}}):"drafts"===n.specialRole?e("IconDraft",{attrs:{size:20}}):"sent"===n.specialRole?e("IconSent",{attrs:{size:20}}):"archive"===n.specialRole?e("IconArchive",{attrs:{size:20}}):"trash"===n.specialRole?e("IconTrash",{attrs:{size:20}}):e("IconFolder",{attrs:{size:20}}),t._v(" "),e("div",{staticClass:"mailbox-title"},[t._v("\n\t\t\t\t\t\t"+t._s(t.getMailboxTitle(n))+"\n\t\t\t\t\t")])],1)})),0):e("IconFolder",{attrs:{size:65}}),t._v(" "),e("div",{staticClass:"empty-icon empty"}),t._v(" "),e("h2",[t._v(t._s(t.t("mail","No more submailboxes in here")))])],1),t._v(" "),e("div",{staticClass:"buttons"},[e("ButtonVue",{attrs:{type:"primary",disabled:t.loading||!t.allowRoot&&!t.selectedMailboxId,"aria-label":t.loading?t.labelSelectLoading:t.labelSelect},on:{click:t.onSelect},scopedSlots:t._u([{key:"icon",fn:function(){return[t.loading?e("IconLoading",{attrs:{size:20}}):t._e()]},proxy:!0}])},[t._v("\n\t\t\t\t"+t._s(t.loading?t.labelSelectLoading:t.labelSelect)+"\n\t\t\t")])],1)])])}),[],!1,null,"1a3766c1",null).exports},75292:(t,e,n)=>{"use strict";n.d(e,{A:()=>s});var i=n(71354),a=n.n(i),o=n(76314),r=n.n(o)()(a());r.push([t.id,".editor-wrapper--bordered[data-v-caf9c680]{--border-offset: calc(var(--border-width-input-focused, 2px) - var(--border-width-input, 2px));margin-top:var(--default-grid-baseline);border:var(--border-width-input, 2px) solid var(--color-border-maxcontrast);border-radius:var(--border-radius-large);height:200px;padding:9px}.editor-wrapper--bordered[data-v-caf9c680] .ck.ck-editor__editable_inline{padding:0 !important}.editor-wrapper--bordered[data-v-caf9c680]:focus{padding:calc(9px - var(--border-offset));border-color:var(--color-main-text);border-width:var(--border-width-input-focused, 2px)}.editor-wrapper--bordered[data-v-caf9c680]:hover{padding:calc(9px - var(--border-offset));border-color:var(--color-main-text);border-width:var(--border-width-input-focused, 2px)}.editor[data-v-caf9c680]{width:100%;height:calc(100% - 75px);overflow:scroll;margin-bottom:10px}.editor.ck[data-v-caf9c680]{border:none !important;box-shadow:none !important;padding:0}[data-v-caf9c680] a{color:#07d}[data-v-caf9c680] p{cursor:text;margin:0 !important}","",{version:3,sources:["webpack://./src/components/TextEditor.vue"],names:[],mappings:"AACA,2CACC,8FAAA,CACA,uCAAA,CACA,2EAAA,CACA,wCAAA,CACA,YAAA,CAEA,WAAA,CAEA,0EACC,oBAAA,CAED,iDACC,wCAAA,CACA,mCAAA,CACA,mDAAA,CAED,iDACC,wCAAA,CACA,mCAAA,CACA,mDAAA,CAIF,yBACC,UAAA,CACA,wBAAA,CACA,eAAA,CACA,kBAAA,CAEA,4BACC,sBAAA,CACA,0BAAA,CACA,SAAA,CAIF,oBACC,UAAA,CAGD,oBACC,WAAA,CACA,mBAAA",sourcesContent:["\n.editor-wrapper--bordered{\n\t--border-offset: calc(var(--border-width-input-focused, 2px) - var(--border-width-input, 2px));\n\tmargin-top: var(--default-grid-baseline);\n\tborder: var(--border-width-input, 2px) solid var(--color-border-maxcontrast);\n\tborder-radius:var(--border-radius-large);\n\theight: 200px;\n\t// to align with the text input in the text block modal\n\tpadding: 9px;\n\n\t:deep(.ck.ck-editor__editable_inline) {\n\t\tpadding:0 !important;\n\t}\n\t&:focus {\n\t\tpadding: calc(9px - var(--border-offset));\n\t\tborder-color: var(--color-main-text);\n\t\tborder-width: var(--border-width-input-focused, 2px);\n\t}\n\t&:hover {\n\t\tpadding: calc(9px - var(--border-offset));\n\t\tborder-color: var(--color-main-text);\n\t\tborder-width: var(--border-width-input-focused, 2px);\n\t}\n}\n\n.editor {\n\twidth: 100%;\n\theight: calc(100% - 75px);\n\toverflow: scroll;\n\tmargin-bottom: 10px;\n\n\t&.ck {\n\t\tborder: none !important;\n\t\tbox-shadow: none !important;\n\t\tpadding: 0;\n\t}\n}\n\n:deep(a) {\n\tcolor: #07d;\n}\n\n:deep(p) {\n\tcursor: text;\n\tmargin: 0 !important;\n}\n"],sourceRoot:""}]);const s=r},79722:t=>{"use strict";t.exports="data:image/svg+xml,%3c%21--%20-%20SPDX-FileCopyrightText:%202020%20Google%20Inc.%20-%20SPDX-License-Identifier:%20Apache-2.0%20--%3e%3csvg%20xmlns=%27http://www.w3.org/2000/svg%27%20width=%2724%27%20height=%2724%27%20fill=%27%23222%27%3e%3cpath%20d=%27M5.6%207.4L7%206l6%206-6%206-1.4-1.4%204.6-4.6-4.6-4.6m6%200L13%206l6%206-6%206-1.4-1.4%204.6-4.6-4.6-4.6z%27/%3e%3c/svg%3e"},86886:t=>{"use strict";t.exports="data:image/svg+xml,%3c%21--%20-%20SPDX-FileCopyrightText:%202020%20Google%20Inc.%20-%20SPDX-License-Identifier:%20Apache-2.0%20--%3e%3csvg%20xmlns=%27http://www.w3.org/2000/svg%27%20width=%2724%27%20height=%2724%27%20fill=%27%23222%27%3e%3cpath%20d=%27M8.6%2016.6l4.6-4.6-4.6-4.6L10%206l6%206-6%206-1.4-1.4z%27/%3e%3c/svg%3e"},93246:(t,e,n)=>{"use strict";n.d(e,{A:()=>s});var i=n(71354),a=n.n(i),o=n(76314),r=n.n(o)()(a());r.push([t.id,".text-block-list-item[data-v-51280ad6]{padding-inline-start:0px !important;padding-inline-end:0px !important}.text-block-list-item[data-v-51280ad6] .list-item-content{padding:0px !important}.text-block-buttons[data-v-51280ad6]{width:100%;justify-self:end;display:flex;justify-content:flex-end}.text-block-buttons__button[data-v-51280ad6]{margin:var(--default-grid-baseline)}","",{version:3,sources:["webpack://./src/components/textBlocks/ListItem.vue"],names:[],mappings:"AACA,uCACC,mCAAA,CACA,iCAAA,CACA,0DACC,sBAAA,CAIF,qCACC,UAAA,CACA,gBAAA,CACA,YAAA,CACA,wBAAA,CACA,6CACC,mCAAA",sourcesContent:["\n.text-block-list-item {\n\tpadding-inline-start: 0px !important;\n\tpadding-inline-end: 0px !important;\n\t:deep(.list-item-content) {\n\t\tpadding: 0px !important;\n\t}\n}\n\n.text-block-buttons {\n\twidth: 100%;\n\tjustify-self: end;\n\tdisplay: flex;\n\tjustify-content: flex-end;\n\t&__button {\n\t\tmargin: var(--default-grid-baseline);\n\t}\n}\n"],sourceRoot:""}]);const s=r},96153:(t,e,n)=>{"use strict";n.d(e,{A:()=>s});var i=n(71354),a=n.n(i),o=n(76314),r=n.n(o)()(a());r.push([t.id,"\n/*\nOverwrite the default z-index for CKEditor\nhttps://github.com/ckeditor/ckeditor5/issues/1142\n */\n.ck .ck-reset {\n\tbackground: var(--color-main-background) !important;\n}\n/* Default ckeditor value of padding-inline-start, to overwrite the global styling from server */\n.ck-content ul, .ck-content ol {\n\tpadding-inline-start: 40px;\n}\n.ck-read-only {\n\tcolor: var(--color-main-text) !important;\n\tbackground-color: var(--color-main-background) !important;\n\topacity: 1 !important;\n\tfont-size: 100% !important;\n}\n.ck-list__item {\n.ck-off {\n\t\tbackground:var(--color-main-background) !important;\n}\n.ck-on {\n\t\tbackground:var(--color-primary-element-light) !important;\n}\n}\n.custom-item-username {\n\tcolor: var(--color-main-text) !important;\n}\n.link-title {\n\tcolor: var(--color-main-text) !important;\n\tmargin-inline-start: var(--default-grid-baseline) !important;\n}\n.custom-item {\n\twidth : 100% !important;\n\tborder-radius : 8px !important;\n\tpadding : 4px 8px !important;\n\tdisplay :block;\n\tbackground:var(--color-main-background)!important;\n}\n.custom-item:hover {\n\tbackground:var(--color-primary-element-light)!important;\n}\n.link-container{\n\tborder-radius :8px !important;\n\tpadding :4px 8px !important;\n\tdisplay : block;\n\twidth : 100% !important;\n\tbackground:var(--color-main-background)!important;\nimg.link-icon {\n\t\twidth: 16px;\n\t\theight: 16px;\n}\n}\n.link-container:hover {\n\tbackground:var(--color-primary-element-light)!important;\n}\n:root {\n\t--ck-z-default: 10000;\n\t--ck-balloon-border-width:  0;\n}\n.ck.ck-toolbar {\n\tborder-radius: var(--border-radius-large) !important;\n\tbackground: none;\n}\n.ck-rounded-corners .ck.ck-dropdown__panel, .ck.ck-dropdown__panel.ck-rounded-corners {\n\tborder-radius: var(--border-radius-large) !important;\n\toverflow: visible;\n}\n.ck.ck-list-styles-list {\n/* our composer is very small, having menus vertically shown is better */\n\tgrid-template-rows: repeat(3,auto) !important;\n\tgrid-template-columns: unset !important;\n}\n.ck.ck-button {\n\tborder-radius: var(--border-radius-element) !important;\n}\n.ck-powered-by-balloon {\n\tdisplay: none !important;\n}\n.editor-wrapper {\n\tdisplay: flex;\n\tflex-direction: column-reverse;\n\theight: 100%;\n.toolbar {\n\t\tposition: sticky;\n\t\tbottom: 0;\n\t\tz-index: 10;\n}\n.editable {\n\t\tflex-grow: 1;\n\t\toverflow-y: auto;\n}\n}\n.ck.ck-editor__editable.ck-focused:not(.ck-editor__nested-editable) {\n\tborder: none;\n\tbox-shadow: none;\n\twidth: 99%;\n\theight: 97%;\n}\n.ck.ck-button, a.ck.ck-button {\n\tfont-size: small;\n\tfont-weight: normal;\n}\n.ck-source-editing-area {\n\theight: 97%;\n\toverflow: scroll;\n}\n.ck-source-editing-area textarea {\n\tborder: 0;\n}\n.ck.ck-editor__editable_inline {\n\twidth: 99%;\n\theight: 97%;\n\tborder: 0;\n}\n.select, button:not(.button-vue,[class^=vs__]), .button, input[type=button], input[type=submit], input[type=reset] {\n\tcolor: var(--color-main-text);\n}\n/* we need the paragraph field a bit smaller so it doesnt break the toolbar for signature */\n.ck.ck-dropdown.ck-heading-dropdown .ck-dropdown__button .ck-button__label {\n\twidth: 6em !important;\n}\n.ck.ck-editor__top .ck-sticky-panel .ck-sticky-panel__content {\n\tborder: none;\n}\n","",{version:3,sources:["webpack://./src/components/TextEditor.vue"],names:[],mappings:";AAgfA;;;EAGA;AACA;CACA,mDAAA;AACA;AACA,gGAAA;AACA;CACA,0BAAA;AACA;AAEA;CACA,wCAAA;CACA,yDAAA;CACA,qBAAA;CACA,0BAAA;AACA;AAEA;AACA;EACA,kDAAA;AACA;AACA;EACA,wDAAA;AACA;AACA;AAEA;CACA,wCAAA;AACA;AAEA;CACA,wCAAA;CACA,4DAAA;AACA;AAEA;CACA,uBAAA;CACA,8BAAA;CACA,4BAAA;CACA,cAAA;CACA,iDAAA;AACA;AAEA;CACA,uDAAA;AACA;AAEA;CACA,6BAAA;CACA,2BAAA;CACA,eAAA;CACA,uBAAA;CACA,iDAAA;AACA;EACA,WAAA;EACA,YAAA;AACA;AACA;AAEA;CACA,uDAAA;AACA;AAEA;CACA,qBAAA;CACA,6BAAA;AACA;AAEA;CACA,oDAAA;CACA,gBAAA;AACA;AAEA;CACA,oDAAA;CACA,iBAAA;AACA;AAEA;AACA,wEAAA;CACA,6CAAA;CACA,uCAAA;AACA;AAEA;CACA,sDAAA;AACA;AAEA;CACA,wBAAA;AACA;AAEA;CACA,aAAA;CACA,8BAAA;CACA,YAAA;AAEA;EACA,gBAAA;EACA,SAAA;EACA,WAAA;AACA;AAEA;EACA,YAAA;EACA,gBAAA;AACA;AACA;AAEA;CACA,YAAA;CACA,gBAAA;CACA,UAAA;CACA,WAAA;AACA;AAEA;CACA,gBAAA;CACA,mBAAA;AACA;AAEA;CACA,WAAA;CACA,gBAAA;AACA;AAEA;CACA,SAAA;AACA;AAEA;CACA,UAAA;CACA,WAAA;CACA,SAAA;AACA;AAEA;CACA,6BAAA;AACA;AACA,2FAAA;AACA;CACA,qBAAA;AACA;AAEA;CACA,YAAA;AACA",sourcesContent:["\x3c!--\n  - SPDX-FileCopyrightText: 2019 Nextcloud GmbH and Nextcloud contributors\n  - SPDX-License-Identifier: AGPL-3.0-or-later\n--\x3e\n\n<template>\n\t<div :class=\"{ 'editor-wrapper--bordered': isBordered }\" class=\"editor-wrapper\">\n\t\t<div ref=\"toolbarContainer\" class=\"toolbar\" />\n\n\t\t<div ref=\"editableContainer\" class=\"editable\" />\n\n\t\t<ckeditor v-if=\"ready\"\n\t\t\t:value=\"value\"\n\t\t\t:config=\"config\"\n\t\t\t:editor=\"editor\"\n\t\t\t:disabled=\"disabled\"\n\t\t\tclass=\"editor\"\n\t\t\t@input=\"onEditorInput\"\n\t\t\t@ready=\"onEditorReady\" />\n\t</div>\n</template>\n\n<script>\nimport CKEditor from '@ckeditor/ckeditor5-vue2'\nimport AlignmentPlugin from '@ckeditor/ckeditor5-alignment/src/alignment.js'\nimport { Mention } from '@ckeditor/ckeditor5-mention'\nimport Editor from '@ckeditor/ckeditor5-editor-classic/src/classiceditor.js'\nimport EssentialsPlugin from '@ckeditor/ckeditor5-essentials/src/essentials.js'\nimport BlockQuotePlugin from '@ckeditor/ckeditor5-block-quote/src/blockquote.js'\nimport BoldPlugin from '@ckeditor/ckeditor5-basic-styles/src/bold.js'\nimport FontPlugin from '@ckeditor/ckeditor5-font/src/font.js'\nimport ParagraphPlugin from '@ckeditor/ckeditor5-paragraph/src/paragraph.js'\nimport HeadingPlugin from '@ckeditor/ckeditor5-heading/src/heading.js'\nimport ItalicPlugin from '@ckeditor/ckeditor5-basic-styles/src/italic.js'\nimport Underline from '@ckeditor/ckeditor5-basic-styles/src/underline.js'\nimport Superscript from '@ckeditor/ckeditor5-basic-styles/src/superscript.js'\nimport Subscript from '@ckeditor/ckeditor5-basic-styles/src/subscript.js'\nimport LinkPlugin from '@ckeditor/ckeditor5-link/src/link.js'\nimport ListPlugin from '@ckeditor/ckeditor5-list/src/list.js'\nimport ListProperties from '@ckeditor/ckeditor5-list/src/listproperties.js'\nimport RemoveFormat from '@ckeditor/ckeditor5-remove-format/src/removeformat.js'\nimport SignaturePlugin from '../ckeditor/signature/SignaturePlugin.js'\nimport StrikethroughPlugin from '@ckeditor/ckeditor5-basic-styles/src/strikethrough.js'\nimport QuotePlugin from '../ckeditor/quote/QuotePlugin.js'\nimport Base64UploadAdapter from '@ckeditor/ckeditor5-upload/src/adapters/base64uploadadapter.js'\nimport ImagePlugin from '@ckeditor/ckeditor5-image/src/image.js'\nimport FindAndReplace from '@ckeditor/ckeditor5-find-and-replace/src/findandreplace.js'\nimport ImageResizePlugin from '@ckeditor/ckeditor5-image/src/imageresize.js'\nimport ImageUploadPlugin from '@ckeditor/ckeditor5-image/src/imageupload.js'\nimport GeneralHtmlSupport from '@ckeditor/ckeditor5-html-support/src/generalhtmlsupport.js'\nimport { DropdownView } from '@ckeditor/ckeditor5-ui'\nimport MailPlugin from '../ckeditor/mail/MailPlugin.js'\nimport { searchProvider, getLinkWithPicker } from '@nextcloud/vue/components/NcRichText'\nimport { getLanguage } from '@nextcloud/l10n'\nimport logger from '../logger.js'\nimport PickerPlugin from '../ckeditor/smartpicker/PickerPlugin.js'\nimport { autoCompleteByName } from '../service/ContactIntegrationService.js'\nimport { emojiSearch, emojiAddRecent } from '@nextcloud/vue'\nimport { toPlain, Text } from '../util/text.js'\nexport default {\n\tname: 'TextEditor',\n\tcomponents: {\n\t\tckeditor: CKEditor.component,\n\t},\n\tprops: {\n\t\tvalue: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t\thtml: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false,\n\t\t},\n\t\tplaceholder: {\n\t\t\ttype: String,\n\t\t\tdefault: '',\n\t\t},\n\t\tfocus: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false,\n\t\t},\n\t\tbus: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t\tdisabled: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false,\n\t\t},\n\t\ttextBlocks: {\n\t\t\ttype: Array,\n\t\t\tdefault: () => [],\n\t\t},\n\t\tisBordered: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false,\n\t\t},\n\t\treadOnly: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false,\n\t\t},\n\t},\n\tdata() {\n\t\tconst plugins = [\n\t\t\tEssentialsPlugin,\n\t\t\tParagraphPlugin,\n\t\t\tSignaturePlugin,\n\t\t\tQuotePlugin,\n\t\t\tPickerPlugin,\n\t\t\tMention,\n\t\t\tLinkPlugin,\n\t\t\tFindAndReplace,\n\t\t\tGeneralHtmlSupport,\n\t\t]\n\t\tconst toolbar = ['undo', 'redo']\n\n\t\tif (this.html) {\n\t\t\tplugins.push(...[\n\t\t\t\tHeadingPlugin,\n\t\t\t\tAlignmentPlugin,\n\t\t\t\tBoldPlugin,\n\t\t\t\tItalicPlugin,\n\t\t\t\tUnderline,\n\t\t\t\tStrikethroughPlugin,\n\t\t\t\tSubscript,\n\t\t\t\tSuperscript,\n\t\t\t\tBlockQuotePlugin,\n\t\t\t\tListPlugin,\n\t\t\t\tImagePlugin,\n\t\t\t\tImageUploadPlugin,\n\t\t\t\tImageResizePlugin,\n\t\t\t\tListProperties,\n\t\t\t\tFontPlugin,\n\t\t\t\tRemoveFormat,\n\t\t\t\tBase64UploadAdapter,\n\t\t\t\tMailPlugin,\n\t\t\t])\n\t\t\ttoolbar.unshift(...[\n\t\t\t\t'heading',\n\t\t\t\t'fontFamily',\n\t\t\t\t'fontSize',\n\t\t\t\t'bold',\n\t\t\t\t'italic',\n\t\t\t\t'underline',\n\t\t\t\t'strikethrough',\n\t\t\t\t'fontColor',\n\t\t\t\t'subscript',\n\t\t\t\t'superscript',\n\t\t\t\t'fontBackgroundColor',\n\t\t\t\t'insertImage',\n\t\t\t\t'alignment',\n\t\t\t\t'bulletedList',\n\t\t\t\t'numberedList',\n\t\t\t\t'blockquote',\n\t\t\t\t'link',\n\t\t\t\t'removeFormat',\n\t\t\t\t'findAndReplace',\n\t\t\t])\n\t\t}\n\n\t\treturn {\n\t\t\tlinkTribute: null,\n\t\t\temojiTribute: null,\n\t\t\ttextSmiles: [],\n\t\t\tready: false,\n\t\t\teditor: Editor,\n\t\t\tconfig: {\n\t\t\t\tlicenseKey: 'GPL',\n\t\t\t\tplaceholder: this.placeholder,\n\t\t\t\tplugins,\n\t\t\t\ttoolbar: {\n\t\t\t\t\titems: toolbar,\n\t\t\t\t},\n\t\t\t\tlanguage: 'en',\n\t\t\t\tmention: {\n\t\t\t\t\tfeeds: [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tmarker: ':',\n\t\t\t\t\t\t\tfeed: this.getEmoji,\n\t\t\t\t\t\t\titemRenderer: this.customEmojiRenderer,\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tmarker: '/',\n\t\t\t\t\t\t\tfeed: this.getLink,\n\t\t\t\t\t\t\titemRenderer: this.customLinkRenderer,\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tmarker: '@',\n\t\t\t\t\t\t\tfeed: this.getContact,\n\t\t\t\t\t\t\titemRenderer: this.customRenderer,\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tmarker: '!',\n\t\t\t\t\t\t\tfeed: this.getTextBlock,\n\t\t\t\t\t\t\titemRenderer: this.customRenderer,\n\t\t\t\t\t\t},\n\t\t\t\t\t],\n\t\t\t\t},\n\t\t\t},\n\t\t}\n\t},\n\tbeforeMount() {\n\t\tthis.loadEditorTranslations(getLanguage())\n\t},\n\tmethods: {\n\t\tgetLink(text) {\n\t\t\tconst results = searchProvider(text)\n\t\t\tif (results.length === 1 && !results[0].title.toLowerCase().includes(text.toLowerCase())) {\n\t\t\t\treturn []\n\t\t\t}\n\t\t\treturn results\n\t\t},\n\t\tgetEmoji(text) {\n\t\t\tconst emojiResults = emojiSearch(text)\n\t\t\tif (this.textSmiles.includes(':' + text)) {\n\n\t\t\t\temojiResults.unshift(':' + text)\n\t\t\t}\n\t\t\treturn emojiResults\n\t\t},\n\t\tasync getContact(text) {\n\t\t\tif (text.length === 0) {\n\t\t\t\treturn []\n\t\t\t}\n\t\t\tlet contactResults = await autoCompleteByName(text)\n\t\t\tcontactResults = contactResults.filter(result => result.email.length > 0)\n\t\t\treturn contactResults\n\t\t},\n\t\tgetTextBlock(text) {\n\t\t\tif (text.length === 0) {\n\t\t\t\treturn []\n\t\t\t}\n\t\t\treturn this.textBlocks.filter(textBlock => textBlock.title.toLowerCase().includes(text.toLowerCase()))\n\t\t},\n\t\t customEmojiRenderer(item) {\n\t\t\tconst itemElement = document.createElement('span')\n\n\t\t\titemElement.classList.add('custom-item')\n\t\t\titemElement.id = `mention-list-item-id-${item.colons}`\n\t\t\titemElement.textContent = `${item.native} `\n\t\t\tconst usernameElement = document.createElement('span')\n\n\t\t\tusernameElement.classList.add('custom-item-username')\n\t\t\tusernameElement.textContent = item.colons\n\n\t\t\titemElement.appendChild(usernameElement)\n\n\t\t\treturn itemElement\n\t\t},\n\t\tcustomLinkRenderer(item) {\n\t\t\tconst itemElement = document.createElement('span')\n\t\t\titemElement.classList.add('link-container')\n\n\t\t\tconst icon = document.createElement('img')\n\t\t\ticon.classList.add('link-icon')\n\t\t\ticon.src = `${item.icon_url} `\n\n\t\t\tconst usernameElement = document.createElement('span')\n\n\t\t\tusernameElement.classList.add('link-title')\n\t\t\tusernameElement.textContent = `${item.title} `\n\t\t\titemElement.appendChild(icon)\n\t\t\titemElement.appendChild(usernameElement)\n\n\t\t\treturn itemElement\n\t\t},\n\t\tcustomRenderer(item, type) {\n\t\t\tconst itemElement = document.createElement('span')\n\n\t\t\titemElement.classList.add('custom-item')\n\t\t\titemElement.id = `mention-list-item-id-${item.id}`\n\t\t\tconst usernameElement = document.createElement('p')\n\t\t\tconst label = type === 'contact' ? item.label : item.title\n\t\t\tusernameElement.classList.add('custom-item-username')\n\t\t\tusernameElement.textContent = label\n\n\t\t\titemElement.appendChild(usernameElement)\n\n\t\t\treturn itemElement\n\t\t},\n\t\toverrideDropdownPositionsToNorth(editor, toolbarView) {\n\t\t\tconst {\n\t\t\t\tsouth, north, southEast, southWest, northEast, northWest,\n\t\t\t\tsouthMiddleEast, southMiddleWest, northMiddleEast, northMiddleWest,\n\t\t\t} = DropdownView.defaultPanelPositions\n\n\t\t\tlet panelPositions\n\n\t\t\tif (editor.locale.uiLanguageDirection !== 'rtl') {\n\t\t\t\tpanelPositions = [\n\t\t\t\t\tnorthEast, northWest, northMiddleEast, northMiddleWest, north,\n\t\t\t\t\tsouthEast, southWest, southMiddleEast, southMiddleWest, south,\n\t\t\t\t]\n\t\t\t} else {\n\t\t\t\tpanelPositions = [\n\t\t\t\t\tnorthWest, northEast, northMiddleWest, northMiddleEast, north,\n\t\t\t\t\tsouthWest, southEast, southMiddleWest, southMiddleEast, south,\n\t\t\t\t]\n\t\t\t}\n\n\t\t\tfor (const item of toolbarView.items) {\n\t\t\t\tif (!(item instanceof DropdownView)) {\n\t\t\t\t\tcontinue\n\t\t\t\t}\n\n\t\t\t\titem.on('change:isOpen', () => {\n\t\t\t\t\tif (!item.isOpen) {\n\t\t\t\t\t\treturn\n\t\t\t\t\t}\n\n\t\t\t\t\titem.panelView.position = DropdownView._getOptimalPosition({\n\t\t\t\t\t\telement: item.panelView.element,\n\t\t\t\t\t\ttarget: item.buttonView.element,\n\t\t\t\t\t\tfitInViewport: true,\n\t\t\t\t\t\tpositions: panelPositions,\n\t\t\t\t\t}).name\n\t\t\t\t})\n\t\t\t}\n\t\t},\n\t\toverrideTooltipPositions(toolbarView) {\n\t\t\tfor (const item of toolbarView.items) {\n\t\t\t\tif (item.buttonView) {\n\t\t\t\t\titem.buttonView.tooltipPosition = 'n'\n\t\t\t\t} else if (item.tooltipPosition) {\n\t\t\t\t\titem.tooltipPosition = 'n'\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\tasync loadEditorTranslations(language) {\n\t\t\tif (language === 'en') {\n\t\t\t\t// The default, nothing to fetch\n\t\t\t\treturn this.showEditor('en')\n\t\t\t}\n\n\t\t\ttry {\n\t\t\t\tlogger.debug(`loading ${language} translations for CKEditor`)\n\t\t\t\tawait import(\n\t\t\t\t\t/* webpackMode: \"lazy-once\" */\n\t\t\t\t\t/* webpackPrefetch: true */\n\t\t\t\t\t/* webpackPreload: true */\n\t\t\t\t\t`@ckeditor/ckeditor5-build-decoupled-document/build/translations/${language}`\n\t\t\t\t)\n\t\t\t\tthis.showEditor(language)\n\t\t\t} catch (error) {\n\t\t\t\tlogger.error(`could not find CKEditor translations for \"${language}\"`, { error })\n\t\t\t\tthis.showEditor('en')\n\t\t\t}\n\t\t},\n\t\tshowEditor(language) {\n\t\t\tlogger.debug(`using \"${language}\" as CKEditor language`)\n\t\t\tthis.config.language = language\n\n\t\t\tthis.ready = true\n\t\t},\n\t\t/**\n\t\t * @param {module:core/editor/editor~Editor} editor editor the editor instance\n\t\t */\n\t\tonEditorReady(editor) {\n\t\t\tlogger.debug('TextEditor is ready', { editor })\n\n\t\t\t// https://ckeditor.com/docs/ckeditor5/latest/examples/builds-custom/bottom-toolbar-editor.html\n\t\t\tthis.$refs.toolbarContainer.appendChild(editor.ui.view.toolbar.element)\n\t\t\tthis.$refs.editableContainer.appendChild(editor.ui.view.editable.element)\n\t\t\tif (this.readOnly) {\n\t\t\t\teditor.ui.view.toolbar.element.style.display = 'none'\n\t\t\t\teditor.enableReadOnlyMode('text-block')\n\t\t\t}\n\t\t\tif (editor.ui) {\n\t\t\t\tthis.overrideDropdownPositionsToNorth(editor, editor.ui.view.toolbar)\n\t\t\t\tthis.overrideTooltipPositions(editor.ui.view.toolbar)\n\t\t\t}\n\t\t\teditor.commands.get('mention')?.on('execute', (event, data) => {\n\t\t\t\tevent.stop()\n\t\t\t\tconst eventData = data[0]\n\t\t\t\tconst item = eventData.mention\n\t\t\t\tif (eventData.marker === ':') {\n\t\t\t\t\temojiAddRecent(item)\n\t\t\t\t\tthis.editorInstance.execute('insertItem', item.native, ':')\n\t\t\t\t}\n\t\t\t\tif (eventData.marker === '/') {\n\t\t\t\t\tgetLinkWithPicker(item.id)\n\t\t\t\t\t\t.then((link) => {\n\t\t\t\t\t\t\tthis.editorInstance.execute('insertItem', link, '/')\n\t\t\t\t\t\t\tthis.editorInstance.editing.view.focus()\n\t\t\t\t\t\t})\n\t\t\t\t\t\t.catch((error) => {\n\t\t\t\t\t\t\tconsole.debug('Smart picker promise rejected:', error)\n\t\t\t\t\t\t})\n\t\t\t\t}\n\t\t\t\tif (eventData.marker === '@') {\n\t\t\t\t\tthis.editorInstance.execute('insertItem', { email: item.email[0], label: item.label }, '@')\n\t\t\t\t\tthis.$emit('mention', { email: item.email[0], label: item.label })\n\t\t\t\t}\n\t\t\t\tif (eventData.marker === '!') {\n\t\t\t\t\tthis.insertTextBlock(item, false)\n\t\t\t\t}\n\t\t\t}, { priority: 'high' })\n\n\t\t\tthis.editorInstance = editor\n\n\t\t\tif (this.focus) {\n\t\t\t\tlogger.debug('focusing TextEditor')\n\t\t\t\teditor.editing.view.focus()\n\t\t\t}\n\n\t\t\tif (this.html) {\n\t\t\t\tthis.$emit('show-toolbar', editor.ui._focusableToolbarDefinitions[0].toolbarView.element)\n\t\t\t}\n\n\t\t\tthis.bus.on('append-to-body-at-cursor', this.appendToBodyAtCursor)\n\t\t\tthis.bus.on('insert-text-block', this.insertTextBlock)\n\t\t\tthis.$emit('ready', editor)\n\t\t},\n\t\tonEditorInput(text) {\n\t\t\tif (text !== this.value) {\n\t\t\t\tlogger.debug(`TextEditor input changed to <${text}>`)\n\t\t\t\tthis.$emit('input', text)\n\t\t\t}\n\t\t},\n\t\tappendToBodyAtCursor(toAppend) {\n\t\t\t// https://ckeditor.com/docs/ckeditor5/latest/builds/guides/faq.html#where-are-the-editorinserthtml-and-editorinserttext-methods-how-to-insert-some-content\n\t\t\tconst viewFragment = this.editorInstance.data.processor.toView(toAppend)\n\t\t\tconst modelFragment = this.editorInstance.data.toModel(viewFragment)\n\t\t\tthis.editorInstance.model.insertContent(modelFragment)\n\t\t},\n\t\teditorExecute(commandName, ...args) {\n\t\t\tif (this.editorInstance) {\n\t\t\t\tthis.editorInstance.execute(commandName, ...args)\n\t\t\t} else {\n\t\t\t\tthrow new Error('Impossible to execute a command before editor is ready.')\n\t\t\t}\n\t\t},\n\t\tinsertTextBlock(textBlock, addTriggrer = true) {\n\t\t\tif (addTriggrer) {\n\t\t\t\tthis.appendToBodyAtCursor('!')\n\t\t\t}\n\t\t\tlet content = textBlock.content\n\t\t\tif (!this.html) {\n\t\t\t\tconst text = new Text('html', content)\n\t\t\t\tcontent = toPlain(text).value\n\t\t\t}\n\t\t\tthis.editorInstance.execute('insertItem', { content, isHtml: this.html }, '!')\n\t\t},\n\t},\n}\n<\/script>\n\n<style lang=\"scss\" scoped>\n.editor-wrapper--bordered{\n\t--border-offset: calc(var(--border-width-input-focused, 2px) - var(--border-width-input, 2px));\n\tmargin-top: var(--default-grid-baseline);\n\tborder: var(--border-width-input, 2px) solid var(--color-border-maxcontrast);\n\tborder-radius:var(--border-radius-large);\n\theight: 200px;\n\t// to align with the text input in the text block modal\n\tpadding: 9px;\n\n\t:deep(.ck.ck-editor__editable_inline) {\n\t\tpadding:0 !important;\n\t}\n\t&:focus {\n\t\tpadding: calc(9px - var(--border-offset));\n\t\tborder-color: var(--color-main-text);\n\t\tborder-width: var(--border-width-input-focused, 2px);\n\t}\n\t&:hover {\n\t\tpadding: calc(9px - var(--border-offset));\n\t\tborder-color: var(--color-main-text);\n\t\tborder-width: var(--border-width-input-focused, 2px);\n\t}\n}\n\n.editor {\n\twidth: 100%;\n\theight: calc(100% - 75px);\n\toverflow: scroll;\n\tmargin-bottom: 10px;\n\n\t&.ck {\n\t\tborder: none !important;\n\t\tbox-shadow: none !important;\n\t\tpadding: 0;\n\t}\n}\n\n:deep(a) {\n\tcolor: #07d;\n}\n\n:deep(p) {\n\tcursor: text;\n\tmargin: 0 !important;\n}\n</style>\n\n<style>\n/*\nOverwrite the default z-index for CKEditor\nhttps://github.com/ckeditor/ckeditor5/issues/1142\n */\n .ck .ck-reset {\n\tbackground: var(--color-main-background) !important;\n }\n/* Default ckeditor value of padding-inline-start, to overwrite the global styling from server */\n.ck-content ul, .ck-content ol {\n\tpadding-inline-start: 40px;\n}\n\n.ck-read-only {\n\tcolor: var(--color-main-text) !important;\n\tbackground-color: var(--color-main-background) !important;\n\topacity: 1 !important;\n\tfont-size: 100% !important;\n}\n\n.ck-list__item {\n\t.ck-off {\n\t\tbackground:var(--color-main-background) !important;\n\t}\n\t.ck-on {\n\t\tbackground:var(--color-primary-element-light) !important;\n\t}\n}\n\n.custom-item-username {\n\tcolor: var(--color-main-text) !important;\n }\n\n .link-title {\n\tcolor: var(--color-main-text) !important;\n\tmargin-inline-start: var(--default-grid-baseline) !important;\n }\n\n .custom-item {\n\twidth : 100% !important;\n\tborder-radius : 8px !important;\n\tpadding : 4px 8px !important;\n\tdisplay :block;\n\tbackground:var(--color-main-background)!important;\n }\n\n .custom-item:hover {\n\tbackground:var(--color-primary-element-light)!important;\n }\n\n .link-container{\n\tborder-radius :8px !important;\n\tpadding :4px 8px !important;\n\tdisplay : block;\n\twidth : 100% !important;\n\tbackground:var(--color-main-background)!important;\n\timg.link-icon {\n\t\twidth: 16px;\n\t\theight: 16px;\n\t}\n }\n\n .link-container:hover {\n\tbackground:var(--color-primary-element-light)!important;\n }\n\n:root {\n\t--ck-z-default: 10000;\n\t--ck-balloon-border-width:  0;\n}\n\n.ck.ck-toolbar {\n\tborder-radius: var(--border-radius-large) !important;\n\tbackground: none;\n}\n\n.ck-rounded-corners .ck.ck-dropdown__panel, .ck.ck-dropdown__panel.ck-rounded-corners {\n\tborder-radius: var(--border-radius-large) !important;\n\toverflow: visible;\n}\n\n.ck.ck-list-styles-list {\n/* our composer is very small, having menus vertically shown is better */\n\tgrid-template-rows: repeat(3,auto) !important;\n\tgrid-template-columns: unset !important;\n}\n\n.ck.ck-button {\n\tborder-radius: var(--border-radius-element) !important;\n}\n\n.ck-powered-by-balloon {\n\tdisplay: none !important;\n}\n\n.editor-wrapper {\n\tdisplay: flex;\n\tflex-direction: column-reverse;\n\theight: 100%;\n\n\t.toolbar {\n\t\tposition: sticky;\n\t\tbottom: 0;\n\t\tz-index: 10;\n\t}\n\n\t.editable {\n\t\tflex-grow: 1;\n\t\toverflow-y: auto;\n\t}\n}\n\n.ck.ck-editor__editable.ck-focused:not(.ck-editor__nested-editable) {\n\tborder: none;\n\tbox-shadow: none;\n\twidth: 99%;\n\theight: 97%;\n}\n\n.ck.ck-button, a.ck.ck-button {\n\tfont-size: small;\n\tfont-weight: normal;\n}\n\n.ck-source-editing-area {\n\theight: 97%;\n\toverflow: scroll;\n}\n\n.ck-source-editing-area textarea {\n\tborder: 0;\n}\n\n.ck.ck-editor__editable_inline {\n\twidth: 99%;\n\theight: 97%;\n\tborder: 0;\n}\n\n.select, button:not(.button-vue,[class^=vs__]), .button, input[type=button], input[type=submit], input[type=reset] {\n\tcolor: var(--color-main-text);\n}\n/* we need the paragraph field a bit smaller so it doesnt break the toolbar for signature */\n.ck.ck-dropdown.ck-heading-dropdown .ck-dropdown__button .ck-button__label {\n\twidth: 6em !important;\n}\n\n.ck.ck-editor__top .ck-sticky-panel .ck-sticky-panel__content {\n\tborder: none;\n}\n</style>\n"],sourceRoot:""}]);const s=r}}]);
//# sourceMappingURL=mail.400.7fc0f7d1f3eca541941f.js.map