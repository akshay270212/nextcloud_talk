"use strict";(self.webpackChunknextcloud_mail=self.webpackChunknextcloud_mail||[]).push([[563],{4872:t=>{t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYBAMAAAASWSDLAAAAD1BMVEUAAAD///////////////+PQt5oAAAABHRSTlMAy2EFIuWxUgAAACRJREFUGNNjGBBgJOICBY7KDCoucODEAJSAS6FwUJShGjAQAADBPRGrK2/FhgAAAABJRU5ErkJggg=="},6707:(t,e,n)=>{n.d(e,{A:()=>A});var a=n(71354),i=n.n(a),l=n(76314),o=n.n(l)()(i());o.push([t.id,"\n.vue-treeselect__control {\n\tpadding: 0;\n\tborder: 0;\n\twidth: 250px;\n}\n.vue-treeselect__control-arrow-container {\n\tdisplay: none;\n}\n.vue-treeselect--searchable .vue-treeselect__input-container {\n\tpadding-inline-start: 0;\n\tbackground-color: var(--color-main-background)\n}\ninput.vue-treeselect__input {\n\tmargin: 0;\n\tpadding: 0;\n\tborder: 1px solid var(--color-border-maxcontrast) !important;\n}\n.vue-treeselect__menu {\n\tbackground: var(--color-main-background);\n}\n.vue-treeselect--single .vue-treeselect__option--selected {\n\tbackground: var(--color-primary-element-light);\n\tborder-radius: var(--border-radius-large);\n}\n.vue-treeselect__option.vue-treeselect__option--highlight,\n.vue-treeselect__option:hover,\n.vue-treeselect__option:focus {\n\tborder-radius: var(--border-radius-large);\n}\n.vue-treeselect__placeholder, .vue-treeselect__single-value {\n\tline-height: 34px;\n\tcolor: var(--color-main-text);\n}\n\n","",{version:3,sources:["webpack://./src/components/MailboxInlinePicker.vue"],names:[],mappings:";AA+EA;CACA,UAAA;CACA,SAAA;CACA,YAAA;AACA;AAEA;CACA,aAAA;AACA;AAEA;CACA,uBAAA;CACA;AACA;AAEA;CACA,SAAA;CACA,UAAA;CACA,4DAAA;AACA;AAEA;CACA,wCAAA;AACA;AAEA;CACA,8CAAA;CACA,yCAAA;AACA;AAEA;;;CAGA,yCAAA;AACA;AAEA;CACA,iBAAA;CACA,6BAAA;AACA",sourcesContent:["\x3c!--\n  - SPDX-FileCopyrightText: 2018 Nextcloud GmbH and Nextcloud contributors\n  - SPDX-License-Identifier: AGPL-3.0-or-later\n--\x3e\n<template>\n\t<Treeselect ref=\"Treeselect\"\n\t\tv-model=\"selected\"\n\t\t:options=\"mailboxes\"\n\t\t:multiple=\"false\"\n\t\t:clearable=\"false\"\n\t\t:disabled=\"disabled\" />\n</template>\n<script>\nimport Treeselect from '@riophae/vue-treeselect'\nimport '@riophae/vue-treeselect/dist/vue-treeselect.css'\nimport { mailboxHasRights } from '../util/acl.js'\n\nimport { mapStores } from 'pinia'\nimport useMainStore from '../store/mainStore.js'\n\nexport default {\n\tname: 'MailboxInlinePicker',\n\tcomponents: {\n\t\tTreeselect,\n\t},\n\tprops: {\n\t\taccount: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t\tdisabled: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false,\n\t\t},\n\t\tvalue: {\n\t\t\ttype: Number,\n\t\t\tdefault: undefined,\n\t\t},\n\t},\n\tdata() {\n\t\treturn {\n\t\t\tselected: this.value,\n\t\t}\n\t},\n\tcomputed: {\n\t\t...mapStores(useMainStore),\n\t\tmailboxes() {\n\t\t\treturn this.getMailboxes()\n\t\t},\n\t},\n\twatch: {\n\t\tselected(val) {\n\t\t\tif (val !== this.value) {\n\t\t\t\tthis.$emit('input', val)\n\t\t\t\tthis.selected = val\n\t\t\t}\n\t\t},\n\t},\n\tmethods: {\n\t\tgetMailboxes(mailboxId) {\n\t\t\tlet mailboxes = []\n\t\t\tif (!mailboxId) {\n\t\t\t\tmailboxes = this.mainStore.getMailboxes(this.account.accountId)\n\t\t\t} else {\n\t\t\t\tmailboxes = this.mainStore.getSubMailboxes(mailboxId)\n\t\t\t}\n\t\t\tmailboxes = mailboxes.filter(mailbox => mailboxHasRights(mailbox, 'i'))\n\t\t\treturn mailboxes.map((mailbox) => {\n\t\t\t\t return {\n\t\t\t\t\tid: mailbox.databaseId,\n\t\t\t\t\tlabel: mailbox.displayName,\n\t\t\t\t\tchildren: mailbox.mailboxes.length > 0 ? this.getMailboxes(mailbox.databaseId) : '',\n\t\t\t\t}\n\t\t\t})\n\t\t},\n\t},\n}\n<\/script>\n<style>\n.vue-treeselect__control {\n\tpadding: 0;\n\tborder: 0;\n\twidth: 250px;\n}\n\n.vue-treeselect__control-arrow-container {\n\tdisplay: none;\n}\n\n.vue-treeselect--searchable .vue-treeselect__input-container {\n\tpadding-inline-start: 0;\n\tbackground-color: var(--color-main-background)\n}\n\ninput.vue-treeselect__input {\n\tmargin: 0;\n\tpadding: 0;\n\tborder: 1px solid var(--color-border-maxcontrast) !important;\n}\n\n.vue-treeselect__menu {\n\tbackground: var(--color-main-background);\n}\n\n.vue-treeselect--single .vue-treeselect__option--selected {\n\tbackground: var(--color-primary-element-light);\n\tborder-radius: var(--border-radius-large);\n}\n\n.vue-treeselect__option.vue-treeselect__option--highlight,\n.vue-treeselect__option:hover,\n.vue-treeselect__option:focus {\n\tborder-radius: var(--border-radius-large);\n\t}\n\n.vue-treeselect__placeholder, .vue-treeselect__single-value {\n\tline-height: 34px;\n\tcolor: var(--color-main-text);\n}\n\n</style>\n"],sourceRoot:""}]);const A=o},8663:t=>{t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAIAgMAAAC5YVYYAAAACVBMVEUAAAD///////9zeKVjAAAAAnRSTlMAuLMp9oYAAAAPSURBVAjXY4CDrJUgBAMAGaECJ9dz3BAAAAAASUVORK5CYII="},10362:(t,e,n)=>{function a(){return Math.random().toString(16).slice(2)}n.d(e,{z:()=>a})},13729:(t,e,n)=>{n.d(e,{A:()=>A});var a=n(71354),i=n.n(a),l=n(76314),o=n.n(l)()(i());o.push([t.id,".modal__content[data-v-3d125024]{margin:25px}.filter-name[data-v-3d125024],.filter-operator[data-v-3d125024],.filter-tests[data-v-3d125024],.filter-actions[data-v-3d125024]{margin-bottom:8px}.form-group[data-v-3d125024]{margin:calc(var(--default-grid-baseline)*4) 0;display:flex;flex-direction:column;align-items:flex-start}.external-label[data-v-3d125024]{display:flex;width:100%;margin-top:1rem}.external-label label[data-v-3d125024]{padding-top:7px;padding-inline-end:14px;white-space:nowrap}.help-text p[data-v-3d125024]{margin-bottom:.2em}.help-text[data-v-3d125024]{margin-bottom:calc(var(--default-grid-baseline)*2)}","",{version:3,sources:["webpack://./src/components/mailFilter/UpdateModal.vue"],names:[],mappings:"AACA,iCACC,WAAA,CAGD,gIACC,iBAAA,CAGD,6BACC,6CAAA,CACA,YAAA,CACA,qBAAA,CACA,sBAAA,CAGD,iCACC,YAAA,CACA,UAAA,CACA,eAAA,CAGD,uCACC,eAAA,CACA,uBAAA,CACA,kBAAA,CAGD,8BACC,kBAAA,CAGD,4BACC,kDAAA",sourcesContent:["\n.modal__content {\n\tmargin: 25px;\n}\n\n.filter-name, .filter-operator, .filter-tests, .filter-actions {\n\tmargin-bottom: 8px;\n}\n\n.form-group {\n\tmargin: calc(var(--default-grid-baseline) * 4) 0;\n\tdisplay: flex;\n\tflex-direction: column;\n\talign-items: flex-start;\n}\n\n.external-label {\n\tdisplay: flex;\n\twidth: 100%;\n\tmargin-top: 1rem;\n}\n\n.external-label label {\n\tpadding-top: 7px;\n\tpadding-inline-end: 14px;\n\twhite-space: nowrap;\n}\n\n.help-text p {\n\tmargin-bottom: 0.2em;\n}\n\n.help-text {\n\tmargin-bottom: calc(var(--default-grid-baseline) * 2);\n}\n"],sourceRoot:""}]);const A=o},18139:(t,e,n)=>{n.d(e,{A:()=>y});var a=n(49123),i=n.n(a),l=(n(18149),n(28290)),o=n(51849),A=n(49519);const s={name:"MailboxInlinePicker",components:{Treeselect:i()},props:{account:{type:Object,required:!0},disabled:{type:Boolean,default:!1},value:{type:Number,default:void 0}},data(){return{selected:this.value}},computed:{...(0,o.n2)(A.A),mailboxes(){return this.getMailboxes()}},watch:{selected(t){t!==this.value&&(this.$emit("input",t),this.selected=t)}},methods:{getMailboxes(t){let e=[];return e=t?this.mainStore.getSubMailboxes(t):this.mainStore.getMailboxes(this.account.accountId),e=e.filter((t=>(0,l.w)(t,"i"))),e.map((t=>({id:t.databaseId,label:t.displayName,children:t.mailboxes.length>0?this.getMailboxes(t.databaseId):""})))}}};var r=n(85072),c=n.n(r),d=n(97825),u=n.n(d),p=n(77659),m=n.n(p),h=n(55056),g=n.n(h),f=n(10540),v=n.n(f),b=n(41113),C=n.n(b),_=n(6707),x={};x.styleTagTransform=C(),x.setAttributes=g(),x.insert=m().bind(null,"head"),x.domAPI=u(),x.insertStyleElement=v(),c()(_.A,x),_.A&&_.A.locals&&_.A.locals;const y=(0,n(14486).A)(s,(function(){var t=this;return(0,t._self._c)("Treeselect",{ref:"Treeselect",attrs:{options:t.mailboxes,multiple:!1,clearable:!1,disabled:t.disabled},model:{value:t.selected,callback:function(e){t.selected=e},expression:"selected"}})}),[],!1,null,null,null).exports},18467:t=>{t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAMAAADXqc3KAAAAUVBMVEUAAADh4eHh4eHh4eHh4eHi4uLi4uLh4eHh4eHh4eHf39/j4+Ph4eHh4eHh4eHg4ODi4uLh4eHh4eHi4uLh4eHh4eHh4eHh4eHh4eH////h4eF3FMFTAAAAGnRSTlMA+/eJhGhfSHE9JBzz5KaQf3pXT0Xbz0I5AYDw8F0AAAB+SURBVCjPrdHbDoMgEEVRKAii1dZe9fz/hxplTiKIT7qfYCWTEEZdUvOwbckNAD2WHeh3brHW5f5EzGQ+iN+b1Gt6KPvtv16Dn6JX9M9ya3/A1yfu5dlyduL6Hec7mXY6ddXLPP2lpABGZ8PWXfYLTJxZekVhhl7eTX24zZPNKXoRC7zQLjUAAAAASUVORK5CYII="},34867:t=>{t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAIAgMAAAC5YVYYAAAACVBMVEUAAADi4uLh4eHOxeSRAAAAAnRSTlMAuLMp9oYAAAAPSURBVAjXY4CDrJUgBAMAGaECJ9dz3BAAAAAASUVORK5CYII="},35121:t=>{t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQAgMAAABinRfyAAAADFBMVEUAAADi4uLi4uLh4eE5RQaIAAAAA3RSTlMAyTzPIdReAAAAGUlEQVQI12PAD+b///+Nof7//79gAsLFCwAx/w4blADeeQAAAABJRU5ErkJggg=="},40136:t=>{t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAMAAAAoLQ9TAAAAYFBMVEUAAAD///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////98JRy6AAAAH3RSTlMAzu4sDenl38fBvo1OMyIdEQrj1cSihX5hYFpHNycIcQOASAAAAF9JREFUGNN9zEcOgDAMRFHTS0LvNfe/JRmHKAIJ/mqeLJn+k9uDtaeUeFnFziGsBucUTirrprfe81RqZ3Bb6hPWeuZwDFOHyf+ig9CCzQ7INBn7bG5kF+QSt13BHNJnF7AaCT4Y+CW7AAAAAElFTkSuQmCC"},40620:(t,e,n)=>{n.d(e,{A:()=>A});var a=n(71354),i=n.n(a),l=n(76314),o=n.n(l)()(i());o.push([t.id,".input-field[data-v-68890c32]{min-width:260px}","",{version:3,sources:["webpack://./src/components/mailFilter/ActionAddflag.vue"],names:[],mappings:"AACA,8BACC,eAAA",sourcesContent:["\n.input-field {\n\tmin-width: 260px;\n}\n"],sourceRoot:""}]);const A=o},41387:t=>{t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYBAMAAAASWSDLAAAAD1BMVEUAAADh4eHg4ODNzc3h4eEYfw2wAAAABHRSTlMAy2EFIuWxUgAAACRJREFUGNNjGBBgJOICBY7KDCoucODEAJSAS6FwUJShGjAQAADBPRGrK2/FhgAAAABJRU5ErkJggg=="},42702:(t,e,n)=>{n.d(e,{R2:()=>l,cc:()=>r,cj:()=>c,fJ:()=>A,kv:()=>a,sm:()=>s,xj:()=>i});var a,i,l,o=n(10362);!function(t){t.All="allof",t.Any="anyof"}(a||(a={})),function(t){t.From="from",t.Subject="subject",t.To="to"}(i||(i={})),function(t){t.Contains="contains",t.Is="is",t.Matches="matches"}(l||(l={}));class A{id;field;operator;values;constructor(){this.id=(0,o.z)()}hasValues(){return this.values.length>0}}class s{id;type;mailbox;constructor(){this.id=(0,o.z)(),this.type="fileinto"}}class r{id;type;constructor(){this.id=(0,o.z)(),this.type="stop"}}class c{id;name;enable=!1;operator;tests;actions;priority=0;constructor(){this.id=(0,o.z)()}}},46805:(t,e,n)=>{n.d(e,{A:()=>A});var a=n(71354),i=n.n(a),l=n(76314),o=n.n(l)()(i());o.push([t.id,".solid[data-v-47891d35]{margin:calc(var(--default-grid-baseline)*4) 0 0 0}.mail-filter-rows[data-v-47891d35]{margin-bottom:calc(var(--default-grid-baseline)*4)}.mail-filter-rows__row[data-v-47891d35]{display:flex;gap:var(--default-grid-baseline);align-items:baseline}.mail-filter-rows__row__column[data-v-47891d35]{display:block;flex-grow:1}.mail-filter-rows__row__column *[data-v-47891d35]{width:100%}.mail-filter-rows__row__select[data-v-47891d35]{max-width:100% !important;width:100%}.values-list[data-v-47891d35]{display:flex;gap:var(--default-grid-baseline);flex-wrap:wrap}.values-list__item[data-v-47891d35]{display:flex;gap:var(--default-grid-baseline)}","",{version:3,sources:["webpack://./src/components/mailFilter/Test.vue"],names:[],mappings:"AACA,wBACC,iDAAA,CAGD,mCACC,kDAAA,CACA,wCACC,YAAA,CACA,gCAAA,CACA,oBAAA,CACA,gDACC,aAAA,CACA,WAAA,CAED,kDACC,UAAA,CAED,gDACC,yBAAA,CACA,UAAA,CAMH,8BACC,YAAA,CACA,gCAAA,CACA,cAAA,CACA,oCACC,YAAA,CACA,gCAAA",sourcesContent:["\n.solid {\n\tmargin: calc(var(--default-grid-baseline) * 4) 0 0 0;\n}\n\n.mail-filter-rows {\n\tmargin-bottom: calc(var(--default-grid-baseline) * 4);\n\t&__row {\n\t\tdisplay: flex;\n\t\tgap: var(--default-grid-baseline);\n\t\talign-items: baseline;\n\t\t&__column {\n\t\t\tdisplay: block;\n\t\t\tflex-grow: 1;\n\t\t}\n\t\t&__column *{\n\t\t\twidth: 100%;\n\t\t}\n\t\t&__select {\n\t\t\tmax-width: 100% !important;\n\t\t\twidth: 100%;\n\t\t}\n\n\t}\n}\n\n.values-list {\n\tdisplay: flex;\n\tgap: var(--default-grid-baseline);\n\tflex-wrap: wrap;\n\t&__item {\n\t\tdisplay: flex;\n\t\tgap: var(--default-grid-baseline);\n\t}\n}\n"],sourceRoot:""}]);const A=o},63679:t=>{t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQAgMAAABinRfyAAAADFBMVEUAAAD///////////84wDuoAAAAA3RSTlMAyTzPIdReAAAAGUlEQVQI12PAD+b///+Nof7//79gAsLFCwAx/w4blADeeQAAAABJRU5ErkJggg=="},65926:(t,e,n)=>{n.d(e,{A:()=>A});var a=n(71354),i=n.n(a),l=n(76314),o=n.n(l)()(i());o.push([t.id,".mail-filter-row[data-v-0761af72]{display:flex;gap:5px}","",{version:3,sources:["webpack://./src/components/mailFilter/Action.vue"],names:[],mappings:"AACA,kCACC,YAAA,CACA,OAAA",sourcesContent:["\n.mail-filter-row {\n\tdisplay: flex;\n\tgap: 5px;\n}\n"],sourceRoot:""}]);const A=o},66214:(e,n,a)=>{a.d(n,{A:()=>L});var i=a(4658),l=a(99495),o=a(42702);const A={name:"Test",components:{NcButton:i.x1,NcSelect:i.EQ,DeleteIcon:l.A},props:{test:{type:Object,required:!0}},data:()=>({inputValue:"",localValues:[],fields:[o.xj.Subject,o.xj.From,o.xj.To],operators:[o.R2.Is,o.R2.Contains,o.R2.Matches]}),mounted(){this.localValues=[...this.test.values]},methods:{updateTest(t){this.$emit("update-test",{...this.test,...t})},deleteTest(){this.$emit("delete-test",this.test)},getLabelForField(e){switch(e){case o.xj.Subject:return t("mail","Subject");case o.xj.From:return t("mail","Sender");case o.xj.To:return t("mail","Recipient")}return e},getLabelForOperator(e){switch(e){case o.R2.Is:return t("mail","is exactly");case o.R2.Contains:return t("mail","contains");case o.R2.Matches:return t("mail","matches")}return e}}};var s=a(85072),r=a.n(s),c=a(97825),d=a.n(c),u=a(77659),p=a.n(u),m=a(55056),h=a.n(m),g=a(10540),f=a.n(g),v=a(41113),b=a.n(v),C=a(46805),_={};_.styleTagTransform=b(),_.setAttributes=h(),_.insert=p().bind(null,"head"),_.domAPI=d(),_.insertStyleElement=f(),r()(C.A,_),C.A&&C.A.locals&&C.A.locals;var x=a(14486);const y=(0,x.A)(A,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"mail-filter-rows"},[e("div",{staticClass:"mail-filter-rows__row"},[e("div",{staticClass:"mail-filter-rows__row__column"},[e("NcSelect",{attrs:{"input-label":"field",value:t.test.field,required:!0,"label-outside":!0,options:t.fields},on:{input:function(e){return t.updateTest({field:e})}},scopedSlots:t._u([{key:"selected-option",fn:function(e){let{label:n}=e;return[t._v("\n\t\t\t\t\t"+t._s(t.getLabelForField(n))+"\n\t\t\t\t")]}},{key:"option",fn:function(e){let{label:n}=e;return[t._v("\n\t\t\t\t\t"+t._s(t.getLabelForField(n))+"\n\t\t\t\t")]}}])})],1),t._v(" "),e("div",{staticClass:"mail-filter-rows__row__column"},[e("NcSelect",{attrs:{"input-label":"operator",value:t.test.operator,required:!0,"label-outside":!0,options:t.operators},on:{input:function(e){return t.updateTest({operator:e})}},scopedSlots:t._u([{key:"selected-option",fn:function(e){let{label:n}=e;return[t._v("\n\t\t\t\t\t"+t._s(t.getLabelForOperator(n))+"\n\t\t\t\t")]}},{key:"option",fn:function(e){let{label:n}=e;return[t._v("\n\t\t\t\t\t"+t._s(t.getLabelForOperator(n))+"\n\t\t\t\t")]}}])})],1),t._v(" "),e("div",{staticClass:"mail-filter-rows__row__column"},[e("NcButton",{attrs:{"aria-label":"Delete action",type:"tertiary-no-background"},on:{click:t.deleteTest},scopedSlots:t._u([{key:"icon",fn:function(){return[e("DeleteIcon",{attrs:{size:20}})]},proxy:!0}])},[t._v("\n\t\t\t\t"+t._s(t.t("mail","Delete test"))+"\n\t\t\t")])],1)]),t._v(" "),e("div",{staticClass:"mail-filter-rows__row"},[e("NcSelect",{staticClass:"mail-filter-rows__row__select",attrs:{"input-label":"value",multiple:!0,wrap:!0,"close-on-select":!1,taggable:!0,required:!0},on:{"option:selected":function(e){return t.updateTest({values:t.localValues})},"option:deselected":function(e){return t.updateTest({values:t.localValues})}},model:{value:t.localValues,callback:function(e){t.localValues=e},expression:"localValues"}})],1),t._v(" "),e("hr",{staticClass:"solid"})])}),[],!1,null,"47891d35",null).exports,w={name:"Operator",components:{NcCheckboxRadioSwitch:i.AO},props:{filter:{type:Object,required:!0}},data:()=>({MailFilterOperator:o.kv}),methods:{updateFilter(t){this.$emit("update:operator",t)}}},B=(0,x.A)(w,(function(){var t=this,e=t._self._c;return e("div",[e("div",[e("h6",[t._v(t._s(t.t("mail","Operator")))])]),t._v(" "),e("div",[e("NcCheckboxRadioSwitch",{attrs:{checked:t.filter.operator,value:t.MailFilterOperator.All,name:"sharing_permission_radio",type:"radio"},on:{"update:checked":function(e){return t.updateFilter(t.MailFilterOperator.All)}}},[t._v("\n\t\t\t"+t._s(t.t("mail","If all the conditions are met, the actions will be performed"))+"\n\t\t")]),t._v(" "),e("NcCheckboxRadioSwitch",{attrs:{checked:t.filter.operator,value:t.MailFilterOperator.Any,name:"sharing_permission_radio",type:"radio"},on:{"update:checked":function(e){return t.updateFilter(t.MailFilterOperator.Any)}}},[t._v("\n\t\t\t"+t._s(t.t("mail","If any of the conditions are met, the actions will be performed"))+"\n\t\t")])],1)])}),[],!1,null,null,null).exports;var I=a(10362),S=a(51849),M=a(49519);const D={name:"ActionFileinto",components:{MailboxInlinePicker:a(18139).A},props:{action:{type:Object,required:!0},account:{type:Object,required:!0}},computed:{...(0,S.n2)(M.A),mailbox(){return this.getMailboxDatabaseIdByName(this.action?.mailbox)}},methods:{onInput(t){this.$emit("update-action",{mailbox:this.getMailboxNameByDatabaseId(t)})},getMailboxDatabaseIdByName(t){return this.mainStore.getMailboxesAndSubmailboxesByAccountId(this.account.id).find((e=>e.name===t))?.databaseId},getMailboxNameByDatabaseId(t){return this.mainStore.getMailbox(t)?.name}}},E=(0,x.A)(D,(function(){var t=this;return(0,t._self._c)("MailboxInlinePicker",{attrs:{account:t.account,value:t.mailbox},on:{input:t.onInput}})}),[],!1,null,null,null).exports,R={name:"ActionAddflag",components:{NcTextField:i.v},props:{action:{type:Object,required:!0},account:{type:Object,required:!0}},computed:{flag(){return this.action.flag??""}},methods:{onInput(t){this.$emit("update-action",{flag:t})}}};var T=a(40620),k={};k.styleTagTransform=b(),k.setAttributes=h(),k.insert=p().bind(null,"head"),k.domAPI=d(),k.insertStyleElement=f(),r()(T.A,k),T.A&&T.A.locals&&T.A.locals;const N=(0,x.A)(R,(function(){var t=this;return(0,t._self._c)("NcTextField",{attrs:{required:!0,label:t.t("mail","Flag"),value:t.flag},on:{"update:value":t.onInput}})}),[],!1,null,"68890c32",null).exports,U={name:"ActionStop",props:{action:{type:Object,required:!0},account:{type:Object,required:!0}}},O=(0,x.A)(U,(function(){var t=this;return(0,t._self._c)("p",[t._v(t._s(t.t("mail","The stop action ends all processing")))])}),[],!1,null,null,null).exports,F={name:"Action",components:{NcSelect:i.EQ,NcTextField:i.v,NcButton:i.x1,ActionFileinto:E,ActionAddflag:N,ActionStop:O,DeleteIcon:l.A},props:{action:{type:Object,required:!0},account:{type:Object,required:!0}},data:()=>({availableTypes:["addflag","fileinto","stop"]}),computed:{componentInstance(){return"fileinto"===this.action.type?E:"addflag"===this.action.type?N:"stop"===this.action.type?O:null}},methods:{updateAction(t){this.$emit("update-action",{...this.action,...t})},deleteAction(){this.$emit("delete-action",this.action)}}};var H=a(65926),V={};V.styleTagTransform=b(),V.setAttributes=h(),V.insert=p().bind(null,"head"),V.domAPI=d(),V.insertStyleElement=f(),r()(H.A,V),H.A&&H.A.locals&&H.A.locals;const j=(0,x.A)(F,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"mail-filter-row"},[e("div",{staticClass:"mail-filter-column"},[e("NcSelect",{attrs:{value:t.action.type,required:!0,"label-outside":!0,options:t.availableTypes},on:{input:function(e){return t.updateAction({type:e})}}})],1),t._v(" "),e("div",{staticClass:"mail-filter-column"},[t.componentInstance?e(t.componentInstance,{tag:"component",attrs:{action:t.action,account:t.account},on:{"update-action":t.updateAction}}):t._e()],1),t._v(" "),e("div",{staticClass:"mail-filter-column"},[e("NcButton",{attrs:{"aria-label":"Delete action",type:"tertiary-no-background"},on:{click:t.deleteAction},scopedSlots:t._u([{key:"icon",fn:function(){return[e("DeleteIcon",{attrs:{size:20}})]},proxy:!0}])},[t._v("\n\t\t\t"+t._s(t.t("mail","Delete action"))+"\n\t\t\t")])],1)])}),[],!1,null,"0761af72",null).exports,Y={name:"UpdateModal",components:{IconCheck:a(90629).A,Action:j,Operator:B,Test:y,NcButton:i.x1,NcCheckboxRadioSwitch:i.AO,NcLoadingIcon:i.ne,NcModal:i.FH,NcTextField:i.v},props:{filter:{type:Object,required:!0},account:{type:Object,required:!0},loading:{type:Boolean,required:!1}},data(){return{clone:structuredClone(this.filter)}},methods:{createTest(){this.clone.tests.push({id:(0,I.z)(),operator:null,values:[]})},updateTest(t){const e=this.clone.tests.findIndex((e=>e.id===t.id));this.$set(this.clone.tests,e,t)},deleteTest(t){this.clone.tests=this.clone.tests.filter((e=>e.id!==t.id))},createAction(){this.clone.actions.push({id:(0,I.z)(),type:null})},updateAction(t){const e=this.clone.actions.findIndex((e=>e.id===t.id));this.$set(this.clone.actions,e,t)},updateOperator(t){this.clone.operator=t},deleteAction(t){this.clone.actions=this.clone.actions.filter((e=>e.id!==t.id))},updateFilter(){this.$emit("update-filter",structuredClone(this.clone))},closeModal(){this.$emit("close")}}};var z=a(13729),G={};G.styleTagTransform=b(),G.setAttributes=h(),G.insert=p().bind(null,"head"),G.domAPI=d(),G.insertStyleElement=f(),r()(z.A,G),z.A&&z.A.locals&&z.A.locals;const L=(0,x.A)(Y,(function(){var t=this,e=t._self._c;return e("NcModal",{attrs:{size:"large","close-on-click-outside":!1,name:t.t("mail","Update mail filter")},on:{close:t.closeModal}},[e("form",{staticClass:"modal__content",on:{submit:function(e){return e.preventDefault(),t.updateFilter.apply(null,arguments)}}},[e("div",{staticClass:"filter-name"},[e("NcTextField",{attrs:{value:t.clone.name,label:t.t("mail","Filter name"),required:!0},on:{"update:value":function(e){return t.$set(t.clone,"name",e)}}})],1),t._v(" "),e("div",{staticClass:"filter-operator"},[e("Operator",{attrs:{filter:t.clone},on:{"update:operator":t.updateOperator}})],1),t._v(" "),e("div",{staticClass:"filter-tests"},["allof"===t.clone.operator?e("h6",[t._v("\n\t\t\t\t"+t._s(t.t("mail","If all the conditions are met"))+"\n\t\t\t")]):e("h6",[t._v("\n\t\t\t\t"+t._s(t.t("mail","If any of the conditions are met"))+"\n\t\t\t")]),t._v(" "),e("div",{staticClass:"help-text"},[e("p",[t._v("\n\t\t\t\t\t"+t._s(t.t("mail","Tests are applied to incoming emails on your mail server, targeting fields such as subject (the email's subject line), from (the sender), and to (the recipient). You can use the following operators to define conditions for these fields:"))+"\n\t\t\t\t")]),t._v(" "),e("p",[e("strong",[t._v("is")]),t._v(": "+t._s(t.t("mail","An exact match. The field must be identical to the provided value."))+"\n\t\t\t\t")]),t._v(" "),e("p",[e("strong",[t._v("contains")]),t._v(": "+t._s(t.t("mail",'A substring match. The field matches if the provided value is contained within it. For example, "report" would match "port".'))+"\n\t\t\t\t")]),t._v(" "),e("p",[e("strong",[t._v("matches")]),t._v(": "+t._s(t.t("mail",'A pattern match using wildcards. The "*" symbol represents any number of characters (including none), while "?" represents exactly one character. For example, "*report*" would match "Business report 2024".'))+"\n\t\t\t\t")])]),t._v(" "),t._l(t.clone.tests,(function(n){return e("Test",{key:n.id,attrs:{test:n},on:{"update-test":t.updateTest,"delete-test":t.deleteTest}})})),t._v(" "),e("NcButton",{staticClass:"app-settings-button",attrs:{type:"secondary","aria-label":t.t("mail","Add condition")},on:{click:t.createTest}},[t._v("\n\t\t\t\t"+t._s(t.t("mail","Add condition"))+"\n\t\t\t")])],2),t._v(" "),e("div",{staticClass:"filter-actions"},[e("h6",[t._v(t._s(t.t("mail","Then perform these actions")))]),t._v(" "),e("div",{staticClass:"help-text"},[e("p",[t._v("\n\t\t\t\t\t"+t._s(t.t("mail","Actions are triggered when the specified tests are true. The following actions are available:"))+"\n\t\t\t\t")]),t._v(" "),e("p",[e("strong",[t._v("fileinto")]),t._v(": "+t._s(t.t("mail","Moves the message into a specified folder."))+"\n\t\t\t\t")]),t._v(" "),e("p",[e("strong",[t._v("addflag")]),t._v(": "+t._s(t.t("mail","Adds a flag to the message."))+"\n\t\t\t\t")]),t._v(" "),e("p",[e("strong",[t._v("stop")]),t._v(": "+t._s(t.t("mail","Halts the execution of the filter script. No further filters with will be processed after this action."))+"\n\t\t\t\t")])]),t._v(" "),t._l(t.clone.actions,(function(n){return e("Action",{key:n.id,attrs:{action:n,account:t.account},on:{"update-action":t.updateAction,"delete-action":t.deleteAction}})})),t._v(" "),e("NcButton",{staticClass:"app-settings-button",attrs:{type:"secondary","aria-label":t.t("mail","Add action")},on:{click:t.createAction}},[t._v("\n\t\t\t\t"+t._s(t.t("mail","Add action"))+"\n\t\t\t")])],2),t._v(" "),e("NcTextField",{attrs:{value:t.clone.priority,type:"number",label:t.t("mail","Priority"),required:!0},on:{"update:value":function(e){return t.$set(t.clone,"priority",e)}}}),t._v(" "),e("NcCheckboxRadioSwitch",{attrs:{checked:t.clone.enable,type:"switch"},on:{"update:checked":function(e){return t.$set(t.clone,"enable",e)}}},[t._v("\n\t\t\t"+t._s(t.t("mail","Enable filter"))+"\n\t\t")]),t._v(" "),e("NcButton",{attrs:{type:"primary","native-type":"submit"},scopedSlots:t._u([{key:"icon",fn:function(){return[t.loading?e("NcLoadingIcon",{attrs:{size:20}}):e("IconCheck",{attrs:{size:20}})]},proxy:!0}])},[t._v("\n\t\t\t"+t._s(t.t("mail","Save filter"))+"\n\t\t")])],1)])}),[],!1,null,"3d125024",null).exports},77905:t=>{t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAMAAADz0U65AAAAP1BMVEUAAADj4+Pf39/h4eHh4eHh4eHk5OTh4eHg4ODi4uLh4eHh4eHg4ODh4eHh4eHg4ODh4eHh4eHp6en////h4eFqcyvUAAAAFHRSTlMAOQfy7bgS5NrBvqOIfXNHMSELAgQ/iFsAAAA2SURBVAjXY4AANjYIzcjMAaVFuBkY+RkEWERYmRjYRXjANAOfiIgIFxNIAa8IpxBEi6AwiAQAK2MBd7xY8csAAAAASUVORK5CYII="},83957:(t,e,n)=>{n.d(e,{A:()=>s});var a=n(51849),i=n(63814),l=n(70715),o=n(10362),A=n(85745);const s=(0,a.nY)("mailFilter",{state:()=>({filters:[]}),actions:{async fetch(t){await this.$patch((async e=>{const n=await async function(t){const e=(0,i.Jv)("/apps/mail/api/filter/{accountId}",{accountId:t}),{data:n}=await l.Ay.get(e);return n}(t);e.filters=n.map((t=>(t.id=(0,o.z)(),t.tests.map((t=>(t.id=(0,o.z)(),t))),t.actions.map((t=>(t.id=(0,o.z)(),t))),t)))}))},async store(t){let e=structuredClone(this.filters);e=e.map((t=>(delete t.id,t.tests.map((t=>(delete t.id,t))),t.actions.map((t=>(delete t.id,t))),t))),await async function(t,e){const n=(0,i.Jv)("/apps/mail/api/filter/{accountId}",{accountId:t}),{data:a}=await l.Ay.put(n,{filters:e});return a}(t,e)},async update(t){await this.$patch((e=>{const n=e.filters.findIndex((e=>e.id===t.id));A.A.debug("update filter",{filter:t,index:n}),-1===n?e.filters.push(t):e.filters[n]=t,e.filters.sort(((t,e)=>t.priority-e.priority))}))},async delete(t){await this.$patch((e=>{const n=e.filters.findIndex((e=>e.id===t.id));A.A.debug("delete filter",{filter:t,index:n}),-1!==n&&e.filters.splice(n,1)}))}}})},85752:t=>{t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAMAAADXqc3KAAAAWlBMVEUAAAD///////////////////////////////////////////////////////////////////////////////////////////////////////////////////9ZMre9AAAAHXRSTlMA/PiJhGNI9XlEHJB/b2ldV08+Oibk49vPp6QhAYgGBuwAAACCSURBVCjPrdHdDoIwDAXgTWAqCigo/+f9X5OwnoUwtis4V92XNWladUl+rzQPeQJAN2EHxoOnsPn7/oYk8fxBv08Rr/deOH/aZ2Nm8ZJ+s573QGfWKnNuZGzWm3+lv2V3pcU1XQ385/yjmBoM3Z+dXvlbYLLD3ujhTaOM3KaIXvNkFkuSEvYy1LqOAAAAAElFTkSuQmCC"},95773:t=>{t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAMAAAAoLQ9TAAAAXVBMVEUAAADh4eHh4eHh4eHi4uLb29vh4eHh4eHh4eHh4eHh4eHh4eHh4eHi4uLi4uLj4+Pi4uLk5OTo6Ojh4eHh4eHi4uLg4ODg4ODh4eHg4ODh4eHf39/g4OD////h4eEzIk+wAAAAHnRSTlMAzu6/LA3p5eLZx8ONTjYiHRIKooV+YWBaRzEnCANnm5rnAAAAZElEQVQY033P2wqAIAyA4VWaaWrnc/n+j5mbhBjUf7WPoTD47TJb4i5zTr/sRDRHuyFaoWX7uK/RlbctlPEuyI1f4WY9yQINEkf6rzzo8YIzmUFoCs7J1EjeIaa9bXIEmzl8dgOZEAj/+2IvzAAAAABJRU5ErkJggg=="},96443:t=>{t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAMAAADz0U65AAAAQlBMVEUAAAD///////////////////////////////////////////////////////////////////////////////////8IX9KGAAAAFXRSTlMA8u24NxILB+Tawb6jiH1zRz0xIQIIP3GUAAAAMklEQVQI1y3FtQEAMQDDQD+EGbz/qkEVOpyEOP6PudKjZNSXn4Jm2CKRdBKzSLsFWl8fMG0Bl6Jk1rMAAAAASUVORK5CYII="}}]);
//# sourceMappingURL=mail.563.4e698f80f00413c9426f.js.map